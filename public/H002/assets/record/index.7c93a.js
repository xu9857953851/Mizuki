window.__require=function t(e,r,o){function a(_,n){if(!r[_]){if(!e[_]){var c=_.split("/");if(c=c[c.length-1],!e[c]){var i="function"==typeof __require&&__require;if(!n&&i)return i(c,!0);if(d)return d(c,!0);throw new Error("Cannot find module '"+_+"'")}_=c}var s=r[_]={exports:{}};e[_][0].call(s.exports,function(t){return a(e[_][1][t]||t)},s,s.exports,t,e,r,o)}return r[_].exports}for(var d="function"==typeof __require&&__require,_=0;_<o.length;_++)a(o[_]);return a}({RecordEntry:[function(t,e,r){"use strict";cc._RF.push(e,"7ba15LKlu9Onq06FtAyyWFG","RecordEntry");var o=__extends,a=__decorate;Object.defineProperty(r,"__esModule",{value:!0}),r.RecordEntry=void 0;var d=t("RecordData"),_=t("GameManager"),n=t("NodePoolItem"),c=t("Timer"),i=t("Utils"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.record_start_btn=null,e.record_stop_btn=null,e.time_lbl=null,e}return o(e,t),e.prototype.onLoad=function(){_.gm.data.event_emitter.on(d.RecordData.RECORD_STATE_CHANGE,this.on_record_state_change_handler,this),this.on_record_state_change_handler()},e.prototype.onEnable=function(){this.on_record_state_change_handler()},e.prototype.onDestroy=function(){_.gm.data.event_emitter.off(d.RecordData.RECORD_STATE_CHANGE,this.on_record_state_change_handler,this),this._time&&this._time.stop()},e.prototype.editor_on_button_click_handler=function(t){if(t.target==this.record_start_btn.node)_.gm.ui.show_panel(_.gm.const.Record);else if(t.target==this.record_stop_btn.node){if(Math.floor((Date.now()-_.gm.data.record_data.record_timestamp)/1e3)<d.RecordData.MIN_RECORD_TIME)return void _.gm.ui.show_notice(cc.js.formatStr("\u5f55\u5236\u65f6\u95f4\u4e0d\u80fd\u5c11\u4e8e%d\u79d2",d.RecordData.MIN_RECORD_TIME));this.stop_record()}},e.prototype.on_record_state_change_handler=function(){var t=this;this.record_start_btn.node.active=1!=_.gm.data.record_data.record_state,this.record_stop_btn.node.active=1==_.gm.data.record_data.record_state,1==_.gm.data.record_data.record_state?(this._time||(this._time=new c.Timer),this._time.is_running||this._time.start(function(){var e=Math.floor((Date.now()-_.gm.data.record_data.record_timestamp)/1e3);t.time_lbl.string=i.Utils.time_format(e,"mm:ss"),e>=d.RecordData.AUTO_END_RECORD_TIME&&(t._time.stop(),t.stop_record())},1e3,0)):this._time&&this._time.stop()},e.prototype.stop_record=function(){_.gm.channel.record_stop(!1),_.gm.data.record_data.record_state=2,_.gm.data.event_emitter.emit(d.RecordData.RECORD_STATE_CHANGE),_.gm.ui.show_panel(_.gm.const.Record)},a([m(cc.Button)],e.prototype,"record_start_btn",void 0),a([m(cc.Button)],e.prototype,"record_stop_btn",void 0),a([m(cc.Label)],e.prototype,"time_lbl",void 0),a([l],e)}(n.NodePoolItem);r.RecordEntry=u,cc._RF.pop()},{GameManager:void 0,NodePoolItem:void 0,RecordData:void 0,Timer:void 0,Utils:void 0}],Record:[function(t,e,r){"use strict";cc._RF.push(e,"ef397359stMXqP344+dUQui","Record");var o=__extends,a=__decorate;Object.defineProperty(r,"__esModule",{value:!0}),r.Record=void 0;var d=t("ChannelManager"),_=t("Constants"),n=t("RecordData"),c=t("GameManager"),i=t("GameModule"),s=t("Utils"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon_spr=null,e.count_lbl=null,e.name_lbl=null,e.piece_node=null,e.close_btn=null,e.record_btn=null,e.share_record_btn=null,e}return o(e,t),e.prototype.onEnable=function(){if(c.gm.channel.show_banner_ad(d.BANNER_AD_TYPE.ALL),c.gm.data.record_data.share_record_count<c.gm.data.record_data.reward_array.length?this._reward_data=c.gm.data.record_data.reward_array[c.gm.data.record_data.share_record_count]:this._reward_data=c.gm.data.record_data.reward_data,this.count_lbl.string="X"+this._reward_data.value,this._reward_data){var t=c.gm.config.get_row_data("PropConfigData",this._reward_data.id.toString());t&&(this.name_lbl.string=t.name+"x"+this._reward_data.value,s.Utils.async_set_sprite_frame(this.icon_spr,_.BundleName.COMMON,"res/show/"+t.icon_id)),this.piece_node.active=this._reward_data.id!=_.RewardIdEnum.DIAMOND}this.record_btn.node.active=0==c.gm.data.record_data.record_state,this.share_record_btn.node.active=2==c.gm.data.record_data.record_state},e.prototype.onDisable=function(){c.gm.channel.hide_banner_ad(d.BANNER_AD_TYPE.ALL)},e.prototype.editor_on_button_click_handler=function(t){var e=this;t.target==this.close_btn.node?c.gm.ui.async_hide_module(c.gm.const.Record):t.target==this.record_btn.node?(c.gm.channel.record_start(),c.gm.data.record_data.record_state=1,c.gm.data.record_data.record_timestamp=Date.now(),c.gm.data.event_emitter.emit(n.RecordData.RECORD_STATE_CHANGE),c.gm.ui.async_hide_module(c.gm.const.Record)):t.target==this.share_record_btn.node&&c.gm.channel.viedo_share(!0,function(t){0==t&&e._reward_data&&(c.gm.ui.async_hide_module(c.gm.const.Record),c.gm.data.record_data.share_record_count++,c.gm.data.record_data.record_state=0,c.gm.data.record_data.record_timestamp=0,c.gm.data.event_emitter.emit(n.RecordData.RECORD_STATE_CHANGE),c.gm.data.record_data.async_write_data(),c.gm.data.warehouse_data.player_add_item(e._reward_data.id,e._reward_data.value),e._reward_data.id==_.RewardIdEnum.DIAMOND?c.gm.ui.show_coin_fly(_.RewardIdEnum.DIAMOND,e.icon_spr.node.convertToWorldSpaceAR(cc.Vec3.ZERO)):c.gm.ui.start.fly_hero_piece(e.icon_spr.node))})},a([u(cc.Sprite)],e.prototype,"icon_spr",void 0),a([u(cc.Label)],e.prototype,"count_lbl",void 0),a([u(cc.Label)],e.prototype,"name_lbl",void 0),a([u(cc.Node)],e.prototype,"piece_node",void 0),a([u(cc.Button)],e.prototype,"close_btn",void 0),a([u(cc.Button)],e.prototype,"record_btn",void 0),a([u(cc.Button)],e.prototype,"share_record_btn",void 0),a([m],e)}(i.GameModule);r.Record=p,cc._RF.pop()},{ChannelManager:void 0,Constants:void 0,GameManager:void 0,GameModule:void 0,RecordData:void 0,Utils:void 0}]},{},["Record","RecordEntry"]);