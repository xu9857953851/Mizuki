window.__require=function a(t,e,n){function i(r,_){if(!e[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var d="function"==typeof __require&&__require;if(!_&&d)return d(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var c=e[r]={exports:{}};t[r][0].call(c.exports,function(a){return i(t[r][1][a]||a)},c,c.exports,a,t,e,n)}return e[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({SignDay:[function(a,t,e){"use strict";cc._RF.push(t,"69a4aRIqVhA66E69myssjBS","SignDay");var n=__extends,i=__decorate;Object.defineProperty(e,"__esModule",{value:!0}),e.SignDay=void 0;var o=a("ChannelManager"),r=a("Constants"),_=a("TaskData"),s=a("GameManager"),d=a("GameModule"),c=a("Utils"),g=a("NetUtils"),y=cc._decorator,l=y.ccclass,u=y.property,m=function(a){function t(){var t=null!==a&&a.apply(this,arguments)||this;return t.btn_close=null,t.video_btn=null,t.cancle_btn=null,t.close_btn=null,t.day_ary=[],t}return n(t,a),t.prototype.onEnable=function(){var a=this;s.gm.channel.show_banner_ad(o.BANNER_AD_TYPE.ALL),s.gm.ui.start.auto_pause(),c.Utils.set_sprite_state(this.video_btn.node,cc.Sprite.State.GRAY),this.video_btn.interactable=!1,this.video_btn.node.active=!1,this.btn_close.node.active=!1,this.cancle_btn.node.active=!1,s.gm.data.sign_data.today_sign_state<=0?(this.video_btn.node.active=!0,c.Utils.set_sprite_state(this.video_btn.node,cc.Sprite.State.NORMAL),this.video_btn.interactable=!0,s.gm.channel.get_channel_name()==o.ChannelManager.TT_GAME?this.cancle_btn.node.active=!0:this.scheduleOnce(function(){a.cancle_btn.node.active=!0},s.gm.const.CLOSE_BTN_DELAY_TIME),this.close_btn.node.active=!1):this.close_btn.node.active=!0,this.update_view()},t.prototype.onDisable=function(){s.gm.channel.hide_banner_ad(o.BANNER_AD_TYPE.ALL),s.gm.ui.start.resume_auto_pause()},t.prototype.update_view=function(){for(var a=0;a<7;++a){var t=s.gm.config.get_row_data("SignConfigData",1+a+"");this.day_ary[a].getChildByName("count").getComponent(cc.Label).string="x"+t.array[0].value,a<6&&(1==a?c.Utils.async_set_sprite_frame(this.day_ary[a].getChildByName("icon").getComponent(cc.Sprite),r.BundleName.COMMON,"res/show/"+t.array[0].id):c.Utils.async_set_sprite_frame(this.day_ary[a].getChildByName("icon").getComponent(cc.Sprite),r.BundleName.SIGN,"res/"+t.array[0].id));var e=this.day_ary[a].getChildByName("normal_choose");s.gm.data.sign_data.today_sign_state>0&&s.gm.data.sign_data.sign_day==a+1||s.gm.data.sign_data.sign_day>a+1?(this.day_ary[a].getChildByName("gain").active=!0,e.stopAllActions()):(this.day_ary[a].getChildByName("gain").active=!1,e.opacity=180,e.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.5,0),cc.fadeTo(.5,180))))),e.active=this.day_ary[a].getChildByName("star").active=s.gm.data.sign_data.today_sign_state<=0&&a+1==s.gm.data.sign_data.sign_day||s.gm.data.sign_data.today_sign_state>0&&s.gm.data.sign_data.sign_day==a}},t.prototype.truly_reward_process=function(a){var t=s.gm.data.sign_data.sign_day;if(t>7)s.gm.ui.async_hide_module(s.gm.const.SignDay);else if(s.gm.data.sign_data.today_sign_state>0)s.gm.ui.async_hide_module(s.gm.const.SignDay);else{var e=s.gm.config.get_row_data("SignConfigData",t.toString());if(s.gm.data.sign_data.today_sign_state=1,s.gm.data.sign_data.async_write_data(),t<7){var n;if(2==t){if(s.gm.data.warehouse_data.get_item_count(e.array[0].value)>0)s.gm.data.warehouse_data.player_add_item(e.array[0].id+100,e.array[0].value*a*s.gm.const.HERO_NEED_PIECE_COUNT),(n=s.gm.config.get_row_data("PropConfigData",(e.array[0].id+100).toString()))&&s.gm.ui.show_notice(cc.js.formatStr("\u606d\u559c\u83b7\u5f97%s x",n.name,a*s.gm.const.HERO_NEED_PIECE_COUNT));else if(s.gm.data.warehouse_data.player_add_item(e.array[0].id,e.array[0].value),(n=s.gm.config.get_row_data("PropConfigData",e.array[0].id.toString()))&&s.gm.ui.show_notice(cc.js.formatStr("\u606d\u559c\u83b7\u5f97%s x",n.name,1)),a>1){s.gm.data.warehouse_data.player_add_item(e.array[0].id+100,e.array[0].value*(a-1)*s.gm.const.HERO_NEED_PIECE_COUNT);var i=s.gm.config.get_row_data("PropConfigData",(e.array[0].id+100).toString());i&&s.gm.ui.show_notice(cc.js.formatStr("\u606d\u559c\u83b7\u5f97%s x",i.name,(a-1)*s.gm.const.HERO_NEED_PIECE_COUNT))}}else for(var o=0;o<e.array.length;++o)s.gm.data.warehouse_data.player_add_item(e.array[o].id,e.array[o].value*a),s.gm.ui.show_coin_fly(e.array[o].id,this.node.convertToWorldSpaceAR(cc.Vec3.ZERO),1)}else{var _=[],d=s.gm.config.get_row_data_array("PoolConfigData",e.array[0].id+"");s.gm.data.setRandomReward(d,_,a),s.gm.ui.set_module_args(s.gm.const.OpenBox.key,{list:_,type:r.StoreTypeEnum.StoreTypeGreate}),s.gm.ui.show_panel(s.gm.const.OpenBox)}s.gm.ui.async_hide_module(s.gm.const.SignDay),s.gm.ui.start.start_ui&&s.gm.ui.start.start_ui.check_sign_red()}},t.prototype.get_reward_list=function(a){var t=[],e=s.gm.data.sign_data.sign_day,n=s.gm.config.get_row_data("SignConfigData",e.toString());if(e<7)if(2==e){if(s.gm.data.warehouse_data.get_item_count(n.array[0].value)>0)(r=new _.BoxItemData).id=n.array[0].id+100,r.count=n.array[0].value*a*s.gm.const.HERO_NEED_PIECE_COUNT,t.push(r);else if((r=new _.BoxItemData).id=n.array[0].id,r.count=n.array[0].value,t.push(r),a>1){var i=new _.BoxItemData;i.id=n.array[0].id+100,i.count=n.array[0].value*(a-1)*s.gm.const.HERO_NEED_PIECE_COUNT,t.push(i)}}else for(var o=0;o<n.array.length;++o){var r;(r=new _.BoxItemData).id=n.array[o].id,r.count=n.array[o].value*a,t.push(r)}else{var d=s.gm.config.get_row_data_array("PoolConfigData",n.array[0].id+"");s.gm.data.setRandomReward(d,t,a)}return t},t.prototype.onClick=function(a){var t=this;a.target==this.btn_close.node||a.target==this.close_btn.node?s.gm.ui.async_hide_module(s.gm.const.SignDay):a.target==this.video_btn.node?s.gm.channel.show_video_ad(function(){t.truly_reward_process(3),s.gm.ui.async_hide_module(s.gm.const.SignDay),g.ReportData.instance.report_point(705)},this):a.target==this.cancle_btn.node&&(this.truly_reward_process(1),s.gm.ui.async_hide_module(s.gm.const.SignDay))},i([u(cc.Button)],t.prototype,"btn_close",void 0),i([u(cc.Button)],t.prototype,"video_btn",void 0),i([u(cc.Button)],t.prototype,"cancle_btn",void 0),i([u(cc.Button)],t.prototype,"close_btn",void 0),i([u([cc.Node])],t.prototype,"day_ary",void 0),i([l],t)}(d.GameModule);e.SignDay=m,cc._RF.pop()},{ChannelManager:void 0,Constants:void 0,GameManager:void 0,GameModule:void 0,NetUtils:void 0,TaskData:void 0,Utils:void 0}]},{},["SignDay"]);