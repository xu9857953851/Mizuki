window.__require=function t(a,e,i){function o(n,_){if(!e[n]){if(!a[n]){var r=n.split("/");if(r=r[r.length-1],!a[r]){var d="function"==typeof __require&&__require;if(!_&&d)return d(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+n+"'")}n=r}var l=e[n]={exports:{}};a[n][0].call(l.exports,function(t){return o(a[n][1][t]||t)},l,l.exports,t,a,e,i)}return e[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<i.length;n++)o(i[n]);return o}({TaskDay:[function(t,a,e){"use strict";cc._RF.push(a,"4b8a4epdDBJepe5g23Nqfdn","TaskDay");var i=__extends,o=__decorate;Object.defineProperty(e,"__esModule",{value:!0}),e.TaskDay=void 0;var s=t("Constants"),n=t("GameManager"),_=t("Utils"),r=t("GameModule"),d=cc._decorator,l=d.ccclass,c=d.property,u=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.today_node=null,a.today_lbl=null,a.not_today_node=null,a.not_today_lbl=null,a.duihao_node=null,a}return i(a,t),a.prototype.setData=function(t){for(var a=0,e=0;e<n.gm.data.task_data.daily_task_list.length;++e)if(n.gm.data.task_data.daily_task_list[e].state!=s.TaskStateEnum.GOT_REWARD){a=e-e%5;break}var i=-1;for(e=a;e<a+5;++e)if(n.gm.data.task_data.daily_task_list[e].state==s.TaskStateEnum.FINISH){i=e-a;break}var o=a+t;if(n.gm.data.task_data.daily_task_list[o].state==s.TaskStateEnum.GOT_REWARD){this.today_node.active=!1,this.not_today_node.active=!0;var r=n.gm.data.task_data.daily_task_list[o].query_config();this.not_today_lbl.string="\u7b2c"+r.value+"\u5173",_.Utils.set_sprite_state(this.duihao_node,cc.Sprite.State.NORMAL)}else n.gm.data.task_data.daily_task_list[o].state==s.TaskStateEnum.FINISH&&i==t?(this.today_node.active=!0,this.not_today_node.active=!1,r=n.gm.data.task_data.daily_task_list[o].query_config(),this.today_lbl.string=r.value+"\u5173"):(this.today_node.active=!1,this.not_today_node.active=!0,r=n.gm.data.task_data.daily_task_list[o].query_config(),this.not_today_lbl.string="\u7b2c"+r.value+"\u5173",_.Utils.set_sprite_state(this.duihao_node,cc.Sprite.State.GRAY))},o([c(cc.Node)],a.prototype,"today_node",void 0),o([c(cc.Label)],a.prototype,"today_lbl",void 0),o([c(cc.Node)],a.prototype,"not_today_node",void 0),o([c(cc.Label)],a.prototype,"not_today_lbl",void 0),o([c(cc.Node)],a.prototype,"duihao_node",void 0),o([l],a)}(r.GameModule);e.TaskDay=u,cc._RF.pop()},{Constants:void 0,GameManager:void 0,GameModule:void 0,Utils:void 0}],TaskItem:[function(t,a,e){"use strict";cc._RF.push(a,"8285e/6MeRPV70HWXZ7XzUM","TaskItem");var i=__extends,o=__decorate;Object.defineProperty(e,"__esModule",{value:!0}),e.TaskItem=void 0;var s=t("Constants"),n=t("GameManager"),_=t("ListViewItem"),r=t("Utils"),d=t("NetUtils"),l=cc._decorator,c=l.ccclass,u=l.property,p=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.item_spr=null,a.name_lbl=null,a.dgree_lbl=null,a.diamond_lbl=null,a.unfinish_node=null,a.gotten_node=null,a.get_btn=null,a.progress=null,a}return i(a,t),Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.update_view()},enumerable:!1,configurable:!0}),a.prototype.update_view=function(){this._data;var t=this._data.query_config();r.Utils.async_set_sprite_frame(this.item_spr,s.BundleName.TASK,cc.js.formatStr("res/%d",t.condition)),this.name_lbl.string=t.taskName,this.dgree_lbl.string="("+this._data.dgree+"/"+t.value+")",this.progress.progress=this._data.dgree/t.value,this.progress.progress=this.progress.progress>=1?1:this.progress.progress,this._data.state==s.TaskStateEnum.GOT_REWARD?(this.gotten_node.active=!0,this.unfinish_node.active=!1):this._data.state==s.TaskStateEnum.FINISH?(this.gotten_node.active=!1,this.unfinish_node.active=!0,r.Utils.set_sprite_state(this.get_btn.node,cc.Sprite.State.NORMAL),this.diamond_lbl.string=t.array[0].reward_value+"",this.dgree_lbl.node.color=cc.color().fromHEX("#ff3c00")):(r.Utils.set_sprite_state(this.get_btn.node,cc.Sprite.State.GRAY),this.gotten_node.active=!1,this.unfinish_node.active=!0,this.diamond_lbl.string=t.array[0].reward_value+"",this.dgree_lbl.node.color=cc.color().fromHEX("#9d672c"))},a.prototype.reset=function(){this.item_spr.spriteFrame=null,this.name_lbl.string="",this.dgree_lbl.string="",this.diamond_lbl.string=""},a.prototype.editor_on_button_click_handler=function(){if(this._data.state!=s.TaskStateEnum.GOT_REWARD)if(this._data.state!=s.TaskStateEnum.ACCEPT){var t=this._data.query_config();if(t.taskType==s.TaskTypeEnum.TASK_ACHIVEMENT){var a=n.gm.config.get_row_data("TaskConfigData",(this._data.task_id+1).toString());a?(this._data.state=s.TaskStateEnum.ACCEPT,this._data.task_id+=1,this._data.dgree>=a.value&&(this._data.state=s.TaskStateEnum.FINISH)):this._data.state=s.TaskStateEnum.GOT_REWARD}for(var e=0;e<t.array.length;++e)n.gm.data.warehouse_data.player_add_item(t.array[e].reward_id,t.array[e].reward_value),n.gm.ui.show_coin_fly(t.array[e].reward_id,this.diamond_lbl.node.convertToWorldSpaceAR(cc.Vec3.ZERO));n.gm.data.task_data.async_write_data(),n.gm.ui.task.update_achivement_view(),n.gm.audio.play_effect("receive_reward"),n.gm.ui.start.start_ui&&n.gm.ui.start.start_ui.check_task_red(),d.ReportData.instance.report_once_point(706)}else n.gm.ui.show_notice("\u4efb\u52a1\u672a\u5b8c\u6210"),n.gm.audio.play_effect("error")},o([u(cc.Sprite)],a.prototype,"item_spr",void 0),o([u(cc.Label)],a.prototype,"name_lbl",void 0),o([u(cc.Label)],a.prototype,"dgree_lbl",void 0),o([u(cc.Label)],a.prototype,"diamond_lbl",void 0),o([u(cc.Node)],a.prototype,"unfinish_node",void 0),o([u(cc.Node)],a.prototype,"gotten_node",void 0),o([u(cc.Button)],a.prototype,"get_btn",void 0),o([u(cc.ProgressBar)],a.prototype,"progress",void 0),o([c],a)}(_.ListViewItem);e.TaskItem=p,cc._RF.pop()},{Constants:void 0,GameManager:void 0,ListViewItem:void 0,NetUtils:void 0,Utils:void 0}],Task:[function(t,a,e){"use strict";cc._RF.push(a,"8ff8b6MpVxL1ZBrp+jLwUHR","Task");var i=__extends,o=__decorate;Object.defineProperty(e,"__esModule",{value:!0}),e.Task=void 0;var s=t("GameManager"),n=t("GameModule"),_=t("ListView"),r=t("Constants"),d=t("TaskDay"),l=t("ChannelManager"),c=t("NetUtils"),u=cc._decorator,p=u.ccclass,h=u.property,y=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.close_btn=null,a.get_daily_btn=null,a.achivement_list=null,a.daily_node=null,a.box_open_node=null,a.box_close_node=null,a._task_data=[],a._finish_count=0,a}return i(a,t),a.prototype.onEnable=function(){s.gm.channel.show_banner_ad(l.BANNER_AD_TYPE.ALL),s.gm.ui.start.auto_pause(),this.update_achivement_view(),this.update_daily_view()},a.prototype.onDisable=function(){s.gm.channel.hide_banner_ad(l.BANNER_AD_TYPE.ALL),this.achivement_list.reset(),s.gm.ui.start.resume_auto_pause()},a.prototype.update_daily_view=function(){for(var t=0;t<this.daily_node.childrenCount;++t)this.daily_node.children[t].getComponent(d.TaskDay).setData(t);for(this.box_open_node.active=!1,this.box_close_node.active=!0,t=0;t<s.gm.data.task_data.daily_task_list.length;++t)if(s.gm.data.task_data.daily_task_list[t].state==r.TaskStateEnum.FINISH){this.box_open_node.active=!0,this.box_close_node.active=!1;break}},a.prototype.update_achivement_view=function(){s.gm.data.task_data.sort_task(s.gm.data.task_data.achivement_list),s.gm.data.task_data.async_write_data(),this._task_data=s.gm.data.task_data.achivement_list,this.achivement_list.setData(this._task_data)},a.prototype.editor_on_button_click_handler=function(t){if(t.target==this.close_btn.node)s.gm.ui.async_hide_module(s.gm.const.Task);else if(t.target==this.get_daily_btn.node){for(var a=0;a<s.gm.data.task_data.daily_task_list.length;++a)if(s.gm.data.task_data.daily_task_list[a].state==r.TaskStateEnum.FINISH){var e=s.gm.data.task_data.daily_task_list[a].query_config(),i=s.gm.config.get_row_data_array("PoolConfigData",e.array[0].reward_id+""),o=[];s.gm.data.setRandomReward(i,o),s.gm.ui.set_module_args(s.gm.const.OpenBox.key,{list:o,type:r.StoreTypeEnum.StoreTypeFree}),s.gm.ui.show_panel(s.gm.const.OpenBox),s.gm.data.task_data.daily_task_list[a].state=r.TaskStateEnum.GOT_REWARD,s.gm.ui.start.start_ui&&s.gm.ui.start.start_ui.check_task_red(),s.gm.data.task_data.async_write_data(),c.ReportData.instance.report_once_point(707);break}this.update_daily_view()}},o([h(cc.Button)],a.prototype,"close_btn",void 0),o([h(cc.Button)],a.prototype,"get_daily_btn",void 0),o([h(_.ListView)],a.prototype,"achivement_list",void 0),o([h(cc.Node)],a.prototype,"daily_node",void 0),o([h(cc.Node)],a.prototype,"box_open_node",void 0),o([h(cc.Node)],a.prototype,"box_close_node",void 0),o([p],a)}(n.GameModule);e.Task=y,cc._RF.pop()},{ChannelManager:void 0,Constants:void 0,GameManager:void 0,GameModule:void 0,ListView:void 0,NetUtils:void 0,TaskDay:"TaskDay"}]},{},["Task","TaskDay","TaskItem"]);