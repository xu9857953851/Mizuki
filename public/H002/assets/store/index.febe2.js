window.__require=function t(e,o,a){function n(r,i){if(!o[r]){if(!e[r]){var d=r.split("/");if(d=d[d.length-1],!e[d]){var s="function"==typeof __require&&__require;if(!i&&s)return s(d,!0);if(_)return _(d,!0);throw new Error("Cannot find module '"+r+"'")}r=d}var l=o[r]={exports:{}};e[r][0].call(l.exports,function(t){return n(e[r][1][t]||t)},l,l.exports,t,e,o,a)}return o[r].exports}for(var _="function"==typeof __require&&__require,r=0;r<a.length;r++)n(a[r]);return n}({StoreExchangeItem:[function(t,e,o){"use strict";cc._RF.push(e,"37722KQy7dH/rXEkWAeie6D","StoreExchangeItem");var a=__extends,n=__decorate;Object.defineProperty(o,"__esModule",{value:!0}),o.StoreExchangeItem=void 0;var _=t("Constants"),r=t("GameManager"),i=t("GameModule"),d=cc._decorator,s=d.ccclass,l=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.diamond_lbl=null,e.item_count_lbl=null,e.red_node=null,e._shop_id=0,e}return a(e,t),e.prototype.update_view=function(t){this._shop_id=t;var e=r.gm.config.get_row_data("ShopConfigData",t+"");this.diamond_lbl.string=e.diamond+"",this.item_count_lbl.string=e.value+"",this.red_node.active=e.diamond<=r.gm.data.warehouse_data.diamond_num},e.prototype.editor_on_button_click_handler=function(){var t=r.gm.config.get_row_data("ShopConfigData",this._shop_id+"");r.gm.data.warehouse_data.diamond_num<t.diamond?(r.gm.ui.set_module_args(r.gm.const.GetMoney.key,{data:_.RewardIdEnum.DIAMOND}),r.gm.ui.show_panel(r.gm.const.GetMoney)):(r.gm.data.warehouse_data.player_del_item(_.RewardIdEnum.DIAMOND,t.diamond),r.gm.data.warehouse_data.player_add_item(_.RewardIdEnum.PART,t.value),r.gm.ui.show_coin_fly(_.RewardIdEnum.PART,this.diamond_lbl.node.convertToWorldSpaceAR(cc.Vec3.ZERO)),r.gm.ui.store.update_exchange_view())},n([l(cc.Label)],e.prototype,"diamond_lbl",void 0),n([l(cc.Label)],e.prototype,"item_count_lbl",void 0),n([l(cc.Node)],e.prototype,"red_node",void 0),n([s],e)}(i.GameModule);o.StoreExchangeItem=m,cc._RF.pop()},{Constants:void 0,GameManager:void 0,GameModule:void 0}],StoreStage:[function(t,e,o){"use strict";cc._RF.push(e,"913b0F9mI9IGYXd0OCo2/dL","StoreStage");var a=__extends,n=__decorate;Object.defineProperty(o,"__esModule",{value:!0}),o.StoreStage=void 0;var _=t("Constants"),r=t("GameManager"),i=t("GameModule"),d=t("Utils"),s=cc._decorator,l=s.ccclass,m=s.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.count_lbl=null,e.value_lbl=null,e.icon_sprite=null,e}return a(e,t),e.prototype.onEnable=function(){},e.prototype.update_view=function(t,e){this.count_lbl.string=r.gm.const.LIANDONG_BOX_DATA[e].count+"",this.value_lbl.string="x"+r.gm.const.LIANDONG_BOX_DATA[e].value,d.Utils.async_set_sprite_frame(this.icon_sprite,_.BundleName.START,"res/hero/avatar_"+(t-100))},e.prototype.onDisable=function(){},n([m(cc.Label)],e.prototype,"count_lbl",void 0),n([m(cc.Label)],e.prototype,"value_lbl",void 0),n([m(cc.Sprite)],e.prototype,"icon_sprite",void 0),n([l],e)}(i.GameModule);o.StoreStage=g,cc._RF.pop()},{Constants:void 0,GameManager:void 0,GameModule:void 0,Utils:void 0}],Store:[function(t,e,o){"use strict";cc._RF.push(e,"5733196uElOtaDd0zw0yrDp","Store");var a=__extends,n=__decorate;Object.defineProperty(o,"__esModule",{value:!0}),o.Store=void 0;var _=t("Constants"),r=t("WarehouseData"),i=t("GameManager"),d=t("GameModule"),s=t("Timer"),l=t("Utils"),m=t("NetUtils"),g=t("StoreExchangeItem"),c=t("StoreStage"),u=cc._decorator,p=u.ccclass,f=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.close_btn=null,e.gold_add_btn=null,e.gold_lbl=null,e.diamond_add_btn=null,e.diamond_lbl=null,e.diamond_exchange_lbl=null,e.diamond_left_count_lbl=null,e.diamond_box_btn=null,e.free_left_count_lbl=null,e.free_box_btn=null,e.free_piece_lbl=null,e.classic_left_count_lbl=null,e.classic_diamond_count_lbl=null,e.classic_box_btn=null,e.classic_piece_lbl=null,e.greate_lbl=null,e.greate_diamond_count_lbl=null,e.greate_left_count_lbl=null,e.greate_box_btn=null,e.greate_free_node=null,e.greate_unfree_node=null,e.liandong_lbl=null,e.liandong_left_count_lbl=null,e.liandong_box_btn=null,e.stage_node=null,e.progress=null,e.exchange_node=null,e.free_red_node=null,e._free_timer=new s.Timer,e._diamond_timer=new s.Timer,e._greate_timer=new s.Timer,e}return a(e,t),e.prototype.onEnable=function(){i.gm.ui.start.auto_pause(),this.update_view(),this.on_update_money_handler(),this.open_free_timer(),this.open_diamond_timer(),i.gm.data.start_data.level_id>=i.gm.const.GREATE_BOX_OPEN_LEVEL&&this.open_greate_timer(),i.gm.data.event_emitter.on(r.WarehouseData.UPDATE_MONEY,this.on_update_money_handler,this)},e.prototype.update_view=function(){this.update_diamond_view(),this.update_free_view(),this.update_classic_view(),this.update_greate_view(),this.update_liandong_view(),this.update_exchange_view()},e.prototype.open_free_timer=function(){var t=this;this._free_timer.is_running||this._free_timer.start(function(){var e=new Date,o=Math.floor(e.getTime()/1e3),a=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeFree+"");i.gm.data.store_data.next_free_box_time>o?(t.free_left_count_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_free_box_time-o,"mm:ss")+"\u540e\u514d\u8d39",t.free_red_node.active=!1):(t.free_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(a.num-i.gm.data.store_data.free_box_count)+"\u6b21",t.free_red_node.active=!0)},1e3,0)},e.prototype.open_diamond_timer=function(){var t=this;this._diamond_timer.is_running||this._diamond_timer.start(function(){var e=new Date,o=Math.floor(e.getTime()/1e3),a=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeDiamond+"");i.gm.data.store_data.next_diamond_time>o?t.diamond_left_count_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_diamond_time-o,"mm:ss")+"\u540e\u514d\u8d39":t.diamond_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(a.num-i.gm.data.store_data.diamond_count)+"\u6b21"},1e3,0)},e.prototype.open_greate_timer=function(){var t=this;this._greate_timer.is_running||this._greate_timer.start(function(){var e=new Date,o=Math.floor(e.getTime()/1e3);i.gm.data.store_data.next_greate_box_time>o?(t.greate_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_greate_box_time-o,"hh:mm:ss")+"\u540e\u514d\u8d39",t.greate_free_node.active=!1,t.greate_unfree_node.active=!0):(t.greate_lbl.string="",t.greate_free_node.active=!0,t.greate_unfree_node.active=!1)},1e3,0)},e.prototype.update_diamond_view=function(){var t=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeDiamond+"");this.diamond_exchange_lbl.string="\u94bb\u77f3x"+t.value;var e=Date.now()/1e3;i.gm.data.store_data.next_diamond_time>e?this.diamond_left_count_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_diamond_time-e,"mm:ss")+"\u540e\u514d\u8d39":this.diamond_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(t.num-i.gm.data.store_data.diamond_count)+"\u6b21"},e.prototype.update_free_view=function(){var t=Date.now()/1e3,e=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeFree+"");i.gm.data.store_data.next_free_box_time>t?(this.free_left_count_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_free_box_time-t,"mm:ss")+"\u540e\u514d\u8d39",this.free_red_node.active=!1):(this.free_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(e.num-i.gm.data.store_data.free_box_count)+"\u6b21",this.free_red_node.active=!0);var o=i.gm.config.get_row_data_array("PoolConfigData",e.box+"");this.free_piece_lbl.string=o[0].drop+""},e.prototype.update_classic_view=function(){var t=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeClassic+"");this.classic_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(t.num-i.gm.data.store_data.classic_box_count)+"\u6b21",this.classic_diamond_count_lbl.string=t.diamond+"";var e=i.gm.config.get_row_data_array("PoolConfigData",t.box+"");this.classic_piece_lbl.string=e[0].drop+""},e.prototype.update_greate_view=function(){var t=Date.now()/1e3,e=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeGreate+"");this.greate_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(e.num-i.gm.data.store_data.greate_box_count)+"\u6b21",this.greate_diamond_count_lbl.string=e.diamond+"",i.gm.data.start_data.level_id>=i.gm.const.GREATE_BOX_OPEN_LEVEL?i.gm.data.store_data.next_greate_box_time>=t?(this.greate_lbl.string=l.Utils.time_format(i.gm.data.store_data.next_greate_box_time-t,"hh:mm:ss")+"\u540e\u514d\u8d39",this.greate_free_node.active=!1,this.greate_unfree_node.active=!0):(this.greate_lbl.string="",this.greate_free_node.active=!0,this.greate_unfree_node.active=!1):this.greate_lbl.string="\u901a\u8fc7\u5173\u5361"+i.gm.const.GREATE_BOX_OPEN_LEVEL+"\u4e4b\u540e\u7acb\u5373\u514d\u8d39"},e.prototype.update_liandong_view=function(){for(var t=i.gm.const.LIANDONG_BOX_ID[Math.floor(i.gm.data.store_data.liandong_days)%i.gm.const.LIANDONG_BOX_ID.length],e=i.gm.config.get_row_data("PropConfigData",t+""),o=0;o<i.gm.const.LIANDONG_BOX_DATA.length;++o)if(i.gm.data.store_data.liandong_box_count<i.gm.const.LIANDONG_BOX_DATA[o].count){this.liandong_lbl.string=i.gm.const.LIANDONG_BOX_DATA[o].count-i.gm.data.store_data.liandong_box_count+"\u6b21\u4e4b\u540e\u5fc5\u5f97"+e.name;break}var a=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeLiandong+"");for(this.liandong_left_count_lbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570:"+(a.num-i.gm.data.store_data.liandong_box_count)+"\u6b21",o=0;o<this.stage_node.childrenCount;++o)this.stage_node.children[o].getComponent(c.StoreStage).update_view(t,o);this.progress.progress=i.gm.data.store_data.liandong_box_count/i.gm.const.LIANDONG_BOX_DATA[2].count},e.prototype.update_exchange_view=function(){for(var t=0;t<this.exchange_node.childrenCount;++t)this.exchange_node.children[t].getComponent(g.StoreExchangeItem).update_view(_.StoreTypeEnum.StoreTypeExchange1+t)},e.prototype.onDisable=function(){i.gm.ui.start.resume_auto_pause(),i.gm.data.event_emitter.off(r.WarehouseData.UPDATE_MONEY,this.on_update_money_handler,this),this._free_timer.is_running&&this._free_timer.stop(),this._diamond_timer.is_running&&this._diamond_timer.stop(),this._greate_timer.is_running&&this._greate_timer.stop()},e.prototype.on_update_money_handler=function(){this.gold_lbl.string=i.gm.data.warehouse_data.gold_num.toString(),this.diamond_lbl.string=i.gm.data.warehouse_data.diamond_num.toString()},e.prototype.openBox=function(t){var e=[],o=i.gm.config.get_row_data("ShopConfigData",t+""),a=i.gm.config.get_row_data_array("PoolConfigData",o.value+""),n=i.gm.config.get_row_data_array("PoolConfigData",o.box+"");i.gm.data.setRandomReward(a,e),i.gm.data.setRandomReward(n,e),i.gm.ui.set_module_args(i.gm.const.OpenBox.key,{list:e,type:t}),i.gm.ui.show_panel(i.gm.const.OpenBox)},e.prototype.editor_on_button_click_handler=function(t){var e=this,o=Date.now()/1e3;if(t.target==this.close_btn.node)i.gm.ui.show_start(),i.gm.ui.async_hide_module(i.gm.const.Store);else if(t.target==this.gold_add_btn.node)i.gm.ui.set_module_args(i.gm.const.GetMoney.key,{data:_.RewardIdEnum.GOLD}),i.gm.ui.show_panel(i.gm.const.GetMoney);else if(t.target==this.diamond_add_btn.node)i.gm.ui.set_module_args(i.gm.const.GetMoney.key,{data:_.RewardIdEnum.DIAMOND}),i.gm.ui.show_panel(i.gm.const.GetMoney);else if(t.target==this.classic_box_btn.node){if((d=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeClassic+"")).num<=i.gm.data.store_data.classic_box_count)return i.gm.ui.show_notice("\u4eca\u65e5\u6b21\u6570\u5df2\u6ee1"),void i.gm.audio.play_effect("error");if(i.gm.data.warehouse_data.diamond_num<d.diamond)return i.gm.ui.set_module_args(i.gm.const.GetMoney.key,{data:_.RewardIdEnum.DIAMOND}),void i.gm.ui.show_panel(i.gm.const.GetMoney);i.gm.data.warehouse_data.player_del_item(_.RewardIdEnum.DIAMOND,d.diamond),i.gm.data.store_data.classic_box_count++,i.gm.data.store_data.async_write_data(),this.openBox(_.StoreTypeEnum.StoreTypeClassic),this.update_classic_view(),m.ReportData.instance.report_point(11),m.ReportData.instance.report_once_point(711)}else if(t.target==this.diamond_box_btn.node){var a=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeDiamond+"");if(a.num<=i.gm.data.store_data.diamond_count)return i.gm.ui.show_notice("\u4eca\u65e5\u6b21\u6570\u5df2\u6ee1"),void i.gm.audio.play_effect("error");if(o<i.gm.data.store_data.next_diamond_time){var n=l.Utils.time_format(Math.floor(i.gm.data.store_data.next_diamond_time-o),"mm:ss")+"\u540e\u53ef\u514d\u8d39\u9886\u53d6";return void i.gm.ui.show_notice(n)}i.gm.channel.show_video_ad(function(){i.gm.data.store_data.next_diamond_time=o+a.time,i.gm.data.store_data.diamond_count++,i.gm.data.store_data.async_write_data(),i.gm.data.warehouse_data.player_add_item(_.RewardIdEnum.DIAMOND,a.value),i.gm.ui.show_coin_fly(_.RewardIdEnum.DIAMOND,e.diamond_box_btn.node.convertToWorldSpaceAR(cc.Vec3.ZERO)),e.update_diamond_view(),m.ReportData.instance.report_point(9),m.ReportData.instance.report_once_point(709)},this)}else if(t.target==this.free_box_btn.node){var r=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeFree+"");if(r.num<=i.gm.data.store_data.free_box_count)return i.gm.ui.show_notice("\u4eca\u65e5\u6b21\u6570\u5df2\u6ee1"),void i.gm.audio.play_effect("error");if(o<i.gm.data.store_data.next_free_box_time)return n=l.Utils.time_format(Math.floor(i.gm.data.store_data.next_free_box_time-o),"mm:ss")+"\u540e\u53ef\u514d\u8d39\u9886\u53d6",void i.gm.ui.show_notice(n);i.gm.channel.show_video_ad(function(){i.gm.data.store_data.next_free_box_time=o+r.time,i.gm.data.store_data.free_box_count++,i.gm.data.store_data.async_write_data(),e.openBox(_.StoreTypeEnum.StoreTypeFree),e.update_free_view(),m.ReportData.instance.report_point(10),m.ReportData.instance.report_once_point(710)},this)}else if(t.target==this.greate_box_btn.node){if((d=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeGreate+"")).num<=i.gm.data.store_data.greate_box_count)return i.gm.ui.show_notice("\u4eca\u65e5\u6b21\u6570\u5df2\u6ee1"),void i.gm.audio.play_effect("error");if(i.gm.data.start_data.level_id>=i.gm.const.GREATE_BOX_OPEN_LEVEL)if(i.gm.data.store_data.next_greate_box_time>=o){if(i.gm.data.warehouse_data.diamond_num<d.diamond)return i.gm.ui.set_module_args(i.gm.const.GetMoney.key,{data:_.RewardIdEnum.DIAMOND}),void i.gm.ui.show_panel(i.gm.const.GetMoney);i.gm.data.warehouse_data.player_del_item(_.RewardIdEnum.DIAMOND,d.diamond),i.gm.data.store_data.greate_box_count++,i.gm.data.store_data.async_write_data()}else i.gm.data.store_data.next_greate_box_time=o+d.time,i.gm.data.store_data.greate_box_count++,i.gm.data.store_data.async_write_data();else{if(i.gm.data.warehouse_data.diamond_num<d.diamond)return i.gm.ui.set_module_args(i.gm.const.GetMoney.key,{data:_.RewardIdEnum.DIAMOND}),void i.gm.ui.show_panel(i.gm.const.GetMoney);i.gm.data.warehouse_data.player_del_item(_.RewardIdEnum.DIAMOND,d.diamond),i.gm.data.store_data.greate_box_count++,i.gm.data.store_data.async_write_data()}this.openBox(_.StoreTypeEnum.StoreTypeGreate),this.update_greate_view(),m.ReportData.instance.report_point(12),m.ReportData.instance.report_once_point(712)}else if(t.target==this.liandong_box_btn.node){var d;if((d=i.gm.config.get_row_data("ShopConfigData",_.StoreTypeEnum.StoreTypeLiandong+"")).num<=i.gm.data.store_data.liandong_box_count)return i.gm.ui.show_notice("\u4eca\u65e5\u6b21\u6570\u5df2\u6ee1"),void i.gm.audio.play_effect("error");i.gm.channel.show_video_ad(function(){i.gm.data.store_data.liandong_box_count++;for(var t=0;t<i.gm.const.LIANDONG_BOX_DATA.length;++t)if(i.gm.const.LIANDONG_BOX_DATA[t].count==i.gm.data.store_data.liandong_box_count){i.gm.data.warehouse_data.player_add_item(i.gm.const.LIANDONG_BOX_ID[Math.floor(i.gm.data.store_data.liandong_days)%i.gm.const.LIANDONG_BOX_ID.length],i.gm.const.LIANDONG_BOX_DATA[t].value);break}i.gm.data.store_data.async_write_data(),e.openBox(_.StoreTypeEnum.StoreTypeLiandong),e.update_liandong_view(),m.ReportData.instance.report_point(13),m.ReportData.instance.report_once_point(713)},this)}},n([f(cc.Button)],e.prototype,"close_btn",void 0),n([f(cc.Button)],e.prototype,"gold_add_btn",void 0),n([f(cc.Label)],e.prototype,"gold_lbl",void 0),n([f(cc.Button)],e.prototype,"diamond_add_btn",void 0),n([f(cc.Label)],e.prototype,"diamond_lbl",void 0),n([f(cc.Label)],e.prototype,"diamond_exchange_lbl",void 0),n([f(cc.Label)],e.prototype,"diamond_left_count_lbl",void 0),n([f(cc.Button)],e.prototype,"diamond_box_btn",void 0),n([f(cc.Label)],e.prototype,"free_left_count_lbl",void 0),n([f(cc.Button)],e.prototype,"free_box_btn",void 0),n([f(cc.Label)],e.prototype,"free_piece_lbl",void 0),n([f(cc.Label)],e.prototype,"classic_left_count_lbl",void 0),n([f(cc.Label)],e.prototype,"classic_diamond_count_lbl",void 0),n([f(cc.Button)],e.prototype,"classic_box_btn",void 0),n([f(cc.Label)],e.prototype,"classic_piece_lbl",void 0),n([f(cc.Label)],e.prototype,"greate_lbl",void 0),n([f(cc.Label)],e.prototype,"greate_diamond_count_lbl",void 0),n([f(cc.Label)],e.prototype,"greate_left_count_lbl",void 0),n([f(cc.Button)],e.prototype,"greate_box_btn",void 0),n([f(cc.Node)],e.prototype,"greate_free_node",void 0),n([f(cc.Node)],e.prototype,"greate_unfree_node",void 0),n([f(cc.Label)],e.prototype,"liandong_lbl",void 0),n([f(cc.Label)],e.prototype,"liandong_left_count_lbl",void 0),n([f(cc.Button)],e.prototype,"liandong_box_btn",void 0),n([f(cc.Node)],e.prototype,"stage_node",void 0),n([f(cc.ProgressBar)],e.prototype,"progress",void 0),n([f(cc.Node)],e.prototype,"exchange_node",void 0),n([f(cc.Node)],e.prototype,"free_red_node",void 0),n([p],e)}(d.GameModule);o.Store=h,cc._RF.pop()},{Constants:void 0,GameManager:void 0,GameModule:void 0,NetUtils:void 0,StoreExchangeItem:"StoreExchangeItem",StoreStage:"StoreStage",Timer:void 0,Utils:void 0,WarehouseData:void 0}]},{},["Store","StoreExchangeItem","StoreStage"]);