window.__require=function t(e,a,n){function i(r,s){if(!a[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var h=a[r]={exports:{}};e[r][0].call(h.exports,function(t){return i(e[r][1][t]||t)},h,h.exports,t,e,a,n)}return a[r].exports}for(var o="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({ActionTagLogic:[function(t,e,a){"use strict";cc._RF.push(e,"5e1cbp3xklKta15UiaFcGvu","ActionTagLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=function(){function t(){this.tmpActionTags=new Array;for(var t=1;t<30;t++)this.tmpActionTags.push(0)}return t.prototype.setTmpActionTag=function(t){this.tmpActionTags[t]=1},t.prototype.getTmpActionTag=function(t){return this.tmpActionTags[t]},t.prototype.setActionTag=function(t){t=Math.min(t,o.default.Instance.playerData.actionTags.length),o.default.Instance.playerData.actionTags[t]=1,o.default.Instance.localStorage(!1)},t.prototype.getActionTag=function(t){return o.default.Instance.playerData.actionTags[t]},t.prototype.rechargedEvent=function(){for(var t=1;t<=5;t++)o.default.Instance.playerData.actionTags[t]=1},t.prototype.closeEvent=function(t){o.default.Instance.playerData.actionTags[t]=0},t.prototype.diamondCostEvent=function(t){o.default.Instance.playerData.actionTags[t]=1},t.prototype.getAdBtnTag=function(t){return o.default.Instance.playerData.rechargeTotalNum>0?0==o.default.Instance.playerData.actionTags[t]&&Math.random()>.5?1:2:1},t}();i.default=r,cc._RF.pop()},{}],ActivityItem:[function(t,e,a){"use strict";cc._RF.push(e,"307d50BBMZNdobCJ/iaA5AG","ActivityItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("MainLogic"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItemList=new Array,e}return r(e,t),e.prototype.init=function(t,e,a){this.activityType=t,this.rewardTarget=e,this.rewardId=a,this.targetNode=cc.find("Content/Tip",this.node),this.listNode=cc.find("Reward",this.node),this.targetNode.getComponent(cc.Label).string="\u8fbe\u5230"+e+"\u7ea7";for(var n=c.default.Instance.giftMap.get(a).itemList,i=0;i<n.length;++i){var o=n[i],r=l.default.Instance.sceneNodeManager.getRewardItem(o[1],o[2],o[0],i,!1,!1,!1,!1,!1);this.rewardItemList.push(r),this.listNode.addChild(r.node)}},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],ActivityLayer:[function(t,e,a){"use strict";cc._RF.push(e,"e2cc6Yf9MtMtJKDpF2cnUV0","ActivityLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("ActivityItem"),u=cc._decorator,d=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.pageState=!1,e}return r(e,t),e.prototype.init=function(t){this.ruleNode1=cc.find("Layer1/Rule1/Content",this.node),this.ruleNode2=cc.find("Layer1/Rule2/Content",this.node),this.ruleNode3=cc.find("Layer1/Rule3/Content",this.node),this.listView1=cc.find("Layer1/List",this.node).getComponent(cc.ScrollView),this.timeNode1=cc.find("Layer1/Time",this.node),this.zqewmNode=cc.find("Layer1/zqewm",this.node),this.review(t)},e.prototype.review=function(t){if(this.pageType=t,this.node.active=!0,1==t&&!this.pageState){this.pageState=!0;var e=l.default.Instance.festivalTypeMap.get(1);this.timeNode1.getComponent(cc.Label).string=e.festival_start_time+"~"+e.festival_end_time,this.ruleNode1.getComponent(cc.Label).string=e.target_des,this.ruleNode2.getComponent(cc.Label).string=e.reward_des,this.ruleNode3.getComponent(cc.Label).string=e.details_des;for(var a=e.typeKeys,n=0;n<a.length;++n){var i=a[n],o=e.giftIds[n],r=cc.instantiate(this.itemPrefab);r.getComponent(h.default).init(1,i,o),this.listView1.content.addChild(r)}}},e.prototype.onClickBtn=function(t,e){c.SoundManager.Instance.playEffect("anniu"),1==e&&(this.node.active=!1)},s([p(cc.Prefab)],e.prototype,"itemPrefab",void 0),s([d],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],AdOrDiamondLogic:[function(t,e,a){"use strict";cc._RF.push(e,"0ebb89tZKBO+KU2fU6Qj2gS","AdOrDiamondLogic");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){},cc._RF.pop()},{}],AdServer:[function(t,e,a){"use strict";cc._RF.push(e,"6837dFy1cJCarRDrjKAmsxh","AdServer");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("WxAdServer"),r=n("WebAdServer"),s=n("OppAdServer"),c=n("QqAdServer"),l=n("VivoAdServer"),h=n("PublicEnum"),u=n("PublicConst"),d=(n("GameData"),n("DouyinAdServer")),p=n("Web4399AdServer"),f=function(){function t(){this.adServer=null}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t,this._instance.init()),this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){try{switch(u.default.Platform){case h.PLAT_FORM.Wx:this.adServer=new o.default(this),this.setKeepScreenOn();break;case h.PLAT_FORM.QQ:this.adServer=new c.default(this),this.setKeepScreenOn();break;case h.PLAT_FORM.Opp:this.adServer=new s.OppAdServer(this);break;case h.PLAT_FORM.UC:this.adServer=new r.WebAdServer(this);break;case h.PLAT_FORM.Vivo:this.adServer=new l.VivoAdServer(this),this.setKeepScreenOn();break;case h.PLAT_FORM.Android:this.adServer=new r.WebAdServer(this);break;case h.PLAT_FORM.Douyin:this.adServer=new d.default(this);break;case h.PLAT_FORM.Web_4399:this.adServer=new p.Web4399AdServer(this);break;default:this.adServer=new r.WebAdServer(this)}this.adServer.init()}catch(t){console.log("init ",t)}},t.prototype.load=function(){try{this.adServer.load()}catch(t){console.log("load ",t)}},t.prototype.showInterAd=function(){try{if(null!=this.adServer){if(!this.adServer.haveAd)return;this.adServer.showInterAd()}}catch(t){console.log("showInterAd ",t)}},t.prototype.loadAdReward=function(){try{if(null!=this.adServer){if(!this.adServer.haveAd)return;this.adServer.loadRewardAd(),console.log("loadAdReward...")}}catch(t){console.log("loadAdReward ",t)}},t.prototype.showBannerAd=function(t,e){try{if(null!=this.adServer){if(!this.adServer.haveAd)return;this.adServer.showBannerAd(t,e)}}catch(i){console.log("showBannerAd ",i)}},t.prototype.hideBannerAd=function(){console.log("\u9690\u85cfbanner");try{if(null!=this.adServer){if(!this.adServer.haveAd)return;this.adServer.hideBannerAd()}}catch(t){console.log("hideBannerAd ",t)}},t.prototype.shareAppCallBack=function(t,e){try{null!=this.adServer&&this.adServer.shareAppCallBack(t,e)}catch(i){console.log("shareApp ",i)}},t.prototype.shareApp=function(t,e,a){try{if(!u.default.Share_Switch)return;null!=this.adServer&&this.adServer.shareApp(t,e,a)}catch(o){console.log("shareApp ",o)}},t.prototype.shareState=function(t){return!(t<=3)},t.prototype.addShareEvent=function(){},t.prototype.noVideoToShare=function(){return u.default.Platform==h.PLAT_FORM.Wx||u.default.Platform==h.PLAT_FORM.Douyin},t.prototype.adHandler=function(t,e,a){try{console.log("\u5e7f\u544a\u5df2\u8df3\u8fc7\uff0c\u76f4\u63a5\u9886\u53d6\u5956\u52b1:",this.getAdTypeName(t)),a.call(e,t,0)}catch(o){console.log("adHandler ",o)}},t.prototype.showCustomAd=function(t){try{null!=this.adServer&&this.adServer.showCustomAd(t)}catch(e){}},t.prototype.hideCustomAd=function(t){try{null!=this.adServer&&this.adServer.hideCustomAd(t)}catch(e){}},t.prototype.showNativeAd=function(t,e){try{if(!this.adServer.haveAd)return;this.adServer.showNativeAd(t,e)}catch(i){console.log("showNativeAd ",i)}},t.prototype.showNativeAd2=function(t,e){try{if(!this.adServer.haveAd)return;this.adServer.showNativeAd2(t,e)}catch(i){console.log("showNativeAd2 ",i)}},t.prototype.adReportEvent=function(t,e){try{this.adServer.adReportEvent(t,e)}catch(i){console.log("adReportEvent ",i)}},t.prototype.adReportEvent2=function(t,e){try{this.adServer.adReportEvent2(t,e)}catch(i){console.log("adReportEvent2 ",i)}},t.prototype.vibrateShort=function(){try{this.adServer.vibrateShort({success:function(){},fail:function(){},complete:function(){}})}catch(t){console.log("vibrateShort ",t)}},t.prototype.navigateToMiniProgram=function(t,e,a){try{var n={appId:t.appid,path:t.path};this.adServer.navigateToMiniProgram(n,e,a)}catch(r){console.log("navigateToMiniProgram ",r)}},t.prototype.showShareMenu=function(){try{this.adServer.showShareMenu()}catch(t){console.log("showShareMenu ",t)}},t.prototype.showModal=function(t,e,a,n,i){void 0===a&&(a="\u5206\u4eab\u5931\u8d25"),void 0===n&&(n="\u5206\u4eab\u5931\u8d25,\u8bf7\u5206\u4eab\u81f3\u5927\u4e8e30\u4eba\u7684\u7fa4"),void 0===i&&(i="\u53bb\u5206\u4eab"),cc.game.pause();try{var o={title:a,content:n,confirmText:i,cancelColor:"",confirmColor:"#6e7b9f",success:function(a){cc.game.resume(),a.confirm?t.call(e,0):a.cancel&&t.call(e,-1)},complete:function(){cc.game.resume()}};this.adServer.showModal(o)}catch(c){console.log("showModal ",c)}},t.prototype.getAdTypeName=function(e){switch(e){case t.SHARE_TYPE_ADD_COIN:case t.AD_TYPE_ADD_COIN:return"\u83b7\u5f97\u91d1\u5e01";case t.SHARE_TYPE_ADD_COUNTING:case t.AD_TYPE_ADD_COUNTING:return"\u83b7\u5f97\u70b9\u5238";case t.SHARE_TYPE_ADD_POWER:case t.AD_TYPE_ADD_POWER:return"\u83b7\u5f97\u4f53\u529b";case t.SHARE_TYPE_ADD_CRYSTAL:case t.AD_TYPE_ADD_CRYSTAL:return"\u83b7\u5f97\u65e0\u8272\u6676\u4f53";case t.SHARE_TYPE_LOTTERY:case t.AD_TYPE_LOTTERY:return"\u5927\u8f6c\u76d8";case t.SHARE_TYPE_SIGNIN_AGAIN:case t.AD_TYPE_SIGNIN_AGAIN:return"\u7b7e\u5230\u518d\u6b21\u9886\u53d6";case t.SHARE_TYPE_SIGNIN_DOUBLE:case t.AD_TYPE_SIGNIN_DOUBLE:return"\u7b7e\u5230\u4e24\u500d\u9886\u53d6";case t.SHARE_TYPE_REVIVED:case t.AD_TYPE_REVIVED:return"\u590d\u6d3b";case t.SHARE_TYPE_GET_INTEGRAL:case t.AD_TYPE_GET_INTEGRAL:return"\u770b\u89c6\u9891\u83b7\u53d6\u901a\u884c\u8bc1\u79ef\u5206";case t.SHARE_TYPE_GET_CRYTAL:case t.AD_TYPE_GET_CRYTAL:return"\u770b\u89c6\u9891\u83b7\u53d6\u901a\u884c\u8bc1\u6c34\u6676";case t.AD_TYPE_GET_SUPER_REWARD:case t.SHARE_TYPE_GET_SUPER_REWARD:return"\u770b\u89c6\u9891\u83b7\u53d6\u901a\u884c\u8bc1\u8d85\u7ea7\u5956\u52b1";case t.SHARE_TYPE_GET_COMMON_REWARD:case t.AD_TYPE_GET_COMMON_REWARD:return"\u770b\u89c6\u9891\u83b7\u53d6\u901a\u884c\u8bc1\u8d35\u5bbe\u5956\u52b1";case t.SHARE_TYPE_TASK_TYPE1:case t.AD_TYPE_TASK_TYPE1:return"\u4efb\u52a1\u89c6\u9891\u6b21\u65701";case t.SHARE_TYPE_BUFF_BOX:case t.AD_TYPE_BUFF_BOX:return"Buff\u5b9d\u7bb1";case t.SHARE_TYPE_TASK_TYPE2:case t.AD_TYPE_TASK_TYPE2:return"\u4efb\u52a1\u89c6\u9891\u6b21\u65702";case t.SHARE_COMBAT_RESULT_FLOP_CARD:case t.AD_COMBAT_RESULT_FLOP_CARD:return"\u7ed3\u7b97\u770b\u89c6\u9891\u7ffb\u5361";case t.SHARE_TYPE_TASK:return"\u4efb\u52a1\u91cc\u7684\u5206\u4eab";case t.SHARE_TYPE_FASHION:return"\u5206\u4eab\u83b7\u53d6\u65f6\u88c5";case t.AD_TYPE_FUBEN_TZ:case t.SHARE_TYPE_FUBEN_TZ:return"\u526f\u672c\u6311\u6218";case t.SHARE_TYPE_RESOLVE_REWQRD_DOUBLE:case t.AD_TYPE_RESOLVE_REWQRD_DOUBLE:return"\u5956\u52b1\u53cc\u500d\u9886\u53d6";case t.SHARE_TYPE_SHAKE_JAR:case t.AD_TYPE_SHAKE_JAR:return"\u770b\u89c6\u9891\u6447\u7f50\u5b50";case t.SHARE_TYPE_SHOP_PROP_UPDATE:case t.AD_TYPE_SHOP_PROP_UPDATE:return"\u5546\u5e97\u5237\u65b0\u9053\u5177";case t.AD_TYPE_GET_SKILL1:case t.SHARE_TYPE_GET_SKILL1:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd1";case t.AD_TYPE_GET_SKILL2:case t.SHARE_TYPE_GET_SKILL2:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd2";case t.AD_TYPE_GET_SKILL3:case t.SHARE_TYPE_GET_SKILL3:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd3";case t.AD_TYPE_GET_SKILL4:case t.SHARE_TYPE_GET_SKILL4:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd4";case t.AD_TYPE_GET_SKILL5:case t.SHARE_TYPE_GET_SKILL5:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd5";case t.AD_TYPE_GET_SKILL6:case t.SHARE_TYPE_GET_SKILL6:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd6";case t.AD_TYPE_GET_SKILL7:case t.SHARE_TYPE_GET_SKILL7:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd7";case t.AD_TYPE_GET_SKILL8:case t.SHARE_TYPE_GET_SKILL8:return"\u83b7\u53d6\u672c\u5c40\u6280\u80fd8";case t.SHARE_TYPE_BUY_GRID:case t.AD_TYPE_BUY_GRID:return"\u83b7\u53d6\u683c\u5b50";case t.SHARE_TYPE_PASS_CHECK_CRYTRAL:return"\u9080\u8bf7\u65b0\u7528\u6237\u83b7\u53d6\u6c34\u6676";case t.SHARE_TYPE_DIAM_WELFARE1:case t.AD_TYPE_DIAM_WELFARE1:return"\u94bb\u77f3\u798f\u5229\u767d\u94bb\u89c6\u9891";case t.SHARE_TYPE_DIAM_WELFARE2:case t.AD_TYPE_DIAM_WELFARE2:return"\u94bb\u77f3\u798f\u5229\u7c89\u94bb\u89c6\u9891";case t.SHARE_TYPE_SHOP_REWARD:case t.AD_TYPE_SHOP_REWARD:return"\u5546\u57ce\u770b\u89c6\u9891\u83b7\u53d6\u5956\u52b1";case t.SHARE_TYPE_SHOP_INVITE:return"\u5546\u57ce\u5206\u4eab\u9080\u8bf7\u65b0\u7528\u6237";case t.AD_TYPE_BUNNY_GIRL:case t.SHARE_TYPE_BUNNY_GIRL:return"\u83b7\u53d6\u5154\u5973\u90ce";case t.AD_TYPE_CLIMB_TOWER_SD:case t.SHARE_TYPE_CLIMB_TOWER_SD:return"\u722c\u5854\u626b\u8361";case t.SHARE_TYPE_SELF_TALENT:case t.AD_TYPE_SELF_TALENT:return"\u4e2a\u4eba\u5929\u8d4b\u70b9";case t.AD_TYPE_GET_MSDHQ:case t.SHARE_TYPE_GET_MSDHQ:return"\u83b7\u53d6\u9b54\u795e\u5151\u6362\u5238";case t.AD_TYPE_HELP_TALENT:case t.SHARE_TYPE_HELP_TALENT:return"\u52a9\u529b\u5929\u8d4b\u70b9"}return""},t.prototype.getAdTypeKey=function(e){switch(e){case t.SHARE_TYPE_ADD_COIN:return"SHARE_TYPE_ADD_COIN";case t.AD_TYPE_ADD_COIN:return"AD_TYPE_ADD_COIN";case t.SHARE_TYPE_ADD_COUNTING:return"SHARE_TYPE_ADD_COUNTING";case t.AD_TYPE_ADD_COUNTING:return"AD_TYPE_ADD_COUNTING";case t.SHARE_TYPE_ADD_POWER:return"SHARE_TYPE_ADD_POWER";case t.AD_TYPE_ADD_POWER:return"AD_TYPE_ADD_POWER";case t.SHARE_TYPE_ADD_CRYSTAL:return"SHARE_TYPE_ADD_CRYSTAL";case t.AD_TYPE_ADD_CRYSTAL:return"AD_TYPE_ADD_CRYSTAL";case t.SHARE_TYPE_LOTTERY:return"SHARE_TYPE_LOTTERY";case t.AD_TYPE_LOTTERY:return"AD_TYPE_LOTTERY";case t.SHARE_TYPE_SIGNIN_AGAIN:return"SHARE_TYPE_SIGNIN_AGAIN";case t.AD_TYPE_SIGNIN_AGAIN:return"AD_TYPE_SIGNIN_AGAIN";case t.SHARE_TYPE_SIGNIN_DOUBLE:return"SHARE_TYPE_SIGNIN_DOUBLE";case t.AD_TYPE_SIGNIN_DOUBLE:return"AD_TYPE_SIGNIN_DOUBLE";case t.SHARE_TYPE_REVIVED:return"SHARE_TYPE_REVIVED";case t.AD_TYPE_REVIVED:return"AD_TYPE_REVIVED";case t.SHARE_TYPE_GET_INTEGRAL:return"SHARE_TYPE_GET_INTEGRAL";case t.AD_TYPE_GET_INTEGRAL:return"AD_TYPE_GET_INTEGRAL";case t.SHARE_TYPE_GET_CRYTAL:return"SHARE_TYPE_GET_CRYTAL";case t.AD_TYPE_GET_CRYTAL:return"AD_TYPE_GET_CRYTAL";case t.AD_TYPE_GET_SUPER_REWARD:return"AD_TYPE_GET_SUPER_REWARD";case t.SHARE_TYPE_GET_SUPER_REWARD:return"SHARE_TYPE_GET_SUPER_REWARD";case t.SHARE_TYPE_GET_COMMON_REWARD:return"SHARE_TYPE_GET_COMMON_REWARD";case t.AD_TYPE_GET_COMMON_REWARD:return"AD_TYPE_GET_COMMON_REWARD";case t.SHARE_TYPE_TASK_TYPE1:return"SHARE_TYPE_TASK_TYPE1";case t.AD_TYPE_TASK_TYPE1:return"AD_TYPE_TASK_TYPE1";case t.SHARE_TYPE_BUFF_BOX:return"SHARE_TYPE_BUFF_BOX";case t.AD_TYPE_BUFF_BOX:return"AD_TYPE_BUFF_BOX";case t.SHARE_TYPE_TASK_TYPE2:return"SHARE_TYPE_TASK_TYPE2";case t.AD_TYPE_TASK_TYPE2:return"AD_TYPE_TASK_TYPE2";case t.SHARE_COMBAT_RESULT_FLOP_CARD:return"SHARE_COMBAT_RESULT_FLOP_CARD";case t.AD_COMBAT_RESULT_FLOP_CARD:return"AD_COMBAT_RESULT_FLOP_CARD";case t.SHARE_TYPE_TASK:return"SHARE_TYPE_TASK";case t.SHARE_TYPE_FASHION:return"SHARE_TYPE_FASHION";case t.AD_TYPE_FUBEN_TZ:return"AD_TYPE_FUBEN_TZ";case t.SHARE_TYPE_FUBEN_TZ:return"SHARE_TYPE_FUBEN_TZ";case t.SHARE_TYPE_RESOLVE_REWQRD_DOUBLE:return"SHARE_TYPE_RESOLVE_REWQRD_DOUBLE";case t.AD_TYPE_RESOLVE_REWQRD_DOUBLE:return"AD_TYPE_RESOLVE_REWQRD_DOUBLE";case t.SHARE_TYPE_SHAKE_JAR:return"SHARE_TYPE_SHAKE_JAR";case t.AD_TYPE_SHAKE_JAR:return"AD_TYPE_SHAKE_JAR";case t.SHARE_TYPE_SHOP_PROP_UPDATE:return"SHARE_TYPE_SHOP_PROP_UPDATE";case t.AD_TYPE_SHOP_PROP_UPDATE:return"AD_TYPE_SHOP_PROP_UPDATE";case t.AD_TYPE_GET_SKILL1:return"AD_TYPE_GET_SKILL1";case t.SHARE_TYPE_GET_SKILL1:return"SHARE_TYPE_GET_SKILL1";case t.AD_TYPE_GET_SKILL2:return"AD_TYPE_GET_SKILL2";case t.SHARE_TYPE_GET_SKILL2:return"SHARE_TYPE_GET_SKILL2";case t.AD_TYPE_GET_SKILL3:return"AD_TYPE_GET_SKILL3";case t.SHARE_TYPE_GET_SKILL3:return"SHARE_TYPE_GET_SKILL3";case t.AD_TYPE_GET_SKILL4:return"AD_TYPE_GET_SKILL4";case t.SHARE_TYPE_GET_SKILL4:return"SHARE_TYPE_GET_SKILL4";case t.AD_TYPE_GET_SKILL5:return"AD_TYPE_GET_SKILL5";case t.SHARE_TYPE_GET_SKILL5:return"SHARE_TYPE_GET_SKILL5";case t.AD_TYPE_GET_SKILL6:return"AD_TYPE_GET_SKILL6";case t.SHARE_TYPE_GET_SKILL6:return"SHARE_TYPE_GET_SKILL6";case t.AD_TYPE_GET_SKILL7:return"AD_TYPE_GET_SKILL7";case t.SHARE_TYPE_GET_SKILL7:return"SHARE_TYPE_GET_SKILL7";case t.AD_TYPE_GET_SKILL8:return"AD_TYPE_GET_SKILL8";case t.SHARE_TYPE_GET_SKILL8:return"SHARE_TYPE_GET_SKILL8";case t.SHARE_TYPE_BUY_GRID:return"SHARE_TYPE_BUY_GRID";case t.AD_TYPE_BUY_GRID:return"AD_TYPE_BUY_GRID";case t.SHARE_TYPE_PASS_CHECK_CRYTRAL:return"SHARE_TYPE_PASS_CHECK_CRYTRAL";case t.SHARE_TYPE_DIAM_WELFARE1:return"SHARE_TYPE_DIAM_WELFARE1";case t.AD_TYPE_DIAM_WELFARE1:return"AD_TYPE_DIAM_WELFARE1";case t.SHARE_TYPE_DIAM_WELFARE2:return"SHARE_TYPE_DIAM_WELFARE2";case t.AD_TYPE_DIAM_WELFARE2:return"AD_TYPE_DIAM_WELFARE2";case t.SHARE_TYPE_SHOP_REWARD:return"SHARE_TYPE_SHOP_REWARD";case t.AD_TYPE_SHOP_REWARD:return"AD_TYPE_SHOP_REWARD";case t.SHARE_TYPE_SHOP_INVITE:return"SHARE_TYPE_SHOP_INVITE";case t.AD_TYPE_BUNNY_GIRL:return"AD_TYPE_BUNNY_GIRL";case t.SHARE_TYPE_BUNNY_GIRL:return"SHARE_TYPE_BUNNY_GIRL";case t.AD_TYPE_CLIMB_TOWER_SD:return"AD_TYPE_CLIMB_TOWER_SD";case t.SHARE_TYPE_CLIMB_TOWER_SD:return"SHARE_TYPE_CLIMB_TOWER_SD";case t.SHARE_TYPE_SELF_TALENT:return"SHARE_TYPE_SELF_TALENT";case t.AD_TYPE_SELF_TALENT:return"AD_TYPE_SELF_TALENT";case t.AD_TYPE_GET_MSDHQ:return"AD_TYPE_GET_MSDHQ";case t.SHARE_TYPE_GET_MSDHQ:return"SHARE_TYPE_GET_MSDHQ"}return""},t.prototype.hasScreenFringe=function(){try{return this.adServer.hasScreenFringe()}catch(t){return 0}},t.prototype.getSetting=function(t,e){try{this.adServer.getSetting(t,e)}catch(i){e.call(t,-1)}},t.prototype.login=function(t,e){try{this.adServer.login(t,e)}catch(i){e.call(t,-1)}},t.prototype.getLaunchOptionsSync=function(){try{return this.adServer.getLaunchOptionsSync()}catch(t){}},t.prototype.getLaunchOptions=function(t,e){try{this.adServer.getLaunchOptions(t,e)}catch(i){}},t.prototype.openSetting=function(t,e){try{this.adServer.openSetting(t,e)}catch(i){e.call(t,-1)}},t.prototype.createUserInfoButton=function(t,e){try{this.adServer.createUserInfoButton(t,e)}catch(i){e.call(t,-1)}},t.prototype.showSubscribeStatus=function(t,e){try{this.adServer.showSubscribeStatus(t,e)}catch(i){}},t.prototype.showSubscribeMessage=function(t){try{this.adServer.showSubscribeMessage(t)}catch(e){}},t.prototype.createUserInfoButton2=function(t,e){try{this.adServer.createUserInfoButton2(t,e)}catch(i){e.call(t,-1)}},t.prototype.openCustomerServiceConversation=function(t,e,a){try{this.adServer.openCustomerServiceConversation(t,e,a)}catch(o){}},t.prototype.hideUserInfoBtn=function(){try{this.adServer.hideUserInfoBtn()}catch(t){}},t.prototype.setKeepScreenOn=function(){try{this.adServer.setKeepScreenOn()}catch(t){console.log("setKeepScreenOn ",t)}},t.prototype.getGamehash=function(){return u.default.Platform==h.PLAT_FORM.Wx?"fea5b072f7828033bd77bfc0b03feeef":u.default.Platform==h.PLAT_FORM.QQ?"78e4114531121868e3ffdeb5942f5099":u.default.Platform==h.PLAT_FORM.Vivo?"6648df2dffa3cba19d7322d347cc7c34":u.default.Platform==h.PLAT_FORM.Opp?"0f3b0e6da6337ec3f27f538509416184":u.default.Platform==h.PLAT_FORM.Douyin?"59a02174f5c665f67842c025c252a8d8":"fea5b072f7828033bd77bfc0b03feeef"},t.prototype.getGameToken=function(){return u.default.Platform==h.PLAT_FORM.Wx?"LEMqPNJZfVTsaFMLlbDOZnLfzSgdXzMD":u.default.Platform==h.PLAT_FORM.QQ?"LEMqPNJZfVTsaFMLlbDOZnLfzSgdXzMD":u.default.Platform==h.PLAT_FORM.Vivo?"LEMqPNJZfVTsaFMLlbDOZnLfzSgdXzMD":u.default.Platform==h.PLAT_FORM.Opp?"LEMqPNJZfVTsaFMLlbDOZnLfzSgdXzMD":u.default.Platform==h.PLAT_FORM.Douyin?"PcBbJpkCEtAILDUgRVmfYHNKiQBqzZFi":"LEMqPNJZfVTsaFMLlbDOZnLfzSgdXzMD"},t.prototype.showAppBoxAd=function(){try{this.adServer.showAppBoxAd()}catch(t){}},t.prototype.showBlockAd=function(t){try{this.adServer.showBlockAd(t)}catch(e){}},t.prototype.hideBlockAd=function(){try{this.adServer.hideBlockAd()}catch(t){}},t.prototype.showGameClub=function(){try{this.adServer.showGameClub()}catch(t){}},t.prototype.hideGameClub=function(){try{this.adServer.hideGameClub()}catch(t){}},t.prototype.getAppId=function(){try{this.adServer.getAppId()}catch(t){}},t.prototype.virtualPayment=function(t,e,a){try{this.adServer.virtualPayment(t,e,a)}catch(o){}},t.prototype.setClipboardData=function(t){try{this.adServer.setClipboardData(t)}catch(e){}},t.prototype.recordStart=function(t,e){try{this.adServer.recordStart(t,e)}catch(i){}},t.prototype.recordPause=function(){try{this.adServer.recordPause()}catch(t){}},t.prototype.recordResume=function(){try{this.adServer.recordResume()}catch(t){}},t.prototype.recordEnd=function(){try{this.adServer.recordEnd()}catch(t){}},t.prototype.reportCustomData=function(t,e){void 0===e&&(e={});try{this.adServer.reportCustomData(t,e)}catch(i){}},t.prototype.shareVideo=function(t,e){try{this.adServer.shareVideo(t,e)}catch(i){}},t.prototype.navigateToVideoView=function(t,e){try{this.adServer.navigateToVideoView(t,e)}catch(i){}},t.prototype.openAwemeUserProfile=function(t,e){try{this.adServer.openAwemeUserProfile(t,e)}catch(i){}},t.AD_TYPE_ADD_COIN=1,t.AD_TYPE_ADD_COUNTING=2,t.AD_TYPE_ADD_POWER=3,t.AD_TYPE_ADD_CRYSTAL=4,t.AD_TYPE_SIGNIN_AGAIN=7,t.AD_TYPE_SIGNIN_DOUBLE=8,t.AD_TYPE_LOTTERY=9,t.AD_TYPE_SHAKE_JAR=10,t.AD_TYPE_SHOP_PROP_UPDATE=11,t.AD_TYPE_BUY_GRID=12,t.AD_COMBAT_RESULT_FLOP_CARD=13,t.AD_TYPE_REVIVED=14,t.AD_TYPE_GET_INTEGRAL=15,t.AD_TYPE_FUBEN_TZ=16,t.AD_TYPE_GET_CRYTAL=17,t.AD_TYPE_GET_SUPER_REWARD=18,t.AD_TYPE_GET_COMMON_REWARD=19,t.AD_TYPE_BUFF_BOX=20,t.AD_TYPE_GET_SKILL1=21,t.AD_TYPE_GET_SKILL2=22,t.AD_TYPE_GET_SKILL3=23,t.AD_TYPE_GET_SKILL4=24,t.AD_TYPE_GET_SKILL5=25,t.AD_TYPE_GET_SKILL6=26,t.AD_TYPE_GET_SKILL7=27,t.AD_TYPE_GET_SKILL8=28,t.AD_TYPE_TASK_TYPE1=30,t.AD_TYPE_TASK_TYPE2=31,t.AD_TYPE_RESOLVE_REWQRD_DOUBLE=34,t.AD_TYPE_DIAM_WELFARE1=38,t.AD_TYPE_DIAM_WELFARE2=39,t.AD_TYPE_SHOP_REWARD=40,t.AD_TYPE_BUNNY_GIRL=41,t.AD_TYPE_CLIMB_TOWER_SD=42,t.AD_TYPE_SELF_TALENT=43,t.AD_TYPE_GET_MSDHQ=44,t.AD_TYPE_HELP_TALENT=45,t.SCREEN_AD_COMBAT_RESULT=100,t.AD_NOVIDEO_TO_SHARE=1e3,t.SHARE_TYPE_ADD_COIN=201,t.SHARE_TYPE_ADD_COUNTING=202,t.SHARE_TYPE_ADD_POWER=203,t.SHARE_TYPE_ADD_CRYSTAL=204,t.SHARE_TYPE_SIGNIN_AGAIN=207,t.SHARE_TYPE_SIGNIN_DOUBLE=208,t.SHARE_TYPE_LOTTERY=209,t.SHARE_TYPE_SHAKE_JAR=210,t.SHARE_TYPE_SHOP_PROP_UPDATE=211,t.SHARE_TYPE_BUY_GRID=212,t.SHARE_COMBAT_RESULT_FLOP_CARD=213,t.SHARE_TYPE_REVIVED=214,t.SHARE_TYPE_GET_INTEGRAL=15,t.SHARE_TYPE_FUBEN_TZ=216,t.SHARE_TYPE_GET_CRYTAL=217,t.SHARE_TYPE_GET_SUPER_REWARD=218,t.SHARE_TYPE_GET_COMMON_REWARD=219,t.SHARE_TYPE_BUFF_BOX=220,t.SHARE_TYPE_GET_SKILL1=221,t.SHARE_TYPE_GET_SKILL2=222,t.SHARE_TYPE_GET_SKILL3=223,t.SHARE_TYPE_GET_SKILL4=224,t.SHARE_TYPE_GET_SKILL5=225,t.SHARE_TYPE_GET_SKILL6=226,t.SHARE_TYPE_GET_SKILL7=227,t.SHARE_TYPE_GET_SKILL8=228,t.SHARE_TYPE_TASK_TYPE1=230,t.SHARE_TYPE_TASK_TYPE2=231,t.SHARE_TYPE_RESOLVE_REWQRD_DOUBLE=234,t.SHARE_TYPE_TASK=235,t.SHARE_TYPE_FASHION=236,t.SHARE_TYPE_PASS_CHECK_CRYTRAL=237,t.SHARE_TYPE_DIAM_WELFARE1=238,t.SHARE_TYPE_DIAM_WELFARE2=239,t.SHARE_TYPE_SHOP_REWARD=240,t.SHARE_TYPE_BUNNY_GIRL=241,t.SHARE_TYPE_CLIMB_TOWER_SD=242,t.SHARE_TYPE_SELF_TALENT=243,t.SHARE_TYPE_GET_MSDHQ=244,t.SHARE_TYPE_HELP_TALENT=245,t.SHARE_TYPE_SHOP_INVITE=300,t}();i.default=f,cc._RF.pop()},{}],AssetUtils:[function(t,e,a){"use strict";cc._RF.push(e,"016e8vcXmtGAKgc3FCLrZL6","AssetUtils");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.AssetUtils=void 0;var i=function(){function t(){}return t.loadSpriteFrame=function(t,e,a,n){cc.resources.load(e,cc.SpriteFrame,function(i,o){if(i)console.warn("Load res fail,url:"+e);else try{t.getComponent(cc.Sprite).spriteFrame=o,null!=a&&a.call(n)}catch(r){console.log("loadSpriteFrame ",r)}})},t.loadSpriteFrame2=function(t,e,a){cc.resources.load(t,cc.SpriteFrame,function(n,i){if(n)console.warn("Load res fail,url:"+t);else try{null!=e&&e.call(a,i)}catch(o){console.log("loadSpriteFrame ",o)}})},t.loadRemoteUrl2=function(t,e){cc.assetManager.loadRemote(e,{ext:".jpg"},function(a,n){a?console.warn("Load res fail,url:"+e):t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)})},t.loadPrefab=function(t,e,a){cc.resources.load(t,cc.Prefab,function(n,i){n?console.warn("Load res fail,url:"+t):e.call(a,i,t)})},t.loadRemoteUrl=function(t,e){cc.assetManager.loadRemote(e,function(a,n){a?console.warn("Load res fail,url:"+e):t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)})},t.loadSpriteAtlas=function(t,e,a){cc.resources.load(e,cc.SpriteAtlas,function(n,i){n?console.warn("Load res fail,url:"+e):t.getComponent(cc.Sprite).spriteFrame=i.getSpriteFrame(a)})},t.loadSpine=function(t,e,a,n,i){cc.resources.loadDir(e,function(o,r){o||r.length<=0?console.warn("Load res fail,url:"+e):(r.forEach(function(e){e instanceof sp.SkeletonData&&(t.skeletonData=e)}),null==a||0==a.length||a.length>0&&t.setSkin(a),n.call(i))})},t.loadSound=function(t,e,a){cc.resources.load(t,cc.AudioClip,function(n,i){n?console.warn("Load res fail,url:"+t):e.call(a,i)})},t.loadConfigJson=function(t,e,a){var n="Json/"+t;cc.resources.load(n,cc.JsonAsset,function(i,o){i?console.warn("Load Config Json fail,url:"+n):e.call(a,t,o.json)})},t.loadResArray=function(t,e,a,n){cc.resources.preload(t,function(t,a,i){e.call(n,t,a,i)},function(t,e){e.forEach(function(){}),a.call(n,t,e)})},t.loadParticles=function(t,e){cc.resources.loadDir(e,cc.ParticleAsset,function(a,n){a?console.warn("Load res fail,url:"+e):t.file=n[0]})},t}();n.AssetUtils=i,cc._RF.pop()},{}],BaseAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"f8668LQTcpD+aevfPpwVT8F","BaseAdServer");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t){this.component2=null,this.versionNo="1.0.0",this.rewardAd=null,this.interAd=null,this.bannerAd=null,this.oldBannerAd=null,this.reCreateBanner=!0,this.bannerOk=!1,this.nativeAd=null,this.appBoxAd=null,this.blockAdList=new Array,this.nativeAd2=null,this.rewardAdLoadStatus=0,this.currShowBanner=!1,this.bannerType=0,this.bannerPlace=0,this.haveAd=!1,this.videoPath="",this.recorderStarTime=0,this.adServer=t}return t.prototype.getAppId=function(){return""},t.prototype.createBannerAd=function(){},t.prototype.showGameClub=function(){},t.prototype.hideGameClub=function(){},t.prototype.showAppBoxAd=function(){},t.prototype.showBlockAd=function(){},t.prototype.hideBlockAd=function(){},t.prototype.showNativeAd=function(t,e){e.call(t,-1,null)},t.prototype.showNativeAd2=function(t,e){e.call(t,-1,null)},t.prototype.adReportEvent=function(){},t.prototype.adReportEvent2=function(){},t.prototype.vibrateShort=function(){},t.prototype.navigateToMiniProgram=function(){},t.prototype.showShareMenu=function(){},t.prototype.showModal=function(){},t.prototype.hasScreenFringe=function(){return 0},t.prototype.getSetting=function(){},t.prototype.openSetting=function(){},t.prototype.getUserInfo=function(){},t.prototype.createUserInfoButton=function(){},t.prototype.createUserInfoButton2=function(){},t.prototype.hideUserInfoBtn=function(){},t.prototype.setKeepScreenOn=function(){},t.prototype.login=function(){},t.prototype.getLaunchOptionsSync=function(){},t.prototype.virtualPayment=function(){},t.prototype.showSubscribeStatus=function(){},t.prototype.showSubscribeMessage=function(){},t.prototype.showCustomAd=function(){},t.prototype.hideCustomAd=function(){},t.prototype.openCustomerServiceConversation=function(){},t.prototype.getLaunchOptions=function(){},t.prototype.setClipboardData=function(){},t.prototype.recordStart=function(){},t.prototype.recordPause=function(){},t.prototype.recordResume=function(){},t.prototype.recordEnd=function(){},t.prototype.reportCustomData=function(t,e){void 0===e&&(e={})},t.prototype.shareVideo=function(){},t.prototype.navigateToVideoView=function(){},t.prototype.openAwemeUserProfile=function(){},t}();n.default=i,cc._RF.pop()},{}],BuffBox:[function(t,e,a){"use strict";cc._RF.push(e,"cf3cbluPBZN1LCfI2c1PWGy","BuffBox");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("GameData"),h=i("PublicConst"),u=i("MyMathUtils"),d=i("MainLogic"),p=i("AdServer"),f=i("TaskLogic"),y=i("PublicEnum"),m=cc._decorator,g=m.ccclass,I=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.type=t,this.bodyNode=cc.find("Img/Background",this.node),c.AssetUtils.loadSpriteFrame(this.bodyNode,"Combat/zhandou-"+(57+t))},e.prototype.resetData=function(){var t=-cc.winSize.width/2+Math.random()*cc.winSize.width,e=Math.random()*cc.winSize.height/2;this.node.x=t,this.node.y=e,this.startMove()},e.prototype.startMove=function(){var t=this,e=u.default.toRadian(360*Math.random()),a=this.node.x+200*Math.cos(e);a=Math.min(a,cc.winSize.width/2),a=Math.max(a,-cc.winSize.width/2);var n=this.node.y+200*Math.sin(e);n=Math.min(n,cc.winSize.height/2),n=Math.max(n,0);var i=cc.v2(this.node.x,this.node.y).sub(cc.v2(a,n)).mag()/100;this.node.runAction(cc.sequence(cc.moveTo(i,cc.v2(a,n)),cc.callFunc(function(){t.startMove()},this)))},e.prototype.onclickEvent=function(t,e){0==e&&p.default.Instance.adHandler(p.default.AD_TYPE_BUFF_BOX,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){0==e?(0!=l.default.Instance.playerData.cdActiveFreeAd&&a||d.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1),d.default.Instance.combatScene.showMsgInfo(["\u8fde\u7eed\u4e09\u5173\u94f6\u5e01\u6536\u76ca\u589e\u52a010%","\u7acb\u5373\u83b7\u5f9710\u70b9\u4f53\u529b","\u8fde\u7eed\u4e09\u5173\u7075\u529b\u6536\u76ca\u589e\u52a010%"][this.type-1],1),2==this.type&&d.default.Instance.moneyLogic.addItemCount(1003,5),l.default.Instance.localStorage(!0),this.delete()):-1==e?(d.default.Instance.combatScene.showMsgInfo(h.default.NO_AD),p.default.Instance.noVideoToShare()&&(t==p.default.AD_TYPE_SHOP_PROP_UPDATE&&(this.shareType=p.default.SHARE_TYPE_SHOP_PROP_UPDATE),h.default.Platform==y.PLAT_FORM.Douyin?p.default.Instance.shareAppCallBack(this,this.shareAppCallback2):d.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),p.default.Instance.shareApp())):d.default.Instance.combatScene.showMsgInfo(h.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void d.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,d.default.Instance.combatScene.showMsgInfo(h.default.SUCCESS_SHARE,1),p.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else d.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-p.default.Instance.adServer.shareDateTime)/1e3);if(p.default.Instance.shareState(e)){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void d.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,d.default.Instance.combatScene.showMsgInfo(h.default.SUCCESS_SHARE,1),p.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else p.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(d.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),p.default.Instance.shareApp())},e.prototype.delete=function(){this.node.stopAllActions(),d.default.Instance.mainLayer.nodeManager.putBuffBox(this)},s([g],e)}(cc.Component));o.default=I,cc._RF.pop()},{}],BuffData:[function(t,e,a){"use strict";cc._RF.push(e,"cf6aaKV1N5N1IbYSUaa4FN/","BuffData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){this.buffId=t,this.continueTime=e},cc._RF.pop()},{}],BuffEnum:[function(t,e,a){"use strict";cc._RF.push(e,"160f8nX6dNOXoPwKO9p30k3","BuffEnum");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.BUFF_EFFECT_EVENT=n.BUFF_TYPE=void 0,function(t){t[t.None=0]="None",t[t.ADD_BODY_SIZE=1]="ADD_BODY_SIZE",t[t.ADD_ATK_RATE=2]="ADD_ATK_RATE",t[t.ADD_ATK_SPEED_RATE=3]="ADD_ATK_SPEED_RATE",t[t.ADD_SKILL=4]="ADD_SKILL",t[t.HP_RATE=5]="HP_RATE",t[t.ADD_HP=6]="ADD_HP",t[t.MOVE_SPEED=7]="MOVE_SPEED",t[t.Forzen=8]="Forzen",t[t.Crit_Rate=9]="Crit_Rate",t[t.Stoic=10]="Stoic",t[t.Def_Rate=11]="Def_Rate",t[t.Exp_Rate=12]="Exp_Rate"}(n.BUFF_TYPE||(n.BUFF_TYPE={})),function(t){t[t.Start=0]="Start",t[t.Interval=1]="Interval",t[t.End=2]="End"}(n.BUFF_EFFECT_EVENT||(n.BUFF_EFFECT_EVENT={})),cc._RF.pop()},{}],BuffInfo:[function(t,e,a){"use strict";cc._RF.push(e,"476cf9EICNOaZCCcLit1blP","BuffInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.buffTypeList=new Array,this.valueList=new Array,this.timeList=new Array,this.id=o.default.stringToInt(t.id),this.name=t.name,this.buff_type=o.default.stringToInt(t.buff_type),this.value=o.default.stringToFloat(t.value),this.last_time=o.default.stringToFloat(t.last_time),this.buff2_type=o.default.stringToInt(t.buff2_type),this.value2=o.default.stringToFloat(t.value2),this.last2_time=o.default.stringToFloat(t.last2_time),this.grow_coefficient=o.default.stringToFloat(t.grow_coefficient),this.buff_type&&(this.buffTypeList.push(this.buff_type),this.valueList.push(this.value),this.timeList.push(this.last_time)),this.buff2_type&&(this.buffTypeList.push(this.buff2_type),this.valueList.push(this.value2),this.timeList.push(this.last2_time))},cc._RF.pop()},{}],BuffManager:[function(t,e,a){"use strict";cc._RF.push(e,"f52ccd/72ZIzZBuwYkvZ/c0","BuffManager");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("BuffUtil"),r=n("PublicEnum"),s=n("BuffEnum"),c=function(){function t(t){this.buffList=new Array,this._heroSprite=t}return t.prototype.logicUpdate=function(t){for(var e=this.buffList.length-1;e>=0;e--){var a=this.buffList[e];a._active?a.logicUpdate(t):this.buffList.splice(e,1)}},t.prototype.resetData=function(){this.buffList.splice(0,this.buffList.length)},t.prototype.addBuff=function(t){t.activeBuff(this);var e=o.default.getBuffEffectType(t.buffType);this.addBuffEffect(e,t),this.buffList.push(t)},t.prototype.addBuffList=function(t){for(var e=0;e<t.length;e++){var a=t[e];this.addBuff(a)}},t.prototype.addBuffEffect=function(t){for(var e=0;e<t.length;e++)t[e]},t.prototype.buffObjIntervalEvent=function(t){this._heroSprite.lifeStatus!=r.LIFE_STATUS.Dead&&o.default.buffEffect(t,this._heroSprite,s.BUFF_EFFECT_EVENT.Interval)},t.prototype.buffObjectEndEvent=function(t){o.default.buffEffect(t,this._heroSprite,s.BUFF_EFFECT_EVENT.End)},t.prototype.buffObjectStartEvent=function(t){o.default.buffEffect(t,this._heroSprite,s.BUFF_EFFECT_EVENT.Start)},t.prototype.cancelBuffType=function(t){for(var e=0;e<this.buffList.length;e++){var a=this.buffList[e];a._active&&a.buffType==t&&(a._active=!1)}},t.prototype.querySkillBuff=function(){for(var t=new Array,e=0;e<this.buffList.length;e++){var a=this.buffList[e];a._active&&a.skillId>0&&t.push(a.skillId)}return t},t}();i.default=c,cc._RF.pop()},{}],BuffObject:[function(t,e,a){"use strict";cc._RF.push(e,"a102b1qjM9KoJZ743oxMghI","BuffObject");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=n("MainLogic"),s=function(){function t(){this._active=!0,this.intervalTime=0,this.intervalTargetTime=0,this.buffAmountValue=0,this.intervalTime=0}return t.prototype.init=function(t,e,a,n){this.buffType=t,this.skillId=n,this.buffAmountValue=e,this.continueTime=a,this.intervalTime=.5},t.prototype.activeBuff=function(t){this.buffManager=t,this._active=!0,0!=this.intervalTime&&(this.intervalTargetTime=this.intervalTime),this.continueTargetTime=this.continueTime,this.buffManager.buffObjectStartEvent(this)},t.prototype.logicUpdate=function(t){r.default.Instance.combatLayer.gameStep!=o.GAME_STEP.Over&&this._active&&(this.continueTargetTime-=t,this.continueTargetTime<=0&&(this._active=!1,this.buffManager.buffObjectEndEvent(this)),0!=this.intervalTime&&(this.intervalTargetTime-=t,this.intervalTargetTime<=0&&(this.buffManager.buffObjIntervalEvent(this),this.intervalTargetTime=this.intervalTime)))},t}();i.default=s,cc._RF.pop()},{}],BuffUtil:[function(t,e,a){"use strict";cc._RF.push(e,"dc825x2MbVH8ZblSdqY4MCG","BuffUtil");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("BuffObject"),r=n("PlayerAttribute"),s=n("BuffEnum"),c=n("PublicEnum"),l=function(){function t(){}return t.createBuffByHit=function(e){for(var a=new Array,n=0;n<e.length;++n)switch(e[n][0]){case 30:a.push(t.createBuff(s.BUFF_TYPE.Forzen,0,e[n][2],0))}return a},t.buffEffect=function(e,a,n){if(n==s.BUFF_EFFECT_EVENT.Interval);else if(n==s.BUFF_EFFECT_EVENT.End||n==s.BUFF_EFFECT_EVENT.Start){var i=e.buffAmountValue;e.buffType==s.BUFF_TYPE.Forzen?a.hurtStatus(e.buffType,n,e.continueTime):e.buffType==s.BUFF_TYPE.ADD_HP&&n==s.BUFF_EFFECT_EVENT.End||(a.hurtStatus(e.buffType,n,e.continueTime),n==s.BUFF_EFFECT_EVENT.End&&(i=-i),a.hurtData(t.buffTypeToAttribyte(e.buffType),i,!1),a.hp<=0&&a.hurtEvent(c.SKILL_EVENT.Dead))}},t.buffTypeToAttribyte=function(t){var e=r.ATTRIBUTE_TYPE.None;switch(t){case s.BUFF_TYPE.ADD_ATK_RATE:e=r.ATTRIBUTE_TYPE.Attack_Rate;break;case s.BUFF_TYPE.ADD_BODY_SIZE:e=r.ATTRIBUTE_TYPE.Body_size;break;case s.BUFF_TYPE.ADD_ATK_SPEED_RATE:e=r.ATTRIBUTE_TYPE.Attack_Speed;break;case s.BUFF_TYPE.HP_RATE:e=r.ATTRIBUTE_TYPE.HP_Rate;break;case s.BUFF_TYPE.ADD_HP:e=r.ATTRIBUTE_TYPE.ADD_HP;break;case s.BUFF_TYPE.MOVE_SPEED:e=r.ATTRIBUTE_TYPE.Move_Speed;break;case s.BUFF_TYPE.Crit_Rate:e=r.ATTRIBUTE_TYPE.Crit_Rate;break;case s.BUFF_TYPE.Stoic:e=r.ATTRIBUTE_TYPE.Stoic;break;case s.BUFF_TYPE.Def_Rate:e=r.ATTRIBUTE_TYPE.Def_Rate;break;case s.BUFF_TYPE.Exp_Rate:e=r.ATTRIBUTE_TYPE.Exp_Rate}return e},t.getBuffEffectType=function(){return new Array},t.createBuffBySpecialItem=function(e,a){for(var n=new Array,i=0;i<e.buffTypeList.length;++i){var o=e.buffTypeList[i],r=e.valueList[i]+e.grow_coefficient*(a-1);switch(o){case 1:n.push(t.createBuff(s.BUFF_TYPE.ADD_ATK_RATE,r/100,e.timeList[i],0));break;case 2:n.push(t.createBuff(s.BUFF_TYPE.HP_RATE,r/100,e.timeList[i],0));break;case 3:n.push(t.createBuff(s.BUFF_TYPE.Def_Rate,r/100,e.timeList[i],0));break;case 4:n.push(t.createBuff(s.BUFF_TYPE.Exp_Rate,r/100,e.timeList[i],0));break;case 5:n.push(t.createBuff(s.BUFF_TYPE.Crit_Rate,r/100,e.timeList[i],0));break;case 13:n.push(t.createBuff(s.BUFF_TYPE.Stoic,r,e.timeList[i],0))}}return n},t.createBuff=function(t,e,a,n){var i=new o.default;return i.init(t,e,a,n),i},t.createPetBuff=function(t,e){var a=new o.default;return a.init(t,0,e,0),a},t.copyBuffObject=function(t){var e=new o.default;return t.init(t.buffType,t.buffAmountValue,t.continueTime,t.skillId),e},t}();i.default=l,cc._RF.pop()},{}],BulletData:[function(t,e,a){"use strict";cc._RF.push(e,"a465bBeUG5NIZvF9NrdgOkv","BulletData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=function(){function t(){this.bulletStep=o.BULLET_STEP.Warn,this.bulletMoveType=o.BULLET_MOVE_TYPE.None,this.hurtType=o.BULLET_HURT_TYPE.Normal,this.explodeType=o.BULLET_EXPLODE_TYPE.None,this.collideShape=o.COLLIDE_SHAPE.Circle_Circle,this.isSelfSkill=!0,this.playTimes=0,this.isExplodeDivision=!1,this.noAddAnima=!1}return t.prototype.init=function(t){this.bulletSprite=t;var e=this.bulletSprite.skillInfo;switch(1==e.hurt_area_type&&(this.collideShape=o.COLLIDE_SHAPE.Rect_Circle),e.skill_type){case o.SKILL_TYPE.Type_1001:this.hurtType=o.BULLET_HURT_TYPE.Continue,this.bulletMoveType=o.BULLET_MOVE_TYPE.Angle,this.playTimes=0;break;case o.SKILL_TYPE.Type_1008:this.hurtType=o.BULLET_HURT_TYPE.Through,this.bulletMoveType=o.BULLET_MOVE_TYPE.Angle,this.playTimes=0;break;case o.SKILL_TYPE.Type_2028:this.hurtType=o.BULLET_HURT_TYPE.Through,this.bulletMoveType=o.BULLET_MOVE_TYPE.None,this.explodeType=o.BULLET_EXPLODE_TYPE.Target_Position_Explode,this.playTimes=1;break;case o.SKILL_TYPE.Type_3:this.hurtType=o.BULLET_HURT_TYPE.Normal,this.bulletMoveType=o.BULLET_MOVE_TYPE.Angle,this.playTimes=0;break;case o.SKILL_TYPE.Type_2027:case o.SKILL_TYPE.Type_2027:this.hurtType=o.BULLET_HURT_TYPE.Scope,this.bulletMoveType=o.BULLET_MOVE_TYPE.None,this.playTimes=1}},t.prototype.resetData=function(){this.bulletStep=o.BULLET_STEP.Fly,this.noAddAnima=!1,this.isSelfSkill=this.isSelfSkillBullet()},t.prototype.isSelfSkillBullet=function(){var t=this.bulletSprite.skillInfo;if(null==this.bulletSprite.heroSprite)return!1;for(var e=this.bulletSprite.heroSprite.skills,a=0;a<e.length;++a)if(t==e[a])return!0;return!1},t}();i.default=r,cc._RF.pop()},{}],BulletSprite:[function(t,e,a){"use strict";cc._RF.push(e,"c5d65xy//BDnpMqcZhMamTh","BulletSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("ConfigData"),h=i("StringUtils"),u=i("PublicEnum"),d=i("HurtUtil"),p=i("Dictionary"),f=i("BulletData"),y=i("RectCircle"),m=i("MyMathUtils"),g=i("MainLogic"),I=i("SoundManager"),_=cc._decorator,v=_.ccclass,S=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadDragonFinish=!1,e.hitTargetMap=new p.Dictionary,e.moveTimes=1,e.moveAngleNum=0,e.lastFramePos=cc.Vec2.ZERO,e}return r(e,t),e.prototype.init=function(t){var e=this;this.skillId=t,this.skillInfo=l.default.Instance.skillMap.get(this.skillId),this.bulletData=new f.default,this.bulletData.init(this),this.armature=cc.find("Armature",this.node),this.armatureDisplay=this.armature.getComponent(sp.Skeleton),this.explodeArmature=cc.find("ExplodeArmature",this.node),this.explodeArmature.active=!1,this.explodeArmatureDisplay=this.explodeArmature.getComponent(sp.Skeleton),this.resList=h.default.stringToStringListForRes(this.skillInfo.bullet_id),this.node.scale=l.default.Instance.resourceMap.get(this.skillInfo.bullet_id).scale;var a=this.resList[0];c.AssetUtils.loadSpine(this.armatureDisplay,"Bullet/"+a,null,function(){e.loadDragonFinish=!0,e.playAnimate(e.bulletData.playTimes)},this);var n=this;this.armatureDisplay.setCompleteListener(function(){n.skillInfo.skill_type!=u.SKILL_TYPE.Type_1001&&n.skillInfo.skill_type!=u.SKILL_TYPE.Type_2028&&n.playAnimate2()}),h.default.stringIsNull(this.skillInfo.exploded_id)||(this.explodeResList=h.default.stringToStringListForRes(this.skillInfo.exploded_id),this.explodeArmature.scale=l.default.Instance.resourceMap.get(this.skillInfo.exploded_id).scale,a=this.explodeResList[0],c.AssetUtils.loadSpine(this.explodeArmatureDisplay,"Bullet/"+a,null,function(){},this))},e.prototype.resetData=function(t,e,a,n,i){this.heroSprite=t,this.targetHeroSprite=e,null!=this.heroSprite?this.battleCamp=this.heroSprite.battleCamp:this.battleCamp=u.BATTLE_CAMP.Enemy,this.node.x=a.x,this.node.y=a.y,null==i&&(i=90),this.moveAngleNum=i,this.bulletData.resetData(),this.lastFramePos=cc.v2(this.node.x,this.node.y),this.armature.active=!0,this.explodeArmature.active=!1,this.targetPositon=n,this.skillInfo.skill_type==u.SKILL_TYPE.Type_1001?(this.node.angle=this.moveAngleNum,this.playAnimate(this.bulletData.playTimes)):this.skillInfo.skill_type==u.SKILL_TYPE.Type_3||this.skillInfo.skill_type==u.SKILL_TYPE.Type_2027?(this.hitTargetMap.clear(),this.node.angle=this.moveAngleNum,this.playAnimate(this.bulletData.playTimes)):(this.hitTargetMap.clear(),this.playAnimate(this.bulletData.playTimes)),this.node.active=!1},e.prototype.playAnimate=function(t){null==t&&(t=1),this.armatureDisplay.setAnimation(0,this.resList[1],0==t),this.armatureDisplay.timeScale=1.4},e.prototype.playAnimate2=function(t){this.resList.length<3||(null==t&&(t=0),this.armatureDisplay.setAnimation(0,this.resList[2],0==t),this.armatureDisplay.timeScale=1)},e.prototype.playExplodeAnimate=function(){this.armature.active=!1,this.explodeArmature.active=!0,this.explodeArmatureDisplay.setAnimation(0,this.explodeResList[1],!1)},e.prototype.mainStep=function(){this.node.active=!0,this.skillInfo.skill_type==u.SKILL_TYPE.Type_1001||this.skillInfo.skill_type==u.SKILL_TYPE.Type_2028?this.moveToTarget():this.skillInfo.skill_type==u.SKILL_TYPE.Type_4?(this.node.opacity=255,this.standTarget()):this.skillInfo.skill_type==u.SKILL_TYPE.Type_5?(this.node.opacity=255,this.moveTimes=9,this.schedule(this.hurtSchedule,.05),this.moveTimesByTarget()):this.doStep()},e.prototype.doStep=function(){var t=this,e=this.bulletData.bulletStep;e==u.BULLET_STEP.Warn||(e==u.BULLET_STEP.Fly?(this.bulletData.bulletMoveType==u.BULLET_MOVE_TYPE.Angle?this.moveByAngle():this.bulletData.bulletMoveType==u.BULLET_MOVE_TYPE.Curve&&this.parabolaMove(),this.bulletData.hurtType==u.BULLET_HURT_TYPE.Normal||this.bulletData.hurtType==u.BULLET_HURT_TYPE.Scope?(this.hitTargetMap.clear(),this.skillInfo.skill_type==u.SKILL_TYPE.Type_2027||this.skillInfo.skill_type==u.SKILL_TYPE.Type_2029?(this.schedule(this.hurtSchedule,this.skillInfo.hurt_intermission),this.node.runAction(cc.sequence(cc.delayTime(this.skillInfo.Trap_last_time),cc.callFunc(function(){t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))):this.schedule(this.hurtSchedule,.05)):this.bulletData.hurtType==u.BULLET_HURT_TYPE.Target?this.moveToTargetAndHurt():this.bulletData.hurtType==u.BULLET_HURT_TYPE.Continue?(this.hitTargetMap.clear(),this.delayHurtByTime()):this.bulletData.hurtType==u.BULLET_HURT_TYPE.Through&&(this.hitTargetMap.clear(),this.schedule(this.hurtSchedule,.05))):e==u.BULLET_STEP.Explode?this.skillInfo.skill_type==u.SKILL_TYPE.Type_2028?(this.playAnimate2(1),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))):this.bulletData.isExplodeDivision?this.exportDivision():(this.playExplodeAnimate(),this.node.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))):e==u.BULLET_STEP.Delete&&this.delete())},e.prototype.delayHurtByTime=function(){var t=this;this.schedule(this.hurtSchedule,this.skillInfo.hurt_intermission),this.node.runAction(cc.sequence(cc.delayTime(this.skillInfo.Trap_last_time),cc.callFunc(function(){t.unschedule(t.hurtSchedule),t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))},e.prototype.followTargetPosition=function(){var t=this.targetHeroSprite.heroNode.getBodyCenter();null!=this.skillInfo.hurtStartList&&this.skillInfo.hurtStartList.length>0&&(t.x+=this.skillInfo.hurtStartList[0][0],t.y+=this.skillInfo.hurtStartList[0][1]),this.node.x=t.x,this.node.y=t.y},e.prototype.moveToTargetAndHurt=function(){var t=this;this.schedule(this.followTargetPosition,0),this.node.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){t.hurtTarget(),t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))},e.prototype.moveByAngle=function(){var t=this,e=this.skillInfo.shot_range/this.skillInfo.speed,a=cc.v2(this.skillInfo.shot_range*Math.cos(m.default.toRadian(this.moveAngleNum)),this.skillInfo.shot_range*Math.sin(m.default.toRadian(this.moveAngleNum)));this.node.runAction(cc.sequence(cc.moveBy(e,a),cc.callFunc(function(){t.bulletData.bulletStep==u.BULLET_STEP.Fly&&(t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep())},this)))},e.prototype.moveToTarget=function(){var t=this;if(null==this.targetPositon){var e=(n=2*cc.winSize.width)/this.skillInfo.speed,a=0;this.node.runAction(cc.sequence(cc.moveBy(e,cc.v2(this.heroSprite.heroStatus.face*n,0)),cc.delayTime(a),cc.callFunc(function(){t.bulletData.hurtType==u.BULLET_HURT_TYPE.Continue?(t.playAnimate2(),t.hitTargetMap.clear(),t.delayHurtByTime()):(t.unschedule(t.hurtSchedule),t.delete())},this)))}else{var n;e=(n=this.node.getPosition().sub(this.targetPositon).mag())/this.skillInfo.speed,a=0,this.node.runAction(cc.sequence(cc.moveTo(e,this.targetPositon),cc.delayTime(a),cc.callFunc(function(){t.bulletData.hurtType==u.BULLET_HURT_TYPE.Continue?(t.playAnimate2(),t.hitTargetMap.clear(),t.delayHurtByTime()):t.bulletData.explodeType==u.BULLET_EXPLODE_TYPE.Target_Position_Explode?(t.hurtSchedule(),t.bulletData.bulletStep=u.BULLET_STEP.Explode,t.doStep()):(t.unschedule(t.hurtSchedule),t.delete())},this)))}this.skillInfo.skill_type!=u.SKILL_TYPE.Type_1001&&this.skillInfo.skill_type!=u.SKILL_TYPE.Type_2028&&this.schedule(this.hurtSchedule,.05)},e.prototype.updateBulletAngle=function(){var t=cc.v2(this.node.x,this.node.y),e=t.sub(this.lastFramePos);if(e.normalizeSelf(),0!=e.len()){var a=180*cc.v2(1,0).signAngle(e)/Math.PI;this.node.angle=a,this.lastFramePos=t}else this.lastFramePos=t},e.prototype.parabolaMove=function(){var t=this,e=this.node.getPosition().sub(this.targetPositon).mag(),a=e/this.skillInfo.speed,n=this.bezierAction(a,this.node.getPosition(),this.targetPositon,e/3.5,80);this.unschedule(this.updateBulletAngle),this.schedule(this.updateBulletAngle,0),this.node.runAction(cc.sequence(n,cc.callFunc(function(){t.unschedule(t.hurtSchedule),t.unschedule(t.updateBulletAngle),t.bulletData.explodeType==u.BULLET_EXPLODE_TYPE.Collide_Explode?(t.bulletData.bulletStep=u.BULLET_STEP.Explode,t.doStep()):t.delete()},this)))},e.prototype.bezierAction=function(t,e,a,n,i){var o=i*Math.PI/180,r=e.x+(a.x-e.x)/4,s=cc.v2(r,n+e.y+Math.cos(o)*r),c=e.x+(a.x-e.x)/2,l=cc.v2(c,n+e.y+Math.cos(o)*c);return cc.bezierTo(t,[s,l,a])},e.prototype.exportDivision=function(){var t=this;this.node.runAction(cc.repeat(cc.sequence(cc.callFunc(function(){for(var e=0,a=t.heroSprite.heroStatus.face,n=0;n<t.skillInfo.bulletAngleList.length;n++){e=90+(e=t.skillInfo.bulletAngleList[n])*a*-1;var i=t.node.getPosition(),o=g.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(t.heroSprite,t.heroSprite.skills[0].id,null,i,null,e);o.bulletData.noAddAnima=!0,o.mainStep()}},this),cc.delayTime(.2)),3)),this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){t.bulletData.bulletStep=u.BULLET_STEP.Delete,t.doStep()},this)))},e.prototype.standTarget=function(){var t=this;this.schedule(this.hurtSchedule,.05),this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){t.unschedule(t.hurtSchedule),t.delete()},this)))},e.prototype.moveTimesByTarget=function(){var t=this;if(this.moveTimes--,0==this.moveTimes)return this.unschedule(this.hurtSchedule),void this.delete();var e=[[225,45],[135,-45],[225,45],[135,-45],[225,45],[135,-45],[225,45],[135,-45]],a=cc.v2(this.targetPositon.x+400*Math.cos(e[this.moveTimes-1][0]),this.targetPositon.y+400*Math.sin(e[this.moveTimes-1][0])),n=cc.v2(this.targetPositon.x+400*Math.cos(e[this.moveTimes-1][1]),this.targetPositon.y+400*Math.sin(e[this.moveTimes-1][1]));this.node.x=a.x,this.node.y=a.y;var i=Math.atan2(n.y-a.y,n.x-a.x);this.node.angle=180*i/Math.PI;var o=a.sub(n).mag()/this.skillInfo.speed;this.node.runAction(cc.sequence(cc.moveTo(o,n),cc.callFunc(function(){t.moveTimesByTarget()},this)))},e.prototype.delete=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks(),g.default.Instance.mainLayer.nodeManager.putBullet(this)},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this),this.armatureDisplay.timeScale=0},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this),this.armatureDisplay.timeScale=1},e.prototype.hurtTarget=function(){if(this.targetHeroSprite.heroStatus.canAttacked()){var t=d.default.createNormalHurtData(this.heroSprite,this.targetHeroSprite,this.skillInfo,this.bulletData.isSelfSkill);d.default.hurt(t);var e=1;this.node.getPosition().x>this.targetHeroSprite.node.getPosition().x&&(e=-1),I.SoundManager.Instance.playEffect(this.skillInfo.hit_sound),this.targetHeroSprite.hitEvent(e,this.skillInfo.hitImpulseList[0],this.skillInfo.hitTimeList[0],!0,1,this.skillInfo.id,1,this.heroSprite)}},e.prototype.hurtSchedule=function(){var t;g.default.Instance.combatScene.gameModel==u.GAME_MODEL.Normal&&(this.battleCamp==u.BATTLE_CAMP.Self?t=g.default.Instance.combatLayer.mainLayer.heroSpriteList:(t=new Array).push(g.default.Instance.combatLayer.mainLayer.myHeroSprite));for(var e=this.node.getPosition(),a=this.node.scale,n=new cc.Rect(e.x-this.skillInfo.hurtAreaList[0]*a/2,e.y-this.skillInfo.hurtAreaList[1]*a/2,this.skillInfo.hurtAreaList[0]*a,this.skillInfo.hurtAreaList[1]*a),i=0;i<t.length;i++){var o=t[i];if(null!=o&&o.heroStatus.canAttacked()){var r=!1,s=o.node.getPosition();if(s.y+=o.heroNode.bodyBoxSprite.y,this.bulletData.collideShape==u.COLLIDE_SHAPE.Circle_Circle)r=s.sub(e).mag()-this.skillInfo.hurtAreaList[0]<0;else{var c=y.default.newCircle(cc.v2(o.node.getPosition().x,o.node.getPosition().y+o.heroNode.bodyBoxSprite.y*o.node.scaleY),.5*o.roleInfo.bodyArea.height*o.node.scale);r=y.default.collide(n,this.moveAngleNum,c)}if(r){var l=this.hitTargetMap.get(o.randomId);if(null!=l){if(++l>this.skillInfo.max_hurt)continue}else l=1;this.hitTargetMap.put(o.randomId,l);var h=void 0;if(null!=this.heroSprite)h=d.default.createNormalHurtData(this.heroSprite,o,this.skillInfo,this.bulletData.isSelfSkill),d.default.hurt(h);else{var p=g.default.Instance.combatLayer.dungeonInfo.atk_coefficient*this.trapSprite.trapInfo.atk;h=d.default.createTrapHurtData(o,this.skillInfo,p),d.default.hurt(h)}var f=1;if(this.node.getPosition().x>o.node.getPosition().x&&(f=-1),I.SoundManager.Instance.playEffect(this.skillInfo.hit_sound),0==o.roleInfo.is_fly&&this.skillInfo.hitImpulseList1&&this.skillInfo.hitTimeList1){var m=1;o.hitEvent(f,this.skillInfo.hitImpulseList1[0],this.skillInfo.hitTimeList1[0],!0,m,this.skillInfo.id,1,this.heroSprite)}else this.skillInfo.hitImpulseList&&this.skillInfo.hitTimeList?(m=1,o.hitEvent(f,this.skillInfo.hitImpulseList[0],this.skillInfo.hitTimeList[0],!0,m,this.skillInfo.id,1,this.heroSprite)):o.hitEvent(f,[0,0],0,!0,1,this.skillInfo.id,1,this.heroSprite);if(null!=this.heroSprite&&this.heroSprite.battleCamp==u.BATTLE_CAMP.Self&&g.default.Instance.combatLayer.uiLayer.showHurtEffect(Math.abs(h.hurtPoint)),this.bulletData.hurtType==u.BULLET_HURT_TYPE.Normal){this.bulletData.bulletStep=u.BULLET_STEP.Delete,this.doStep();break}this.bulletData.explodeType==u.BULLET_EXPLODE_TYPE.Collide_Explode&&this.bulletData.bulletStep==u.BULLET_STEP.Fly&&(this.node.stopAllActions(),this.bulletData.bulletStep=u.BULLET_STEP.Explode,this.doStep()),null!=this.heroSprite&&this.battleCamp==u.BATTLE_CAMP.Self&&this.skillInfo==this.heroSprite.skills[0]&&this.heroSprite.heroShooter.shootBulletByBuff(o)}}}},s([v],e)}(cc.Component));o.default=S,cc._RF.pop()},{}],BunnyFashion:[function(t,e,a){"use strict";cc._RF.push(e,"5adf1zt87FNQoKEOqTBAQUR","BunnyFashion");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("GameData"),u=i("AssetUtils"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.fashionId=t,this.fashionIndex=e,this.itemNode=cc.find("Item",this.node),this.itemNode.scale=.7;var a=l.default.Instance.equipmentMap.get(t);u.AssetUtils.loadSpriteFrame(this.itemNode,"Fasion/fashion_"+a.id),this.review()},e.prototype.review=function(){var t=h.default.Instance.playerData.bunnyStatus[this.fashionIndex];h.default.Instance.playerData.bunnyDay==this.fashionIndex&&0==t&&(t=1,h.default.Instance.playerData.bunnyStatus[this.fashionIndex]=1);for(var e=1;e<=3;++e){var a=cc.find("Status"+e,this.node);if(a.active=e==t+1,1==e)for(var n=1;n<=3;++n)cc.find("Day"+n,a).active=n==this.fashionIndex}},e.prototype.onClickBtn=function(){c.SoundManager.Instance.playEffect("anniu")},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],CdkeyLayer:[function(t,e,a){"use strict";cc._RF.push(e,"d376dJXWBRLyqkCRxeUwKHk","CdkeyLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.review(t)},e.prototype.review=function(t){this.pageType=t,this.node.active=!0;for(var e=1;e<=4;++e){var a=cc.find("Layer"+e,this.node);a.active=e==t,cc.find("Close",a).active=4==this.pageType||3==this.pageType,e==t&&(this.editBox=cc.find("Code",a).getComponent(cc.EditBox),this.editBox.string="")}},e.prototype.onClickBtn=function(t,e){c.SoundManager.Instance.playEffect("anniu"),this.editBox.string,1==e&&(this.node.active=!1),1==e&&this.pageType},s([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],ChapterBoxData:[function(t,e,a){"use strict";cc._RF.push(e,"e6219oZ0VRPq4nMeVwvOWls","ChapterBoxData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.status=new Array,this.chapterId=t,this.status.push(1),this.status.push(1),this.status.push(1)},cc._RF.pop()},{}],ChapterData:[function(t,e,a){"use strict";cc._RF.push(e,"9e137O6ptBLuYqd2Dosfumx","ChapterData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,a){this.chapterId=t,this.dungeonId=e,this.difficulty=a,this.status=1,this.starNum=1,this.count=0},cc._RF.pop()},{}],ChapterInfo:[function(t,e,a){"use strict";cc._RF.push(e,"563969StIdEm73zAu8QI7w/","ChapterInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.guide_tips=t.guide_tips,this.chapter_id=o.default.stringToInt(t.chapter_id),this.chapter_picture1=t.chapter_picture1,this.chapter_picture2=t.chapter_picture2,this.small_map=t.small_map,this.big_map=t.big_map,this.BG=t.BG,this.mode=t.mode,this.line=t.line,this.line_coordinate=t.line_coordinate,this.linePosList=o.default.config_stringToFloatList(this.line_coordinate,"_"),this.chest1_id=o.default.stringToInt(t.chest1_id),this.chest2_id=o.default.stringToInt(t.chest2_id),this.chest3_id=o.default.stringToInt(t.chest3_id),this.positionList=o.default.config_stringToFloatListOfList(this.mode,"_")},cc._RF.pop()},{}],ChapterItem:[function(t,e,a){"use strict";cc._RF.push(e,"0787aEbDNxF9YIzp56jnykv","ChapterItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("MainLogic"),l=i("ConfigData"),h=i("AssetUtils"),u=i("SoundManager"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.index=1,e}return r(e,t),e.prototype.init=function(t,e){this.index=t,this.chapterLayer=e,this.effectNode=cc.find("Effect",this.node),this.dungeonNumNode=cc.find("Img/DungeonNum",this.node),this.levelNode=cc.find("Img/Level",this.node),this.bossNode=cc.find("Boss",this.node)},e.prototype.reset=function(t){this.node.x=t[0],this.node.y=t[1];var e,a=c.default.Instance.chapterLogic.getMaxChapterInfo(this.chapterLayer.selectDiffculty)[0],n=c.default.Instance.chapterLogic.getMaxChapterInfo(this.chapterLayer.selectDiffculty)[1],i=this.chapterLayer.selectChapterId;if(this.status=3,1==this.chapterLayer.selectDiffculty)i<a?this.status=1:i==a&&this.index<n&&(this.status=1);else{var o=this.chapterLayer.selectDiffculty-1;4==this.chapterLayer.selectDiffculty&&(o=1);var r=c.default.Instance.chapterLogic.getChapterData(i,this.index,o);null==r?this.status=3:0==r.count?this.status=3:this.status=1}var s=l.default.Instance.dungeonMap.get(i);if(s&&(e=s.get(this.index).get(this.chapterLayer.selectDiffculty),h.AssetUtils.loadSpriteFrame(this.node,"Combat/"+e.small_bg),e.boss_id)){var u=l.default.Instance.roleMap.get(e.boss_id);h.AssetUtils.loadSpriteFrame(this.bossNode,"Combat/guanka_head_"+u.picture_id)}this.dungeonNumNode.getComponent(cc.Label).string=""+(e?e.name:this.index),this.levelNode.getComponent(cc.Label).string=e.chapter+"-"+e.dungeon,i==a&&this.index==n&&(this.status=2),i==a&&this.index==n?this.effectNode.active=!0:this.effectNode.active=!1;for(var d=1;d<=3;d++){var p=cc.find("Status"+d,this.node);p.active=!1,this.status==d||1==d&&2==this.status&&!this.effectNode.active?p.active=!0:p.active=!1}},e.prototype.onClickEvent=function(){this.status>2||(u.SoundManager.Instance.playEffect("anniu"),this.chapterLayer.selectDungeonId=this.index,this.chapterLayer.showCenterMap(),c.default.Instance.combatScene.popLayer.reviewChapterMorePage(1))},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],ChapterLayer:[function(t,e,a){"use strict";cc._RF.push(e,"830bfNGkixGYbgZ5hqOp8hq","ChapterLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("ConfigData"),h=i("StringUtils"),u=i("AdServer"),d=i("MainLogic"),p=i("GuideUtils"),f=i("PublicEnum"),y=i("SoundManager"),m=cc._decorator,g=m.ccclass,I=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chapterItemPrefab=null,e.selectDiffculty=1,e.preDiffculty=1,e.chapterMax=10,e.chapterItemList=new Array,e.showEquipmentTime=0,e}return r(e,t),e.prototype.init=function(){this.nameNode=cc.find("Top/Name",this.node),this.mapNode=cc.find("Center/Map",this.node),this.combatAtk=cc.find("Bottom1/Recommend/Layout/CombatAtk",this.node),this.myFightNode=cc.find("Bottom1/MyFight/Layout/MyFight",this.node),this.myFightUp=cc.find("Bottom1/MyFight/Layout/Up",this.node),this.myFightDown=cc.find("Bottom1/MyFight/Layout/Down",this.node),d.default.Instance.combatScene.isFringe>0?(console.log("\u5f53\u524d\u5218\u6d77\u5c4f"),cc.find("Left",this.node).getComponent(cc.Widget).left=d.default.Instance.combatScene.isFringe):console.log("\u5f53\u524d\u4e0d\u662f\u5218\u6d77\u5c4f"),this.selectChapterId=d.default.Instance.chapterLogic.getMaxChapterInfo(this.selectDiffculty)[0];var t=l.default.Instance.chapterMap.getValues();this.chapterMax=t.length,this.startGameBtn=cc.find("Bottom1/StartGameBtn",this.node),this.money1Node=cc.find("Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Top/Money/Type2/Num",this.node),this.money3Node=cc.find("Top/Money/Type3/Num",this.node),this.showMoney(),this.initChapterList(),this.review()},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=h.default.stringToWord(d.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+d.default.Instance.moneyLogic.getItemCount(1003),this.money3Node.getComponent(cc.Label).string=""+d.default.Instance.moneyLogic.getItemCount(1014)},e.prototype.review=function(){var t=this;this.node.active=!0,1==this.selectDiffculty&&(this.selectChapterId=d.default.Instance.chapterLogic.getMaxChapterInfo(this.selectDiffculty)[0]),this.showCenterMap(),this.showMoney(),u.default.Instance.hideBannerAd(),this.scheduleOnce(function(){t.guideAction()},0),this.scheduleOnce(function(){u.default.Instance.showCustomAd(1)},0)},e.prototype.showCenterMap=function(){cc.find("Bottom1",this.node).active=this.selectDiffculty<4,cc.find("Bottom2",this.node).active=4==this.selectDiffculty,cc.find("Fire",this.node).active=4==this.selectDiffculty,cc.find("Bg1",this.node).active=this.selectDiffculty<4,cc.find("Bg2",this.node).active=4==this.selectDiffculty,this.selectDiffculty<4&&(cc.find("Bottom1/Adventure/Background/Effect",this.node).active=1==this.selectDiffculty,cc.find("Bottom1/Warrior/Background/Effect",this.node).active=2==this.selectDiffculty,cc.find("Bottom1/King/Background/Effect",this.node).active=3==this.selectDiffculty);var t=l.default.Instance.chapterMap.get(this.selectChapterId);this.nameNode.getComponent(cc.Label).string=t.guide_tips+"-"+["\u5192\u9669","\u52c7\u58eb","\u738b\u8005","\u6df1\u6e0a"][this.selectDiffculty-1];for(var e=t.positionList,a=9;a>=0;a--){var n=this.chapterItemList[a];a<e.length?(n.node.active=!0,n.reset(e[a])):n.node.active=!1}},e.prototype.initChapterList=function(){for(var t=0;t<10;t++){var e=cc.instantiate(this.chapterItemPrefab),a=e.getComponent("ChapterItem");a.init(t+1,this),this.chapterItemList.push(a),e.zIndex=10-t,this.mapNode.addChild(e)}},e.prototype.selectChapter=function(t){t>d.default.Instance.chapterLogic.getMaxChapterInfo(1)[0]||(this.selectChapterId=t,this.showCenterMap())},e.prototype.hideNode=function(){this.node.active=!1,u.default.Instance.hideCustomAd(1),d.default.Instance.combatScene.homeLayer.streetLayer.leaveShowLayer()},e.prototype.onClickEvent=function(t,e){if(y.SoundManager.Instance.playEffect("anniu"),0==e)this.hideNode(),d.default.Instance.combatScene.gotoHomeLayer();else if(1==e){d.default.Instance.combatScene.popLayer.pointGuideFinish();var a=(new Date).getTime();if((a-this.showEquipmentTime)/1e3>60&&c.default.Instance.playerData.equipmentGridCount-d.default.Instance.roleLogic.getUnEquipmentCount()<5)return this.showEquipmentTime=a,void d.default.Instance.combatScene.popLayer.reviewGamePauseLayer(f.PAGE_NAME.Home,2);d.default.Instance.chapterLogic.quickStartGame(f.PAGE_NAME.Chapter,d.default.Instance.chapterLogic.getMaxChapterInfo(this.selectDiffculty)[0],d.default.Instance.chapterLogic.getMaxChapterInfo(this.selectDiffculty)[1],this.selectDiffculty)&&(this.node.active=!1)}else 10==e?1==this.selectChapterId||this.selectChapter(this.selectChapterId-1):11==e?this.selectChapterId==this.chapterMax||this.selectChapter(this.selectChapterId+1):13==e?(this.preDiffculty=this.selectDiffculty,this.selectDiffculty=1,this.showCenterMap()):14==e?(this.preDiffculty=this.selectDiffculty,this.selectDiffculty=2,this.showCenterMap()):15==e?(this.preDiffculty=this.selectDiffculty,this.selectDiffculty=3,this.showCenterMap()):16==e?c.default.Instance.playerData.level>=35?(this.preDiffculty=this.selectDiffculty,this.selectDiffculty=4,this.showCenterMap()):d.default.Instance.combatScene.showMsgInfo("35\u7ea7\u540e\u5f00\u542f"):17==e?(this.selectDiffculty=this.preDiffculty,this.preDiffculty=4,this.showCenterMap()):100==e?d.default.Instance.combatScene.popLayer.reviewMoneyMorePage(f.PAGE_NAME.Chapter,1,!0):101==e?d.default.Instance.combatScene.popLayer.reviewMoneyMorePage(f.PAGE_NAME.Chapter,2,!0):102==e&&d.default.Instance.combatScene.popLayer.reviewMoneyMorePage(f.PAGE_NAME.Chapter,3,!0)},e.prototype.guideAction=function(t){var e;e=this.startGameBtn.convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),p.default.Instance.isHaveGuide(2,1,t)&&d.default.Instance.combatScene.popLayer.reviewGuideLayer(2,1,this,this.guideCallback,e,cc.size(100,100))},e.prototype.guideCallback=function(){this.node.active&&this.guideAction(!0)},s([I(cc.Prefab)],e.prototype,"chapterItemPrefab",void 0),s([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{}],ChapterLogic:[function(t,e,a){"use strict";cc._RF.push(e,"d9b04/tDGpB/L5A659VFmN8","ChapterLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("ChapterData"),r=n("GameData"),s=n("ConfigData"),c=n("PublicConst"),l=n("PublicEnum"),h=n("MainLogic"),u=n("DataUtils"),d=n("TaskLogic"),p=n("DateUtils"),f=n("NumberMethod"),y=function(){function t(){}return t.prototype.quickStartGame=function(t,e,a,n,i){void 0===i&&(i=!0);var o=s.default.Instance.chapterTypeMap.get(e);if(1==o){if(100*e+a>h.default.Instance.chapterLogic.getMaxChaperId(n)&&1==n)return console.log("\u8bf7\u5148\u901a\u5173\u524d\u9762\u5173\u5361"),h.default.Instance.combatScene.showMsgInfo("\u8bf7\u5148\u901a\u5173\u524d\u9762\u5173\u5361"),!1;var c=!0,u=1003;if(4==n?(c=h.default.Instance.moneyLogic.addItemCount(1014,-1),u=1014):(c=h.default.Instance.moneyLogic.addItemCount(1003,-1),u=1003),!c)return h.default.Instance.moneyLogic.showMoreMoney(t,u,!0),!1}else if(5==o);else if(h.default.Instance.chapterLogic.getFubenNanduLevel(e,a)>r.default.Instance.playerData.level)return console.log("\u7b49\u7ea7\u4e0d\u8db3\uff0c\u65e0\u6cd5\u6311\u6218"),h.default.Instance.combatScene.showMsgInfo("\u7b49\u7ea7\u4e0d\u8db3\uff0c\u65e0\u6cd5\u6311\u6218"),!1;return h.default.Instance.combatScene.gameModel=l.GAME_MODEL.Normal,r.default.Instance.playerData.currChapter=e,r.default.Instance.playerData.currDungeon=a,r.default.Instance.playerData.currDiffculty=n,h.default.Instance.combatScene.gotoCombatLayer(),!0},t.prototype.receiveCombatBox=function(t,e){null==e&&(e=1);for(var a=0;a<t.length;a++){var n=t[a],i=n[0],o=n[1],r=void 0;1==n[2]?(r=s.default.Instance.equipmentMap.get(i),this.receiveEquipment(r,o,a)):(o*=e,r=s.default.Instance.itemMap.get(i),this.receiveItem(r,o,a))}h.default.Instance.tipsLogic.updateAllTips()},t.prototype.receiveItem=function(t,e,a){h.default.Instance.moneyLogic.addItemCount(t.id,e),h.default.Instance.combatScene.addRewardEffect(t.id,e,a,2)},t.prototype.receiveEquipment=function(t,e,a){for(var n=0,i=0;i<e&&h.default.Instance.equipmentLogic.addEquipmentData(t.id);++i)n+=1;n>0?h.default.Instance.combatScene.addRewardEffect(t.id,n,a,1):h.default.Instance.combatScene.showMsgInfo("\u80cc\u5305\u5df2\u6ee1")},t.prototype.getChapterData=function(t,e,a){for(var n=r.default.Instance.playerData.chapterDataList,i=0;i<n.length;i++){var o=n[i];if(null==o.difficulty&&(o.difficulty=1),o.chapterId==t&&o.dungeonId==e&&o.difficulty==a)return o}return null},t.prototype.getDungeonStarNum=function(t,e){for(var a=r.default.Instance.playerData.chapterDataList,n=0,i=0;i<a.length;i++){var o=a[i];null==o.difficulty&&(o.difficulty=1),o.chapterId==t&&o.dungeonId==e&&(n+=o.count)}return n},t.prototype.setDungeonStarNum=function(t,e,a,n){var i=this.getChapterData(t,e,a);null==i&&(i=new o.default(t,e,a),r.default.Instance.playerData.chapterDataList.push(i)),1==n&&(i.starNum=3,i.count+=1),r.default.Instance.localStorage(h.default.Instance.combatScene.isGameStart())},t.prototype.setSameChapterAndDungeon=function(t){r.default.Instance.playerData.currChapter=this.getMaxChapterInfo(t)[0],r.default.Instance.playerData.currDungeon=this.getMaxChapterInfo(t)[1]},t.prototype.totalStarResult=function(){var t=h.default.Instance.combatLayer;if(t.gameResult==l.GAME_RESULT.Success){t.starResult[0]=1;var e=t.mainLayer.myHeroSprite,a=e.hp/e.hpMax,n=t.dungeonInfo;2==n.star_type2&&a>n.star_key2&&(t.starResult[1]=1),2==n.star_type3&&a>n.star_key3&&(t.starResult[2]=1),3==n.star_type2&&t.gameTimeResult<n.star_key2&&(t.starResult[1]=1),3==n.star_type3&&t.gameTimeResult<n.star_key3&&(t.starResult[2]=1)}},t.prototype.passSuccessChapter=function(){var t=s.default.Instance.dungeonMap.get(r.default.Instance.playerData.currChapter),e=s.default.Instance.chapterTypeMap.get(r.default.Instance.playerData.currChapter),a=t.getKeys().length,n=0,i=this.getChapterId();if(1==e){var o=r.default.Instance.playerData.currDiffculty,l=h.default.Instance.chapterLogic.getMaxChapterInfo(o)[0],u=h.default.Instance.chapterLogic.getMaxChapterInfo(o)[1];if(r.default.Instance.playerData.currChapter==l&&r.default.Instance.playerData.currDungeon==u){var p=r.default.Instance.playerData.currChapter,f=r.default.Instance.playerData.currDungeon;1==o&&(r.default.Instance.playerData.currDungeon>=a?(n=1,r.default.Instance.playerData.currChapter++,r.default.Instance.playerData.currChapter<=c.default.MAX_CHAPTER?r.default.Instance.playerData.currDungeon=1:r.default.Instance.playerData.currChapter=c.default.MAX_CHAPTER):(n=2,r.default.Instance.playerData.currDungeon++),r.default.Instance.playerData.maxChapterInfo[o-1][0]=r.default.Instance.playerData.currChapter,r.default.Instance.playerData.maxChapterInfo[o-1][1]=r.default.Instance.playerData.currDungeon),r.default.Instance.playerData.maxChapterInfo[o][0]=p,r.default.Instance.playerData.maxChapterInfo[o][1]=f}}else 5==e?(r.default.Instance.playerData.towerLayerCount+=1,r.default.Instance.playerData.towerLayerCount>c.default.MAX_TOWER_LAYER&&(r.default.Instance.playerData.towerLayerCount=c.default.MAX_TOWER_LAYER),r.default.Instance.playerData.towerLayerCount>r.default.Instance.playerData.maxTowerLayerCount&&(r.default.Instance.playerData.maxTowerLayerCount=r.default.Instance.playerData.towerLayerCount-1,r.default.Instance.playerData.tgTowerTime=Math.floor((new Date).getTime()/1e3)),r.default.Instance.playerData.currDungeon=r.default.Instance.playerData.towerLayerCount):(n=2,h.default.Instance.tipsLogic.updateFuben(),r.default.Instance.playerData.endlessChallengeCount[e]-=1);return h.default.Instance.taskLogic.finishAllTask(d.default.type_adopt_dungeon_count,0,1),h.default.Instance.taskLogic.finishAllTask(d.default.type_adopt_appoint_dungeon,i,1),r.default.Instance.localStorage(h.default.Instance.combatScene.isGameStart()),n},t.prototype.passFailChapter=function(){var t=s.default.Instance.chapterTypeMap.get(r.default.Instance.playerData.currChapter);1==t||5==t||(r.default.Instance.playerData.endlessChallengeCount[t]-=1,h.default.Instance.tipsLogic.updateFuben(),r.default.Instance.localStorage(h.default.Instance.combatScene.isGameStart()))},t.prototype.getChapterId=function(){return 100*r.default.Instance.playerData.currChapter+r.default.Instance.playerData.currDungeon},t.prototype.getMaxChaperId=function(t){return 100*this.getMaxChapterInfo(t)[0]+this.getMaxChapterInfo(t)[1]},t.prototype.getMaxChapterInfo=function(t){return r.default.Instance.playerData.maxChapterInfo[t-1]},t.prototype.getChapterByChapterId=function(t){return Math.floor(t/100)},t.prototype.isOpen=function(t,e,a){return!(t>this.getMaxChapterInfo(e)[0]||t==this.getMaxChapterInfo(e)[0]&&a>this.getMaxChapterInfo(e)[1])},t.prototype.getMonsterDeathReward=function(t,e){void 0===e&&(e=!0);var a,n=h.default.Instance.combatLayer.dungeonInfo,i=s.default.Instance.dropMap.get(n.drop_id);if(!i)return console.log(" get monster death reward error 1 "),null;var o=0;if(1==t?(a=i.monsterDropNum,o=i.monster_exp):2==t?(a=i.eliteDropNum,o=i.elite_exp):3==t?(a=i.boosDropNum,o=i.boss_exp):(a=i.chasmBoosDropNum,o=i.chasm_boss_exp),e){var r=h.default.Instance.combatLayer.mainLayer.myHeroSprite;o=f.default.Instance.getExpNum(o,r.battleCamp,r.heroAttri),h.default.Instance.moneyLogic.addItemCount(1005,o),h.default.Instance.combatLayer.uiLayer.addRewardTip(1005,2,o)}if(!a)return console.log(" get monster death reward error 2 "),null;for(var c,l=Math.random(),d=0,p=0;p<a.length;++p)if(l<=a[p][1]){d=a[p][0];break}if(0==d)return null;if(!(c=1==t?i.monsterDrop:2==t?i.eliteDrop:3==t?i.bossDrop:i.chasmBossDrop))return console.log(" get monster death reward error 3 "),null;var y=new Array;for(p=0;p<c.length;++p)y.push(c[p][3]);var m=u.default.randomIndexListByWeight(y),g=new Array;for(p=0;p<d;++p)g.push(c[m[p]]);return g},t.prototype.getCombatResultReward=function(t){var e,a=h.default.Instance.combatLayer.dungeonInfo;e=1==t?a.rewardItemList:a.adRewardItemList;for(var n=new Array,i=0;i<e.length;++i)n.push(e[i][3]);var o=u.default.randomIndexListByWeight(n),r=new Array;for(i=0;i<o.length;++i)r.push(e[o[i]]);return r},t.prototype.getFubenChallegeCount=function(){for(var t=0,e=s.default.Instance.endlessMap.getKeys(),a=0;a<e.length;++a){var n=e[a],i=s.default.Instance.endlessMap.get(n),o=p.default.getWeekData();i.openTime.indexOf(o)>=0&&(t+=r.default.Instance.playerData.endlessChallengeCount[i.type])}return t},t.prototype.getFubenNanduLevel=function(t,e){for(var a=1e7,n=s.default.Instance.chapterTypeMap.get(t),i=s.default.Instance.endlessMap.get(n),o=0;o<i.openLevel.length;++o)if(i.openLevel[o][0]==e){a=i.openLevel[o][1];break}return a},t}();i.default=y,cc._RF.pop()},{}],ChapterMorePage:[function(t,e,a){"use strict";cc._RF.push(e,"c4d8f+IKGdKhIYwakAvgEsE","ChapterMorePage");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("ConfigData"),h=i("PublicEnum"),u=i("MainLogic"),d=i("AdServer"),p=i("SoundManager"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MaxPageNum=2,e.showEquipmentTime=0,e}return r(e,t),e.prototype.init=function(t){this.pageType=t,this.fightNumNode1=cc.find("Page2/Fight/Num",this.node),this.fightNumNode2=cc.find("Page2/MyFight/Num",this.node),this.TipBtn=cc.find("Page2/TipBtn",this.node),this.review(this.pageType)},e.prototype.review=function(t){this.node.active=!0,this.pageType=t;for(var e=1;e<=this.MaxPageNum;e++)(p=cc.find("Page"+e,this.node)).active=t==e;if(1==this.pageType){var a=cc.find("Page1/Level",this.node),n=cc.find("Page1/RewardList",this.node).getComponent(cc.ScrollView);n.content.removeAllChildren();var i=u.default.Instance.combatScene.popLayer.chapterLayer,o=l.default.Instance.dungeonMap.get(i.selectChapterId).get(i.selectDungeonId).get(i.selectDiffculty);a.getComponent(cc.Label).string="Lv."+o.lvlList[0][1];var r=l.default.Instance.dropMap.get(o.drop_id);for(e=0;e<r.dropShow.length;++e){var s=u.default.Instance.sceneNodeManager.getRewardItem(r.dropShow[e][0],0,r.dropShow[e][1],e,!1,!1,!1,!0,!0);n.content.addChild(s.node)}cc.find("Page1/Sy",this.node).active=4==i.selectDiffculty}else if(2==this.pageType){var h=c.default.Instance.playerData;o=l.default.Instance.dungeonMap.get(u.default.Instance.chapterLogic.getMaxChapterInfo(1)[0]).get(u.default.Instance.chapterLogic.getMaxChapterInfo(1)[1]).get(1),this.fightNumNode1.getComponent(cc.Label).string=""+o.fight_capacity,this.fightNumNode2.getComponent(cc.Label).string=""+u.default.Instance.roleLogic.getCombatAtk(h.roleId,1);var p=cc.find("Background/Status",this.TipBtn);1==h.fightTip?p.active=!1:p.active=!0}d.default.Instance.showCustomAd(2)},e.prototype.onClickEvent=function(t,e){if(p.SoundManager.Instance.playEffect("anniu"),0==e)this.node.active=!1,d.default.Instance.hideCustomAd(2);else if(2==e){var a=(new Date).getTime();if((a-this.showEquipmentTime)/1e3>60&&c.default.Instance.playerData.equipmentGridCount-u.default.Instance.roleLogic.getUnEquipmentCount()<5)return this.showEquipmentTime=a,void u.default.Instance.combatScene.popLayer.reviewGamePauseLayer(h.PAGE_NAME.Home,2);var n=u.default.Instance.combatScene.popLayer.chapterLayer;u.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.ChapterStart,n.selectChapterId,n.selectDungeonId,n.selectDiffculty,!1)&&(this.node.active=!1,d.default.Instance.hideCustomAd(2),u.default.Instance.combatScene.popLayer.chapterLayer.node.active=!1)}else 10==e?(1==c.default.Instance.playerData.fightTip?c.default.Instance.playerData.fightTip=0:c.default.Instance.playerData.fightTip=1,c.default.Instance.localStorage(u.default.Instance.combatScene.isGameStart()),this.review(this.pageType)):11==e?(this.node.active=!1,d.default.Instance.hideCustomAd(2),u.default.Instance.combatScene.popLayer.chapterLayer.hideNode(),u.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(h.PAGE_NAME.ChapterStart,c.default.Instance.playerData.roleId)):12==e&&u.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.ChapterStart,u.default.Instance.chapterLogic.getMaxChapterInfo(1)[0],u.default.Instance.chapterLogic.getMaxChapterInfo(1)[1],1,!1)&&(this.node.active=!1,d.default.Instance.hideCustomAd(2))},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],CircleRectIntersect:[function(t,e,a){"use strict";cc._RF.push(e,"67717yXIwlJh5xHGCeWt9Pi","CircleRectIntersect");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.CircleRectIntersect=void 0;var i=function(){function t(){}return t.DistanceBetweenTwoPoints=function(t,e,a,n){return Math.sqrt((a-t)*(a-t)+(n-e)*(n-e))},t.DistanceFromPointToLine=function(t,e,a,n,i,o){var r=o-n,s=a-i,c=i*n-a*o;return Math.abs(r*t+s*e+c)/Math.sqrt(r*r+s*s)},t.IsCircleIntersectRectangle=function(e,a,n,i,o,r,s,c,l){var h=t.DistanceBetweenTwoPoints(i,o,c,l),u=t.DistanceBetweenTwoPoints(i,o,r,s),d=t.DistanceFromPointToLine(e,a,i,o,r,s),p=t.DistanceFromPointToLine(e,a,i,o,c,l);return!(d>h+n||p>u+n||!(d<=h||p<=u||(d-h)*(d-h)+(p-u)*(p-u)<=n*n))},t}();n.CircleRectIntersect=i,cc._RF.pop()},{}],ClimbTowerLayer:[function(t,e,a){"use strict";cc._RF.push(e,"f8f0f9DYdZPE5JOFpzC0NAn","ClimbTowerLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("MainLogic"),y=i("TaskLogic"),m=cc._decorator,g=m.ccclass,I=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.towerItemPrefab=null,e.towerTowerRewardPrefab=null,e.layerRewardItemList=new Array,e.towerItemNodes=new Array,e.taskRewardItemList=new Array,e.sdRewardItemList=new Array,e.shareType=0,e}return r(e,t),e.prototype.init=function(){this.layerRewardListNode=cc.find("Layer/Center/Rewards",this.node),this.towerListNode=cc.find("Layer/Center/Towers/view/content",this.node),this.sdNode=cc.find("Layer/Center/Sd",this.node),this.sdTipNode=cc.find("Layer/Center/Sd/Tip",this.node),this.seasionIdNode=cc.find("Layer/Right/Seasion/Id",this.node),this.seasionTimeNode=cc.find("Layer/Right/Seasion/Time",this.node),this.taskNameNode=cc.find("Layer/Right/Task/Target/Name",this.node),this.taskRewardListNode=cc.find("Layer/Right/Task/Reward/List/view/content",this.node),this.czCountNode=cc.find("Layer/Center/CzCount",this.node),this.seasionRewardNode=cc.find("RewardLayer",this.node),this.seasionRewardNode.active=!1,this.seasionRewardRankNode=cc.find("My/Rank",this.seasionRewardNode),this.seasionRewardList=cc.find("RewardList",this.seasionRewardNode).getComponent(cc.ScrollView),this.seasionIdNode.getComponent(cc.Label).string=l.default.ClimbTowerSeasionId+"",this.seasionTimeNode.getComponent(cc.Label).string=l.default.ClimbTowerTime[0]+"-"+l.default.ClimbTowerTime[1],this.sdLayerNode=cc.find("SdLayer",this.node),this.sdLayerNode.active=!1,this.review(),this.showSeasionRewardLayer()},e.prototype.review=function(){if(this.node.active=!0,0==this.layerRewardItemList.length)for(var t=0;t<5;++t){var e=f.default.Instance.sceneNodeManager.getRewardItem(1001,1,2,t,!1,!1,!1,!1,!1);this.layerRewardItemList.push(e),this.layerRewardListNode.addChild(e.node)}if(0==this.towerItemNodes.length)for(t=0;t<5;++t){var a=cc.instantiate(this.towerItemPrefab);this.towerListNode.addChild(a),this.towerItemNodes.push(a)}var n=d.default.Instance.dungeonMap.get(200),i=p.default.Instance.playerData.towerLayerCount;for(i>l.default.MAX_TOWER_LAYER-4&&(i=l.default.MAX_TOWER_LAYER-4),t=1;t<=5;++t){var o=i+t-1,r=n.get(o).get(0);cc.find("Layer/Center/Layers/Layer"+t+"/Count",this.node).getComponent(cc.Label).string=o+"",cc.find("Layer/Center/Layers/Layer"+t+"/Light",this.node).active=p.default.Instance.playerData.towerLayerCount==o;var s=r.rewardItemList[0],c=this.layerRewardItemList[t-1];c.init([s[2],s[0],s[1]],!1),c.resetData(s[1],0,!1,!1,!1,!1,!1),a=this.towerItemNodes[t-1];var h=cc.find("Lock",a),u=cc.find("Tower1",a),y=cc.find("Tower2",a);h.active=o>p.default.Instance.playerData.maxTowerLayerCount+1,u.active=o%5!=0,y.active=o%5==0}p.default.Instance.playerData.towerLayerCount<p.default.Instance.playerData.maxTowerLayerCount-5?(this.sdNode.active=!0,this.sdTipNode.getComponent(cc.Label).string="\u626b\u8361\u81f3\u7b2c"+(p.default.Instance.playerData.maxTowerLayerCount-5)+"\u5173"):this.sdNode.active=!1,this.czCountNode.getComponent(cc.Label).string="\u5f53\u5929\u5269\u4f59\u91cd\u7f6e"+p.default.Instance.playerData.towerCzCount+"\u6b21",this.setTargetInfo(),this.seasionRewardRankNode.getComponent(cc.Label).string="\u6211\u7684\u6392\u540d\uff1a\u672a\u77e5"},e.prototype.setTargetInfo=function(){for(var t=0;t<this.taskRewardItemList.length;t++){var e=this.taskRewardItemList[t];f.default.Instance.sceneNodeManager.putRewardItem(e)}this.taskRewardItemList.splice(0,this.taskRewardItemList.length);var a=f.default.Instance.taskLogic.getTowerTargetInfo();if(this.taskNameNode.getComponent(cc.Label).string=a.task_content,a){var n=l.default.ClimbTowerSeasionId%4;0==n&&(n=4);var i=a.awardList[n-1],o=d.default.Instance.giftMap.get(i),r=f.default.Instance.giftBagLoigc.getGiftRewardByIndex(o.jsonIndex);for(t=0;t<r.length;++t){var s=r[t][2],c=r[t][0],h=r[t][1];e=f.default.Instance.sceneNodeManager.getRewardItem(c,h,s,t,!1,!1,!1,!1,!1),this.taskRewardItemList.push(e),this.taskRewardListNode.addChild(e.node)}}},e.prototype.showSeasionRewardLayer=function(){for(var t=d.default.Instance.towerRewardMap,e=0;e<t.length;++e){var a=t[e],n=cc.instantiate(this.towerTowerRewardPrefab);this.seasionRewardList.content.addChild(n);var i=cc.find("Name/Rank1",n),o=cc.find("Name/Rank2",n);if(1==a.startLevel)i.active=!0,o.active=!1;else{var r=a.startLevel+"";0==a.endLevel?r+="\u540d+":r=r+"-"+a.endLevel+"\u540d",o.active=!0,i.active=!1,o.getComponent(cc.Label).string=r}for(var s=cc.find("Reward",n),c=0;c<a.itemList.length;++c){var l=a.itemList[c],h=f.default.Instance.sceneNodeManager.getRewardItem(l[1],l[2],l[0],c,!1,!1,!1,!1,!1);s.addChild(h.node)}}},e.prototype.getSdReward=function(){for(var t=p.default.Instance.playerData.maxTowerLayerCount-5,e=new Array,a=p.default.Instance.playerData.towerLayerCount;a<=t;++a){var n=d.default.Instance.dungeonMap.get(200).get(a).get(0).rewardItemList[0];if(0==e.length)e.push([n[0],n[1],n[2]]);else{for(var i=!1,o=0;o<e.length;++o)e[o][0]==n[0]&&e[o][2]==n[2]&&(e[o][1]+=n[1],i=!0);i||e.push([n[0],n[1],n[2]])}}f.default.Instance.chapterLogic.receiveCombatBox(e),p.default.Instance.playerData.towerLayerCount=t+1,this.sdLayerNode.active=!0,cc.find("Title",this.sdLayerNode).getComponent(cc.Label).string="\u626b\u8361\u81f3\u7b2c"+p.default.Instance.playerData.towerLayerCount+"\u5c42";var r=cc.find("List",this.sdLayerNode);for(a=0;a<this.sdRewardItemList.length;++a)this.sdRewardItemList[a].node.active=!1;for(a=0;a<e.length;++a){var s=this.sdRewardItemList[a];null==s&&(s=f.default.Instance.sceneNodeManager.getRewardItem(1001,1,2,a,!1,!1,!1,!1,!1),r.addChild(s.node),this.sdRewardItemList.push(s)),s.init([e[a][2],e[a][0],e[a][1]],!1),s.resetData(e[a][1],0,!1,!1,!1,!1,!1)}},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},e.prototype.onClickBtn=function(t,e){if(u.SoundManager.Instance.playEffect("anniu"),1==e)f.default.Instance.combatScene.gotoHomeLayer(),this.node.active=!1;else if(2==e)f.default.Instance.combatScene.popLayer.reviewTalentLayer();else if(3==e)f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewRankingLayer(1,2,!0);else if(4==e)c.default.Instance.showCustomAd(1),this.seasionRewardNode.active=!0;else if(5==e)f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewShopLayer(2);else if(6==e)1==p.default.Instance.playerData.towerRewardOver?f.default.Instance.combatScene.showMsgInfo("\u5956\u52b1\u5df2\u9886\u53d6\u5b8c"):f.default.Instance.taskLogic.getTowerReward()&&this.review();else if(7==e){if(0==p.default.Instance.playerData.towerCzCount)return void f.default.Instance.combatScene.showMsgInfo("\u91cd\u7f6e\u6b21\u6570\u5df2\u7528\u5b8c");p.default.Instance.playerData.towerLayerCount=1,p.default.Instance.playerData.towerCzCount-=1,this.review()}else if(8==e){if(p.default.Instance.playerData.level<20)return void f.default.Instance.combatScene.showMsgInfo("\u8fbe\u523020\u7ea7\u540e\u624d\u53ef\u6311\u6218");f.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.Home,200,p.default.Instance.playerData.towerLayerCount,0)&&(this.node.active=!1)}else 9==e?c.default.Instance.adHandler(c.default.AD_TYPE_CLIMB_TOWER_SD,this,this.adCallback):10==e?(c.default.Instance.hideCustomAd(1),this.seasionRewardNode.active=!1):11==e&&(this.sdLayerNode.active=!1,c.default.Instance.hideCustomAd(1))},e.prototype.adCallback=function(t,e,a){0==e?(t!=c.default.AD_TYPE_CLIMB_TOWER_SD&&t!=c.default.SHARE_TYPE_CLIMB_TOWER_SD||(this.getSdReward(),this.review(),c.default.Instance.showCustomAd(1)),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||f.default.Instance.taskLogic.finishAllTask(y.default.type_see_ad_count1,0,1)):-1==e?(f.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_CLIMB_TOWER_SD&&(this.shareType=c.default.SHARE_TYPE_CLIMB_TOWER_SD),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):f.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):f.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void f.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,f.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else f.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void f.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,f.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(f.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([I(cc.Prefab)],e.prototype,"towerItemPrefab",void 0),s([I(cc.Prefab)],e.prototype,"towerTowerRewardPrefab",void 0),s([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{}],CombatLayer:[function(t,e,a){"use strict";cc._RF.push(e,"58bdaWT4fpDsJa+f4PA0d7p","CombatLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("GameData"),h=i("ConfigData"),u=i("PublicConst"),d=i("TimeLogSerer"),p=i("MainLogic"),f=i("AdServer"),y=i("MyMathUtils"),m=i("DataUtils"),g=i("SoundManager"),I=i("StringUtils"),_=cc._decorator,v=_.ccclass,S=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameStep=c.GAME_STEP.Init,e.gameResult=c.GAME_RESULT.None,e.starResult=[0,0,0],e.rankingIndex=4,e.gameTime=0,e.loadResList=new Array,e.loadResCount=0,e.guideWalkStatus=-1,e.heroPositionX=0,e.isGuide=!1,e.isGuide2=!0,e.isRevive=!1,e.canGoNextRoom=!1,e.loadSceneStage=!1,e.revivedCount=3,e.showSayTime=1,e.pressAttack=!1,e.popEquipmentGridTip=!1,e.loadMonsterRecord=new Array,e}return r(e,t),e.prototype.init=function(){this.mainLayer=cc.find("MainLayer",this.node).getComponent("MainLayer"),this.uiLayer=cc.find("UiLayer",this.node).getComponent("UiLayer"),this.uiLayer.init(this),this.mainLayer.init(this)},e.prototype.gameInit=function(){this.gameStep=c.GAME_STEP.Init,d.default.Instance.printCommonLog("Game Init"),this.loadResList.splice(0,this.loadResList.length),this.loadResCount=0;var t=l.default.Instance.playerData;if(1==t.currChapter&&1==t.currDungeon&&1==t.currDiffculty||(this.loadResList.indexOf("Effect")<0&&(this.loadResList.push("Effect"),this.loadMonsterRecord.push("Effect")),this.loadResList.indexOf("Bullet")<0&&(this.loadResList.push("Bullet"),this.loadMonsterRecord.push("Bullet"))),this.dungeonInfo=h.default.Instance.dungeonMap.get(t.currChapter).get(t.currDungeon).get(t.currDiffculty),this.dungeonInfo.monsterIdList)for(var e=0;e<this.dungeonInfo.monsterIdList.length;e++){var a=this.dungeonInfo.monsterIdList[e][0],n=h.default.Instance.roleMap.get(a),i="Animation/"+I.default.stringToStringListForRes(n.res_id)[0];this.loadMonsterRecord.indexOf(i)<0&&(this.loadResList.push(i),this.loadMonsterRecord.push(i))}if(this.dungeonInfo.eliteMonsterList)for(e=0;e<this.dungeonInfo.eliteMonsterList.length;e++)a=this.dungeonInfo.eliteMonsterList[e][0],n=h.default.Instance.roleMap.get(a),i="Animation/"+I.default.stringToStringListForRes(n.res_id)[0],this.loadMonsterRecord.indexOf(i)<0&&(this.loadResList.push(i),this.loadMonsterRecord.push(i));if(this.dungeonInfo.boss_id&&(n=h.default.Instance.roleMap.get(this.dungeonInfo.boss_id),i="Animation/"+I.default.stringToStringListForRes(n.res_id)[0],this.loadMonsterRecord.indexOf(i)<0&&(this.loadResList.push(i),this.loadMonsterRecord.push(i))),this.dungeonInfo.chasm_boss_id&&(n=h.default.Instance.roleMap.get(this.dungeonInfo.chasm_boss_id),i="Animation/"+I.default.stringToStringListForRes(n.res_id)[0],this.loadMonsterRecord.indexOf(i)<0&&(this.loadResList.push(i),this.loadMonsterRecord.push(i))),this.loadResList.length>0){var o=this;for(e=0;e<this.loadResList.length;++e)cc.resources.loadDir(this.loadResList[e],function(t){t&&console.log(t),o.loadSpineCallBack()})}else this.initLoadCallback2()},e.prototype.loadSpineCallBack=function(){this.loadResCount+=1,this.loadResCount>=this.loadResList.length&&this.initLoadCallback2()},e.prototype.initLoadCallback2=function(){var t=this;this.scheduleOnce(function(){t.mainLayer.gameInit(),t.uiLayer.gameInit(),p.default.Instance.combatScene.mainCamera.gameInit()})},e.prototype.gameTimeSchedule=function(){this.gameTime++,this.gameStep==c.GAME_STEP.Starting&&(this.showSayTime-=1,this.showSayTime<=0&&(this.showSayTime=y.default.randomInt(5,10),this.showSayEnemy()),this.uiLayer.showGameTime(1))},e.prototype.gameReStart=function(){this.guideWalkStatus=-1,this.isGuide=!1,this.isGuide2=!0,this.revivedCount=3,this.showSayTime=1,this.pressAttack=!1,this.loadSceneStage=!1,this.popEquipmentGridTip=!1,this.isRevive=!1,this.canGoNextRoom=!1,g.SoundManager.Instance.playMusic("battle_bg"),this.starResult[0]=0,this.starResult[1]=0,this.starResult[2]=0,this.rankingIndex=4,this.gameTime=0,p.default.Instance.combatLayer.uiLayer.showSceneChange(),p.default.Instance.combatScene.showCombatLoading(!1),d.default.Instance.printCommonLog("Game ReStart")},e.prototype.gameReStart2=function(){this.schedule(this.gameTimeSchedule,1),p.default.Instance.combatScene.mainCamera.gameStart(),p.default.Instance.equipmentLogic.extraEffect.clear(),this.mainLayer.gameRestart(),0==p.default.Instance.combatScene.adLoadStatus&&(f.default.Instance.load(),u.default.Share_Switch&&f.default.Instance.showShareMenu(),p.default.Instance.combatScene.adLoadStatus=1)},e.prototype.readGo=function(){var t=this;p.default.Instance.combatScene.gameModel==c.GAME_MODEL.Normal&&this.mainLayer.monsterManager.gameStart(),f.default.Instance.hideCustomAd(1),f.default.Instance.hideCustomAd(2),f.default.Instance.showCustomAd(3),u.default.isVivoOrOppo()&&f.default.Instance.showBannerAd(),this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){t.gameStep=c.GAME_STEP.Starting},this)))},e.prototype.goNextRoom=function(t){var e=this;this.destorySyJing(),this.loadSceneStage=!0;var a=this.mainLayer.monsterManager.currRoomNum,n=new Array,i=1;1==t?(n.push(a[0]),n.push(a[1]-1),i=3):2==t?(n.push(a[0]-1),n.push(a[1]),i=4):3==t?(n.push(a[0]),n.push(a[1]+1),i=1):4==t&&(n.push(a[0]+1),n.push(a[1]),i=2);var o=this.dungeonInfo.getRoomInfo(n[0],n[1]),r=this.dungeonInfo.getDoors([o[3],o[4]]),s=this.dungeonInfo.stage;this.mainLayer.nodeManager.changeBgStage(s,r,function(){e.mainLayer.monsterManager.currRoomNum=n,e.mainLayer.updateHeroPos(i),e.mainLayer.clearNode(),e.mainLayer.monsterManager.dispatchMonster(r),e.loadSceneStage=!1},this)},e.prototype.gameOver=function(t){this.isRevive||this.gameStep!=c.GAME_STEP.Over&&(1!=this.dungeonInfo.type&&5!=this.dungeonInfo.type&&null!=p.default.Instance.combatScene.popLayer.revivedLayer&&p.default.Instance.combatScene.popLayer.revivedLayer.node.active&&(p.default.Instance.combatScene.popLayer.revivedLayer.node.active=!1),this.gameStep=c.GAME_STEP.Over,this.gameResult=t,this.unschedule(this.gameTimeSchedule),this.gameTimeResult=this.gameTime,p.default.Instance.combatScene.mainCamera.gameOver(),2==this.dungeonInfo.type?p.default.Instance.moneyLogic.addItemCount(1001,this.uiLayer.totalCoin):3==this.dungeonInfo.type?p.default.Instance.moneyLogic.addItemCount(1005,this.uiLayer.totalCoin):4==this.dungeonInfo.type&&p.default.Instance.moneyLogic.addItemCount(1004,this.uiLayer.totalCoin),f.default.Instance.hideCustomAd(3),t==c.GAME_RESULT.Success?(p.default.Instance.chapterLogic.setDungeonStarNum(this.dungeonInfo.chapter,this.dungeonInfo.dungeon,this.dungeonInfo.difficulty,1),this.mainLayer.gameOver(),this.uiLayer.gameOver(),p.default.Instance.combatScene.popLayer.reviewCombatResultLayer()):(p.default.Instance.chapterLogic.setDungeonStarNum(this.dungeonInfo.chapter,this.dungeonInfo.dungeon,this.dungeonInfo.difficulty,0),p.default.Instance.chapterLogic.passFailChapter(),this.mainLayer.gameOver(),this.uiLayer.gameOver(),p.default.Instance.combatScene.popLayer.reviewCombatResultLayer()),p.default.Instance.roleLogic.updateBuffDataTime(this.gameTimeResult),p.default.Instance.roleLogic.updateTitleDataTime(this.gameTimeResult),l.default.Instance.localStorage2())},e.prototype.quitGame=function(){this.gameStep=c.GAME_STEP.Over,this.unschedule(this.gameTimeSchedule),this.gameTimeResult=this.gameTime,p.default.Instance.combatScene.mainCamera.gameOver(),this.mainLayer.gameOver(),this.uiLayer.gameOver(),p.default.Instance.chapterLogic.passFailChapter(),p.default.Instance.roleLogic.updateBuffDataTime(this.gameTimeResult),p.default.Instance.roleLogic.updateTitleDataTime(this.gameTimeResult),l.default.Instance.localStorage2()},e.prototype.heroDeadEvent=function(t,e,a){void 0===a&&(a=!1),p.default.Instance.combatScene.gameModel==c.GAME_MODEL.Normal?t==c.BATTLE_CAMP.Self?this.gameOver(c.GAME_RESULT.Fail):4==e?this.mainLayer.monsterManager.createSyBoss():a&&this.mainLayer.monsterManager.isLastWave?this.gameOver(c.GAME_RESULT.Success):this.allEnemyDead()&&!this.mainLayer.monsterManager.isCreateSyBoss&&(this.mainLayer.monsterManager.isLastWave?this.gameOver(c.GAME_RESULT.Success):(this.canGoNextRoom=!0,this.mainLayer.currFightMap.hideFance()),this.mainLayer.monsterManager.passCurrRoom()):t==c.BATTLE_CAMP.Self?this.gameOver(c.GAME_RESULT.Fail):this.allEnemyDead()&&this.gameOver(c.GAME_RESULT.Success)},e.prototype.destorySyJing=function(){for(var t=0;t<this.mainLayer.heroSpriteList.length;t++){var e=this.mainLayer.heroSpriteList[t];4==e.monsterType&&e.delete()}},e.prototype.allEnemyDead=function(){for(var t=!1,e=0;e<this.mainLayer.heroSpriteList.length;e++)this.mainLayer.heroSpriteList[e].lifeStatus!=c.LIFE_STATUS.Dead&&(t=!0);return!t},e.prototype.getLifeEnemyCount=function(){for(var t=0,e=0;e<this.mainLayer.heroSpriteList.length;e++)this.mainLayer.heroSpriteList[e].lifeStatus!=c.LIFE_STATUS.Dead&&(t+=1);return t},e.prototype.showSayEnemy=function(){for(var t=new Array,e=0;e<this.mainLayer.heroSpriteList.length;++e){var a=this.mainLayer.heroSpriteList[e];a.lifeStatus!=c.LIFE_STATUS.Dead&&4!=a.monsterType?t.push(1):t.push(0)}var n=m.default.randomIndexListByWeight(t),i=0,o=function(t){var e=r.mainLayer.heroSpriteList[n[t]];if(e.lifeStatus!=c.LIFE_STATUS.Dead&&4!=e.monsterType&&(r.scheduleOnce(function(){e.heroNode.addEffect(c.EFFECT_TYPE.Show_Say,cc.v2(0,e.roleInfo.height+50),2)},.5*i),(i+=1)>=2))return"break"},r=this;for(e=0;e<n.length&&"break"!==o(e);++e);},s([v],e)}(cc.Component));o.default=S,cc._RF.pop()},{}],CombatResultLayer:[function(t,e,a){"use strict";cc._RF.push(e,"f4b15rOMT9CsKnoPEFgcX/Z","CombatResultLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("MainLogic"),l=i("ResultCardItem"),h=i("GuideUtils"),u=i("AdServer"),d=i("SoundManager"),p=i("PublicEnum"),f=i("GameData"),y=i("ConfigData"),m=i("PublicConst"),g=cc._decorator,I=g.ccclass,_=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.commonCard=new Array,e.goldCard=new Array,e.adRewardCount=0,e.rewardCount=0,e.againClose=0,e}return r(e,t),e.prototype.init=function(){this.succNode=cc.find("Layer",this.node);for(var t=cc.find("Layer/CommonCardList",this.node),e=1;e<4;++e)(a=cc.find("Card"+e,t).getComponent(l.default)).init(this),this.commonCard.push(a);for(t=cc.find("Layer/GoldCardList",this.node),e=1;e<4;++e){var a;(a=cc.find("Card"+e,t).getComponent(l.default)).init(this),this.goldCard.push(a)}this.failNode=cc.find("Fail",this.node),this.towerSuccNode=cc.find("TowerSucc",this.node),this.towerRewardNode=cc.find("Rewards",this.towerSuccNode),this.towerFailNode=cc.find("TowerFail",this.node),this.towerRewardScript=c.default.Instance.sceneNodeManager.getRewardItem(1001,1,2,0,!1,!1,!1,!1,!1),this.towerRewardNode.addChild(this.towerRewardScript.node),this.review()},e.prototype.review=function(){var t=this;if(this.node.active=!0,this.dungeonInfo=c.default.Instance.combatLayer.dungeonInfo,this.succNode.active=!1,this.failNode.active=!1,this.towerSuccNode.active=!1,this.towerFailNode.active=!1,c.default.Instance.combatLayer.gameResult==p.GAME_RESULT.Success)if(c.default.Instance.chapterLogic.passSuccessChapter(),5==this.dungeonInfo.type){this.towerSuccNode.active=!0;var e=this.dungeonInfo.rewardItemList[0];this.towerRewardScript.init([e[2],e[0],e[1]],!1),this.towerRewardScript.resetData(e[1],0,!1,!1,!1,!1,!1),c.default.Instance.chapterLogic.receiveCombatBox([e])}else{this.succNode.active=!0,this.adRewardCount=0,this.rewardCount=0,this.againClose=0;for(var a=c.default.Instance.chapterLogic.getCombatResultReward(1),n=0;n<this.commonCard.length;++n)this.commonCard[n].review(0,this.dungeonInfo.gold_reward,a[n]);var i=c.default.Instance.chapterLogic.getCombatResultReward(2);for(n=0;n<this.goldCard.length;++n)this.goldCard[n].review(1,this.dungeonInfo.gold_reward,i[n])}else 5==this.dungeonInfo.type?this.towerFailNode.active=!0:this.failNode.active=!0;this.scheduleOnce(function(){t.guideAction(),u.default.Instance.showCustomAd(1),m.default.Platform!=p.PLAT_FORM.Web&&m.default.Platform!=p.PLAT_FORM.Douyin||c.default.Instance.combatScene.popLayer.reviewGameRecordLayer()},0)},e.prototype.openCard=function(t){if(1==t){for(var e=0;e<this.goldCard.length;++e)this.goldCard[e].isAd=2,this.goldCard[e].adTip.active=!0,this.goldCard[e].coinTip.active=!1;this.adRewardCount+=1}else if(2==t)this.adRewardCount+=1;else{for(e=0;e<this.commonCard.length;++e)this.commonCard[e].isOpne=!0;this.rewardCount+=1}},e.prototype.clickGuid=function(){c.default.Instance.combatScene.popLayer.pointGuideFinish()},e.prototype.onClickEvent=function(t,e){if(d.SoundManager.Instance.playEffect("anniu"),1==e)0==this.rewardCount&&0==this.adRewardCount&&0==this.againClose&&5!=this.dungeonInfo.type?(this.againClose=1,c.default.Instance.combatScene.showMsgInfo("\u8fd8\u6709\u5956\u52b1\u53ef\u4ee5\u9886\u53d6")):(this.node.active=!1,u.default.Instance.hideCustomAd(1),c.default.Instance.combatScene.popLayer.pointGuideFinish(),c.default.Instance.combatScene.gotoHomeLayer());else if(2==e)c.default.Instance.combatScene.popLayer.reviewStrengthLayer(p.PAGE_NAME.CombatResult);else if(3==e)c.default.Instance.combatScene.popLayer.reviewSkillLayer(p.PAGE_NAME.CombatResult,1001);else if(4==e)c.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(p.PAGE_NAME.CombatResult,1001);else if(5==e)this.node.active=!1,u.default.Instance.hideCustomAd(1),c.default.Instance.combatScene.popLayer.pointGuideFinish(),c.default.Instance.combatScene.gotoHomeLayer();else if(6==e){if(c.default.Instance.combatScene.popLayer.pointGuideFinish(),5==this.dungeonInfo.type);else if(1==this.dungeonInfo.type);else if(0==f.default.Instance.playerData.currDiffculty){var a=c.default.Instance.combatLayer.dungeonInfo,n=y.default.Instance.endlessMap.get(a.type);if(f.default.Instance.playerData.endlessChallengeCount[n.type]<=0)return void c.default.Instance.combatScene.showMsgInfo("\u6311\u6218\u6b21\u6570\u5df2\u7528\u5b8c")}var i=f.default.Instance.playerData;c.default.Instance.chapterLogic.quickStartGame(p.PAGE_NAME.ChapterStart,i.currChapter,i.currDungeon,i.currDiffculty,!1)&&(this.node.active=!1,u.default.Instance.hideCustomAd(1))}},e.prototype.guideAction=function(t){var e,a=1,n=1;a=3,n=1,e=this.commonCard[1].node.convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),h.default.Instance.isHaveGuide(a,n,t)?c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)):(a=3,n=2,e=cc.find("Layer/Left/button",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),h.default.Instance.isHaveGuide(a,n,t)&&c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)))},e.prototype.guideCallback=function(){this.node.active&&this.guideAction(!0)},s([I],e)}(cc.Component));o.default=_,cc._RF.pop()},{}],CombatScene:[function(t,e,a){"use strict";cc._RF.push(e,"b3426uDMGZOMbs4rp3QFqU5","CombatScene");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("AssetUtils"),h=i("PublicEnum"),u=i("GuideUtils"),d=i("PublicConst"),p=i("MainLogic"),f=i("TimeLogSerer"),y=i("AdServer"),m=i("TaskLogic"),g=i("SoundManager"),I=cc._decorator,_=I.ccclass,v=(I.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.homeLayer=null,e.loadCombatLayerFinish=!1,e.eventShowFun=null,e.eventShowContext=null,e.isPause=!1,e.homePrefab=null,e.isContinue=!1,e.isFringe=0,e.adLoadStatus=0,e.intoGameTime=0,e}return r(e,t),e.prototype.onLoad=function(){p.default.Instance.combatScene=this,f.default.Instance.printCommonLog("CombatScene onLoad start..."),this.sceneNodeManager=this.getComponent("SceneNodeManager"),p.default.Instance.sceneNodeManager=this.sceneNodeManager,this.isFringe=Math.round(y.default.Instance.hasScreenFringe()/2),console.log("isFringe:"+this.isFringe),u.default.Instance.clearTask(),this.mainCameraNode=cc.find("Main Camera",this.node),this.mainCamera=this.mainCameraNode.getComponent("MainCamera"),this.msgNode=cc.find("MsgNode",this.node),this.msgNode.active=!1,this.msgInfoOldPosition=this.msgNode.getPosition(),this.msgInfoNode=cc.find("MsgNode/Info",this.node),this.msgNode2=cc.find("MsgNode2",this.node),this.msgNode2.active=!1,this.msgInfoNode2=cc.find("MsgNode2/Info",this.node),this.popLayer=cc.find("PopLayer",this.node).getComponent("PopLayer"),this.combatLoadingNode=cc.find("ComatLoading",this.node),this.combatLoadingNode.active=!1,this.RewardEffectNode=cc.find("RewardEffect",this.node),this.sceneInit(),this.LoadPrefabNode=cc.find("LoadPrefab",this.node),this.loadImg=cc.find("LoadPrefab/Img",this.node),this.loadImg.runAction(cc.repeatForever(cc.rotateBy(.5,180))),this.FirstCombatLoadingNode=cc.find("FirstCombatLoading",this.node),this.FirstCombatLoadingNode.active=!1,this.payWaitLayer=cc.find("PayWaitLayer",this.node),this.payWaitLayer.active=!1,this.payLoadImg=cc.find("PayWaitLayer/Img",this.node),this.payLoadImg.runAction(cc.repeatForever(cc.rotateBy(.5,180))),f.default.Instance.printCommonLog("CombatScene onLoad");var t=cc.find("Knife",this.node);this.knifeDiplay=t.getComponent(sp.Skeleton),this.lightNode=cc.find("hongguang_ske",this.node),this.bannerNode=cc.find("Banner",this.node),this.bannerNode.active=!1,this.gridNode=cc.find("Grid",this.node),this.gridNode.active=!1},e.prototype.start=function(){f.default.Instance.printCommonLog("CombatScene Start"),this.isContinue=!0,this.combatLoadingNode.active=!0,console.log(" combat scene start "),this.loadHomePrefab(),this.loadCombatLayerPrefab(),p.default.Instance.tipsLogic.updateAllTips(),this.gameLoginLogic(),c.default.Instance.updateRoleData()},e.prototype.gameLoginLogic=function(){if(p.default.Instance.taskLogic.initAchieveTaskData(),p.default.Instance.taskLogic.initThreadData(),p.default.Instance.shopLogic.checkMyShopData()&&p.default.Instance.shopLogic.initMyShopData(),c.default.Instance.todayFirstLogin?(p.default.Instance.taskLogic.initDayData(),p.default.Instance.shopLogic.initShopData(),p.default.Instance.shopLogic.initMyShopData()):0==c.default.Instance.playerData.shopDataList.length&&p.default.Instance.shopLogic.initShopData(),d.default.PassCheckSwitch)if(d.default.PassCheckSeasonId==c.default.Instance.playerData.currPassCheckSeasonId);else if(d.default.PassCheckSeasonId<c.default.Instance.playerData.currPassCheckSeasonId){d.default.PassCheckSwitch=!1;var t=p.default.Instance.moneyLogic.getItemCount(1015);p.default.Instance.moneyLogic.addItemCount(1015,-t);var e=p.default.Instance.moneyLogic.getItemCount(1016);p.default.Instance.moneyLogic.addItemCount(1016,-e),c.default.Instance.playerData.getIntegralVideoCount=0,c.default.Instance.playerData.getCrystalVideoCount=0,c.default.Instance.playerData.inviteNewPlayerCount=0,c.default.Instance.playerData.passCheckLevel=0}else t=p.default.Instance.moneyLogic.getItemCount(1015),p.default.Instance.moneyLogic.addItemCount(1015,-t),e=p.default.Instance.moneyLogic.getItemCount(1016),p.default.Instance.moneyLogic.addItemCount(1016,-e),c.default.Instance.playerData.getIntegralVideoCount=0,c.default.Instance.playerData.getCrystalVideoCount=0,c.default.Instance.playerData.inviteNewPlayerCount=0,c.default.Instance.playerData.passCheckLevel=0,c.default.Instance.playerData.currPassCheckSeasonId=d.default.PassCheckSeasonId,p.default.Instance.taskLogic.initPassCheckTaskData();if(0!=d.default.FriendsHelpId)if(d.default.FriendsHelpId==c.default.Instance.playerData.friendHelpSeasionId);else if(d.default.FriendsHelpId<c.default.Instance.playerData.friendHelpSeasionId){c.default.Instance.playerData.friendHelpSeasionId=0;for(var a=0;a<20;++a)c.default.Instance.playerData.friendHelpStatus[a]=0}else for(c.default.Instance.playerData.friendHelpSeasionId=d.default.FriendsHelpId,a=0;a<20;++a)c.default.Instance.playerData.friendHelpStatus[a]=0;else for(c.default.Instance.playerData.friendHelpSeasionId=0,a=0;a<20;++a)c.default.Instance.playerData.friendHelpStatus[a]=0;console.log(d.default.ClimbTowerSeasionId+"  seasion id  "+c.default.Instance.playerData.towerSeasionId),0!=d.default.ClimbTowerSeasionId?d.default.ClimbTowerSeasionId==c.default.Instance.playerData.towerSeasionId||(c.default.Instance.playerData.towerSeasionId=d.default.ClimbTowerSeasionId,c.default.Instance.playerData.maxTowerLayerCount=0,c.default.Instance.playerData.tgTowerTime=0,c.default.Instance.playerData.towerLayerCount=1,c.default.Instance.playerData.towerRewardOrder=1,c.default.Instance.playerData.towerRewardOver=0):(c.default.Instance.playerData.towerSeasionId=0,c.default.Instance.playerData.maxTowerLayerCount=0,c.default.Instance.playerData.tgTowerTime=0,c.default.Instance.playerData.towerLayerCount=1,c.default.Instance.playerData.towerRewardOrder=1,c.default.Instance.playerData.towerRewardOver=0),p.default.Instance.taskLogic.finishAllTask(m.default.type_login_count,0,1)},e.prototype.sceneInit=function(){var t=this;cc.game.on(cc.game.EVENT_HIDE,function(){console.log("\u6e38\u620f\u8fdb\u5165\u540e\u53f0:"+(new Date).getTime()),c.default.Instance.isBackground=!0,1==c.default.Instance.playerData.musicStatus&&cc.audioEngine.pauseMusic(),1==c.default.Instance.playerData.soundEffectStatus&&cc.audioEngine.pauseAllEffects()},this),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("\u91cd\u65b0\u8fd4\u56de\u6e38\u620f:"+(new Date).getTime()),c.default.Instance.isBackground=!1,null!=t.eventShowFun&&null!=t.eventShowContext&&(t.eventShowFun.call(t.eventShowContext),t.eventShowFun=null,t.eventShowContext=null),1==c.default.Instance.playerData.musicStatus&&g.SoundManager.Instance.musicStatusAd&&cc.audioEngine.resumeMusic(),1==c.default.Instance.playerData.soundEffectStatus&&cc.audioEngine.resumeAllEffects(),y.default.Instance.adServer.currShowBanner&&y.default.Instance.showBannerAd(99)},this);try{document.addEventListener("visibilitychange",function(){document.hidden?(console.log("document.hidden:"+(new Date).getTime()),1==c.default.Instance.playerData.musicStatus&&cc.audioEngine.pauseMusic(),1==c.default.Instance.playerData.soundEffectStatus&&cc.audioEngine.resumeAllEffects()):(console.log("document.show:"+(new Date).getTime()),1==c.default.Instance.playerData.musicStatus&&g.SoundManager.Instance.musicStatusAd&&cc.audioEngine.resumeMusic(),1==c.default.Instance.playerData.soundEffectStatus&&cc.audioEngine.resumeAllEffects())})}catch(e){console.log("----decument listener")}},e.prototype.loadHomePrefab=function(){null==this.homePrefab?(this.showLoadPrefab(),l.AssetUtils.loadPrefab("Prefab/HomeLayer",this.loadHomePrefabCallback,this)):this.gotoHomeLaye2()},e.prototype.loadHomePrefabCallback=function(t){this.homePrefab=t,this.hideLoadPrefab(),this.isContinue&&this.showHomeLayer()},e.prototype.showHomeLayer=function(){this.hideLoadPrefab();var t=cc.instantiate(this.homePrefab);this.homeLayer=t.getComponent("HomeLayer"),cc.find("HomeNode",this.node).addChild(t),null!=this.combatLayer&&(this.combatLayer.node.active=!1)},e.prototype.loadCombatLayerPrefab=function(){this.showLoadPrefab(),l.AssetUtils.loadPrefab("Prefab/CombatLayer",this.loadCombatLayerPrefabCallback,this)},e.prototype.loadCombatLayerPrefabCallback=function(t){this.loadCombatLayerFinish=!0,f.default.Instance.printCommonLog("loadCombatLayerPrefabCallback");var e=cc.instantiate(t);this.combatLayer=e.getComponent("CombatLayer"),this.combatLayer.init(),p.default.Instance.combatLayer=this.combatLayer,p.default.Instance.mainLayer=this.combatLayer.mainLayer,cc.find("CombatNode",this.node).addChild(e),e.active=!1,this.hideLoadPrefab()},e.prototype.gotoHomeLayer=function(){this.loadHomePrefab()},e.prototype.gotoHomeLaye2=function(){console.log(" go to home layer 2"),this.homeLayer.review(),this.combatLoadingNode.active=!1,null!=this.combatLayer&&(this.combatLayer.node.active=!1)},e.prototype.gotoCombatLayer=function(){f.default.Instance.printCommonLog("CombatLoading gotoCombatLayer"),this.showCombatLoading(!0),this.schedule(this.loadCombatScedule,.1)},e.prototype.loadCombatScedule=function(){this.loadCombatLayerFinish&&(this.combatLayer.node.active=!0,null!=this.homeLayer&&(this.homeLayer.node.active=!1),this.combatLayer.gameInit(),this.unschedule(this.loadCombatScedule))},e.prototype.hideCombatLayer=function(){this.combatLayer.node.active=!1},e.prototype.isGameStart=function(){return!!this.combatLayer&&this.combatLayer.gameStep==h.GAME_STEP.Starting},e.prototype.showCombatLayer=function(){this.combatLayer.node.active=!0},e.prototype.showMsgInfo=function(t,e){null==e&&(e=.7),t!=d.default.ERROR_DATA&&t!=d.default.ERROR_CONFIG?(console.log("str:"+t),this.msgInfoNode.getComponent(cc.RichText).string=t,this.msgNode.active=!0,this.msgNode.opacity=255,this.msgNode.x=this.msgInfoOldPosition.x,this.msgNode.y=this.msgInfoOldPosition.y,this.msgNode.runAction(cc.sequence(cc.delayTime(e),cc.spawn(cc.moveBy(.3,cc.v2(0,100)),cc.fadeOut(.3))))):this.showMsgInfo2(t,e)},e.prototype.showMsgInfo2=function(t,e){null==e&&(e=.7),this.msgNode2.active=!0,this.msgNode2.opacity=255,this.msgNode2.runAction(cc.sequence(cc.delayTime(e+.3),cc.fadeOut(.3)))},e.prototype.showLoadPrefab=function(){this.LoadPrefabNode.active=!0},e.prototype.hideLoadPrefab=function(){this.LoadPrefabNode.active=!1},e.prototype.showPayWaitLayer=function(){this.payWaitLayer.active=!0},e.prototype.hidePayWaitLayer=function(){this.payWaitLayer.active=!1},e.prototype.setEventShowCallback=function(t,e){this.eventShowFun=t,this.eventShowContext=e},e.prototype.showCombatLoading=function(t){this.combatLoadingNode.active=t,t||(this.FirstCombatLoadingNode.active=!1)},e.prototype.onClickEvent=function(t,e){0==e&&(null!=this.homePrefab?this.showHomeLayer():(this.isContinue=!0,this.showLoadPrefab()))},e.prototype.addRewardEffect=function(t,e,a,n){void 0===n&&(n=2);var i=p.default.Instance.sceneNodeManager.getRewardEffectSprite(t,e,a,n);this.RewardEffectNode.addChild(i.node)},s([_],e)}(cc.Component));o.default=v,cc._RF.pop()},{}],ConfigData:[function(t,e,a){"use strict";cc._RF.push(e,"ee6e6SdVR5HBpbWt3OqKB7l","ConfigData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("Dictionary"),r=n("RoleInfo"),s=n("AssetUtils"),c=n("ResourceInfo"),l=n("SkillInfo"),h=n("DungeonInfo"),u=n("RobotInfo"),d=n("ChapterInfo"),p=n("ItemInfo"),f=n("GiftInfo"),y=n("GuideConfig"),m=n("TrapInfo"),g=n("TaskInfo"),I=n("ShopInfo"),_=n("SkillHurtInfo"),v=n("GearInfo"),S=n("StageInfo"),L=n("BuffInfo"),T=n("UnlockSkillInfo"),b=n("RoleGrowInfo"),A=n("EquipmentInfo"),E=n("EquipmentGrowInfo"),C=n("DropInfo"),w=n("ExtroEffectInfo"),P=n("EndlessInfo"),k=n("SkillGrowInfo"),M=n("FestivalInfo"),R=n("TowerRewardInfo"),D=n("TalentInfo"),N=function(){function t(){this.loadFinished=!1,this.configList=new Array,this.configCurrIndex=0,this.forceUsedLocal=!1,this.roleGrowMap=new o.Dictionary,this.roleMap=new o.Dictionary,this.resourceMap=new o.Dictionary,this.skillGrowMap=new o.Dictionary,this.skillMap=new o.Dictionary,this.unlockSkillMap=new o.Dictionary,this.skillHurtMap=new o.Dictionary,this.dungeonMap=new o.Dictionary,this.endlessMap=new o.Dictionary,this.chapterTypeMap=new o.Dictionary,this.chapterMap=new o.Dictionary,this.robotMap=new o.Dictionary,this.itemMap=new o.Dictionary,this.equipmentMap=new o.Dictionary,this.growthEquipmentMap=new o.Dictionary,this.suitEquipmentMap=new o.Dictionary,this.equipmentGrowMap=new o.Dictionary,this.giftMap=new o.Dictionary,this.giftTypeMap=new o.Dictionary,this.guideMap=new o.Dictionary,this.buffItemMap=new o.Dictionary,this.trapMap=new o.Dictionary,this.gearMap=new o.Dictionary,this.dropMap=new o.Dictionary,this.extroEffectMap=new o.Dictionary,this.towerRewardMap=new Array,this.talentSkillMap=new o.Dictionary,this.talentSkillTypeMap=new o.Dictionary,this.taskMap=new o.Dictionary,this.achieveMap=new o.Dictionary,this.dayMap=new Array,this.threadTaskMap=new o.Dictionary,this.passCheckTaskMap=new Array,this.towerTaskMap=new Array,this.shopMap=new o.Dictionary,this.myShopMap=new o.Dictionary,this.stageInfoMap=new o.Dictionary,this.festivalTypeMap=new o.Dictionary}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.initMain=function(){this.initLocalConfig()},t.prototype.configListInit=function(){this.configList.push("buff_info"),this.configList.push("chapter_info"),this.configList.push("drop_info"),this.configList.push("dungeon_info"),this.configList.push("equip_grow_info"),this.configList.push("equipment_info"),this.configList.push("extro_effect"),this.configList.push("festival_info"),this.configList.push("gift_info"),this.configList.push("guide"),this.configList.push("item_info"),this.configList.push("pata_gift"),this.configList.push("pata_reward"),this.configList.push("resource_info"),this.configList.push("robot_info"),this.configList.push("role_grow_info"),this.configList.push("role_info"),this.configList.push("shop_info"),this.configList.push("skill_grow_info"),this.configList.push("skill_info"),this.configList.push("skill_unlock_info"),this.configList.push("skillhurt_info"),this.configList.push("special_play"),this.configList.push("stage_info"),this.configList.push("task_info"),this.configList.push("trap_info")},t.prototype.initLocalConfig=function(){this.configCurrIndex=0,this.configListInit(),this.initConfig()},t.prototype.initConfig=function(){s.AssetUtils.loadConfigJson(this.configList[this.configCurrIndex],this.loadCallback,this)},t.prototype.loadCallback=function(t,e){this.initAll(t,e),this.configCurrIndex++,this.configCurrIndex<this.configList.length?this.initConfig():(this.loadFinished=!0,console.log("----------Load config finish!"))},t.prototype.initAll=function(t,e){"buff_info"==t?this.initBuffItem(e):"chapter_info"==t?this.initChapter(e):"drop_info"==t?this.initDropInfo(e):"dungeon_info"==t?this.initDungeon(e):"equip_grow_info"==t?this.initEquipmentGrow(e):"equipment_info"==t?this.initEquipment(e):"extro_effect"==t?this.initExtroEffect(e):"festival_info"==t?this.initFestivalConfig(e):"gift_info"==t?(this.giftInfoJson=JSON.stringify(e),this.initGift(e)):"guide"==t?this.initGuideConfig(e):"item_info"==t?this.initItem(e):"pata_gift"==t?this.initTalent(e):"pata_reward"==t?this.initPataReward(e):"resource_info"==t?this.initResource(e):"robot_info"==t?this.initRobot(e):"role_grow_info"==t?this.initRoleGrowInfo(e):"role_info"==t?this.initRole(e):"shop_info"==t?this.initShopInfo(e):"skill_grow_info"==t?this.initSkillGrowInfo(e):"skill_info"==t?this.initSkill(e):"skill_unlock_info"==t?this.initUnlockSkill(e):"skillhurt_info"==t?this.initSkillHurt(e):"special_play"==t?this.initGearInfo(e):"stage_info"==t?this.initStageInfo(e):"task_info"==t?this.initTaskInfo(e):"trap_info"==t&&this.initTrapInfo(e)},t.prototype.initRoleGrowInfo=function(t){this.roleGrowMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new b.default(e[a]),i=this.roleGrowMap.get(n.role_id);null==i&&(i=new o.Dictionary,this.roleGrowMap.put(n.role_id,i)),i.put(n.lvl,n)}},t.prototype.initRole=function(t){this.roleMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new r.default(e[a]);this.roleMap.put(n.id,n)}},t.prototype.initSkillGrowInfo=function(t){this.skillGrowMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new k.default(e[a]);this.skillGrowMap.put(n.lv,n)}},t.prototype.initSkill=function(t){this.skillMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new l.default(e[a]);this.skillMap.put(n.id,n)}},t.prototype.initUnlockSkill=function(t){this.unlockSkillMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new T.default(e[a]);this.unlockSkillMap.put(n.skill_id,n)}},t.prototype.initSkillHurt=function(t){this.skillHurtMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new _.default(e[a]),i=this.skillHurtMap.get(n.id);null==i&&(i=new o.Dictionary,this.skillHurtMap.put(n.id,i)),i.put(n.num,n)}},t.prototype.initDungeon=function(t){var e=t;this.dungeonMap.clear(),this.chapterTypeMap.clear(),this.endlessMap.clear();for(var a=0;a<e.length;a++){var n=new h.default(e[a]),i=this.dungeonMap.get(n.chapter);if(null==i&&(i=new o.Dictionary,this.dungeonMap.put(n.chapter,i),this.chapterTypeMap.put(n.chapter,n.type)),1==n.type);else if(5==n.type);else{var r=this.endlessMap.get(n.type);null==r&&(r=new P.default(n.type,n.chapter,n.openTime),this.endlessMap.put(n.type,r)),r.openLevel.push([n.dungeon,n.open_condition])}var s=i.get(n.dungeon);null==s&&(s=new o.Dictionary,i.put(n.dungeon,s)),s.put(n.difficulty,n)}},t.prototype.initResource=function(t){this.resourceMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new c.default(e[a]);this.resourceMap.put(n.effect_name,n)}},t.prototype.initRobot=function(t){this.robotMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new u.default(e[a]);this.robotMap.put(n.id,n)}},t.prototype.initChapter=function(t){this.chapterMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new d.default(e[a]);this.chapterMap.put(n.chapter_id,n)}},t.prototype.initItem=function(t){this.itemMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new p.default(e[a]);this.itemMap.put(n.id,n)}},t.prototype.initTalent=function(t){this.talentSkillTypeMap.clear(),this.talentSkillMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new D.default(e[a]),i=this.talentSkillTypeMap.get(n.type);null==i&&(i=new o.Dictionary,this.talentSkillTypeMap.put(n.type,i)),i.put(n.skill_number,n),this.talentSkillMap.put(n.id,n)}},t.prototype.initPataReward=function(t){this.towerRewardMap=new Array;for(var e=t,a=0;a<e.length;a++){var n=new R.default(e[a]);this.towerRewardMap.push(n)}},t.prototype.initEquipment=function(t){this.equipmentMap.clear(),this.growthEquipmentMap.clear(),this.suitEquipmentMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new A.default(e[a]);this.equipmentMap.put(n.id,n),3==n.type&&this.growthEquipmentMap.put(n.tip,n),2==n.type&&this.suitEquipmentMap.put(n.id,n)}},t.prototype.initEquipmentGrow=function(t){this.equipmentGrowMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new E.default(e[a]);this.equipmentGrowMap.put(n.grow_lvl,n)}},t.prototype.initExtroEffect=function(t){this.extroEffectMap.clear();for(var e=t,a=0;a<e.length;++a){var n=new w.default(e[a]);this.extroEffectMap.put(n.id,n)}},t.prototype.initFestivalConfig=function(t){this.festivalTypeMap.clear();for(var e=t,a=0;a<e.length;++a){var n=new M.default(e[a]);this.festivalTypeMap.put(n.festival_type,n)}},t.prototype.initGift=function(t){this.giftMap.clear(),this.giftTypeMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new f.default(e[a],a);this.giftMap.put(n.id,n);var i=this.giftTypeMap.get(n.type);null==i&&(i=new Array,this.giftTypeMap.put(n.type,i)),i.push(n)}},t.prototype.initGuideConfig=function(t){this.guideMap.clear();for(var e=t,a=0;a<e.length;a++){var n=e[a],i=new y.default(n),r=this.guideMap.get(i.task_id);null==r&&(r=new o.Dictionary,this.guideMap.put(i.task_id,r));var s=r.get(i.task_step);null==s&&(s=new Array,r.put(i.task_step,s)),s.push(i)}},t.prototype.initBuffItem=function(t){this.buffItemMap.clear();for(var e=t,a=0;a<e.length;a++){var n=e[a],i=new L.default(n);this.buffItemMap.put(i.id,i)}},t.prototype.initTrapInfo=function(t){this.taskMap.clear();for(var e=t,a=0;a<e.length;a++){var n=e[a],i=new m.default(n);this.trapMap.put(i.id,i)}},t.prototype.initTaskInfo=function(t){this.taskMap.clear(),this.threadTaskMap.clear(),this.achieveMap.clear(),this.dayMap=new Array,this.passCheckTaskMap=new Array,this.towerTaskMap=new Array;for(var e=t,a=0;a<e.length;a++){var n=e[a],i=new g.default(n);if(this.taskMap.put(i.id,i),1==i.small_type)this.threadTaskMap.put(i.order,i);else if(3==i.small_type){var r=this.achieveMap.get(i.type);null==r&&(r=new o.Dictionary,this.achieveMap.put(i.type,r)),r.put(i.order,i)}else 2==i.small_type?this.dayMap.push(i):4==i.small_type?this.passCheckTaskMap.push(i):5==i.small_type&&this.towerTaskMap.push(i)}},t.prototype.initShopInfo=function(t){this.shopMap.clear();for(var e=t,a=0;a<e.length;a++){var n=e[a],i=new I.default(n);if(1==i.shop_type)null==(r=this.shopMap.get(i.type))&&(r=new o.Dictionary,this.shopMap.put(i.type,r)),null==(s=r.get(i.order))&&(s=new Array,r.put(i.order,s)),s.push(i);else if(2==i.shop_type){var r,s;null==(r=this.myShopMap.get(i.type))&&(r=new o.Dictionary,this.myShopMap.put(i.type,r)),null==(s=r.get(i.order))&&(s=new Array,r.put(i.order,s)),s.push(i)}}},t.prototype.initGearInfo=function(t){this.gearMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new v.default(e[a]);this.gearMap.put(n.id,n)}},t.prototype.initStageInfo=function(t){this.stageInfoMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new S.default(e[a]);this.stageInfoMap.put(n.id,n)}},t.prototype.initDropInfo=function(t){this.dropMap.clear();for(var e=t,a=0;a<e.length;a++){var n=new C.default(e[a]);this.dropMap.put(n.id,n)}},t}();i.default=N,cc._RF.pop()},{}],DailyTaskData:[function(t,e,a){"use strict";cc._RF.push(e,"0a850FrdhdC4bZM5LEji717","DailyTaskData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.num=0,this.status=0,this.type=t},cc._RF.pop()},{}],DataUtils:[function(t,e,a){"use strict";cc._RF.push(e,"549a1SNY4BMArYNcdjeq0pQ","DataUtils");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("MyMathUtils"),r=function(){function t(){}return t.randomIndexByWeight=function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];var n=Math.random(),i=0,o=0;for(a=0;a<t.length;a++){if(o=i+t[a]/e*1,n>=i&&n<o)return a;i=o}return-1},t.randomIndexByWeight2=function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a][1];var n=Math.random(),i=0,o=0;for(a=0;a<t.length;a++){if(o=i+t[a][1]/e*1,n>=i&&n<o)return a;i=o}return-1},t.randomIndexListByWeight=function(t){for(var e=0,a=new Array,n=0;n<t.length;n++)e+=t[n],a.push([n,0]);for(n=0;n<a.length;++n){var i=o.default.random(0,e-1);a[n][1]=t[n]+i}a.sort(function(t,e){return e[1]-t[1]});var r=new Array;for(n=0;n<a.length;++n)r.push(a[n][0]);return r},t.sortListByIndex=function(t){for(var e=new Array,a=1;a<=t;a++)e.push(a);return e.sort(function(){return Math.random()>.5?1:-1})},t}();i.default=r,cc._RF.pop()},{}],DateUtils:[function(t,e,a){"use strict";cc._RF.push(e,"f7ca5AHwz1IU6qnUdjX3nry","DateUtils");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.getDayInYear=function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},t.getDayInYear2=function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return e+"."+(a>9?a:"0"+a)+"."+(n>9?n:"0"+n)},t.getDayInYearByTimeStamp=function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},t.getDayInYearByNum=function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},t.getDayInYearByNum2=function(t){var e=new Date(t),a=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return a+"."+(n>9?n:"0"+n)+"."+(i>9?i:"0"+i)},t.getTomorrowTimeDiff=function(){var t=new Date;return 3600*(23-t.getHours())+60*(59-t.getMinutes())+(59-t.getSeconds())},t.getTimeZero=function(t){var e=new Date(t);return t-1e3*(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())},t.getWeekData=function(){var t=(new Date).getDay();return new Array(7,1,2,3,4,5,6)[t]},t}();n.default=i,cc._RF.pop()},{}],DiamWelfareLayer:[function(t,e,a){"use strict";cc._RF.push(e,"03d57/FhTpDW65H2pIy2Ksw","DiamWelfareLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("MainLogic"),y=i("TaskLogic"),m=cc._decorator,g=m.ccclass,I=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardJsonIndex1=0,e.rewardJsonIndex2=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(){this.rewardList1=cc.find("Layer/reward1",this.node),this.rewardList2=cc.find("Layer/reward2",this.node),this.videoNum=cc.find("Layer/Btn2/Num",this.node),this.statusNode1=cc.find("Layer/Status1",this.node),this.statusNode2=cc.find("Layer/Status2",this.node);var t=d.default.Instance.giftTypeMap.get(14)[0];this.rewardJsonIndex1=t.jsonIndex;for(var e=0;e<t.itemList.length;++e){var a=t.itemList[e][0],n=t.itemList[e][1],i=t.itemList[e][2];if(1001==n){var o=f.default.Instance.chapterLogic.getMaxChapterInfo(1);i*=d.default.Instance.dungeonMap.get(o[0]).get(o[1]).get(1).gold_reward}else 1004==n&&(o=f.default.Instance.chapterLogic.getMaxChapterInfo(1),i*=d.default.Instance.dungeonMap.get(o[0]).get(o[1]).get(1).crystal_reward);var r=f.default.Instance.sceneNodeManager.getRewardItem(n,i,a,e,!1,!0,!1,!1,!1);this.rewardList1.addChild(r.node)}for(t=d.default.Instance.giftTypeMap.get(15)[0],this.rewardJsonIndex2=t.jsonIndex,e=0;e<t.itemList.length;++e)a=t.itemList[e][0],n=t.itemList[e][1],i=t.itemList[e][2],1001==n?(o=f.default.Instance.chapterLogic.getMaxChapterInfo(1),i*=d.default.Instance.dungeonMap.get(o[0]).get(o[1]).get(1).gold_reward):1004==n&&(o=f.default.Instance.chapterLogic.getMaxChapterInfo(1),i*=d.default.Instance.dungeonMap.get(o[0]).get(o[1]).get(1).crystal_reward),r=f.default.Instance.sceneNodeManager.getRewardItem(n,i,a,e,!1,!0,!1,!1,!1),this.rewardList2.addChild(r.node);this.review()},e.prototype.review=function(){this.node.active=!0,this.statusNode1.active=p.default.Instance.playerData.diamRewardStatus[0]>0,this.statusNode2.active=p.default.Instance.playerData.diamRewardStatus[1]>0,this.setVideoNum(),c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2)},e.prototype.setVideoNum=function(){this.videoNum.getComponent(cc.Label).string="("+p.default.Instance.playerData.diamWelfareVideoCount+"/2)"},e.prototype.onClickBtn=function(t,e){u.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2)):2==e?c.default.Instance.adHandler(c.default.AD_TYPE_DIAM_WELFARE1,this,this.adCallback):3==e&&c.default.Instance.adHandler(c.default.AD_TYPE_DIAM_WELFARE2,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){if(0==e)if(0!=p.default.Instance.playerData.cdActiveFreeAd&&a||f.default.Instance.taskLogic.finishAllTask(y.default.type_see_ad_count1,0,1),t==c.default.AD_TYPE_DIAM_WELFARE1||t==c.default.SHARE_TYPE_DIAM_WELFARE1){var n=f.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.rewardJsonIndex1);f.default.Instance.giftBagLoigc.receiveGiftItems(n,1),p.default.Instance.playerData.diamRewardStatus[0]+=1,this.statusNode1.active=!0,f.default.Instance.combatScene.homeLayer.showTips()}else t!=c.default.AD_TYPE_DIAM_WELFARE2&&t!=c.default.SHARE_TYPE_DIAM_WELFARE2||(p.default.Instance.playerData.diamWelfareVideoCount+=1,p.default.Instance.playerData.diamWelfareVideoCount>=2?(p.default.Instance.playerData.diamWelfareVideoCount-=2,p.default.Instance.playerData.diamRewardStatus[1]+=1,n=f.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.rewardJsonIndex2),f.default.Instance.giftBagLoigc.receiveGiftItems(n,1),this.statusNode2.active=!0,f.default.Instance.combatScene.homeLayer.showTips()):f.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,1e4,2]],1),this.setVideoNum());else-1==e?(f.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_DIAM_WELFARE1?this.shareType=c.default.SHARE_TYPE_DIAM_WELFARE1:t==c.default.AD_TYPE_DIAM_WELFARE2&&(this.shareType=c.default.SHARE_TYPE_DIAM_WELFARE2),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):f.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):f.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void f.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,f.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else f.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void f.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,f.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(f.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([g],e)}(cc.Component));o.default=I,cc._RF.pop()},{}],Dictionary:[function(t,e,a){"use strict";cc._RF.push(e,"90c40Qcv2xEXq6nHTLsgUR3","Dictionary");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.Dictionary=void 0;var i=function(){function t(){this.map={}}return t.prototype.clear=function(){for(var t=this.getKeys(),e=0;e<t.length;e++)delete this.map[t[e]]},t.prototype.containsKey=function(t){return this.map.propertyIsEnumerable(t)},t.prototype.put=function(t,e){this.map[t]=e},t.prototype.get=function(t){return this.map[t]},t.prototype.remove=function(t){delete this.map[t]},t.prototype.getKeys=function(){return Object.keys(this.map)},t.prototype.getValues=function(){for(var t=new Array,e=this.getKeys(),a=0;a<e.length;a++)t.push(this.map[e[a]]);return t},t.prototype.size=function(){return this.getKeys().length},t}();n.Dictionary=i,cc._RF.pop()},{}],DouyinAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"de828v1HLdA6YGqvmH7fICO","DouyinAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardUnitId="2cg332l82ff08376c8",e.interUnitId="7995l85ji9a529cid8",e.bannerIndex=1,e.bannerUnitId="393ih9gaedl41jt6bd",e.bannerUnitId2="k9ac5o21b0d2hv1vlp",e.interTime=0,e}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.login=function(){},e.prototype.showInterAd=function(){},e.prototype.loadRewardAd=function(){},e.prototype.createBannerAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.showCustomAd=function(){},e.prototype.hideCustomAd=function(){},e.prototype.shareAppCallBack=function(){},e.prototype.shareApp=function(){},e.prototype.shareImg=function(){},e.prototype.adHandler=function(){},e}(i("BaseAdServer").default);o.default=s,cc._RF.pop()},{}],DropInfo:[function(t,e,a){"use strict";cc._RF.push(e,"f047eeRoftNCoMR5Uz3ET70","DropInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.monster_drop_num=t.monster_drop_num,this.monsterDropNum=o.default.config_stringToIntListOfList(this.monster_drop_num,"_"),this.monster_drop=t.monster_drop,this.monsterDrop=o.default.config_stringToIntListOfList(this.monster_drop,"_");var e=0;if(this.monsterDropNum)for(var a=0;a<this.monsterDropNum.length;++a){var n=this.monsterDropNum[a][1]/100;this.monsterDropNum[a][1]=e+n,e=this.monsterDropNum[a][1]}if(this.monster_exp=o.default.stringToInt(t.monster_exp),this.elite_drop_num=t.elite_drop_num,this.eliteDropNum=o.default.config_stringToIntListOfList(this.elite_drop_num,"_"),this.elite_drop=t.elite_drop,this.eliteDrop=o.default.config_stringToIntListOfList(this.elite_drop,"_"),e=0,this.eliteDropNum)for(a=0;a<this.eliteDropNum.length;++a)n=this.eliteDropNum[a][1]/100,this.eliteDropNum[a][1]=e+n,e=this.eliteDropNum[a][1];if(this.elite_exp=o.default.stringToInt(t.elite_exp),this.boss_drop_num=t.boss_drop_num,this.boosDropNum=o.default.config_stringToIntListOfList(this.boss_drop_num,"_"),this.boss_drop=t.boss_drop,this.bossDrop=o.default.config_stringToIntListOfList(this.boss_drop,"_"),e=0,this.boosDropNum)for(a=0;a<this.boosDropNum.length;++a)n=this.boosDropNum[a][1]/100,this.boosDropNum[a][1]=e+n,e=this.boosDropNum[a][1];if(this.boss_exp=o.default.stringToInt(t.boss_exp),this.chasm_boss_drop_num=t.chasm_boss_drop_num,this.chasmBoosDropNum=o.default.config_stringToIntListOfList(this.chasm_boss_drop_num,"_"),this.chasm_boss_drop=t.chasm_boss_drop,this.chasmBossDrop=o.default.config_stringToIntListOfList(this.chasm_boss_drop,"_"),e=0,this.chasmBoosDropNum)for(a=0;a<this.chasmBoosDropNum.length;++a)n=this.chasmBoosDropNum[a][1]/100,this.chasmBoosDropNum[a][1]=e+n,e=this.chasmBoosDropNum[a][1];this.chasm_boss_exp=o.default.stringToInt(t.chasm_boss_exp),this.drop_show=t.drop_show,this.dropShow=o.default.config_stringToIntListOfList(this.drop_show,"_")},cc._RF.pop()},{}],DropItemSprite:[function(t,e,a){"use strict";cc._RF.push(e,"3a1753Yz+9E/IwNsYCbBCGa","DropItemSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("MainLogic"),h=i("AssetUtils"),u=i("ConfigData"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showWordTime=0,e}return r(e,t),e.prototype.init=function(t,e){this.dropItemId=t,this.dropItemType=e,this.itemNode=cc.find("Item",this.node),this.itemImg=cc.find("Item/Img",this.node),this.itemNum=cc.find("Item/Count",this.node),this.nameNode=cc.find("Item/Name",this.node),this.itemName=cc.find("Item/Name/Name",this.node),this.effectNode=cc.find("Item/Effect",this.node),this.effectNode.active=!1,1==this.dropItemType?(this.itemInfo=u.default.Instance.equipmentMap.get(t),this.itemImg.anchorY=.5,this.itemName.getComponent(cc.Label).string=this.itemInfo.name):(this.itemInfo=u.default.Instance.itemMap.get(t),this.itemImg.anchorY=.5),this.itemName.color=c.Quality_COLOR[this.itemInfo.quality],h.AssetUtils.loadSpriteFrame(this.itemImg,"Common/"+this.itemInfo.icon),this.effectNode.active=4==this.itemInfo.quality},e.prototype.resetData=function(t,e,a){var n=this;this.node.x=t.x,this.node.y=t.y,this.dropItemCount=a,1!=this.dropItemType&&(this.itemName.getComponent(cc.Label).string=this.itemInfo.name+"x"+a),this.node.scale=.3,this.node.runAction(cc.sequence(cc.spawn(cc.jumpTo(1,e.x,e.y,200,1),cc.scaleTo(1,1)),cc.callFunc(function(){n.schedule(n.isOpenSchedule,.1)},this)))},e.prototype.isOpenSchedule=function(){var t=l.default.Instance.mainLayer.myHeroSprite;if(null!=t&&t.lifeStatus!=c.LIFE_STATUS.Dead){var e=t.heroNode.getBodyCenter(),a=this.node.getPosition(),n=Math.abs(a.x-e.x),i=Math.abs(a.y-e.y);if(n<100&&i<150)if(1==this.dropItemType){if(l.default.Instance.equipmentLogic.addEquipmentData(this.dropItemId))l.default.Instance.combatLayer.uiLayer.addRewardTip(this.dropItemId,this.dropItemType,this.dropItemCount),this.delete();else if(console.log(" \u683c\u5b50\u5df2\u6ee1 "),this.showWordTime<=0)if(this.showWordTime=5,l.default.Instance.combatLayer.popEquipmentGridTip){var o=l.default.Instance.mainLayer.myHeroSprite;o&&o.heroNode.addEffect(c.EFFECT_TYPE.Show_Word,cc.v2(0,o.roleInfo.height+50),1,0,"\u80cc\u5305\u5df2\u6ee1")}else l.default.Instance.combatLayer.popEquipmentGridTip=!0,l.default.Instance.combatScene.popLayer.reviewGamePauseLayer(c.PAGE_NAME.Combat,3)}else{var r=u.default.Instance.itemMap.get(this.dropItemId);l.default.Instance.equipmentLogic.receiveItem(r,this.dropItemCount),l.default.Instance.combatLayer.uiLayer.addRewardTip(this.dropItemId,this.dropItemType,this.dropItemCount),this.delete()}this.showWordTime>0&&(this.showWordTime-=.1)}},e.prototype.delete=function(t){if(void 0===t&&(t=!1),l.default.Instance.combatLayer.mainLayer.monsterManager.isLastWave)if(1==this.dropItemType){if(t)l.default.Instance.chapterLogic.receiveEquipment(this.itemInfo,this.dropItemCount,0);else if(!l.default.Instance.equipmentLogic.addEquipmentData(this.dropItemId)){console.log(" \u683c\u5b50\u5df2\u6ee1 ");var e=l.default.Instance.mainLayer.myHeroSprite;e&&e.heroNode.addEffect(c.EFFECT_TYPE.Show_Word,cc.v2(0,e.roleInfo.height+50),1,0,"\u80cc\u5305\u5df2\u6ee1")}}else t?l.default.Instance.chapterLogic.receiveItem(this.itemInfo,this.dropItemCount,0):l.default.Instance.equipmentLogic.receiveItem(this.itemInfo,this.dropItemCount);this.node.stopAllActions(),this.unscheduleAllCallbacks(),l.default.Instance.mainLayer.nodeManager.putDropItemSprite(this,this.dropItemType)},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this)},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this)},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],DungeonInfo:[function(t,e,a){"use strict";cc._RF.push(e,"99f6eBU97tJlJxlwOZ6dYzS","DungeonInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils"),r=function(){function t(t){this.firstStagePos=new Array,this.firstStageDoors=new Array,this.id=parseInt(t.id),this.type=o.default.stringToInt(t.type),this.dungeon=parseInt(t.dungeon),this.chapter=parseInt(t.chapter),this.name=t.name,this.difficulty=o.default.stringToInt(t.difficulty),this.mode=o.default.stringToInt(t.mode),this.open_time=t.open_time,this.openTime=o.default.config_stringToIntList(this.open_time),this.open_condition=o.default.stringToInt(t.open_condition),this.stage_position=t.stage_position,this.stagePosList=o.default.config_stringToIntListOfList(this.stage_position),this.stage_type=t.stage_type,this.stageTypeList=o.default.config_stringToIntListOfList(this.stage_type),this.monster_id=t.monster_id,this.boss_id=o.default.stringToInt(t.boss_id),this.chasm_boss_id=o.default.stringToInt(t.chasm_boss_id),this.elite_monster_id=t.elite_monster_id,this.lvl=t.lvl,this.lvlList=o.default.config_stringToIntListOfList(this.lvl),this.atk_coefficient=o.default.stringToFloat(t.atk_coefficient),this.hp_coefficient=o.default.stringToFloat(t.hp_coefficient),this.def_coefficient=o.default.stringToFloat(t.def_coefficient),this.hit_coefficient=o.default.stringToFloat(t.hit_coefficient),this.dodge_coeffcient=o.default.stringToFloat(t.dodge_coeffcient),this.atk_speed_coefficient=o.default.stringToFloat(t.atk_speed_coefficient),this.reward=t.reward,this.rewardItemList=o.default.config_stringToIntListOfList(this.reward),this.ad_reward=t.ad_reward,this.adRewardItemList=o.default.config_stringToIntListOfList(this.ad_reward),this.drop_id=o.default.stringToInt(t.drop_id),this.gold_reward=o.default.stringToInt(t.gold_reward),this.crystal_reward=o.default.stringToInt(t.crystal_reward),this.is_ad=o.default.stringToInt(t.is_ad),this.star_type1=o.default.stringToInt(t.star_type1),this.star_type2=o.default.stringToInt(t.star_type2),this.star_type3=o.default.stringToInt(t.star_type3),this.star_key1=o.default.stringToFloat(t.star_key1),this.star_key2=o.default.stringToFloat(t.star_key2),this.star_key3=o.default.stringToFloat(t.star_key3),this.hp_unit=o.default.stringToInt(t.hp_unit),this.fight_capacity=o.default.stringToFloat(t.fight_capacity),this.stage=t.stage,this.small_bg=t.small_bg,this.initWaveAmountList(),this.getFirstRoomPos(),this.firstStageDoors=this.getDoors(this.firstStagePos)}return t.prototype.initWaveAmountList=function(){if(this.eliteMonsterList=o.default.config_stringToIntListOfList(this.elite_monster_id),this.eliteMonsterList){for(var t=0,e=0;e<this.eliteMonsterList.length;e++)t+=(n=this.eliteMonsterList[e])[1];var a=0;for(e=0;e<this.eliteMonsterList.length;e++)(n=this.eliteMonsterList[e]).push(a),a+=1*n[1]/t,n.push(a)}if(this.monsterIdList=o.default.config_stringToIntListOfList(this.monster_id),this.monsterIdList){for(t=0,e=0;e<this.monsterIdList.length;e++)t+=(n=this.monsterIdList[e])[1];for(a=0,e=0;e<this.monsterIdList.length;e++){var n;(n=this.monsterIdList[e]).push(a),a+=1*n[1]/t,n.push(a)}}},t.prototype.getFirstRoomPos=function(){for(var t=0;t<this.stagePosList.length;++t){var e=this.stagePosList[t];1!=e[2]&&1!=this.stagePosList.length||(this.firstStagePos.push(e[3]),this.firstStagePos.push(e[4]))}},t.prototype.getDoors=function(t){for(var e=[[0,-1],[-1,0],[0,1],[1,0]],a=new Array,n=0;n<4;++n){var i=[t[0]+e[n][0],t[1]+e[n][1]];this.getRoomInfo(i[0],i[1]).length>0&&a.push(n+1)}return a},t.prototype.getRoomInfo=function(t,e){for(var a=0;a<this.stagePosList.length;++a){var n=this.stagePosList[a];if(n[3]==t&&n[4]==e)return n}return[]},t.prototype.getRoomCount=function(){return this.stagePosList.length},t.prototype.getRoomIndex=function(t,e){for(var a=0;a<this.stagePosList.length;++a){var n=this.stagePosList[a];if(n[3]==t&&n[4]==e)return a}return-1},t}();i.default=r,cc._RF.pop()},{}],EffectSprite:[function(t,e,a){"use strict";cc._RF.push(e,"49fe7wHmnVIhJ5IlUEveiD+","EffectSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("AssetUtils"),h=i("PublicConst"),u=i("MainLogic"),d=i("MyMathUtils"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){var e=this;this.effectType=t,this.num1Node=cc.find("Num1",this.node),this.num1Node.scale=.35,this.num1Node.active=!1,this.num2Node=cc.find("Num2",this.node),this.num2Node.active=!1,this.num2Node.scale=.35,this.num3Node=cc.find("Num3",this.node),this.num3Node.active=!1,this.num3Node.scale=.35,this.num4Node=cc.find("Num4",this.node),this.num4Node.active=!1,this.num4Node.scale=.35,this.armatureNode=cc.find("Armature",this.node),this.armatureNode.active=!1,this.particleNode=cc.find("Particle",this.node),this.particleNode.active=!1,this.imgNode=cc.find("Img",this.node),this.imgNode.active=!1,this.sayNode=cc.find("Say",this.node),this.sayNode.active=!1,this.tipNode=cc.find("Tip",this.node),this.tipNode.active=!1,this.upgradeNode=cc.find("Upgrade",this.node),this.upgradeNode.active=!1,this.display=this.armatureNode.getComponent(sp.Skeleton);var a="";switch(t){case c.EFFECT_TYPE.Show_Attack_Num:this.num1Node.active=!0;break;case c.EFFECT_TYPE.Show_Crit_Num:this.num2Node.active=!0;break;case c.EFFECT_TYPE.Show_Add_Hp:this.num3Node.active=!0;break;case c.EFFECT_TYPE.Show_ReBlood:this.num4Node.active=!0;break;case c.EFFECT_TYPE.Effect_hit:case c.EFFECT_TYPE.Effect_hit2:this.armatureNode.active=!0,a="effect04_hit00",this.node.scale=2.5;break;case c.EFFECT_TYPE.Effect_dead:this.armatureNode.active=!0,this.node.scale=1,a="die";break;case c.EFFECT_TYPE.Efffect_forzen:this.armatureNode.active=!0,this.node.scale=1.4,a="pets01_bingdong";break;case c.EFFECT_TYPE.Effect_wudi:this.armatureNode.active=!0,this.node.scale=3,a="EFFbuffs";break;case c.EFFECT_TYPE.Effect_particle:this.node.scale=1.5,this.particleNode.active=!0,a="particle_attackmo1";break;case c.EFFECT_TYPE.Effect_Jisha:this.armatureNode.active=!0,this.node.scale=1,a="effect002_jisha";break;case c.EFFECT_TYPE.Effect_Stoic:this.armatureNode.active=!0,this.node.scale=1,a="effect001_hudun";break;case c.EFFECT_TYPE.Effect_SKZ:this.armatureNode.active=!0,this.node.scale=1,a="role01_skill8";break;case c.EFFECT_TYPE.Effect_Boss_Light:this.armatureNode.active=!0,this.node.scale=1,a="bossguanghuan";break;case c.EFFECT_TYPE.Effect_Upgrade:this.armatureNode.active=!0,this.node.scale=1.5,a="effect008_shengji";break;case c.EFFECT_TYPE.Show_Dodge1:this.imgNode.active=!0,a="fight_suitu_49";break;case c.EFFECT_TYPE.Show_Say:this.sayNode.active=!0;break;case c.EFFECT_TYPE.Show_Word:this.tipNode.active=!0;break;case c.EFFECT_TYPE.Show_Word2:this.node.scale=1.3,this.upgradeNode.active=!0}this.armatureNode.active?l.AssetUtils.loadSpine(this.display,"Effect/"+a,null,function(){e.playEffect()},this):this.particleNode.active?l.AssetUtils.loadParticles(this.particleNode.getComponent(cc.ParticleSystem),"Particle/"+a):this.imgNode.active&&l.AssetUtils.loadSpriteFrame(this.imgNode,"Combat/"+a)},e.prototype.resetData=function(t,e,a,n,i){switch(null==e&&(e=.8),this.node.x=t.x,this.node.y=t.y,this.showTime=e,this.node.opacity=255,null!=a&&(a=Math.floor(a)),this.node.zIndex=999,this.node.stopAllActions(),this.effectType){case c.EFFECT_TYPE.Show_Attack_Num:this.randomPosition(t),this.num1Node.getComponent(cc.Label).string=""+a*h.default.SHOW_NUM_RATE,this.moveAndFadeOut();break;case c.EFFECT_TYPE.Show_Crit_Num:this.randomPosition(t),this.num2Node.getComponent(cc.Label).string=""+a*h.default.SHOW_NUM_RATE,this.moveAndFadeOut2();break;case c.EFFECT_TYPE.Show_Add_Hp:this.randomPosition(t),this.num3Node.getComponent(cc.Label).string="/"+a,this.moveAndFadeOut2();break;case c.EFFECT_TYPE.Show_ReBlood:this.randomPosition(t),this.num4Node.getComponent(cc.Label).string=""+a*h.default.SHOW_NUM_RATE,this.moveAndFadeOut();break;case c.EFFECT_TYPE.Effect_particle:this.node.scale=1.5,this.node.scaleX=u.default.Instance.mainLayer.myHeroSprite.heroStatus.face*this.node.scaleX,this.particleNode.getComponent(cc.ParticleSystem).resetSystem();break;case c.EFFECT_TYPE.Show_Dodge1:this.randomPosition(t),this.moveAndFadeOut3();break;case c.EFFECT_TYPE.Show_Say:cc.find("Say",this.sayNode).getComponent(cc.Label).string=["\u6709\u4eba\u6765\u7838\u573a\u5b50\u5566\uff01\uff01","\u5927\u5bb6\u4e00\u8d77\u4e0a\u554a\uff01","\u5f1f\u5144\u4eec\u6284\u5bb6\u4f19\u554a\uff01","\u6709\u4eba\u6765\u7838\u573a\u5b50\u5566\uff01\uff01","\u5927\u5bb6\u4e00\u8d77\u4e0a\u554a\uff01","\u5f1f\u5144\u4eec\u6284\u5bb6\u4f19\u554a\uff01"][d.default.randomInt(0,5)];break;case c.EFFECT_TYPE.Show_Word:this.tipNode.getComponent(cc.Label).string=i;break;case c.EFFECT_TYPE.Show_Word2:this.upgradeNode.getComponent(cc.Label).string=i,this.moveAndFadeOut4();break;default:this.playEffect(n)}this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(this.delete,this)))},e.prototype.playEffect=function(t){var e;t||(t=1);var a=1;switch(this.effectType){case c.EFFECT_TYPE.Effect_hit:e="hit1";break;case c.EFFECT_TYPE.Effect_hit2:e="hit2";break;case c.EFFECT_TYPE.Effect_dead:e="skill",a=1;break;case c.EFFECT_TYPE.Efffect_forzen:e="bingdong",a=1;break;case c.EFFECT_TYPE.Effect_wudi:e="buff_hudun",a=0;break;case c.EFFECT_TYPE.Effect_Jisha:e="jisha",a=1;break;case c.EFFECT_TYPE.Effect_Stoic:e="hudun",a=0;break;case c.EFFECT_TYPE.Effect_SKZ:e="role01_skill8",a=1,this.schedule(this.followCamera,0);break;case c.EFFECT_TYPE.Effect_Boss_Light:a=0,e="skill";break;case c.EFFECT_TYPE.Effect_Upgrade:a=1,e="shengji"}this.display.setAnimation(0,e,0==a),this.display.timeScale=t},e.prototype.randomPosition=function(t){var e=360*Math.random()*Math.PI/180;this.node.x=30*Math.cos(e)+t.x,this.node.y=30*Math.cos(e)+t.y},e.prototype.randomPosition2=function(t){var e=360*Math.random()*Math.PI/180;this.node.x=120*Math.cos(e)+t.x,this.node.y=100*Math.cos(e)+t.y},e.prototype.moveAndFadeOut=function(){this.node.runAction(cc.sequence(cc.scaleTo(.05,6.4),cc.scaleTo(.1,3*.8),cc.delayTime(.3),cc.fadeOut(.3),cc.callFunc(this.delete,this)))},e.prototype.moveAndFadeOut2=function(){this.node.runAction(cc.sequence(cc.scaleTo(.05,6.4),cc.scaleTo(.1,3*.8),cc.delayTime(.3),cc.fadeOut(.4),cc.callFunc(this.delete,this)))},e.prototype.moveAndFadeOut3=function(){this.node.runAction(cc.sequence(cc.scaleTo(.05,4),cc.scaleTo(.1,1),cc.delayTime(.3),cc.fadeOut(.4),cc.callFunc(this.delete,this)))},e.prototype.moveAndFadeOut4=function(){this.node.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,20)),cc.delayTime(.1),cc.fadeOut(.3),cc.callFunc(this.delete,this)))},e.prototype.followCamera=function(){this.node.x=u.default.Instance.combatScene.mainCamera.node.x},e.prototype.delete=function(){this.unscheduleAllCallbacks(),this.node.stopAllActions(),u.default.Instance.combatScene.combatLayer.mainLayer.nodeManager.pubEffect(this)},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this),this.display.timeScale=0},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this),this.display.timeScale=1},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],EndlessInfo:[function(t,e,a){"use strict";cc._RF.push(e,"764d7+sY8ZLgL/Y9A6yMT9f","EndlessInfo");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,a){this.openTime=new Array,this.openLevel=new Array,this.reward=new Array,this.challengeCount=2,this.adChallengeCount=2,this.type=t,this.chapter=e,this.openTime=a},cc._RF.pop()},{}],EndlessItem:[function(t,e,a){"use strict";cc._RF.push(e,"ac843bzZpFG/7umM0Kx8NTk","EndlessItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("DateUtils"),m=i("MainLogic"),g=i("TaskLogic"),I=i("EndlessModeItem"),_=cc._decorator,v=_.ccclass,S=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modeItems=new Array,e.rewardItemList=new Array,e.currSelectedMode=1,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.endlessInfo=t,this.endlessLayer=e,this.imgNode=cc.find("Img",this.node),this.rewardList=cc.find("RewardList",this.node);var a=m.default.Instance.sceneNodeManager.getRewardItem([0,0,1001,1005,1004][this.endlessInfo.type],0,2,0,!1,!1,!1,!1,!1);this.rewardItemList.push(a),this.rewardList.addChild(a.node),this.modeView=cc.find("Mode",this.node).getComponent(cc.ScrollView);for(var n=1;n<6;++n){var i=cc.find("Mode/view/content/ModeItem"+n,this.node).getComponent(I.default);i.init(this.endlessInfo.openLevel[n-1],this),this.modeItems.push(i)}this.challegeNode=cc.find("Challenge",this.node),this.adChallegeNode=cc.find("AdChallenge",this.node),this.challegeCountNode=cc.find("Count",this.node),this.closeNode=cc.find("Close",this.node),this.timeNode=cc.find("Close/Time",this.node);var o=y.default.getWeekData();this.closeNode.active=this.endlessInfo.openTime.indexOf(o)<0;var r="\u5468";for(n=0;n<this.endlessInfo.openTime.length;++n)r+=["","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u65e5"][this.endlessInfo.openTime[n]],n!=this.endlessInfo.openTime.length-1&&(r+="\u3001");r+="\u5f00\u542f",this.timeNode.getComponent(cc.Label).string=r,this.modeView.scrollToLeft(),this.review()},e.prototype.review=function(){for(var t=0;t<this.modeItems.length;++t)this.modeItems[t].review();this.currSelectedMode>3&&(cc.find("Mode/view/content",this.node).x=-80);var e=p.default.Instance.playerData.endlessChallengeCount[this.endlessInfo.type],a=this.endlessInfo.challengeCount+this.endlessInfo.adChallengeCount;this.challegeCountNode.getComponent(cc.Label).string=e+"/"+a,e>this.endlessInfo.adChallengeCount?(this.adChallegeNode.active=!1,this.challegeNode.active=!0):(this.adChallegeNode.active=!0,this.challegeNode.active=!1,e<=0&&(this.adChallegeNode.getComponent(cc.Button).interactable=!1)),d.default.Instance.dungeonMap.get(this.endlessInfo.chapter).get(this.currSelectedMode).get(0),f.AssetUtils.loadSpriteFrame(this.imgNode,"Combat/fuben_ll_01")},e.prototype.selectedMode=function(t){this.currSelectedMode=t;for(var e=0;e<this.modeItems.length;++e)this.modeItems[e].selectedMode(t);d.default.Instance.dungeonMap.get(this.endlessInfo.chapter).get(this.currSelectedMode).get(0),f.AssetUtils.loadSpriteFrame(this.imgNode,"Combat/fuben_ll_01")},e.prototype.onClickBtn=function(t,e){if(u.SoundManager.Instance.playEffect("anniu"),1==e)this.modeView.scrollToLeft();else if(2==e)this.modeView.scrollToRight();else if(3==e){this.endlessLayer.node.active=!1;var a=this.endlessInfo.chapter,n=this.currSelectedMode;m.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.Endless,a,n,0,!1)}else 4==e&&c.default.Instance.adHandler(c.default.AD_TYPE_FUBEN_TZ,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){if(0==e){if(t==c.default.AD_TYPE_FUBEN_TZ||t==c.default.SHARE_TYPE_FUBEN_TZ){this.endlessLayer.node.active=!1;var n=this.endlessInfo.chapter,i=this.currSelectedMode;m.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.Endless,n,i,0,!1),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||m.default.Instance.taskLogic.finishAllTask(g.default.type_see_ad_count1,0,1)}}else-1==e?(m.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_FUBEN_TZ&&(this.shareType=c.default.SHARE_TYPE_FUBEN_TZ),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):m.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else m.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([v],e)}(cc.Component));o.default=S,cc._RF.pop()},{}],EndlessLayer:[function(t,e,a){"use strict";cc._RF.push(e,"aed76kyHDFAU6qtogUCD8po","EndlessLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicEnum"),h=i("SoundManager"),u=i("ConfigData"),d=i("StringUtils"),p=i("MainLogic"),f=i("EndlessItem"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.endlessItem=new Array,e}return r(e,t),e.prototype.init=function(t){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.helpNode=cc.find("Help",this.node);for(var e=u.default.Instance.endlessMap.getKeys(),a=0;a<e.length;++a){var n=e[a],i=u.default.Instance.endlessMap.get(n),o=cc.find("Layer/Center/List/view/content/EndlessItem"+n,this.node).getComponent(f.default);o.init(i,this),this.endlessItem.push(o)}this.review(t)},e.prototype.review=function(t){this.node.active=!0,this.helpNode.active=!1,this.pageName=t;for(var e=0;e<this.endlessItem.length;++e)this.endlessItem[e].review();this.showMoney(),this.pageName==l.PAGE_NAME.Home||this.pageName==l.PAGE_NAME.Task&&this.scheduleOnce(function(){c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2)},0)},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=d.default.stringToWord(p.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+d.default.stringToWord(p.default.Instance.moneyLogic.getItemCount(1004))},e.prototype.onClickBtn=function(t,e){h.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,p.default.Instance.combatScene.gotoHomeLayer(),this.pageName==l.PAGE_NAME.Home||this.pageName==l.PAGE_NAME.Task&&this.scheduleOnce(function(){c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2)},0)):2==e||3==e||(4==e?this.helpNode.active=!0:5==e?this.helpNode.active=!1:100==e?p.default.Instance.combatScene.popLayer.reviewMoneyMorePage(l.PAGE_NAME.Endless,1,!0):101==e&&p.default.Instance.combatScene.popLayer.reviewMoneyMorePage(l.PAGE_NAME.Endless,2,!0))},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],EndlessModeItem:[function(t,e,a){"use strict";cc._RF.push(e,"86e0bpICGdIj52yJ67t+2/m","EndlessModeItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("GameData"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.modeType=t[0],this.openLevel=t[1],this.endlessItem=e,this.nameNode=cc.find("Name",this.node),this.selectedNode=cc.find("Selected",this.node),this.closeNode=cc.find("Close",this.node),this.levelNode=cc.find("Close/Level",this.node),this.nameNode.getComponent(cc.Label).string=["","\u666e\u901a","\u7cbe\u82f1","\u56f0\u96be","\u6076\u68a6","\u5730\u72f1"][this.modeType],this.selectedNode.active=1==this.modeType,this.levelNode.getComponent(cc.Label).string=this.openLevel+"",this.review()},e.prototype.review=function(){this.closeNode.active=l.default.Instance.playerData.level<this.openLevel,this.closeNode.active||this.endlessItem.selectedMode(this.modeType)},e.prototype.selectedMode=function(t){this.selectedNode.active=t==this.modeType},e.prototype.onClickBtn=function(){c.SoundManager.Instance.playEffect("anniu"),this.closeNode.active||this.endlessItem.selectedMode(this.modeType)},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],EquipmentData:[function(t,e,a){"use strict";cc._RF.push(e,"30df1xE8E9Hr6L505HEGTmB","EquipmentData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("DataUtils"),r=n("MyMathUtils"),s=n("ConfigData");i.default=function(t,e,a){this.extraEffectId=new Array,this.extraEffectPro=new Array,this.extraEffectValue=new Array,this.suitEffectId=new Array,this.suitEffectPro=new Array,this.suitEffectValue=new Array,this.equipState=0,this.equipHeroId=0,this.lockState=0,this.equipPlace=0,this.equipmentScore=0,this.equipmentBasicScore=0,this.strengthCost=new Array,this.placeRatio=[1,1],this.qualityRatio=[1,1],this.levelRatio=[1,1],this.killMonsterCount=0,this.equipmentIndex=t,this.equipmentId=e,this.equipmentLevel=1,this.strengthLevel=0,this.equipState=0,this.lockState=0,this.equipHeroId=0;var n=s.default.Instance.equipmentMap.get(e);if(this.equipPlace=n.place,this.equipmentLevel=n.equip_lvl,this.strengthLevel=a,this.equipmentAtk=Math.round(n.atk*(.2*Math.random()+.9)),this.equipmentHp=Math.round(n.hp*(.2*Math.random()+.9)),this.equipmentDef=Math.round(n.def*(.2*Math.random()+.9)),this.equipmentScore=(1*this.equipmentAtk+.125*this.equipmentHp+1*this.equipmentDef)*(n.crit_rate+n.hit_rate+n.agl+n.atk_speed),this.equipmentBasicScore=this.equipmentScore,this.placeRatio=[[1.5,1.5],[1,1],[1,1],[1,1],[1,1],[1,1]][this.equipPlace-1],this.qualityRatio=[[.5,.05],[.7,.07],[.8,.08],[1,.1]][n.quality-1],this.levelRatio={1:[1,1],5:[1.2,1.2],10:[1.4,1.4],15:[1.7,1.7],20:[2.5,2.5],25:[3,3],30:[4,4],35:[5,5],40:[6,6],45:[8,8],50:[10,10],55:[12,12],60:[15,15]}[n.equip_lvl],n.extraEffectNun&&n.extraEffectId){for(var i=o.default.randomIndexByWeight2(n.extraEffectNun),c=n.extraEffectNun[i][0],l=new Array,h=0;h<n.extraEffectId.length;++h)l.push(10);var u=o.default.randomIndexListByWeight(l);for(h=0;h<c;++h){var d=n.extraEffectId[u[h]];if(g=s.default.Instance.extroEffectMap.get(d))switch(this.extraEffectId.push(d),g.buff_type){case 1:case 2:case 3:case 4:case 5:case 6:if(null==g.probabilityNum)this.extraEffectPro.push(100);else{var p=r.default.random(g.probabilityNum[0],g.probabilityNum[1]);if(g.probabilityQualityCoefficient&&(p*=g.probabilityQualityCoefficient[n.quality-1]),g.probability_lvl_coefficient){var f=Math.floor(n.equip_lvl/5);p*=Math.pow(g.probability_lvl_coefficient,f)}this.extraEffectPro.push(p)}var y=0;y=1==g.effectValue.length?g.effectValue[0]:g.effectValue.length>1?r.default.random(g.effectValue[0],g.effectValue[1]):1==g.mode?.1:1,g.effectQualityCoefficient&&(y*=g.effectQualityCoefficient[n.quality-1]),g.effect_lvl_coefficient&&(f=Math.floor(n.equip_lvl/5),y*=Math.pow(g.effect_lvl_coefficient,f)),this.extraEffectValue.push(y)}else console.log(" \u989d\u5916\u6548\u679c "+d+" \u6ca1\u627e\u5230 ")}}var m=new Array;if(n.suitEffectId1){for(l=[],h=0;h<n.suitEffectId1.length;++h)l.push(10);u=o.default.randomIndexListByWeight(l),m.push(n.suitEffectId1[u[0]])}if(n.suitEffectId2){for(l=[],h=0;h<n.suitEffectId2.length;++h)l.push(10);u=o.default.randomIndexListByWeight(l),m.push(n.suitEffectId2[u[0]])}if(n.suitEffectId3){for(l=[],h=0;h<n.suitEffectId3.length;++h)l.push(10);u=o.default.randomIndexListByWeight(l),m.push(n.suitEffectId3[u[0]])}for(h=0;h<m.length;++h){var g;if(d=m[h],g=s.default.Instance.extroEffectMap.get(d))switch(this.suitEffectId.push(d),g.buff_type){case 1:case 2:case 3:case 4:case 5:case 6:null==g.probabilityNum?this.suitEffectPro.push(100):(p=r.default.random(g.probabilityNum[0],g.probabilityNum[1]),g.probabilityQualityCoefficient&&(p*=g.probabilityQualityCoefficient[n.quality-1]),g.probability_lvl_coefficient&&(f=Math.floor(n.equip_lvl/5),p*=Math.pow(g.probability_lvl_coefficient,f)),this.suitEffectPro.push(p)),y=0,y=1==g.effectValue.length?g.effectValue[0]:g.effectValue.length>1?r.default.random(g.effectValue[0],g.effectValue[1]):1==g.mode?.1:1,g.effectQualityCoefficient&&(y*=g.effectQualityCoefficient[n.quality-1]),g.effect_lvl_coefficient&&(f=Math.floor(n.equip_lvl/5),y*=Math.pow(g.effect_lvl_coefficient,f)),this.suitEffectValue.push(y)}else console.log(" \u989d\u5916\u6548\u679c "+d+" \u6ca1\u627e\u5230 ")}},cc._RF.pop()},{}],EquipmentGrowInfo:[function(t,e,a){"use strict";cc._RF.push(e,"021b9OUd65Pt6Ry/EBv51k6","EquipmentGrowInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.grow_lvl=o.default.stringToInt(t.grow_lvl),this.succes_probability=o.default.stringToFloat(t.succes_probability),this.cost=t.cost,this.costValue=o.default.config_stringToIntListOfList(this.cost),this.one_level_property_add=o.default.stringToFloat(t.one_level_property_add),this.sec_level_property_add=o.default.stringToFloat(t.sec_level_property_add)},cc._RF.pop()},{}],EquipmentInfo:[function(t,e,a){"use strict";cc._RF.push(e,"c124ffkGu1Pt4QFA//1xazH","EquipmentInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.place=o.default.stringToInt(t.place),this.equip_lvl=o.default.stringToInt(t.equip_lvl),this.name=t.name,this.quality=o.default.stringToInt(t.quality),this.type=o.default.stringToInt(t.type),this.tip=o.default.stringToInt(t.tips),this.atk=o.default.stringToInt(t.atk),this.hp=o.default.stringToInt(t.hp),this.def=o.default.stringToFloat(t.def),this.crit_rate=o.default.stringToFloat(t.crit_rate),this.hit_rate=o.default.stringToFloat(t.hit_rate),this.agl=o.default.stringToFloat(t.agl),this.atk_speed=o.default.stringToFloat(t.atk_speed),this.icon=t.icon,this.extra_effect_num=t.extra_effect_num,this.extraEffectNun=o.default.config_stringToIntListOfList(this.extra_effect_num),this.extra_effect_id=t.extra_effect_id,this.extraEffectId=o.default.config_stringToIntList(this.extra_effect_id),this.suit_effect_id1=t.suit_effect_id1,this.suitEffectId1=o.default.config_stringToIntList(this.suit_effect_id1),this.suit_effect_id2=t.suit_effect_id2,this.suitEffectId2=o.default.config_stringToIntList(this.suit_effect_id2),this.suit_effect_id3=t.suit_effect_id3,this.suitEffectId3=o.default.config_stringToIntList(this.suit_effect_id3),this.effect_scale=o.default.stringToFloat(t.effect_scale),this.res_id=t.res_id,this.get_way=o.default.stringToInt(t.get_way),this.compose_way=t.compose_way,this.composeWay=o.default.config_stringToIntList(this.compose_way,"_"),this.last_time=o.default.stringToInt(t.last_time)},cc._RF.pop()},{}],EquipmentLayer:[function(t,e,a){"use strict";cc._RF.push(e,"0c861KlQB9J9IWqz0FCO5ZY","EquipmentLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("StringUtils"),y=i("GuideUtils"),m=i("MainLogic"),g=i("TaskLogic"),I=i("KnapsackItem"),_=i("ResolveLayer"),v=cc._decorator,S=v.ccclass,L=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.knapsackPrefab=null,e.attrItemPrefab=null,e.extraItemPrefab=null,e.strengthItemPrefab=null,e.suitItemPrefab=null,e.equipmentItems=new Array,e.equipmentInfoPos=[[cc.v2(130,188),cc.v2(35,50)],[cc.v2(130,68),cc.v2(35,100)],[cc.v2(130,-50),cc.v2(35,145)],[cc.v2(455,188),cc.v2(-265,50)],[cc.v2(455,68),cc.v2(-265,100)],[cc.v2(455,-50),cc.v2(-265,145)]],e.knapsackItems=new Array,e.selecteEquipmentIndex=0,e.propItems=new Array,e.infoBarItems=[null,null,null,null],e.lockNodes=[null,null,null,null],e.unlockNodes=[null,null,null,null],e.selectedType=0,e.heroArmResId="",e.wingArmResId="",e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.heroNode=cc.find("Layer/Left/Hero",this.node),this.equipmentInfoNode=cc.find("Layer/Left/EquipmentInfo",this.node);var a=cc.find("Info/KnapsackItem",this.equipmentInfoNode).getComponent(I.default);this.infoBarItems[1]=a;var n=cc.find("Info/Lock",this.equipmentInfoNode);this.lockNodes[1]=n;var i=cc.find("Info/Unlock",this.equipmentInfoNode);this.unlockNodes[1]=i,this.allAtkNode=cc.find("Layer/Left/Atk_Value/Value",this.node),this.atkNode=cc.find("Layer/Left/Info_bg/Atk_Value",this.node),this.hpNode=cc.find("Layer/Left/Info_bg/Hp_Value",this.node),this.defNode=cc.find("Layer/Left/Info_bg/Def_Value",this.node),this.critRateNode=cc.find("Layer/Left/Info_bg/Hit_Value",this.node),this.atkSpeedNode=cc.find("Layer/Left/Info_bg/Atk_Speed_Value",this.node),this.moveSpeedNode=cc.find("Layer/Left/Info_bg/Move_Speed_Value",this.node),this.hitRateNode=cc.find("Layer/Left/Info_bg/Hit_Rate_Value",this.node),this.dodgeRateNode=cc.find("Layer/Left/Info_bg/Dodge_Rate_Value",this.node),this.equipmentList=cc.find("Layer/Right/EquipmentList",this.node),this.equipmentContent=cc.find("view/content",this.equipmentList),this.propList=cc.find("Layer/Right/PropList",this.node),this.propContent=cc.find("view/content",this.propList),this.propInfoNode=cc.find("Layer/Right/PropInfo",this.node);var o=cc.find("EquipmentInfo1/Info/KnapsackItem",this.propInfoNode).getComponent(I.default);this.infoBarItems[2]=o;var r=cc.find("EquipmentInfo2/Info/KnapsackItem",this.propInfoNode).getComponent(I.default);this.infoBarItems[3]=r;var s=cc.find("EquipmentInfo3/Info/KnapsackItem",this.propInfoNode).getComponent(I.default);this.infoBarItems[4]=s;var c=cc.find("EquipmentInfo1/Info/Lock",this.propInfoNode);this.lockNodes[2]=c;var l=cc.find("EquipmentInfo1/Info/Unlock",this.propInfoNode);this.unlockNodes[2]=l;var h=cc.find("EquipmentInfo2/Info/Lock",this.propInfoNode);this.lockNodes[3]=h;var u=cc.find("EquipmentInfo2/Info/Unlock",this.propInfoNode);this.unlockNodes[3]=u,this.tipNode=cc.find("GetGrid",this.node),this.resoleLayer=cc.find("ResolveLayer",this.node).getComponent(_.default),this.resoleLayer.init(),this.equipmentList.active=!0,this.propList.active=!1;var d=p.default.Instance.playerData.wearFashionList;this.heroScript=m.default.Instance.sceneNodeManager.getHeroArmature(1001,d[0],d[1],d[2],0),this.heroNode.addChild(this.heroScript.node),this.review(t,e)},e.prototype.review=function(t,e){var a=this;if(this.pageName=t,this.heroId=e,this.pageName==h.PAGE_NAME.Combat&&this.scheduleOnce(function(){m.default.Instance.combatScene.hideCombatLayer()},0),this.node.active=!0,this.tipNode.active=!1,this.resoleLayer.node.active=!1,this.equipmentInfoNode.active=!1,this.propInfoNode.active=!1,p.default.Instance.playerData.getNewEquipment=!1,m.default.Instance.tipsLogic.updateEquipment(),this.updateRoleArm(),this.heroId=e,0==this.equipmentItems.length)for(var n=1;n<=6;++n){var i=cc.find("Layer/Left/Equipment"+n,this.node).getComponent(I.default);i.init(this,4,0,n),this.equipmentItems.push(i)}else for(n=0;n<this.equipmentItems.length;++n)this.equipmentItems[n].review(this,0,0,0);switch(this.showEquipmentList(),this.showPropList(),this.showHeroInfo(),this.showMoney(),this.scheduleOnce(function(){a.guideAction()},0),this.pageName){case h.PAGE_NAME.Home:break;case h.PAGE_NAME.ChapterStart:case h.PAGE_NAME.Task:c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2);break;case h.PAGE_NAME.Combat:c.default.Instance.hideCustomAd(3)}},e.prototype.updateRoleArm=function(){var t=p.default.Instance.playerData.wearFashionList;this.heroScript.resetSlot(t[0],t[1],t[2],0)},e.prototype.showHeroInfo=function(){var t=m.default.Instance.roleLogic.getRoleAllAttr(this.heroId);this.allAtkNode.getComponent(cc.Label).string=""+m.default.Instance.roleLogic.getCombatAtk(this.heroId,1),this.atkNode.getComponent(cc.Label).string=Math.round(t[1])+"",this.hpNode.getComponent(cc.Label).string=Math.round(t[2])+"",this.defNode.getComponent(cc.Label).string=Math.round(t[3])+"",this.critRateNode.getComponent(cc.Label).string=f.default.intFormate(100*t[4])+"%",this.atkSpeedNode.getComponent(cc.Label).string=f.default.intFormate(t[7],3)+"",this.moveSpeedNode.getComponent(cc.Label).string=m.default.Instance.roleLogic.getRoleAllAttr(this.heroId)[8]+"",this.hitRateNode.getComponent(cc.Label).string=f.default.intFormate(100*t[5])+"%",this.dodgeRateNode.getComponent(cc.Label).string=f.default.intFormate(100*t[6])+"%"},e.prototype.updateWeapon=function(){this.updateRoleArm()},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=f.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+f.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1004))},e.prototype.showEquipmentList=function(){for(var t=p.default.Instance.playerData,e=Math.ceil(t.equipmentGridCount/20),a=t.equipmentGridCount-this.equipmentContent.childrenCount,n=0;n<a;++n){var i=cc.instantiate(this.knapsackPrefab);this.equipmentContent.addChild(i),(c=i.getComponent(I.default)).init(this,0,0,0),this.knapsackItems.push(c)}for(var o=0;o<this.knapsackItems.length;++o)this.knapsackItems[o].review(this,0,0,0);var r=p.default.Instance.playerData.equipmentList,s=0;for(o=0;o<r.length;++o)if(0==r[o].equipState)(c=this.knapsackItems[s]).review(this,1,r[o].equipmentId,r[o].equipmentIndex),s+=1;else{var c,l=r[o].equipPlace;(c=this.equipmentItems[l-1]).review(this,4,r[o].equipmentId,r[o].equipmentIndex)}cc.find("ListInfo/Info/Count",this.equipmentList).getComponent(cc.Label).string=s+"/"+t.equipmentGridCount,cc.find("ListInfo/Info/Add",this.equipmentList).active=e<13},e.prototype.showEquipmentInfo=function(t){this.propInfoNode.active=!1,this.selecteEquipmentIndex=t,this.equipmentInfoNode.active=!0,this.setEquipmentInfo(this.equipmentInfoNode,t)},e.prototype.showPropList=function(){for(var t=p.default.Instance.playerData,e=Math.ceil(t.equipmentGridCount/20),a=t.equipmentGridCount-this.propContent.childrenCount,n=0;n<a;++n){var i=cc.instantiate(this.knapsackPrefab);this.propContent.addChild(i),(c=i.getComponent(I.default)).init(this,0,0,0),this.propItems.push(c)}for(var o=0;o<this.propItems.length;++o)this.propItems[o].review(this,0,0,0);var r=p.default.Instance.playerData.propList,s=0;for(o=0;o<r.length;++o){var c;r[o].count>0&&1==d.default.Instance.itemMap.get(r[o].propId).is_show&&((c=this.propItems[s]).review(this,2,r[o].propId,r[o].propQuality),s+=1)}cc.find("ListInfo/Info/Count",this.propList).getComponent(cc.Label).string=s+"/"+t.equipmentGridCount,cc.find("ListInfo/Info/Add",this.propList).active=e<13},e.prototype.showPropInfo=function(t,e,a){this.equipmentInfoNode.active=!1,this.propInfoNode.active=!0;var n=cc.find("EquipmentInfo1",this.propInfoNode),i=cc.find("EquipmentInfo2",this.propInfoNode),o=cc.find("EquipmentInfo3",this.propInfoNode);if(this.selecteEquipmentIndex=e,1==a){n.active=!0,o.active=!1;var r=m.default.Instance.equipmentLogic.getEquipmentData(e);this.setEquipmentInfo(n,e,!0);var s=m.default.Instance.equipmentLogic.roleEquipmentIndexByPlace(this.heroId,r.equipPlace);0==s?i.active=!1:(i.active=!0,this.setEquipmentInfo(i,s))}else 2==a&&(n.active=!1,i.active=!1,o.active=!0,this.setPropInfo(o,e))},e.prototype.setEquipmentInfo=function(t,e,a){void 0===a&&(a=!1);var n=m.default.Instance.equipmentLogic.getEquipmentData(e);if(null!=n){t.active=!0,cc.find("Info/KnapsackItem",t).getComponent(I.default).init(this,6,n.equipmentId,e);var i=d.default.Instance.equipmentMap.get(n.equipmentId);cc.find("Info/Name",t).getComponent(cc.Label).string=i.name,cc.find("Info/Quality",t).getComponent(cc.Label).string="\u54c1\u8d28\uff1a"+m.default.Instance.equipmentLogic.getQualityName(i.quality),cc.find("Info/Type",t).getComponent(cc.Label).string="\u7c7b\u578b\uff1a"+m.default.Instance.equipmentLogic.getPlaceName(n.equipPlace);var o=m.default.Instance.equipmentLogic.getEquipmentAttrType(n.equipmentId);cc.find("Info/Lock",t).active=0==n.lockState,cc.find("Info/Unlock",t).active=1==n.lockState;for(var r=cc.find("Info/List/view/content",t),s=cc.find("Attr",r),c=0;c<s.childrenCount;++c)"Title"!=(p=s.children[c]).name&&p.destroy();var l=cc.find("Extra",r);if(l.destroyAllChildren(),n.extraEffectId){for(c=0;c<n.extraEffectId.length;++c)this.addExtraItem(l,e,n.extraEffectId[c]);l.active=n.extraEffectId.length>0}else l.active=!1;var h=cc.find("Strength",r);for(c=0;c<h.childrenCount;++c)"Title"!=(p=h.children[c]).name&&p.destroy();for(h.active=0!=n.strengthLevel,cc.find("Title/Value",h).getComponent(cc.Label).string="+"+n.strengthLevel,c=0;c<o.length;++c)this.addAttrItem(s,e,o[c]),h.active&&this.addStrengthItem(h,e,o[c]);var u=cc.find("Suit",r);for(c=0;c<u.childrenCount;++c){var p;"Title"!=(p=u.children[c]).name&&p.destroy()}if(2==i.type&&n.suitEffectId){var f=a?0:m.default.Instance.equipmentLogic.getSuitCountByTips(this.heroId,i.tip);for(c=0;c<n.suitEffectId.length;++c)this.addSuitItem(u,e,n.suitEffectId[c],c+1,f);u.active=n.suitEffectId.length>0}else u.active=!1}else t.active=!1},e.prototype.addAttrItem=function(t,e,a){var n=m.default.Instance.equipmentLogic.getEquipmentData(e),i=d.default.Instance.equipmentMap.get(n.equipmentId),o=cc.instantiate(this.attrItemPrefab);t.addChild(o);var r=cc.find("Title",o),s=cc.find("Value",o),c=cc.find("Fw",o);switch(a){case 1:r.getComponent(cc.Label).string="\u653b\u51fb\u529b:",s.getComponent(cc.Label).string=n.equipmentAtk+"",c.getComponent(cc.Label).string="("+Math.round(.9*i.atk)+"-"+Math.round(1.1*i.atk)+")";break;case 2:r.getComponent(cc.Label).string="\u8840\u91cf:",s.getComponent(cc.Label).string=n.equipmentHp+"",c.getComponent(cc.Label).string="("+Math.round(.9*i.hp)+"-"+Math.round(1.1*i.hp)+")";break;case 3:r.getComponent(cc.Label).string="\u9632\u5fa1\u529b:",s.getComponent(cc.Label).string=Math.round(n.equipmentDef)+"",c.getComponent(cc.Label).string="("+Math.round(.9*i.def)+"-"+Math.round(1.1*i.def)+")";break;case 4:r.getComponent(cc.Label).string="\u66b4\u51fb\u7387:",s.getComponent(cc.Label).string=f.default.intFormate(100*i.crit_rate)+"%",c.active=!1;break;case 5:r.getComponent(cc.Label).string="\u547d\u4e2d\u7387:",s.getComponent(cc.Label).string=f.default.intFormate(100*i.hit_rate)+"%",c.active=!1;break;case 6:r.getComponent(cc.Label).string="\u95ea\u907f\u7387:",s.getComponent(cc.Label).string=f.default.intFormate(100*i.agl)+"%",c.active=!1;break;case 7:r.getComponent(cc.Label).string="\u653b\u901f:",s.getComponent(cc.Label).string=f.default.intFormate(i.atk_speed,3)+"",c.active=!1}},e.prototype.addExtraItem=function(t,e,a){var n=m.default.Instance.equipmentLogic.getEquipmentData(e),i=d.default.Instance.extroEffectMap.get(a),o=n.extraEffectId.indexOf(a),r=cc.instantiate(this.extraItemPrefab);t.addChild(r);for(var s=i.introduce,c=["{probability}","{monster_num}","{effect_value}","{property_value}"],l=0;l<c.length;++l)if(s.indexOf(c[l])>=0)switch(l){case 0:s=s.replace(c[l],f.default.intFormate(n.extraEffectPro[o])+"%");break;case 1:s=s.replace(c[l],i.monster_num+"");break;case 2:s=1==i.mode?s.replace(c[l],f.default.intFormate(n.extraEffectValue[o])+"%"):s.replace(c[l],Math.floor(n.extraEffectValue[o])+"")}r.getComponent(cc.Label).string=s},e.prototype.addStrengthItem=function(t,e,a){var n=m.default.Instance.equipmentLogic.getEquipmentData(e),i=(d.default.Instance.equipmentMap.get(n.equipmentId),cc.instantiate(this.strengthItemPrefab));t.addChild(i);var o=cc.find("Title",i),r=cc.find("Value",i),s=0;switch(a){case 1:o.getComponent(cc.Label).string="\u653b\u51fb\u529b:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,1,n.strengthLevel)[1],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 2:o.getComponent(cc.Label).string="\u8840\u91cf:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,2,n.strengthLevel)[1],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 3:o.getComponent(cc.Label).string="\u9632\u5fa1\u529b:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,3,n.strengthLevel)[1],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 4:o.getComponent(cc.Label).string="\u66b4\u51fb\u7387:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,4,n.strengthLevel)[1],r.getComponent(cc.Label).string=f.default.intFormate(100*s)+"%";break;case 5:o.getComponent(cc.Label).string="\u547d\u4e2d\u7387:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,5,n.strengthLevel)[1],r.getComponent(cc.Label).string=f.default.intFormate(100*s)+"%";break;case 6:o.getComponent(cc.Label).string="\u95ea\u907f\u7387:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,6,n.strengthLevel)[1],r.getComponent(cc.Label).string=f.default.intFormate(100*s)+"%";break;case 7:o.getComponent(cc.Label).string="\u653b\u901f:",s=m.default.Instance.equipmentLogic.getEquipmentAttr(e,7,n.strengthLevel)[1],r.getComponent(cc.Label).string=f.default.intFormate(s,3)+""}},e.prototype.addSuitItem=function(t,e,a,n,i){var o=m.default.Instance.equipmentLogic.getEquipmentData(e),r=d.default.Instance.extroEffectMap.get(a),s=o.suitEffectId.indexOf(a),c=cc.instantiate(this.suitItemPrefab);t.addChild(c);for(var l=cc.find("Value",c),h=r.introduce,u=["{probability}","{monster_num}","{effect_value}","{property_value}"],p=0;p<u.length;++p)if(h.indexOf(u[p])>=0)switch(p){case 0:h=h.replace(u[p],f.default.intFormate(o.suitEffectPro[s])+"%");break;case 1:h=h.replace(u[p],r.monster_num+"");break;case 2:h=1==r.mode?h.replace(u[p],f.default.intFormate(o.suitEffectValue[s])+"%"):h.replace(u[p],Math.floor(o.suitEffectValue[s])+"")}l.getComponent(cc.Label).string="["+n+"]  "+h,l.color=cc.color(255,255,255),2==i&&1==n?l.color=cc.color(0,255,0):3==i&&n<=2?l.color=cc.color(0,255,0):i>3&&(l.color=cc.color(0,255,0))},e.prototype.setPropInfo=function(t,e){var a=m.default.Instance.equipmentLogic.getPropData(e);cc.find("Info/KnapsackItem",t).getComponent(I.default).init(this,7,a.propId,a.propQuality);var n=d.default.Instance.itemMap.get(a.propId);cc.find("Info/Name",t).getComponent(cc.Label).string=n.name,cc.find("Info/Quality",t).getComponent(cc.Label).string="\u54c1\u8d28\uff1a"+m.default.Instance.equipmentLogic.getQualityName(n.quality),cc.find("Info/Type",t).getComponent(cc.Label).string="\u7c7b\u578b\uff1a"+n.item_type,cc.find("Info/Desc",t).getComponent(cc.Label).string=n.introduce;var i=cc.find("Bg1",t),o=cc.find("Bg2",t);i.active=7!=n.type&&14!=n.type,o.active=7==n.type||14==n.type||16==n.type,cc.find("Info/Useing",t).active=7==n.type||14==n.type,cc.find("Info/Compose",t).active=16==n.type},e.prototype.updatePropInfo=function(t){for(var e=!1,a=d.default.Instance.itemMap.get(t),n=0;n<this.propItems.length;++n)if(this.propItems[n].itemId==t){e=!0,this.propItems[n].review(this,2,t,a.quality);break}e||this.showPropList()},e.prototype.hideInfoNode=function(){this.equipmentInfoNode.active=!1,this.propInfoNode.active=!1},e.prototype.clickEquipBtn=function(t){if(1==t);else if(2==t){var e=m.default.Instance.equipmentLogic.getEquipmentData(this.selecteEquipmentIndex);if(e){var a=d.default.Instance.equipmentMap.get(e.equipmentId);if(p.default.Instance.playerData.level<a.equip_lvl)return void m.default.Instance.combatScene.showMsgInfo("\u7b49\u7ea7\u4e0d\u8db3");var n=m.default.Instance.equipmentLogic.roleEquipmentIndexByPlace(this.heroId,e.equipPlace);if(0==n);else{var i=m.default.Instance.equipmentLogic.getEquipmentData(n);i.equipState=0,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,0,i.equipPlace)}e.equipState=1,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,this.selecteEquipmentIndex,e.equipPlace)}}p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart()),this.review(this.pageName,this.heroId)},e.prototype.onRemoveBtn=function(t){if(1==t){var e=m.default.Instance.equipmentLogic.getEquipmentData(this.selecteEquipmentIndex);e&&(e.equipState=0,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,0,e.equipPlace))}p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart()),this.review(this.pageName,this.heroId)},e.prototype.onLockBtn=function(t,e){var a=this.selecteEquipmentIndex,n=m.default.Instance.equipmentLogic.getEquipmentData(this.selecteEquipmentIndex);if(n)if(1==t||2==t)n.lockState=e;else if(3==t){var i=m.default.Instance.equipmentLogic.roleEquipmentIndexByPlace(this.heroId,n.equipPlace);0==i||(m.default.Instance.equipmentLogic.getEquipmentData(i).lockState=e,a=i)}p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart()),this.updateLockState(t,a)},e.prototype.updateLockState=function(t,e){var a=m.default.Instance.equipmentLogic.getEquipmentData(e);if(null!=a)if(this.infoBarItems[t].showLockNode(1==a.lockState),this.lockNodes[t].active=0==a.lockState,this.unlockNodes[t].active=1==a.lockState,1==t||3==t)for(var n=0;n<this.equipmentItems.length;++n)this.equipmentItems[n].itemIndex==e&&this.equipmentItems[n].showLockNode(1==a.lockState);else if(2==t)for(n=0;n<this.knapsackItems.length;++n){var i=this.knapsackItems[n];if(i.itemIndex==e){i.showLockNode(1==a.lockState);break}}},e.prototype.resolveSucc=function(){this.review(this.pageName,this.heroId),this.resoleLayer.node.active=!1},e.prototype.onClickEvent=function(t,e){if(u.SoundManager.Instance.playEffect("anniu"),9==e||13==e||15==e||16==e||17==e||18==e||this.hideInfoNode(),1==e)switch(this.node.active=!1,this.pageName==h.PAGE_NAME.Combat?m.default.Instance.combatScene.showCombatLayer():this.pageName==h.PAGE_NAME.CombatResult||m.default.Instance.combatScene.gotoHomeLayer(),m.default.Instance.combatScene.popLayer.pointGuideFinish(),this.pageName){case h.PAGE_NAME.Home:break;case h.PAGE_NAME.ChapterStart:case h.PAGE_NAME.Task:c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2);break;case h.PAGE_NAME.Combat:c.default.Instance.showCustomAd(3);break;case h.PAGE_NAME.CombatResult:c.default.Instance.showCustomAd(1)}else if(2==e)this.equipmentList.active=!0,this.propList.active=!1;else if(3==e)this.equipmentList.active=!1,this.propList.active=!0,p.default.Instance.playerData.showPropUseTip||(p.default.Instance.playerData.showPropUseTip=!0);else if(4==e){m.default.Instance.combatScene.popLayer.pointGuideFinish();for(var a=!1,n=p.default.Instance.playerData.equipmentList,i=0;i<n.length;++i){var o=n[i],r=d.default.Instance.equipmentMap.get(o.equipmentId);if(!(p.default.Instance.playerData.level<r.equip_lvl)){var s=m.default.Instance.equipmentLogic.roleEquipmentIndexByPlace(this.heroId,o.equipPlace);if(0==s)a=!0,o.equipState=1,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,o.equipmentIndex,o.equipPlace);else{var l=m.default.Instance.equipmentLogic.getEquipmentData(s);l.equipmentScore<o.equipmentScore&&(l.equipState=0,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,0,l.equipPlace),o.equipState=1,m.default.Instance.equipmentLogic.roleEquipArm(this.heroId,o.equipmentIndex,o.equipPlace),a=!0)}}}a&&p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart()),this.review(this.pageName,this.heroId)}else if(5==e)this.resoleLayer.review(),c.default.Instance.showCustomAd(1);else if(6==e)c.default.Instance.adHandler(c.default.AD_TYPE_BUY_GRID,this,this.adCallback);else if(7==e)this.tipNode.active=!1,c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2);else if(8==e){if(m.default.Instance.equipmentLogic.getGridCount(1)<=0)return void m.default.Instance.combatScene.showMsgInfo("\u80cc\u5305\u5df2\u6ee1");this.onRemoveBtn(1)}else if(9==e)this.onLockBtn(1,1);else if(10==e)this.selectedType=1,this.tipNode.active=!0,c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2);else if(11==e)this.selectedType=2,this.tipNode.active=!0,c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2);else if(12==e)this.clickEquipBtn(2);else if(13==e)this.onLockBtn(2,1);else if(14==e);else if(15==e)this.onLockBtn(3,1);else if(16==e)this.onLockBtn(1,0);else if(17==e)this.onLockBtn(2,0);else if(18==e)this.onLockBtn(3,0);else if(19==e){var f=this.selecteEquipmentIndex;if(7==(_=d.default.Instance.itemMap.get(f)).type)_.buff_id&&(m.default.Instance.roleLogic.getBuffTime(_.buff_id)>0?m.default.Instance.combatScene.showMsgInfo("\u8eab\u4e0a\u5df2\u6709\u7c7b\u4f3c\u9053\u5177\uff0c\u65e0\u6cd5\u4f7f\u7528"):(m.default.Instance.roleLogic.addBuffData(_.buff_id,_.last_time),m.default.Instance.moneyLogic.addItemCount(f,-1),this.showPropList()));else if(14==_.type){var y=p.default.Instance.playerData.level,I=_.useLv;y>=I[0]&&y<=I[1]?(m.default.Instance.moneyLogic.addItemCount(f,-1),p.default.Instance.playerData.level+=1,m.default.Instance.taskLogic.finishAllTask(g.default.type_role_level,y+1,1),this.showHeroInfo(),this.showPropList()):m.default.Instance.combatScene.showMsgInfo("\u65e0\u6cd5\u5347\u7ea7\uff0c\u7b49\u7ea7\u4e0d\u5339\u914d")}}else if(20==e){f=this.selecteEquipmentIndex;var _=d.default.Instance.itemMap.get(f);if(m.default.Instance.moneyLogic.getItemCount(f)>=_.cost_num){m.default.Instance.moneyLogic.addItemCount(f,-_.cost_num);var v=[_.composeItem[1],_.composeItem[2],_.composeItem[0]];m.default.Instance.chapterLogic.receiveCombatBox([v]),this.showPropList()}else m.default.Instance.combatScene.showMsgInfo("\u9053\u5177\u4e0d\u8db3")}else 100==e?m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Equipment,1,!0):101==e&&m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Equipment,2,!0)},e.prototype.guideAction=function(t){var e,a=1,n=1;if(a=5,n=1,e=cc.find("Layer/Right/Equip",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),y.default.Instance.isHaveGuide(a,n,t))return y.default.Instance.isHaveGuide(4,1)&&y.default.Instance.finishGuideTask(4),void m.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100));a=5,n=2,e=cc.find("Layer/Top/Close",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),y.default.Instance.isHaveGuide(a,n,t)&&m.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100))},e.prototype.guideCallback=function(){this.node.active&&this.guideAction(!0)},e.prototype.adCallback=function(t,e,a){0==e?(0!=p.default.Instance.playerData.cdActiveFreeAd&&a||m.default.Instance.taskLogic.finishAllTask(g.default.type_see_ad_count1,0,1),1==this.selectedType?(p.default.Instance.playerData.equipmentGridCount+=10,this.showEquipmentList(),p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart())):2==this.selectedType&&(p.default.Instance.playerData.propGridCount+=10,this.showPropList(),p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart())),c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2),this.tipNode.active=!1):-1==e?(m.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(this.shareType=c.default.SHARE_TYPE_BUY_GRID,l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):m.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else m.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([L(cc.Prefab)],e.prototype,"knapsackPrefab",void 0),s([L(cc.Prefab)],e.prototype,"attrItemPrefab",void 0),s([L(cc.Prefab)],e.prototype,"extraItemPrefab",void 0),s([L(cc.Prefab)],e.prototype,"strengthItemPrefab",void 0),s([L(cc.Prefab)],e.prototype,"suitItemPrefab",void 0),s([S],e)}(cc.Component);o.default=T,cc._RF.pop()},{}],EquipmentLogic:[function(t,e,a){"use strict";cc._RF.push(e,"70165V6CEdK9KpBq4wIIzFV","EquipmentLogic");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0});var s=i("EquipmentData"),c=i("PropData"),l=i("GameData"),h=i("ConfigData"),u=i("RoleEquipData"),d=i("MainLogic"),p=i("Dictionary"),f=i("DataUtils"),y=i("TaskLogic"),m=i("PublicConst"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.extraEffect=new p.Dictionary,e}return r(e,t),e.prototype.getEquipmentData=function(t){for(var e=l.default.Instance.playerData,a=0;a<e.equipmentList.length;++a){var n=e.equipmentList[a];if(n.equipmentIndex==t)return n.strengthLevel>m.default.MAX_STRENGTH_LEVEL&&(n.strengthLevel=m.default.MAX_STRENGTH_LEVEL),n}return null},e.prototype.addEquipmentData=function(t,e){void 0===e&&(e=0);var a=h.default.Instance.equipmentMap.get(t);if(4==a.type)return console.log("\u83b7\u53d6\u65f6\u88c5"),l.default.Instance.playerData.fashionList.push(t),l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart()),!0;if(6==a.type){console.log("\u83b7\u53d6\u79f0\u53f7");var n=0==a.last_time?999999999:a.last_time;return d.default.Instance.roleLogic.addTitleData(a.id,n),!0}var i=l.default.Instance.playerData.equipmentList;if(i.length-this.getRoleEquipArmCount(l.default.Instance.playerData.roleId)>=l.default.Instance.playerData.equipmentGridCount)return console.log("\u683c\u5b50\u5df2\u6ee1"),!1;l.default.Instance.playerData.equipmentIndex+=1;var o=new s.default(l.default.Instance.playerData.equipmentIndex,t,e);return i.push(o),i.sort(function(t,e){return e.equipmentScore-t.equipmentScore}),l.default.Instance.playerData.getNewEquipment=!0,l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart()),!0},e.prototype.addEquipmentLevel=function(t,e){var a=this.getEquipmentData(t);if(a){for(var n=0;n<e;++n)a.strengthLevel+=1,a.strengthLevel>m.default.MAX_STRENGTH_LEVEL&&(a.strengthLevel=m.default.MAX_STRENGTH_LEVEL);var i=this.getEquipmentAttr(t,1)[0],o=this.getEquipmentAttr(t,2)[0],r=this.getEquipmentAttr(t,3)[0],s=this.getEquipmentAttr(t,4)[0],c=this.getEquipmentAttr(t,5)[0],h=this.getEquipmentAttr(t,6)[0],u=this.getEquipmentAttr(t,7)[0];a.equipmentScore=(1*i+.125*o+1*r)*(s+c+h+u),l.default.Instance.playerData.equipmentList.sort(function(t,e){return e.equipmentScore-t.equipmentScore}),d.default.Instance.taskLogic.finishAllTask(y.default.type_strength_equipment_level,a.strengthLevel,1),d.default.Instance.taskLogic.finishAllTask(y.default.type_strength_equipment_count,0,1),l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())}else console.log(" add equipment level error ")},e.prototype.equipmentLevelZero=function(t){var e=this.getEquipmentData(t);if(e){e.strengthLevel=0;var a=this.getEquipmentAttr(t,1)[0],n=this.getEquipmentAttr(t,2)[0],i=this.getEquipmentAttr(t,3)[0],o=this.getEquipmentAttr(t,4)[0],r=this.getEquipmentAttr(t,5)[0],s=this.getEquipmentAttr(t,6)[0],c=this.getEquipmentAttr(t,7)[0];e.equipmentScore=(1*a+.125*n+1*i)*(o+r+s+c),l.default.Instance.playerData.equipmentList.sort(function(t,e){return e.equipmentScore-t.equipmentScore}),l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())}else console.log(" add equipment level error ")},e.prototype.getGridCount=function(t){var e=l.default.Instance.playerData.equipmentList.length-this.getRoleEquipArmCount(l.default.Instance.playerData.roleId);return 1==t?l.default.Instance.playerData.equipmentGridCount-e:19},e.prototype.removeEquipmentData=function(t){var e=this.getEquipmentData(t),a=l.default.Instance.playerData.equipmentList;a.splice(a.indexOf(e),1),l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())},e.prototype.getEquipmentAttr=function(t,e,a){var n=this.getEquipmentData(t),i=h.default.Instance.equipmentMap.get(n.equipmentId),o=n.strengthLevel;null!=a&&(o=a),o>m.default.MAX_STRENGTH_LEVEL&&(o=m.default.MAX_STRENGTH_LEVEL);var r=new Array;if(1==e){for(var s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).one_level_property_add;var l=n.equipmentAtk*s;r.push(l),r.push(l-n.equipmentAtk)}else if(2==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).one_level_property_add;var u=n.equipmentHp*s;r.push(u),r.push(u-n.equipmentHp)}else if(3==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).one_level_property_add;var d=n.equipmentDef*s;r.push(d),r.push(d-n.equipmentDef)}else if(4==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).sec_level_property_add;var p=i.crit_rate*s;r.push(p),r.push(p-i.crit_rate)}else if(5==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).sec_level_property_add;var f=i.hit_rate*s;r.push(f),r.push(f-i.hit_rate)}else if(6==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).sec_level_property_add;var y=i.agl*s;r.push(y),r.push(y-i.agl)}else if(7==e){for(s=1,c=1;c<=o;c++)s+=h.default.Instance.equipmentGrowMap.get(c).sec_level_property_add;var g=i.atk_speed*s;r.push(g),r.push(g-i.atk_speed)}return r},e.prototype.getEquipmentExtraSuitAttrAdd=function(t,e,a){var n=this.getEquipmentData(t),i=new Array;if(n.extraEffectId)for(var o=0;o<n.extraEffectId.length;++o)i.push([n.extraEffectId[o],n.extraEffectValue[o]]);if(a>1&&n.suitEffectId)for(3==a?a=2:a>3&&(a=3),a=a>n.suitEffectId.length?n.suitEffectId.length:a,o=0;o<a;++o)i.push([n.suitEffectId[o],n.suitEffectValue[o]]);var r=[0,0];for(o=0;o<i.length;++o){var s=h.default.Instance.extroEffectMap.get(i[o][0]);if(s){var c=0;if(5==s.buff_type)switch(e){case 1:9==s.extra_effect_type?c=i[o][1]:10==s.extra_effect_type&&(c=-i[o][1]);break;case 3:2==s.extra_effect_type?c=i[o][1]:1==s.extra_effect_type&&(c=-i[o][1]);break;case 2:7==s.extra_effect_type?c=i[o][1]:8==s.extra_effect_type&&(c=-i[o][1])}1==s.mode?r[1]+=c/100:r[0]+=c}}return r},e.prototype.getEquipmentExtraEffect=function(t,e,a){var n=[[],[]],i=l.default.Instance.playerData,o=this.getRoleEquipData(i.roleId);if(null==o)return n;for(var r=0;r<o.equipment.length;++r)if(0!=o.equipment[r]){var s=this.getEquipmentData(o.equipment[r]);if(null!=s&&1==s.equipState){var c=s.extraEffectId;if(c)for(var u=0;u<c.length;++u){var d=h.default.Instance.extroEffectMap.get(c[u]);d.buff_type==t&&d.target==e&&(null==d.skillId||d.skillId&&d.skillId.indexOf(a)>=0)&&(s.extraEffectPro[u]/100<1?n[0].push([s.equipmentIndex,1,u]):n[1].push([s.equipmentIndex,1,u]))}}}return n},e.prototype.getEquipmentExtraAttr=function(t,e,a){for(var n=this.getEquipmentExtraEffect(t,e,a),i=new Array,o=0;o<11;++o)i.push([0,0]);var r=n[1],s=n[0];if(s.length>0){var c=new Array;for(o=0;o<s.length;++o)c.push(10);var l=f.default.randomIndexByWeight(c),u=n[0][l],d=this.getEquipmentData(u[0]);Math.random()<=(1==u[1]?d.extraEffectPro[u[2]]:d.suitEffectPro[u[2]])/100&&r.push(u)}for(o=0;o<r.length;++o){u=r[o],d=this.getEquipmentData(u[0]);var p=0,y=0;1==u[1]?(p=d.extraEffectId[u[2]],y=d.extraEffectValue[u[2]]):(p=d.suitEffectId[u[2]],y=d.suitEffectValue[u[2]]);var m=h.default.Instance.extroEffectMap.get(p),g=1;if(m.is_add){var I=this.extraEffect.get(p);I?(I.time=(new Date).getTime(),(g=I.count+1)>m.add_limit&&(g=1),I.count=g):this.extraEffect.put(p,{time:(new Date).getTime(),count:1})}1==m.mode?i[m.extra_effect_type][1]+=y/100*g:i[m.extra_effect_type][0]=y*g}return i},e.prototype.getEquipmentExtraBuff=function(t,e){var a=new Array,n=[[],[]],i=l.default.Instance.playerData,o=this.getRoleEquipData(i.roleId);if(null==o)return a;for(var r=0;r<o.equipment.length;++r)if(0!=o.equipment[r]&&null!=(g=this.getEquipmentData(o.equipment[r]))&&1==g.equipState){var s=g.extraEffectId;if(s)for(var c=0;c<s.length;++c)4==(v=h.default.Instance.extroEffectMap.get(s[c])).buff_type&&v.target==e&&v.skillId.indexOf(t)>=0&&(g.extraEffectPro[c]/100<1?n[0].push([g.equipmentIndex,1,c]):n[1].push([g.equipmentIndex,1,c]))}var u=n[1],d=n[0];if(d.length>0){var p=new Array;for(r=0;r<d.length;++r)p.push(10);var y=f.default.randomIndexByWeight(p),m=n[0][y],g=this.getEquipmentData(m[0]);Math.random()<=(1==m[1]?g.extraEffectPro[m[2]]:g.suitEffectPro[m[2]])/100&&u.push(m)}for(r=0;r<u.length;++r){m=u[r],g=this.getEquipmentData(m[0]);var I=0,_=0;1==m[1]?(_=g.extraEffectId[m[2]],null==(I=g.extraEffectValue[m[2]])&&(I=3)):(_=g.suitEffectId[m[2]],I=g.suitEffectValue[m[2]]);var v=h.default.Instance.extroEffectMap.get(_);a.push([v.extra_effect_type,v.mode,I])}return a},e.prototype.getSkillAddLevel=function(t){var e=0,a=[[],[]],n=l.default.Instance.playerData,i=this.getRoleEquipData(n.roleId);if(null==i)return e;for(var o=0;o<i.equipment.length;++o)if(0!=i.equipment[o]&&null!=(g=this.getEquipmentData(i.equipment[o]))&&1==g.equipState){var r=g.extraEffectId;if(r)for(var s=0;s<r.length;++s){var c=h.default.Instance.extroEffectMap.get(r[s]);3==c.buff_type&&c.skillId.indexOf(t)>=0&&(g.extraEffectPro[s]/100<1?a[0].push([g.equipmentIndex,1,s]):a[1].push([g.equipmentIndex,1,s]))}}var u=a[1],d=a[0];if(d.length>0){var p=new Array;for(o=0;o<d.length;++o)p.push(10);var y=f.default.randomIndexByWeight(p),m=a[0][y],g=this.getEquipmentData(m[0]);Math.random()<=(1==m[1]?g.extraEffectPro[m[2]]:g.suitEffectPro[m[2]])/100&&u.push(m)}for(o=0;o<u.length;++o){var I;m=u[o],g=this.getEquipmentData(m[0]),(I=1==m[1]?g.extraEffectValue[m[2]]:g.suitEffectValue[m[2]])>e&&(e=Math.floor(I))}return e},e.prototype.recordArmKillMonster=function(){var t=this.getRoleEquipData(l.default.Instance.playerData.roleId);if(null!=t&&0!=t.equipment[1]){var e=this.getEquipmentData(t.equipment[1]);e.killMonsterCount?e.killMonsterCount+=1:e.killMonsterCount=1;var a=h.default.Instance.equipmentMap.get(e.equipmentId);if(3==a.type){var n=h.default.Instance.extroEffectMap.get(7001);if(e.killMonsterCount-a.tip*n.monster_num>=0){console.log(" \u88c5\u5907\u5347\u7ea7 ");var i=h.default.Instance.growthEquipmentMap.get(a.tip+1);i&&(e.equipmentId=i.id,e.equipmentLevel=i.equip_lvl,e.equipmentAtk=Math.round(i.atk*(e.equipmentAtk/a.atk)),e.equipmentHp=Math.round(i.hp*(e.equipmentHp/a.hp)),e.equipmentDef=Math.round(i.def*(e.equipmentDef/a.def)),e.equipmentScore=(1*e.equipmentAtk+.125*e.equipmentHp+1*e.equipmentDef)*(i.crit_rate+i.hit_rate+i.agl+i.atk_speed),e.placeRatio=[[1.5,1.5],[1,1],[1,1],[1,1],[1,1],[1,1]][e.equipPlace-1],e.qualityRatio=[[.5,.05],[.7,.07],[.8,.08],[1,.1]][i.quality-1],e.levelRatio={1:[1,1],5:[1.2,1.2],10:[1.4,1.4],15:[1.7,1.7],20:[2.5,2.5],25:[3,3],30:[4,4],35:[5,5],40:[6,6],45:[8,8],50:[10,10],55:[12,12],60:[15,15]}[i.equip_lvl],l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart()))}}}},e.prototype.getAllEquipmentAttr=function(t){var e=[0,0,0,0,0,0,0,0],a=null==t?l.default.Instance.playerData.roleId:t,n=this.getRoleEquipData(a);if(null==n)return e;for(var i=0;i<n.equipment.length;++i)if(0!=n.equipment[i]){var o=this.getEquipmentData(n.equipment[i]);if(null!=o&&1==o.equipState)for(var r=1;r<8;++r){var s=this.getEquipmentAttr(o.equipmentIndex,r)[0];e[r]+=s}}return e},e.prototype.getAllEquipmentExtraAttr=function(t){var e=[[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1]],a=null==t?l.default.Instance.playerData.roleId:t,n=this.getRoleEquipData(a);if(null==n)return e;for(var i=new Array,o=0;o<n.equipment.length;++o)if(0!=n.equipment[o]){var r=this.getEquipmentData(n.equipment[o]);if(null!=r&&1==r.equipState){var s=h.default.Instance.equipmentMap.get(r.equipmentId),c=0;2==s.type&&i.indexOf(s.tip)<0&&(c=this.getSuitCountByTips(a,s.tip),i.push(s.tip));for(var u=1;u<8;++u){var d=this.getEquipmentExtraSuitAttrAdd(r.equipmentIndex,u,c);e[u][0]+=d[0],e[u][1]+=d[1]}}}return e},e.prototype.getFashionAttr=function(t){var e=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],a=null==t?l.default.Instance.playerData.roleId:t,n=l.default.Instance.playerData.wearFashionList,i=n[0],o=n[1],r=n[2];if(a!=l.default.Instance.playerData.roleId||i+o+r==0)return e;for(var s=0;s<3;++s)if(0!=n[s]){var c=h.default.Instance.equipmentMap.get(n[s]);if(null!=c)for(var u=c.extraEffectId,d=0;d<u.length;++d){var p=h.default.Instance.extroEffectMap.get(u[d]),f=0,y=0;switch(p.extra_effect_type){case 9:f=p.effectValue[0],y=1;break;case 10:f=-p.effectValue[0],y=1;break;case 1:f=-p.effectValue[0],y=3;break;case 2:f=p.effectValue[0],y=3;break;case 7:f=p.effectValue[0],y=2;break;case 8:f=-p.effectValue[0],y=2}1==p.mode?e[y][1]+=f/100:e[y][0]+=f}}return e},e.prototype.getHeroTitleAttr=function(t){var e=l.default.Instance.playerData.heroTitleList,a=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]];if((null==t?l.default.Instance.playerData.roleId:t)!=l.default.Instance.playerData.roleId||0==e.length)return a;for(var n=0;n<e.length;++n){var i=e[n];if(i.continueTime>0){var o=h.default.Instance.equipmentMap.get(i.buffId);a[1][0]+=o.atk,a[2][0]+=o.hp,a[3][0]+=o.def}}return a},e.prototype.getTalentAttr=function(){for(var t=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],e=1;e<11;++e){var a=h.default.Instance.talentSkillTypeMap.get(1).get(e),n=l.default.Instance.playerData.talentSkill[1][a.skill_number];t[1][0]+=a.atk_grwo*n,t[2][0]+=a.hp_grow*n,t[3][0]+=a.def_grow*n;var i=h.default.Instance.talentSkillTypeMap.get(2).get(e),o=l.default.Instance.playerData.talentSkill[2][i.skill_number];t[1][0]+=i.atk_grwo*o,t[2][0]+=i.hp_grow*o,t[3][0]+=i.def_grow*o}return t},e.prototype.getSuitCountByTips=function(t,e){var a=0,n=null==t?l.default.Instance.playerData.roleId:t,i=this.getRoleEquipData(n);if(null==i)return a;for(var o=0;o<i.equipment.length;++o)if(0!=i.equipment[o]){var r=this.getEquipmentData(i.equipment[o]);if(null!=r&&1==r.equipState){var s=h.default.Instance.equipmentMap.get(r.equipmentId);2==s.type&&s.tip==e&&(a+=1)}}return a},e.prototype.getPropData=function(t){for(var e=l.default.Instance.playerData,a=0;a<e.propList.length;++a){var n=e.propList[a];if(n.propId==t)return n}return null},e.prototype.getPropCount=function(){for(var t=l.default.Instance.playerData,e=0,a=0;a<t.propList.length;++a){var n=t.propList[a],i=n.count;1==h.default.Instance.itemMap.get(n.propId).is_show&&i>0&&(e+=1)}return e},e.prototype.addPropData=function(t,e){var a=this.getPropData(t);if(null==a){var n=h.default.Instance.itemMap.get(t);a=new c.default(t,n.quality,1),l.default.Instance.playerData.propList.push(a)}a.count=e,l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())},e.prototype.getQualityName=function(t){var e="";switch(t){case 1:e="\u666e\u901a";break;case 2:e="\u7a00\u6709";break;case 3:e="\u7f55\u89c1";break;case 4:e="\u53f2\u8bd7";break;default:e="\u666e\u901a"}return e},e.prototype.getPlaceName=function(t){var e="";switch(t){case 1:e="\u6b66\u5668";break;case 2:e="\u4e0a\u8863";break;case 3:e="\u8170\u5e26";break;case 4:e="\u88e4\u5b50";break;case 5:e="\u9879\u94fe";break;case 6:e="\u6212\u6307";break;default:e="\u65e0"}return e},e.prototype.getEquipmentAttrType=function(t){var e=new Array,a=h.default.Instance.equipmentMap.get(t);return a.atk&&e.push(1),a.hp&&e.push(2),a.def&&e.push(3),a.crit_rate&&e.push(4),a.hit_rate&&e.push(5),a.agl&&e.push(6),a.atk_speed&&e.push(7),e},e.prototype.getEquipmentStrengthIndex=function(){for(var t=new Array,e=l.default.Instance.playerData,a=0;a<e.equipmentList.length;++a){var n=e.equipmentList[a],i=h.default.Instance.equipmentGrowMap.get(n.strengthLevel+1);if(null!=i){for(var o=i.costValue,r=d.default.Instance.equipmentLogic.strengthEquipmentCost(o,n.equipmentIndex),s=!0,c=0;c<r.length;++c)if(!(d.default.Instance.moneyLogic.getItemCount(r[c][0])>=r[c][1])){s=!1;break}s&&t.push(n.equipmentIndex)}}return t},e.prototype.getRoleEquipData=function(t){for(var e=l.default.Instance.playerData.roleEquipInfo,a=0;a<e.length;++a)if(t==e[a].roleId)return e[a];return null},e.prototype.checkRoleEquipData=function(){for(var t=l.default.Instance.playerData.equipmentList,e=d.default.Instance.equipmentLogic.getRoleEquipData(1001),a=0;a<t.length;++a)if(1==t[a].equipState){var n=t[a].equipPlace;e.equipment.indexOf(t[a].equipmentIndex)<0&&d.default.Instance.equipmentLogic.roleEquipArm(1001,t[a].equipmentIndex,n)}var i=this.getRoleEquipData(1001);if(i)for(a=1;a<=6;++a){var o=i.equipment[a];null==this.getEquipmentData(o)&&d.default.Instance.equipmentLogic.roleEquipArm(1001,0,a)}l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())},e.prototype.getRoleEquipmentData=function(t,e){var a=this.getRoleEquipData(t);if(null==a)return null;var n=a.equipment[e];return this.getEquipmentData(n)},e.prototype.getRoleEquipmentScore=function(t,e){var a=new Array,n=this.getRoleEquipmentData(l.default.Instance.playerData.roleId,e);if(n){var i=h.default.Instance.equipmentMap.get(n.equipmentId),o=n.equipmentBasicScore?n.equipmentBasicScore:(1*n.equipmentAtk+.125*n.equipmentHp+1*n.equipmentDef)*(i.crit_rate+i.hit_rate+i.agl+i.atk_speed);a.push(o),a.push(n.equipmentScore)}else a.push(0),a.push(0);return a},e.prototype.getPropTipStatus=function(){for(var t=l.default.Instance.playerData.propList,e=0;e<t.length;++e)if(0!=t[e].count){var a=h.default.Instance.itemMap.get(t[e].propId);if(7==a.type||14==a.type)return!0}return!1},e.prototype.getMostSuitEquipment=function(t){for(var e=l.default.Instance.playerData.equipmentList,a=new Array,n=this.getRoleEquipmentScore(l.default.Instance.playerData.roleId,t)[0],i=0;i<e.length;++i){var o=e[i],r=h.default.Instance.equipmentMap.get(o.equipmentId);(o.equipmentBasicScore?o.equipmentBasicScore:(1*o.equipmentAtk+.125*o.equipmentHp+1*o.equipmentDef)*(r.crit_rate+r.hit_rate+r.agl+r.atk_speed))>n&&a.push(o.equipmentIndex)}return a},e.prototype.getRoleEquipArmCount=function(t){var e=this.getRoleEquipData(t);if(null==e)return 0;for(var a=0,n=0;n<e.equipment.length;++n)0!=e.equipment[n]&&(a+=1);return a},e.prototype.roleEquipArm=function(t,e,a){var n=this.getRoleEquipData(t);null==n&&(n=new u.default(t),l.default.Instance.playerData.roleEquipInfo.push(n)),n.equipment[a]=e,1==a&&(d.default.Instance.combatScene.homeLayer.streetLayer.streetHero&&d.default.Instance.combatScene.homeLayer.streetLayer.streetHero.review(),d.default.Instance.combatScene.popLayer.equipmentLayer&&d.default.Instance.combatScene.popLayer.equipmentLayer.updateWeapon(e)),d.default.Instance.taskLogic.finishAllTask(y.default.type_wear_equipment,this.getRoleEquipArmCount(l.default.Instance.playerData.roleId),1),l.default.Instance.localStorage(d.default.Instance.combatScene.isGameStart())},e.prototype.roleEquipmentIndexByPlace=function(t,e){var a=this.getRoleEquipData(t);return null==a?0:a.equipment[e]},e.prototype.strengthEquipmentCost=function(t,e){for(var a=this.getEquipmentData(e),n=new Array,i=0;i<t.length;++i){var o=t[i],r=o[1]*a.placeRatio[0]*a.qualityRatio[0]*a.levelRatio[0];n.push([o[0],Math.round(r)])}return n},e.prototype.addStrengthItem=function(t,e){for(var a=this.getEquipmentData(t),n=!1,i=0;i<a.strengthCost.length;++i)a.strengthCost[i][0]==e[0]&&(n=!0,a.strengthCost[i][1]+=e[1]);n||a.strengthCost.push([e[0],e[1]])},e.prototype.getStrengthResult=function(t){var e=!1,a=this.getEquipmentData(t),n=h.default.Instance.equipmentGrowMap.get(a.strengthLevel+1);return Math.random()<=n.succes_probability&&(e=!0),e},e.prototype.strengthCostItem=function(t){for(var e=0;e<t.length;e++){var a=t[e],n=a[0],i=a[1],o=h.default.Instance.itemMap.get(n);this.receiveItem(o,-i)}d.default.Instance.tipsLogic.updateAllTips()},e.prototype.getResolveItem=function(t,e){for(var a=this.getEquipmentData(t),n=0;n<a.strengthCost.length;++n)if(a.strengthCost[n][0]==e)return a.strengthCost[n][1];return 0},e.prototype.resolveEquipmentReward=function(t,e){for(var a=this.getEquipmentData(e),n=new Array,i=0;i<t.length;++i){var o=t[i],r=o[1]*a.placeRatio[1]*a.qualityRatio[1]*a.levelRatio[1];r=Math.round(r+.25*this.getResolveItem(e,o[0])),n.push([o[0],r])}return n},e.prototype.receiveItem=function(t,e){d.default.Instance.moneyLogic.addItemCount(t.id,e)},e}(cc.Component);o.default=g,cc._RF.pop()},{}],ExtroEffectInfo:[function(t,e,a){"use strict";cc._RF.push(e,"7b1a9pg2l5Be7yqQfhxoUiu","ExtroEffectInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.buff_type=o.default.stringToInt(t.buff_type),this.probability=t.probability,this.probabilityNum=o.default.config_stringToFloatList(this.probability,"_"),this.probability_quality_coefficient=t.probability_quality_coefficient,this.probabilityQualityCoefficient=o.default.config_stringToFloatList(this.probability_quality_coefficient),this.probability_lvl_coefficient=o.default.stringToFloat(t.probability_lvl_coefficient),this.skill_id=t.skill_id,this.skillId=o.default.config_stringToIntList(this.skill_id),this.skill_buff_id=t.skill_buff_id,this.skillBuffId=o.default.config_stringToIntList(this.skill_buff_id),this.target=o.default.stringToInt(t.target),this.monster_num=o.default.stringToInt(t.monster_num),this.extra_effect_type=o.default.stringToInt(t.extra_effect_type),this.mode=o.default.stringToInt(t.mode),this.effect_value=t.effect_value,this.effectValue=o.default.config_stringToFloatList(this.effect_value,"_"),this.effect_quality_coefficient=t.effect_quality_coefficient,this.effectQualityCoefficient=o.default.config_stringToFloatList(this.effect_quality_coefficient),this.effect_lvl_coefficient=o.default.stringToFloat(t.effect_lvl_coefficient),this.is_add=o.default.stringToInt(t.is_add),this.add_limit=o.default.stringToInt(t.add_limit),this.effect_disappear_condition=o.default.stringToInt(t.effect_disappear_condition),this.condition_value=o.default.stringToInt(t.condition_value),this.introduce=t.introduce},cc._RF.pop()},{}],FashionGrid:[function(t,e,a){"use strict";cc._RF.push(e,"fcdd0geL8lPMqVzodIK2Hpp","FashionGrid");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("AssetUtils"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridType=0,e.itemType=0,e.equipmentId=-1,e.getType=0,e}return r(e,t),e.prototype.init=function(t,e,a,n,i){this.fashionLayer=t,this.gridType=e,this.itemType=a,this.getType=i,this.bgNode=cc.find("Bg",this.node),this.itemNode=cc.find("Item",this.node),this.nameNode=cc.find("Name",this.node),this.selectedNode=cc.find("Selected",this.node),this.review(n,i)},e.prototype.review=function(t,e){if(t!=this.equipmentId)if(this.equipmentId=t,0==t)h.AssetUtils.loadSpriteFrame(this.bgNode,"Common/common_quality_0"),this.itemNode.active=!1,this.nameNode.active=!1;else{this.itemNode.active=!0,this.nameNode.active=!0;var a=l.default.Instance.equipmentMap.get(t);h.AssetUtils.loadSpriteFrame(this.bgNode,"Common/common_quality_"+a.quality),h.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+a.icon),h.AssetUtils.loadSpriteFrame(this.nameNode,"Fasion/fashion_name_"+a.id)}e!=this.getType&&(this.getType=e),1==this.gridType&&(this.node.opacity=0==t?0:255)},e.prototype.selectedFashion=function(t){this.selectedNode.active=t==this.equipmentId},e.prototype.onClickBtn=function(t,e){c.SoundManager.Instance.playEffect("anniu"),1==e&&1==this.gridType&&0!=this.equipmentId&&this.fashionLayer.flashFashion(this.itemType,this.equipmentId)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],FashionLayer:[function(t,e,a){"use strict";cc._RF.push(e,"9a881u4t8JGNpFJLXvAbknp","FashionLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("SoundManager"),h=i("ConfigData"),u=i("GameData"),d=i("AssetUtils"),p=i("StringUtils"),f=i("MainLogic"),y=i("FashionGrid"),m=cc._decorator,g=m.ccclass,I=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fashionPrefa=null,e.fashionItems1=new Array,e.selectedFashionId1=0,e.fashionItems2=new Array,e.selectedFashionId2=0,e.fashionItems3=new Array,e.selectedFashionId3=0,e.listType=1,e.equipItems=new Array,e.getTypes={},e}return r(e,t),e.prototype.init=function(t){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.heroNode=cc.find("Layer/Hero",this.node),this.listView1=cc.find("Layer/List1",this.node).getComponent(cc.ScrollView),this.listView2=cc.find("Layer/List2",this.node).getComponent(cc.ScrollView),this.listView3=cc.find("Layer/List3",this.node).getComponent(cc.ScrollView);for(var e=0;e<6;++e){(c=(s=cc.instantiate(this.fashionPrefa)).getComponent(y.default)).init(this,1,1,0,0),this.listView1.content.addChild(s),this.fashionItems1.push(c);var a=cc.instantiate(this.fashionPrefa),n=a.getComponent(y.default);n.init(this,1,2,0,0),this.listView2.content.addChild(a),this.fashionItems2.push(n);var i=cc.instantiate(this.fashionPrefa),o=i.getComponent(y.default);o.init(this,1,3,0,0),this.listView3.content.addChild(i),this.fashionItems3.push(o)}this.equipNode=cc.find("Layer/Equip",this.node);var r=u.default.Instance.playerData.wearFashionList;for(this.selectedFashionId1=r[0],this.selectedFashionId2=r[1],this.selectedFashionId3=r[2],this.heroScript=f.default.Instance.sceneNodeManager.getHeroArmature(1001,r[0],r[1],r[2],0),this.heroNode.addChild(this.heroScript.node),e=0;e<3;++e){var s,c;(c=(s=cc.instantiate(this.fashionPrefa)).getComponent(y.default)).init(this,2,1+e,r[e],0),this.equipNode.addChild(s),s.x=[-130,0,130][e],s.y=0,this.equipItems.push(c)}var l=f.default.Instance.shopLogic.getFashion(1);for(e=0;e<l.length;++e)(p=this.fashionItems1[e]).review(l[e].itemList[0][1],l[e].get_way),this.getTypes[l[e].itemList[0][1]]=l[e].get_way,p.selectedFashion(this.selectedFashionId1);var h=f.default.Instance.shopLogic.getFashion(2);for(e=0;e<h.length;++e)(p=this.fashionItems2[e]).review(h[e].itemList[0][1],h[e].get_way),this.getTypes[h[e].itemList[0][1]]=h[e].get_way,p.selectedFashion(this.selectedFashionId2);var d=f.default.Instance.shopLogic.getFashion(3);for(e=0;e<d.length;++e){var p;(p=this.fashionItems3[e]).review(d[e].itemList[0][1],d[e].get_way),this.getTypes[d[e].itemList[0][1]]=d[e].get_way,p.selectedFashion(this.selectedFashionId3)}this.review(t)},e.prototype.review=function(t){var e;this.node.active=!0,this.pageName=t,e=1==this.listType?this.selectedFashionId1:2==this.listType?this.selectedFashionId2:this.selectedFashionId3,this.showStatus(e),this.showAttr(),this.showMoney()},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=p.default.stringToWord(f.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+p.default.stringToWord(f.default.Instance.moneyLogic.getItemCount(1004))},e.prototype.flashFashion=function(t,e){if(1==t){for(var a=0;a<this.fashionItems1.length;++a)this.fashionItems1[a].selectedFashion(e);this.selectedFashionId1=e}else if(2==t){for(a=0;a<this.fashionItems2.length;++a)this.fashionItems2[a].selectedFashion(e);this.selectedFashionId2=e}else if(3==t){for(a=0;a<this.fashionItems3.length;++a)this.fashionItems3[a].selectedFashion(e);this.selectedFashionId3=e}this.updateRoleArm(),this.showStatus(e)},e.prototype.flashEquipments=function(){for(var t=u.default.Instance.playerData.wearFashionList,e=0;e<this.equipItems.length;++e)this.equipItems[e].review(t[e],0);f.default.Instance.combatScene.homeLayer.streetLayer.streetHero.updateHeroArm(),this.showAttr()},e.prototype.showStatus=function(t){var e=0,a=this.getTypes[t];u.default.Instance.playerData.wearFashionList.indexOf(t)>=0&&0!=t?e=2:u.default.Instance.playerData.fashionList.indexOf(t)>=0&&0!=t?e=1:2==a&&0!=t?e=4:1==a&&0!=t?e=3:3==a&&0!=t?e=5:4==a&&0!=t?e=6:5==a&&0!=t?e=7:6==a&&0!=t&&(e=8);for(var n=1;n<=8;++n){var i=cc.find("Layer/Status"+n,this.node);if(i.active=n==e,8==n){var o=h.default.Instance.equipmentMap.get(t),r=(cc.find("Status8",i),cc.find("Status9",i));if(o&&2==o.composeWay[0]){r.active=!0;var s=cc.find("Cost/Item",r),c=cc.find("Frament",s),l=o.composeWay[2],p=h.default.Instance.itemMap.get(l);p&&(d.AssetUtils.loadSpriteFrame(s,"Common/"+p.icon),c.active=1==p.is_chip);var y=f.default.Instance.moneyLogic.getItemCount(l);cc.find("Cost/Count",r).getComponent(cc.Label).string="("+y+"/"+o.composeWay[3]+")"}else r.active=!1}}},e.prototype.updateRoleArm=function(){var t=u.default.Instance.playerData.wearFashionList,e=0==this.selectedFashionId1?t[0]:this.selectedFashionId1,a=0==this.selectedFashionId2?t[1]:this.selectedFashionId2,n=0==this.selectedFashionId3?t[2]:this.selectedFashionId3;this.heroScript.resetSlot(e,a,n,0)},e.prototype.showAttr=function(){for(var t=u.default.Instance.playerData.wearFashionList,e=new Array,a=new Array,n=new Array,i=0;i<3;++i)if(0!=t[i])for(var o=h.default.Instance.equipmentMap.get(t[i]).extraEffectId,r=0;r<o.length;++r){var s=(m=h.default.Instance.extroEffectMap.get(o[r])).extra_effect_type,c=e.indexOf(s),l=m.introduce;if(c>=0){for(var d=["{probability}","{effect_value}"],p=0;p<d.length;++p)if(l.indexOf(d[p])>=0)switch(p){case 0:n[c]+=m.probabilityNum[0];break;case 1:n[c]+=m.effectValue[0]}}else{e.push(s),a.push(o[r]),d=["{probability}","{effect_value}"];for(var f=0;f<d.length;++f)if(l.indexOf(d[f])>=0)switch(f){case 0:n.push(m.probabilityNum[0]);break;case 1:n.push(m.effectValue[0])}}}for(i=1;i<=10;++i){var y=cc.find("Layer/Attr/Attr"+i,this.node);if(i<=a.length){y.active=!0;for(var m,g=a[i-1],I=(l=(m=h.default.Instance.extroEffectMap.get(g)).introduce,d=["{probability}","{effect_value}"],0);I<d.length;++I)if(l.indexOf(d[I])>=0)switch(I){case 0:l=l.replace(d[I],n[I-1]+"%");break;case 1:l=1==m.mode?l.replace(d[I],n[I-1]+"%"):l.replace(d[I],n[I-1]+"")}y.getComponent(cc.Label).string=l}else y.active=!1}},e.prototype.onClickBtn=function(t,e){if(l.SoundManager.Instance.playEffect("anniu"),1==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer();else if(2==e)this.listType=1,this.listView1.node.active=!0,this.listView2.node.active=!1,this.listView3.node.active=!1,this.showStatus(this.selectedFashionId1);else if(3==e)this.listType=2,this.listView1.node.active=!1,this.listView2.node.active=!0,this.listView3.node.active=!1,this.showStatus(this.selectedFashionId2);else if(4==e)this.listType=3,this.listView1.node.active=!1,this.listView2.node.active=!1,this.listView3.node.active=!0,this.showStatus(this.selectedFashionId3);else if(11==e){var a=0;a=1==this.listType?this.selectedFashionId1:2==this.listType?this.selectedFashionId2:this.selectedFashionId3,u.default.Instance.playerData.wearFashionList[this.listType-1]=a,u.default.Instance.localStorage(!1),this.flashEquipments(),this.showStatus(a)}else if(12==e)a=0,a=1==this.listType?this.selectedFashionId1:2==this.listType?this.selectedFashionId2:this.selectedFashionId3,u.default.Instance.playerData.wearFashionList[this.listType-1]=0,u.default.Instance.localStorage(!1),this.flashEquipments(),this.showStatus(a);else if(13==e)this.node.active=!1,f.default.Instance.combatScene.homeLayer.hideNode(),f.default.Instance.combatScene.popLayer.reviewPassCheckLayer();else if(14==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer(),f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewLotteryLayer(c.PAGE_NAME.Home);else if(15==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer(),f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(1);else if(16==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer(),f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(2);else if(17==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer(),f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewActivityLayer(1);else if(18==e)this.node.active=!1,f.default.Instance.combatScene.gotoHomeLayer(),f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewShopLayer(2,3);else if(19==e){a=0,a=1==this.listType?this.selectedFashionId1:2==this.listType?this.selectedFashionId2:this.selectedFashionId3;var n=h.default.Instance.equipmentMap.get(a),i=n.composeWay[2],o=n.composeWay[3];f.default.Instance.moneyLogic.getItemCount(i)>=o?(u.default.Instance.playerData.fashionList.push(a),u.default.Instance.localStorage(f.default.Instance.combatScene.isGameStart()),this.showStatus(a)):f.default.Instance.moneyLogic.showMoreMoney(c.PAGE_NAME.Home,i,!0)}},s([I(cc.Prefab)],e.prototype,"fashionPrefa",void 0),s([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{}],FestivalInfo:[function(t,e,a){"use strict";cc._RF.push(e,"755b7HachFBAakGTUc9wlZp","FestivalInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.festival_type=o.default.stringToInt(t.festival_type),this.festival_name=t.festival_name,this.festival_title_res=t.festival_title_res,this.task_type=o.default.stringToInt(t.task_type),this.type_key=t.type_key,this.typeKeys=o.default.config_stringToIntList(this.type_key,","),this.gift_id=t.gift_id,this.giftIds=o.default.config_stringToIntList(this.gift_id,","),this.festival_start_time=t.festival_start_time,this.festival_end_time=t.festival_end_time,this.target_des=t.target_des,this.reward_des=t.reward_des,this.details_des=t.details_des},cc._RF.pop()},{}],FightMapData:[function(t,e,a){"use strict";cc._RF.push(e,"2b5f2dyiddBOYqNN+x3a0VP","FightMapData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("MyMathUtils"),r=n("RectCircle"),s=function(){function t(t){this.wallPointsList=new Array,this.doorPointsList=new Array,this.showWallList=new Array,this.showDoorList=new Array,this.npcPointsList=new Array,this.heroPosList=new Array,this.monsterPosList=new Array,this.elitePosList=new Array,this.bossPosList=new Array,this.syPosList=new Array,this.boundaryPoint=new Array,this.mapLeftX=0,this.mapBottomY=0,this.mapRightX=0,this.mapTopY=0,this.gridWidth=50,this.gridHeight=50,this.gridMaxX=0,this.gridMaxY=0,this.grids=[],this.fightMap=t,this.initData()}return t.prototype.initData=function(){this.parsetWall(),this.parseDoor(),this.parseMonster(),this.parseBoundary(),this.parseNpc()},t.prototype.resetFightMapData=function(){var t=cc.v2(0-this.fightMap.bgRect.width/2,0-this.fightMap.bgRect.height/2),e=Math.floor(this.fightMap.bgRect.height/this.gridHeight);this.gridMaxX=e;var a=Math.floor(this.fightMap.bgRect.width/this.gridWidth);this.gridMaxY=a,this.grids=[];for(var n=0;n<e;++n){var i=n*this.gridHeight;this.grids[n]=[];for(var o=0;o<a;++o){var r=o*this.gridWidth,s=cc.v2(t.x+r,t.y+i),c={isGo:!this.objectInWall(s.x,s.y,this.gridWidth,this.gridHeight).inWall,gridX:n,gridY:o,x:s.x+this.gridWidth/2,y:s.y+this.gridHeight/2};this.grids[n].push(c)}}},t.prototype.parsetWall=function(){for(var t=this.fightMap.wallNode.children,e=0;e<t.length;e++){var a=t[e],n=a.x,i=a.y,r=a.width,s=a.height,c=a.angle;this.wallPointsList.push([n-r/2,i-s/2,r,s,o.default.toRadian(c)])}},t.prototype.parseDoor=function(){for(var t=this.fightMap.doorNode.children,e=0;e<t.length;e++){var a=t[e],n=a.x,i=a.y,r=a.width,s=a.height,c=a.angle;this.doorPointsList.push([n-r/2,i-s/2,r,s,o.default.toRadian(c),e+1])}},t.prototype.parseMonster=function(){for(var t=this.fightMap.monsterNode.children,e=0;e<t.length;e++){var a=t[e],n=a.x,i=a.y;a.name.indexOf("hero")>=0?this.heroPosList.push(cc.v2(n,i)):"boss"==a.name?this.bossPosList.push(cc.v2(n,i)):"elite"==a.name?this.elitePosList.push(cc.v2(n,i)):"sy"==a.name?this.syPosList.push(cc.v2(n,i)):this.monsterPosList.push(cc.v2(n,i))}},t.prototype.parseBoundary=function(){for(var t=this.fightMap.boundaryNode.children,e=0;e<t.length;e++){var a=t[e],n=a.x,i=a.y;"Left1"==a.name?this.mapLeftX=n:"Bottom"==a.name?this.mapBottomY=i:"Right1"==a.name?this.mapRightX=n:"Top"==a.name&&(this.mapTopY=i),this.boundaryPoint.push(cc.v2(n,i))}},t.prototype.parseNpc=function(){var t=this.fightMap.npcNode;if(t)for(var e=t.children,a=0;a<e.length;a++){var n=e[a],i=n.x,r=n.y,s=n.width,c=n.height,l=n.angle;this.npcPointsList.push([i-s/2,r-c/2,s,c,o.default.toRadian(l),n.name])}},t.prototype.getMonsterPosList=function(t,e){var a=new Array;if(1==e)for(var n=this.monsterPosList.length-t,i=o.default.randomInt(0,n);i<this.monsterPosList.length;++i)a.push(this.monsterPosList[i]);else if(2==e)for(n=this.elitePosList.length-t,i=o.default.randomInt(0,n);i<this.elitePosList.length;++i)a.push(this.elitePosList[i]);else if(3==e)for(n=this.bossPosList.length-t,i=o.default.randomInt(0,n);i<this.bossPosList.length;++i)a.push(this.bossPosList[i]);else if(4==e)for(n=this.syPosList.length-t,i=o.default.randomInt(0,n);i<this.syPosList.length;++i)a.push(this.syPosList[i]);return a},t.prototype.resetShowDoor=function(t){this.showDoorList=[];for(var e=0;e<t.length;++e)this.showDoorList.push(this.doorPointsList[t[e]-1])},t.prototype.resetMapInfo=function(t){this.showWallList=[],t.indexOf(1)>=0?(this.showWallList.push(this.wallPointsList[0]),this.mapLeftX=this.boundaryPoint[0].x):(this.showWallList.push(this.wallPointsList[1]),this.mapLeftX=this.boundaryPoint[1].x),this.showWallList.push(this.wallPointsList[2]),this.showWallList.push(this.wallPointsList[3]),t.indexOf(3)>=0?(this.showWallList.push(this.wallPointsList[4]),this.mapRightX=this.boundaryPoint[3].x):(this.showWallList.push(this.wallPointsList[5]),this.mapRightX=this.boundaryPoint[4].x)},t.prototype.getHeroPos=function(t){return this.heroPosList[t-1]},t.prototype.objectInWall=function(t,e,a,n){for(var i=r.default.newRect(cc.v2(t,e),a,n),o={},s=!1,c=0,l=0,h=0;h<this.showWallList.length;h++){var u=this.showWallList[h],d=new cc.Rect(u[0],u[1],u[2],u[3]);r.default.rectCollideRect(d,u[4],i,0)&&(s=!0,c=u[4],l++)}return o.inWall=s,o.angle=c,o.times=l,o},t.prototype.objectDoor=function(t,e,a,n){for(var i=r.default.newRect(cc.v2(t,e),a,n),o={},s=!1,c=0,l=0;l<this.showDoorList.length;l++){var h=this.showDoorList[l],u=new cc.Rect(h[0],h[1],h[2],h[3]);if(r.default.rectCollideRect(u,h[4],i,0)){s=!0,h[4],c=h[5];break}}return o.inDoor=s,o.index=c,o},t.prototype.objectNpc=function(t,e,a,n){for(var i=r.default.newRect(cc.v2(t,e),a,n),o={},s=!1,c="",l=0;l<this.npcPointsList.length;l++){var h=this.npcPointsList[l],u=new cc.Rect(h[0],h[1],h[2],h[3]);if(r.default.rectCollideRect(u,h[4],i,0)){s=!0,h[4],c=h[5];break}}return o.inNpc=s,o.name=c,o},t.prototype.getHitRightPos=function(t,e,a,n,i){var o=cc.v2(t.x+e*a,t.y);return o.y>this.mapBottomY&&o.y<this.mapTopY||(o.y<this.mapBottomY?o.y=this.mapBottomY+i/2+20:o.y>this.mapTopY&&(o.y=this.mapTopY-i/2-20)),o.x>this.mapLeftX&&o.x<this.mapRightX||(o.x<this.mapLeftX?o.x=this.mapLeftX+n/2+20:o.x>this.mapRightX&&(o.x=this.mapRightX-n/2-20)),this.objectInWall(o.x,o.y,n,i).inWall&&(o.x=t.x),o},t.prototype.getJumpBackPos=function(t,e,a,n,i){var o=cc.v2(t.x-a*e,t.y);return o.x>this.mapLeftX&&o.x<this.mapRightX||(o.x<this.mapLeftX?(o.x=this.mapLeftX+n/2+20,o.x>t.x&&(o.x=t.x)):o.x>this.mapRightX&&(o.x=this.mapRightX-n/2-20,o.x<t.x&&(o.x=t.x))),this.objectInWall(o.x,o.y,n,i).inWall&&(o.x=t.x),o},t.prototype.getItemDropPos=function(t){return t.y>this.mapBottomY&&t.y<this.mapTopY||(t.y<this.mapBottomY?t.y=this.mapBottomY+30:t.y>this.mapTopY&&(t.y=this.mapTopY-30)),t.x>this.mapLeftX&&t.x<this.mapRightX||(t.x<this.mapLeftX?t.x=this.mapLeftX+30:t.x>this.mapRightX&&(t.x=this.mapRightX-30)),t},t.prototype.getRightPos=function(t){var e=cc.v2(t.x,t.y);return t.x<this.mapLeftX?e.x=this.mapLeftX+20:t.x>this.mapRightX&&(e.x=this.mapRightX-20),t.y>this.mapTopY?e.y=this.mapTopY-20:t.y<this.mapBottomY&&(e.y=this.mapBottomY+20),e},t.prototype.findAccess=function(t,e){var a=this.getGridIndex(t),n=this.getGridInfo(a),i=this.getGridIndex(e),o=(this.getGridInfo(i),[]),r=[],s={isGo:n.isGo,gridX:n.gridX,gridY:n.gridY,fCost:this.getDistanceNodes(a,i),hCost:this.getDistanceNodes(a,i),gCost:0,parent:null};for(o.push(s);o.length>0;){for(var c=o[0],l=o.length,h=0;h<l;h++)o[h].fCost<=c.fCost&&(c=o[h]);if(o.splice(o.indexOf(c),1),r.push(c),c.gridX==i.x&&c.gridY==i.y)return this.generatePath(s,c);var u=this.getNeibourhood(cc.v2(c.gridX,c.gridY));for(h=0;h<u.length;++h){var d={isGo:u[h].isGo,gridX:u[h].gridX,gridY:u[h].gridY,fCost:0,hCost:0,gCost:0,parent:null};if(d.isGo&&!this.existList(r,d)){var p=c.gCost+this.getDistanceNodes(cc.v2(c.gridX,c.gridY),cc.v2(d.gridX,d.gridY));(p<d.gCost||!this.existList(o,d))&&(d.gCost=p,d.hCost=this.getDistanceNodes(cc.v2(d.gridX,d.gridY),i),d.fCost=d.gCost+d.hCost,d.parent=c,this.existList(o,d)||o.push(d))}}}return[]},t.prototype.getDistanceNodes=function(t,e){var a=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y);return a>n?14*n+10*(a-n):14*a+10*(n-a)},t.prototype.getNeibourhood=function(t){for(var e=[],a=[cc.v2(-1,0),cc.v2(0,1),cc.v2(1,0),cc.v2(0,-1)],n=0;n<a.length;n++){var i=t.x+a[n].x,o=t.y+a[n].y;if(i>=0&&i<this.gridMaxX&&o>=0&&o<this.gridMaxY){var r=this.getGridInfo(cc.v2(i,o));e.push(r)}}return e},t.prototype.existList=function(t,e){for(var a=0;a<t.length;++a){var n=t[a];if(n.gridX==e.gridX&&n.gridY==e.gridY)return!0}return!1},t.prototype.generatePath=function(t,e){var a=[];if(null!=e){for(var n=e;n!=t;)a.push(this.getGridInfo(cc.v2(n.gridX,n.gridY))),n=n.parent;a.reverse()}return a},t.prototype.getGridIndex=function(t){var e=Math.floor((t.x+this.fightMap.bgRect.width/2)/this.gridWidth),a=Math.floor((t.y+this.fightMap.bgRect.height/2)/this.gridHeight);return cc.v2(a,e)},t.prototype.getGridInfo=function(t){return this.grids[t.x][t.y]},t}();i.default=s,cc._RF.pop()},{}],FightMap:[function(t,e,a){"use strict";cc._RF.push(e,"01576f3Gd5Ed5Gqxnjvfv6W","FightMap");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("MainLogic"),h=i("FightMapData"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgRect=new cc.Rect,e.maxLeft=0,e.maxRight=0,e}return r(e,t),e.prototype.init=function(t){if(this.fightMapName=t,this.objectLayer=cc.find("ObjectLayer",this.node),this.obstacleLayer=cc.find("ObstacleLayer",this.node),this.shadowLayer=cc.find("ShadowLayer",this.node),this.effectLayer=cc.find("EffectLayer",this.node),this.wallNode=cc.find("Wall",this.node),this.wallNode.active=!1,this.doorNode=cc.find("Door",this.node),this.doorNode.active=!1,this.mainBgNode=cc.find("BgLayer/MainBg",this.node),this.monsterNode=cc.find("MonsterLayer",this.node),this.monsterNode.active=!1,this.boundaryNode=cc.find("Boundary",this.node),this.boundaryNode.active=!1,this.leftDoorNode=cc.find("LeftDoor",this.node),this.leftDoorNode.active=!1,this.leftFanceNode=cc.find("Door",this.leftDoorNode),this.bottomDoorNode=cc.find("BottomDoor",this.node),this.bottomDoorNode.active=!1,this.bottomFanceNode=cc.find("Door",this.bottomDoorNode),this.righttDoorNode=cc.find("RightDoor",this.node),this.righttDoorNode.active=!1,this.rightFanceNode=cc.find("Door",this.righttDoorNode),this.topDoorNode=cc.find("TopDoor",this.node),this.topDoorNode.active=!1,this.topFanceNode=cc.find("Door",this.topDoorNode),this.npcNode=cc.find("Npc",this.node),this.npcNode&&(this.npcNode.active=!1),this.bgRect.width=this.mainBgNode.width*this.mainBgNode.scale,this.bgRect.height=this.mainBgNode.height*this.mainBgNode.scale,this.fightMapData=new h.default(this),"HomeMap"==this.fightMapName){var e=cc.find("Chapter",this.obstacleLayer),a=cc.find("Shop",this.obstacleLayer),n=cc.find("Tower",this.obstacleLayer);cc.find("Level",n).active=c.default.Instance.playerData.level<20;for(var i=[e,a,n],o=0;o<i.length;o++){var r=i[o];r.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,this),r.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,this)}}},e.prototype.resetData=function(t){this.node.x=0,this.node.y=0,this.maxLeft=this.node.x-this.bgRect.width/2,this.maxRight=this.node.x+this.bgRect.width/2,this.fightMapData.resetShowDoor(t)},e.prototype.showDoor=function(t,e){this.leftDoorNode.active=t.indexOf(1)>=0,this.leftFanceNode.active=this.leftDoorNode.active&&e,this.bottomDoorNode.active=t.indexOf(2)>=0,this.bottomFanceNode.active=this.bottomDoorNode.active&&e,this.righttDoorNode.active=t.indexOf(3)>=0,this.rightFanceNode.active=this.righttDoorNode.active&&e,this.topDoorNode.active=t.indexOf(4)>=0,this.topFanceNode.active=this.topDoorNode.active&&e,this.fightMapData.resetMapInfo(t)},e.prototype.hideFance=function(){this.leftDoorNode.active&&(this.leftFanceNode.active=!1),this.bottomDoorNode.active&&(this.bottomFanceNode.active=!1),this.righttDoorNode.active&&(this.rightFanceNode.active=!1),this.topDoorNode.active&&(this.topFanceNode.active=!1)},e.prototype.getHeroBirthPosition=function(t){return this.fightMapData.getHeroPos(t)},e.prototype.touchEndEvent=function(t){var e=t.target.name;if("Chapter"==e)l.default.Instance.combatScene.homeLayer.hideNode(),l.default.Instance.combatScene.popLayer.reviewChapterLayer(),l.default.Instance.combatScene.popLayer.pointGuideFinish();else if("Shop"==e)l.default.Instance.combatScene.homeLayer.hideBanner(),l.default.Instance.combatScene.popLayer.reviewShopLayer(1);else if("Tower"==e){if(c.default.Instance.playerData.level<20)return void l.default.Instance.combatScene.showMsgInfo("\u8fbe\u523020\u7ea7\u540e\u624d\u53ef\u6311\u6218");l.default.Instance.combatScene.homeLayer.hideNode(),l.default.Instance.combatScene.popLayer.reviewClimbTowerLayer()}},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],FightObject:[function(t,e,a){"use strict";cc._RF.push(e,"371801EpTVLAYSyOkD6E4Ef","FightObject");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=cc._decorator,h=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.objectType=c.FIGHT_OBJECT.Tree,e.objectId=0,e.isStatic=!0,e.createInMap=!0,e.originalVec=new cc.Vec2,e.bodyRect=new cc.Rect,e}return r(e,t),e.prototype.onLoad=function(){this.bodyRectNode=cc.find("BodyRect",this.node),null!=this.bodyRectNode&&(this.bodyRect.x=this.bodyRectNode.x,this.bodyRect.y=this.bodyRectNode.y,this.bodyRect.width=this.bodyRectNode.width,this.bodyRect.height=this.bodyRectNode.height),this.originalVec.x=this.node.x,this.originalVec.y=this.node.y,this.reset()},e.prototype.reset=function(){this.node.active=!0,this.node.x=this.originalVec.x,this.node.y=this.originalVec.y,this.isStatic||this.schedule(this.scheduleUpdateZIndex,0)},e.prototype.scheduleUpdateZIndex=function(){var t=Math.floor(cc.winSize.height-this.node.y);this.node.zIndex=t},e.prototype.delete=function(){this.createInMap&&(this.node.active=!1)},s([u({type:cc.Enum(c.FIGHT_OBJECT),displayName:"\u7c7b\u578b"})],e.prototype,"objectType",void 0),s([u(cc.Integer)],e.prototype,"objectId",void 0),s([u(cc.Boolean)],e.prototype,"isStatic",void 0),s([u(cc.Boolean)],e.prototype,"createInMap",void 0),s([h],e)}(cc.Component);o.default=d,cc._RF.pop()},{}],FriendHelpItem:[function(t,e,a){"use strict";cc._RF.push(e,"67a04ZHIZRIRaA6rVEfu40z","FriendHelpItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("GameData"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemIndex=0,e.rewardJsonIndex=0,e}return r(e,t),e.prototype.init=function(t,e,a){this.friendHelpLayer=t,this.itemIndex=a,this.nameNode=cc.find("Name/Name",this.node),this.listNode=cc.find("List",this.node);for(var n=0;n<e.itemList.length;++n){var i=e.itemList[n][0],o=e.itemList[n][1],r=e.itemList[n][2];if(1==i)l.default.Instance.equipmentMap.get(o);else if(l.default.Instance.itemMap.get(o),1001==o){var s=u.default.Instance.chapterLogic.getMaxChapterInfo(1);r*=l.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).gold_reward}else 1004==o&&(s=u.default.Instance.chapterLogic.getMaxChapterInfo(1),r*=l.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).crystal_reward);var c=u.default.Instance.sceneNodeManager.getRewardItem(o,r,i,n,!1,!1,!1,!1,!1);this.listNode.addChild(c.node)}this.rewardJsonIndex=e.jsonIndex,this.nameNode.getComponent(cc.Label).string="\u9080\u8bf7"+e.lvlValue[0]+"\u540d\u597d\u53cb\u52a9\u529b",this.review()},e.prototype.review=function(){this.showBtnStatus()},e.prototype.showBtnStatus=function(){for(var t=h.default.Instance.playerData.friendHelpStatus[this.itemIndex],e=1;e<=3;++e)cc.find("Status"+e,this.node).active=t+1==e},e.prototype.onClickBtn=function(){c.SoundManager.Instance.playEffect("anniu");var t=u.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.rewardJsonIndex);h.default.Instance.playerData.friendHelpStatus[this.itemIndex]=2,u.default.Instance.giftBagLoigc.receiveGiftItems(t,1),this.showBtnStatus()},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],FriendsHelpLayer:[function(t,e,a){"use strict";cc._RF.push(e,"51417VhHohOwZLAY062hsFD","FriendsHelpLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("SoundManager"),u=i("ConfigData"),d=i("GameData"),p=i("MainLogic"),f=i("FriendHelpItem"),y=cc._decorator,m=y.ccclass,g=y.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.itemScripts=new Array,e}return r(e,t),e.prototype.init=function(){this.listView=cc.find("Layer/List",this.node).getComponent(cc.ScrollView),this.countNode=cc.find("Layer/Count",this.node),this.timeNode=cc.find("Layer/Time/Time",this.node),this.timeNode.getComponent(cc.Label).string=l.default.FriendsHelpTime[0]+"-"+l.default.FriendsHelpTime[1];for(var t=u.default.Instance.giftTypeMap.get(16),e=0;e<t.length;++e){var a=cc.instantiate(this.itemPrefab);this.listView.content.addChild(a);var n=a.getComponent(f.default);n.init(this,t[e],t[e].order),this.itemScripts.push(n)}this.review()},e.prototype.review=function(){this.node.active=!0,c.default.Instance.showCustomAd(1)},e.prototype.updateShareCount=function(t){this.countNode.getComponent(cc.Label).string=""+t;for(var e=u.default.Instance.giftTypeMap.get(16),a=0;a<e.length;++a){var n=e[a];t>=n.lvlValue[0]&&0==d.default.Instance.playerData.friendHelpStatus[n.order]&&(d.default.Instance.playerData.friendHelpStatus[n.order]=1)}for(a=0;a<this.itemScripts.length;++a)this.itemScripts[a].review()},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},e.prototype.onClickBtn=function(t,e){h.SoundManager.Instance.playEffect("anniu"),1==e?(c.default.Instance.hideCustomAd(1),this.node.active=!1,p.default.Instance.combatScene.popLayer.autoPopLayer()):2==e||3==e||4==e||5==e||(6==e?(c.default.Instance.shareAppCallBack(this,function(){}),c.default.Instance.shareApp(d.default.Instance.playerData.openid,l.default.FriendsHelpId,601)):7==e&&(this.node.active=!1,p.default.Instance.combatScene.popLayer.reviewMoreGameLayer(2)))},s([g(cc.Prefab)],e.prototype,"itemPrefab",void 0),s([m],e)}(cc.Component);o.default=I,cc._RF.pop()},{}],GameData:[function(t,e,a){"use strict";cc._RF.push(e,"849b6IEg6ZKj7ju0FOgqKnQ","GameData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PlayerData"),r=n("QmLocalStorage"),s=n("PublicConst"),c=n("PublicEnum"),l=n("PlayerAttribute"),h=n("LoginLogic"),u=n("ConfigData"),d=n("DateUtils"),p=function(){function t(){this.isNewPlayer=!1,this.todayFirstLogin=!1,this.saveRequestTimes=0,this.isBackground=!1,this.popSignined=!1,this.playerAttr=new l.PlayerAttribute,this.loginLogin=new h.default,this.powerAdd=0,this.coinAddRate=0,this.animaAddRate=0,this.readLocalData=!1,this.oldPlayerData="",this.accountLevel=140,this.oldAccountLevels=[119],this.enPassWord="",this.modifyDataCount=0,this.showModifyTip=!1}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.initData()},t.prototype.initData=function(){var t,e=!0;null!=(t=r.default.Instance.getItem(s.default.AccountKey))&&""!=t||(e=!1),s.default.Platform==c.PLAT_FORM.Wx||s.default.Platform==c.PLAT_FORM.QQ||s.default.Platform==c.PLAT_FORM.Douyin||(e?this.playerData=JSON.parse(r.default.Instance.getItem(s.default.PlayerDataKey)):this.createAccount(),this.initAccountCallback())},t.prototype.createAccount=function(){r.default.Instance.setItem(s.default.AccountKey,1),t.Instance.playerData=new o.default;var e=JSON.stringify(t.Instance.playerData);r.default.Instance.setItem(s.default.PlayerDataKey,e),this.isNewPlayer=!0},t.prototype.initAccountCallback=function(){this.loginLogin.userLogin(),this.oldPlayerData=JSON.stringify(this.playerData)},t.prototype.savePlayerData=function(t){this.saveRequestTimes++,this.saveRequestTimes>15&&(this.saveRequestTimes=0,this.localStorage(t))},t.prototype.localStorage=function(){r.default.Instance.setItem(s.default.PlayerDataKey,JSON.stringify(this.playerData))},t.prototype.localStorage2=function(){r.default.Instance.setItem(s.default.PlayerDataKey,JSON.stringify(this.playerData)),this.oldPlayerData=JSON.stringify(this.playerData)},t.prototype.getChapterId=function(){return 100*t.Instance.playerData.currChapter+t.Instance.playerData.currDungeon},t.prototype.updateRoleData=function(){for(var e=0;e<t.Instance.playerData.roleDataList.length;++e)for(var a=t.Instance.playerData.roleDataList[e],n=u.default.Instance.roleMap.get(a.heroId),i=0;i<n.skillPools.length;++i){var o=u.default.Instance.unlockSkillMap.get(n.skillPools[i]);1==o.unlock_condition1&&0==a.skillLevel[o.skill_number-1]&&(a.skillLevel[o.skill_number-1]=1)}},t.prototype.newPlayer=function(){return d.default.getDayInYear()==this.playerData.createAccountTime},t.prototype.detalFriendsHelpConfig=function(t){if(t){var e=d.default.getDayInYear2(),a=t.start_time,n=t.detal;if(a>e)return;for(var i=a,o=0,r=1;0==o;){var c=new Date(i).getTime()+864e5*n,l=d.default.getDayInYearByNum2(c);e>=i&&e<=l?(o=r,s.default.FriendsHelpTime.push(i),s.default.FriendsHelpTime.push(l)):(r+=1,c+=864e5,i=d.default.getDayInYearByNum2(c))}s.default.FriendsHelpId=o}},t.prototype.detalTowerTimeConfig=function(t){if(t){var e=d.default.getDayInYear2(),a=t.start_time,n=t.detal-1;if(a>e)return;var i=a,o=0,r=1;for(console.log(" start time ",a);0==o;){var c=new Date(i).getTime()+864e5*n,l=d.default.getDayInYearByNum2(c);e>=i&&e<=l?(o=r,s.default.ClimbTowerTime.push(i),s.default.ClimbTowerTime.push(l)):(r+=1,c+=864e5,i=d.default.getDayInYearByNum2(c))}console.log(" seasionid ",o),s.default.ClimbTowerSeasionId=o}},t.prototype.detalPassCheckConfig=function(t){if(t){var e=d.default.getDayInYear2(),a=t.start_time,n=t.detal-1;if(a>e)return;var i=a,o=0,r=1;for(console.log(" start time ",a);0==o;){var c=new Date(i).getTime()+864e5*n,l=d.default.getDayInYearByNum2(c);e>=i&&e<=l?(o=r,s.default.PassCheckTime.push(i),s.default.PassCheckTime.push(l)):(r+=1,c+=864e5,i=d.default.getDayInYearByNum2(c))}console.log(" seasionid ",o),s.default.PassCheckSeasonId=o,s.default.PassCheckSwitch=!0}},t.prototype.checkModifyCount=function(){if(console.log(" check modify count ",this.modifyDataCount,this.playerData.playerDataErrCount),this.playerData.playerDataErrCount!=this.modifyDataCount&&0!=this.modifyDataCount){this.showModifyTip=!0;var t=this.playerData.openid,e=this.playerData.maxTowerLayerCount;this.createAccount(),0!=e&&(this.playerData.maxTowerLayerCount=1),this.playerData.openid=t,this.playerData.playerDataErrCount=this.modifyDataCount,this.oldPlayerData=JSON.stringify(this.playerData)}else 3==this.modifyDataCount&&(this.showModifyTip=!0,t=this.playerData.openid,e=this.playerData.maxTowerLayerCount,this.createAccount(),0!=e&&(this.playerData.maxTowerLayerCount=1),this.playerData.openid=t,this.playerData.playerDataErrCount=this.modifyDataCount,this.oldPlayerData=JSON.stringify(this.playerData))},t}();i.default=p,cc._RF.pop()},{}],GamePauseLayer:[function(t,e,a){"use strict";cc._RF.push(e,"0b690grAwVL6KAX5X68yY9r","GamePauseLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("PublicEnum"),h=i("MainLogic"),u=i("AdServer"),d=i("SoundManager"),p=i("GameData"),f=i("TaskLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pageName=l.PAGE_NAME.Home,e.pageType=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.review(t,e)},e.prototype.review=function(t,e){this.pageName=t,this.pageType=e,this.node.active=!0;for(var a=1;a<=6;++a)cc.find("Layer"+a,this.node).active=a==this.pageType;this.pageName==l.PAGE_NAME.Home||this.pageName==l.PAGE_NAME.Combat&&this.scheduleOnce(function(){cc.director.pause(),h.default.Instance.combatScene.isPause=!0},.2),this.scheduleOnce(function(){u.default.Instance.showCustomAd(2)},0)},e.prototype.onClickEvent=function(t,e){d.SoundManager.Instance.playEffect("anniu"),c.default.Platform!=l.PLAT_FORM.Vivo&&c.default.Platform!=l.PLAT_FORM.Opp&&u.default.Instance.hideBannerAd(),0==e?(this.node.active=!1,cc.director.resume(),h.default.Instance.combatScene.isPause=!0,u.default.Instance.hideCustomAd(2)):1==e?(this.node.active=!1,cc.director.resume(),h.default.Instance.combatScene.isPause=!0,u.default.Instance.hideCustomAd(2)):2==e?(cc.director.resume(),this.node.active=!1,h.default.Instance.combatScene.isPause=!0,h.default.Instance.combatLayer.quitGame(),h.default.Instance.combatScene.gotoHomeLayer(),u.default.Instance.hideCustomAd(1),u.default.Instance.hideCustomAd(3),u.default.Instance.hideCustomAd(2)):3==e?u.default.Instance.adHandler(u.default.AD_TYPE_BUY_GRID,this,this.adCallback):4==e&&(this.node.active=!1,cc.director.resume(),h.default.Instance.combatScene.isPause=!0,u.default.Instance.hideCustomAd(2))},e.prototype.adCallback=function(t,e,a){0==e?(0!=p.default.Instance.playerData.cdActiveFreeAd&&a||h.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1),p.default.Instance.playerData.equipmentGridCount+=10,p.default.Instance.localStorage(h.default.Instance.combatScene.isGameStart()),this.node.active=!1,cc.director.resume(),h.default.Instance.combatScene.isPause=!0,u.default.Instance.hideCustomAd(2)):-1==e?(h.default.Instance.combatScene.showMsgInfo(c.default.NO_AD),u.default.Instance.noVideoToShare()&&(this.shareType=u.default.SHARE_TYPE_BUY_GRID,c.default.Platform==l.PLAT_FORM.Douyin?u.default.Instance.shareAppCallBack(this,this.shareAppCallback2):h.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())):h.default.Instance.combatScene.showMsgInfo(c.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void h.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,h.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else h.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-u.default.Instance.adServer.shareDateTime)/1e3);if(u.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void h.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,h.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else u.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(h.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],GameRecordLayer:[function(t,e,a){"use strict";cc._RF.push(e,"9183fNUxmdGAIjmw8zuYl3c","GameRecordLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("SoundManager"),h=i("GameData"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.init()},e.prototype.init=function(){var t=cc.find("Layer/List",this.node),e=[[1001,1e5,2],[1002,1e3,2]];t.destroyAllChildren();for(var a=0;a<e.length;a++){var n=e[a],i=u.default.Instance.sceneNodeManager.getRewardItem(n[0],n[1],n[2],a,!1,!0,!1,!1,!1);t.addChild(i.node)}this.review()},e.prototype.review=function(){this.node.active=!0},e.prototype.shareCallback=function(t){0==t?(h.default.Instance.playerData.shareRecordCount+=1,h.default.Instance.playerData.shareRecordCount>10?(u.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5956\u52b1\u5df2\u9886\u5b8c"),h.default.Instance.localStorage(u.default.Instance.combatScene.isGameStart())):u.default.Instance.giftBagLoigc.receiveGiftItems([[1001,1e5,2],[1002,1e3,2]],1)):-2==t?u.default.Instance.combatScene.showMsgInfo("\u5f55\u5236\u65f6\u95f4\u592a\u77ed\uff0c\u5206\u4eab\u5931\u8d25\uff01",2):u.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25!",2),this.node.active=!1},e.prototype.onClickBtn=function(t,e){l.SoundManager.Instance.playEffect("anniu"),1==e?this.node.active=!1:2==e&&c.default.Instance.shareVideo(this,this.shareCallback)},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],GearInfo:[function(t,e,a){"use strict";cc._RF.push(e,"a473cVGTnRE44LmsyHble7E","GearInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.type=o.default.stringToInt(t.type),this.picture_id=o.default.stringToInt(t.picture_id),this.warning_time=o.default.stringToInt(t.warning_time),this.is_attack=o.default.stringToInt(t.is_attack),this.attack_type=o.default.stringToInt(t.attack_type),this.atk=o.default.stringToInt(t.atk),this.hp=o.default.stringToInt(t.hp),this.def=o.default.stringToInt(t.def),this.atk_speed=o.default.stringToInt(t.atk_speed),this.move_speed=o.default.stringToInt(t.move_speed),this.drop_speed=o.default.stringToInt(t.drop_speed),this.res_id=t.res_id,this.skill_normal=o.default.stringToInt(t.skill_normal),this.collide_area=t.collide_area,this.dead_sound=t.dead_sound;var e=o.default.config_stringToIntList(this.collide_area);this.bodyArea=new cc.Size(e[0],e[1])},cc._RF.pop()},{}],GiftBagLogic:[function(t,e,a){"use strict";cc._RF.push(e,"f8722ipyjpKaZNqopIYTHhV","GiftBagLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("GiftInfo"),s=n("ConfigData"),c=n("DataUtils"),l=n("MainLogic"),h=n("PublicEnum"),u=function(){function t(){}return t.prototype.receiveGiftItems=function(t,e,a){void 0===a&&(a=!0);for(var n=0;n<t.length;n++){var i=t[n],o=i[0],r=i[1]*e,c=void 0;1==i[2]?(c=s.default.Instance.equipmentMap.get(o),this.receiveEquipment(c,r,n,a)):(c=s.default.Instance.itemMap.get(o),this.receiveItem(c,r,n,a))}l.default.Instance.tipsLogic.updateAllTips()},t.prototype.receiveItem=function(t,e,a,n){void 0===n&&(n=!0),l.default.Instance.moneyLogic.addItemCount(t.id,e),n&&l.default.Instance.combatScene.addRewardEffect(t.id,e,a)},t.prototype.receiveEquipment=function(t,e,a,n){void 0===n&&(n=!0);for(var i=0;i<e;++i)l.default.Instance.equipmentLogic.addEquipmentData(t.id);n&&l.default.Instance.combatScene.addRewardEffect(t.id,e,a,1)},t.prototype.getJatGiftList=function(t){for(var e,a=s.default.Instance.giftTypeMap.get(t),n=o.default.Instance.playerData.level,i=0;i<a.length;++i)if(n>=a[i].lvlValue[0]&&n<=a[i].lvlValue[1]){e=a[i];break}return e},t.prototype.getJarCCWeaponInfo=function(t){for(var e=s.default.Instance.giftTypeMap.get(11),a=0,n=0;n<e.length;++n)if(e[n].order&&e[n].order>t){a=e[n].order;break}return a},t.prototype.getJarGiftBag=function(t,e,a){for(var n,i,r=s.default.Instance.giftTypeMap.get(t),u=o.default.Instance.playerData.level,d=0;d<r.length;++d)r[d].order==e?i=this.getGiftInfoByIndex(r[d].jsonIndex):u>=r[d].lvlValue[0]&&u<=r[d].lvlValue[1]&&0==r[d].order&&(n=this.getGiftInfoByIndex(r[d].jsonIndex));var p=new Array;if(null!=i){var f=i.itemList[0][0],y=i.itemList[0][1],m=i.itemList[0][2];if(1001==y){var g=l.default.Instance.chapterLogic.getMaxChapterInfo(1);m*=s.default.Instance.dungeonMap.get(g[0]).get(g[1]).get(1).gold_reward}else 1004==y&&(g=l.default.Instance.chapterLogic.getMaxChapterInfo(1),m*=s.default.Instance.dungeonMap.get(g[0]).get(g[1]).get(1).crystal_reward);p.push([y,m,f]),a--}var I=n.itemList,_=new Array;for(d=0;d<I.length;d++)_.push(I[d][3]);var v=new Array;for(d=0;d<a;++d){var S=c.default.randomIndexByWeight(_),L=(f=I[S][0],y=I[S][1],I[S][2]);1001==y?(g=l.default.Instance.chapterLogic.getMaxChapterInfo(1),L*=s.default.Instance.dungeonMap.get(g[0]).get(g[1]).get(1).gold_reward):1004==y&&(g=l.default.Instance.chapterLogic.getMaxChapterInfo(1),L*=s.default.Instance.dungeonMap.get(g[0]).get(g[1]).get(1).crystal_reward),p.push([y,L,f]),v.push(S)}if(11==t){var T={itemList:p};l.default.Instance.combatScene.popLayer.reviewRewardLayer(h.PAGE_NAME.ShakeJar,11,T,!0)}else this.receiveGiftItems(p,1);return v},t.prototype.getDiamWelfareGift=function(){},t.prototype.randomGiftBag=function(t){for(var e=s.default.Instance.giftTypeMap.get(t),a=new Array,n=0;n<e.length;n++){var i=e[n];a.push(i.weight)}return e[c.default.randomIndexByWeight(a)]},t.prototype.randomGiftBagByList=function(t){for(var e=new Array,a=new Array,n=0;n<t.length;n++){for(var i=s.default.Instance.giftMap.get(t[n]),o=i.itemList,r=!1,h=0;h<o.length;h++){var u=o[h][0],d=s.default.Instance.itemMap.get(u);if(6==d.type){var p=d.type_key;if(null!=l.default.Instance.roleLogic.getRoleData(p)){r=!0;continue}}}r||(e.push(i),a.push(i.weight))}var f=c.default.randomIndexByWeight(a);return-1==f?null:e[f]},t.prototype.getGiftRewardByIndex=function(t){for(var e=JSON.parse(s.default.Instance.giftInfoJson)[t],a=new r.default(e,t),n=new Array,i=0;i<a.itemList.length;++i){var o=a.itemList[i][0],c=a.itemList[i][1],h=a.itemList[i][2];if(1001==c){var u=l.default.Instance.chapterLogic.getMaxChapterInfo(1);h*=s.default.Instance.dungeonMap.get(u[0]).get(u[1]).get(1).gold_reward}else 1004==c&&(u=l.default.Instance.chapterLogic.getMaxChapterInfo(1),h*=s.default.Instance.dungeonMap.get(u[0]).get(u[1]).get(1).crystal_reward);n.push([c,h,o])}return n},t.prototype.getGiftInfoByIndex=function(t){var e=JSON.parse(s.default.Instance.giftInfoJson)[t];return new r.default(e,t)},t}();i.default=u,cc._RF.pop()},{}],GiftInfo:[function(t,e,a){"use strict";cc._RF.push(e,"5f38b8VkTRCcICC5I2uGvkt","GiftInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t,e){this.jsonIndex=0,this.id=o.default.stringToInt(t.id),this.type=o.default.stringToInt(t.type),this.order=o.default.stringToInt(t.order),this.weight=o.default.stringToInt(t.weight),this.big_pic=t.big_pic,this.item=t.item,this.ad_item=t.ad_item,this.itemList=o.default.config_stringToIntListOfList(this.item),this.adItemList=o.default.config_stringToIntListOfList(this.ad_item),this.lvl=t.lvl,this.lvlValue=o.default.config_stringToIntList(this.lvl,"_"),this.jsonIndex=e},cc._RF.pop()},{}],GrayLayer:[function(t,e,a){"use strict";cc._RF.push(e,"d83eenYTKZIrqLx/eqmVOWc","GrayLayer");var n,i=a,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,l=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canClickOtherEvent=!1,e}return o(e,t),e.prototype.clickCallback=function(){if(this.canClickOtherEvent){var t=this.node.getParent();t.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){t.active=!1,t.opacity=255},this)))}},r([l(cc.Boolean)],e.prototype,"canClickOtherEvent",void 0),r([c],e)}(cc.Component);i.default=h,cc._RF.pop()},{}],GrowData:[function(t,e,a){"use strict";cc._RF.push(e,"8379eMCs8pAeZ+BJD/as9Zb","GrowData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.id=t,this.status=1},cc._RF.pop()},{}],GuestItem:[function(t,e,a){"use strict";cc._RF.push(e,"c7285UoMfpMI7mX44ztgd4D","GuestItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("MainLogic"),m=i("TaskLogic"),g=cc._decorator,I=g.ccclass,_=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardJsonIndex=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.passCheckLayer=t,this.taskOrder=e.order,this.taskType=e.type,this.fullNode=cc.find("Full",this.node),this.levelNode=cc.find("Level",this.node),this.itemBgNode=cc.find("ItemBg",this.node),this.itemNode=cc.find("Item",this.node),this.countNode=cc.find("Count",this.node),this.btnNode=cc.find("Btn1",this.node),this.grayNode=cc.find("Gray",this.node),this.getNode=cc.find("Get",this.node);var a=l.default.PassCheckSeasonId%4;0==a&&(a=4),this.taskConfig=y.default.Instance.taskLogic.queryPassCheckTaskConfig(this.taskOrder);var n=this.taskConfig.awardList[a-1],i=d.default.Instance.giftMap.get(n),o=i.itemList[0][0],r=i.itemList[0][1],s=i.itemList[0][2];if(1001==r){var c=y.default.Instance.chapterLogic.getMaxChapterInfo(1);s*=d.default.Instance.dungeonMap.get(c[0]).get(c[1]).get(1).gold_reward}else 1004==r&&(c=y.default.Instance.chapterLogic.getMaxChapterInfo(1),s*=d.default.Instance.dungeonMap.get(c[0]).get(c[1]).get(1).crystal_reward);this.rewardJsonIndex=i.jsonIndex,this.itemInfo=1==o?d.default.Instance.equipmentMap.get(r):d.default.Instance.itemMap.get(r),f.AssetUtils.loadSpriteFrame(this.itemBgNode,"Common/common_quality_"+this.itemInfo.quality),f.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+this.itemInfo.icon),this.levelNode.getComponent(cc.Label).string=e.order+"\u7ea7",10==e.order&&(this.levelNode.color=cc.color(51,68,160)),this.countNode.getComponent(cc.Label).string=""+s,this.countNode.color=h.Quality_COLOR[this.itemInfo.quality],this.review()},e.prototype.review=function(){var t=y.default.Instance.taskLogic.queryPassCheckTaskData(this.taskOrder,this.taskType);switch(this.fullNode.active=10==t.order,this.levelNode.active=!1,this.btnNode.active=!1,this.grayNode.active=!1,this.getNode.active=!1,t.status){case 0:this.levelNode.active=!0,this.grayNode.active=!0;break;case 1:case 3:this.btnNode.active=!0;break;case 2:case 4:this.levelNode.active=!0,this.grayNode.active=!0,this.getNode.active=!0}},e.prototype.onClickBtn=function(t,e){u.SoundManager.Instance.playEffect("anniu"),1==e&&c.default.Instance.adHandler(c.default.AD_TYPE_GET_COMMON_REWARD,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){if(0==e){var n=y.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.rewardJsonIndex);y.default.Instance.giftBagLoigc.receiveGiftItems([n[0]],1),y.default.Instance.taskLogic.receivePassCheckReward(this.taskOrder,this.taskType,3),this.review(),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||y.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)}else-1==e?(y.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(this.shareType=c.default.SHARE_TYPE_GET_COMMON_REWARD,l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):y.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else y.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([I],e)}(cc.Component));o.default=_,cc._RF.pop()},{}],GuideConfig:[function(t,e,a){"use strict";cc._RF.push(e,"8c671HMX2JKJ4iOYe+nMyT8","GuideConfig");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=parseInt(t.id),this.guide_type=t.guide_type,this.abbr=t.abbr,this.task_id=parseInt(t.task_id),this.is_last=o.default.stringToInt(t.is_last),this.task_step=parseInt(t.task_step),this.info=t.info,this.type=parseInt(t.type),this.condition=t.condition,this.conditinList=o.default.config_stringToIntList(this.condition),this.force=o.default.stringToInt(t.force)},cc._RF.pop()},{}],GuideLayer:[function(t,e,a){"use strict";cc._RF.push(e,"effcbd5nqdArI0qHpZGBJsl","GuideLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("ConfigData"),h=i("PublicEnum"),u=i("GuideUtils"),d=i("SoundManager"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroArmature=null,e.showDialogTime=0,e.type=0,e}return r(e,t),e.prototype.init=function(t){this._sceneScript=t,this.playerData=c.default.Instance.playerData,this.maskNode=cc.find("MaskNode",this.node),this.maskBgNode=cc.find("MaskNode/MaskBg",this.node),this.dialogueNode=cc.find("Dialogue",this.node),this.nextBtn=cc.find("Dialogue/NextBtn",this.node),this.pointNode=cc.find("Point",this.node),this.pointMsgNode=cc.find("Point/Message",this.node),this.pointMsgInfoNode=cc.find("Point/Message/Info",this.node),this.pointFingerNode=cc.find("Point/Finger",this.node),this.leftNode=cc.find("Dialogue/Left",this.node),this.rightNode=cc.find("Dialogue/Right",this.node)},e.prototype.review=function(t,e,a,n,i,o,r,s){this.callbackContext=a,this.callback=n,this.position=i,this.node.zIndex=a.node.zIndex+1,this.size=o,this.p1=r,this.p2=s,this.node.active=!0,this.guideTaskId=t,this.guideTaskStep1=e,this.guideTaskStep2=0,this.guideTaskData=u.default.Instance.queryGuideTaskData(this.guideTaskId),this.guideList=l.default.Instance.guideMap.get(this.guideTaskId).get(this.guideTaskStep1),this.doStep()},e.prototype.onGuideFinish=function(){console.log("onGuideFinish");var t=this.guideTaskId,e=this.guideTaskStep1;u.default.Instance.finishGuideTaskStep(t,e),l.default.Instance.guideMap.get(t).getValues().length==this.guideTaskStep1&&u.default.Instance.finishGuideTask(t),this.guideTaskStep1++,this.node.active=!1,console.log("\u4efb\u52a1\uff1a"+t+",\u5f15\u5bfc\u7ed3\u675f\u3002"),this.callback.call(this.callbackContext,[t,e])},e.prototype.showDialogueMsg=function(){this.maskNode.width=0,this.maskNode.height=0,this.maskNode.x=0,this.maskNode.y=0,this.maskBgNode.x=0,this.maskBgNode.y=0,this.showDialogTime=(new Date).getTime();var t=cc.find("Dialogue/Msg/Info",this.node),e=this.guideList[this.guideTaskStep2-1];t.getComponent(cc.RichText).string=e.info},e.prototype.showLeftOrRight=function(t){t?(this.leftNode,this.leftNode.active=!0,this.rightNode.active=!1):(this.rightNode,this.leftNode.active=!1,this.rightNode.active=!0)},e.prototype.showPoint=function(){this.maskNode.width=this.size.width,this.maskNode.height=this.size.height,this.maskNode.x=this.position.x,this.maskNode.y=this.position.y,this.maskBgNode.x=-this.position.x,this.maskBgNode.y=-this.position.y,this.pointFingerNode.x=this.position.x,this.pointFingerNode.y=this.position.y,this.pointFingerNode.stopAllActions(),this.position.y>0?this.pointMsgNode.y=this.position.y-this.size.height/2-150:this.pointMsgNode.y=this.position.y+this.size.height/2+200;var t=this.guideList[this.guideTaskStep2-1];this.maskNode.opacity=255,t.info.length>0?this.pointMsgNode.active=!0:this.pointMsgNode.active=!1,this.pointMsgInfoNode.getComponent(cc.RichText).string=t.info},e.prototype.doStep=function(){if(this.guideTaskStep2++,this.guideTaskStep2>=this.guideList.length+1)return this.node.stopAllActions(),void this.onGuideFinish();this.guideList[this.guideTaskStep2-1].type==h.GUIDE_TYPE.Dialogue?(this.type=h.GUIDE_TYPE.Dialogue,this.dialogueNode.active=!0,this.nextBtn.active=!0,this.pointNode.active=!1,this.showDialogueMsg(),this.dialogueNode.stopAllActions()):(this.type=h.GUIDE_TYPE.Point,this.dialogueNode.active=!1,this.nextBtn.active=!1,this.pointNode.active=!0,this.showPoint())},e.prototype.onClickEvent=function(t,e){1!=this.guideList[this.guideTaskStep2-1].force&&(d.SoundManager.Instance.playEffect("anniu"),0==e&&(new Date).getTime()-this.showDialogTime>1e3&&this.doStep())},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],GuideTaskData:[function(t,e,a){"use strict";cc._RF.push(e,"f799euyOYVA8Z9Ws5BVS66C","GuideTaskData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.taskId=t,this.step1=1,this.stauts=0},cc._RF.pop()},{}],GuideUtils:[function(t,e,a){"use strict";cc._RF.push(e,"4a9ad+tHOVIArDPKmBtXWN6","GuideUtils");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("ConfigData"),s=n("GuideTaskData"),c=n("PublicConst"),l=n("MainLogic"),h=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.queryGuideTaskData=function(t){for(var e=o.default.Instance.playerData.guideTaskList,a=0;a<e.length;a++){var n=e[a];if(n.taskId==t)return n}return null},t.prototype.clearTask=function(){for(var t=o.default.Instance.playerData.guideTaskList,e=0;e<t.length;e++){var a=t[e];if(0==a.stauts){var n=r.default.Instance.guideMap.get(a.taskId).get(a.step1);null!=n&&n.length>0&&(0==n[0].is_last?a.step1=1:1==n[0].is_last&&(a.stauts=1))}}o.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.addGuideTask=function(t){var e=this.queryGuideTaskData(t);null==e&&(e=new s.default(t),o.default.Instance.playerData.guideTaskList.push(e),o.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()))},t.prototype.finishGuideTask=function(t){var e=this.queryGuideTaskData(t);null!=e&&(e.stauts=1,o.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()))},t.prototype.finishGuideTaskStep=function(t){var e=this.queryGuideTaskData(t);null!=e&&(e.step1++,o.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()))},t.prototype.isHaveGuide=function(t,e){if(c.default.Is_Senior)return!1;if(null==r.default.Instance.guideMap.get(t))return!1;var a=r.default.Instance.guideMap.get(t).get(e);if(null==a||0==a.length)return!1;var n=l.default.Instance.chapterLogic.getMaxChapterInfo(1)[0],i=l.default.Instance.chapterLogic.getMaxChapterInfo(1)[1];if(0!=a[0].conditinList[0]&&a[0].conditinList[0]!=n||0!=a[0].conditinList[1]&&a[0].conditinList[1]!=i)return!1;var o=this.queryGuideTaskData(t);return null==o&&1==e?(this.addGuideTask(t),!0):(null!=o||1==e)&&1!=o.stauts&&e==o.step1},t}();i.default=h,cc._RF.pop()},{}],HeroArmature:[function(t,e,a){"use strict";cc._RF.push(e,"6aadedI209P9bctCzuUxIii","HeroArmature");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("ConfigData"),h=i("MainLogic"),u=i("StringUtils"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroArmResId="",e.wingArmResId="",e.titleArmResId="",e.weaponId=0,e.weaponLevel=0,e.loadFinish=!1,e.loadWingFinish=!1,e.loadTitleFinish=!1,e}return r(e,t),e.prototype.init=function(t,e,a,n,i){var o=this;this.heroId=t;var r=h.default.Instance.roleLogic.getRoleWingResId(e,a,n,i),s=u.default.stringToStringListForRes(r[0]);this.bodyNode=cc.find("Hero",this.node),this.bodyDiplay=this.bodyNode.getComponent(sp.Skeleton),this.wingNode=cc.find("Wing",this.node),this.wingDiplay=this.wingNode.getComponent(sp.Skeleton),this.titleNode=cc.find("Title",this.node),this.titleDiplay=this.titleNode.getComponent(sp.Skeleton),this.weaponId=h.default.Instance.roleLogic.getRoleWeaponId(),this.heroArmResId=r[0],c.AssetUtils.loadSpine(this.bodyDiplay,"Animation/"+s[0],s[1],function(){o.loadFinish=!0,o.playStand(),h.default.Instance.roleLogic.changeWeaponSkin(o.bodyDiplay,o.weaponId),o.weaponLevel=h.default.Instance.roleLogic.getRoleWeaponLevel(),h.default.Instance.roleLogic.weaponUpgrade(o.bodyDiplay,o.weaponLevel,o.weaponId)},this);var d=r[1];if(this.wingArmResId=d,null!=d){var p=l.default.Instance.resourceMap.get(d).resource_way;this.wingNode.active=!0,c.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+p,null,function(){o.loadWingFinish=!0,o.playWingStand()},this)}else d==this.wingArmResId&&null!=d?(this.loadWingFinish=!0,this.wingNode.active=!0):(this.loadWingFinish=!1,this.wingNode.active=!1);this.titleArmResId=r[2],null!=this.titleArmResId?(this.titleNode.active=!0,c.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+this.titleArmResId,null,function(){o.loadTitleFinish=!0,o.playTitleStand()},this)):(this.loadTitleFinish=!1,this.titleNode.active=!1)},e.prototype.resetSlot=function(t,e,a,n){var i=this,o=h.default.Instance.roleLogic.getRoleWingResId(t,e,a,n);if(o[0]!=this.heroArmResId){this.heroArmResId=o[0];var r=u.default.stringToStringListForRes(o[0]);this.bodyDiplay.setSkin(r[1]),this.playStand(),h.default.Instance.roleLogic.changeWeaponSkin(this.bodyDiplay,this.weaponId)}var s=o[1];if(s!=this.wingArmResId&&null!=s){this.wingArmResId=s;var d=l.default.Instance.resourceMap.get(s).resource_way;this.loadWingFinish=!1,this.wingNode.active=!0,c.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+d,null,function(){i.loadWingFinish=!0,i.playWingStand()},this)}else s==this.wingArmResId&&null!=s?(this.loadWingFinish=!0,this.wingNode.active=!0):null==s&&(this.loadWingFinish=!1,this.wingNode.active=!1);var p=h.default.Instance.roleLogic.getRoleWeaponId();p!=this.weaponId&&(this.weaponId=p,h.default.Instance.roleLogic.changeWeaponSkin(this.bodyDiplay,this.weaponId));var f=h.default.Instance.roleLogic.getRoleWeaponLevel();f!=this.weaponLevel&&(this.weaponLevel=f,h.default.Instance.roleLogic.weaponUpgrade(this.bodyDiplay,this.weaponLevel,p));var y=o[2];y!=this.titleArmResId&&null!=y?(this.titleArmResId=y,this.loadTitleFinish=!1,this.titleNode.active=!0,c.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+y,null,function(){i.loadTitleFinish=!0,i.playTitleStand()},this)):y==this.titleArmResId&&null!=y?(this.loadTitleFinish=!0,this.titleNode.active=!0):null==y&&(this.loadTitleFinish=!1,this.titleNode.active=!1)},e.prototype.resetData=function(t,e,a,n){this.playStand(),this.resetSlot(t,e,a,n)},e.prototype.playSchedule=function(){var t=this.bodyDiplay.animation;"stand"==t?this.playStand():(t="attack")&&this.playStand()},e.prototype.playStand=function(){this.bodyDiplay.setAnimation(0,"stand",!0),this.bodyDiplay.timeScale=1},e.prototype.playAttack=function(){this.bodyDiplay.setAnimation(0,"attack",!1),this.bodyDiplay.timeScale=1.5},e.prototype.playWingStand=function(){this.wingDiplay.setAnimation(0,"stand",!0),this.wingDiplay.timeScale=1},e.prototype.playWingMove=function(){this.wingDiplay.setAnimation(0,"move",!1),this.wingDiplay.timeScale=1},e.prototype.playTitleStand=function(){this.titleDiplay.setAnimation(0,"stand",!0),this.titleDiplay.timeScale=1},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],HeroCollider:[function(t,e,a){"use strict";cc._RF.push(e,"add0aBcSvFDCZurE+jBS8Gm","HeroCollider");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("HurtUtil"),h=i("MainLogic"),u=i("PlayerAttribute"),d=i("SoundManager"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastAtkedHeroSprite=null,e.lastAtkedTime=0,e}return r(e,t),e.prototype.init=function(t){this.heroSprite=t},e.prototype.resetData=function(){this.lastAtkedHeroSprite=null,this.lastAtkedTime=0},e.prototype.onCollisionEnter=function(t){var e=this.getOtherHero(t);if(e!=this.heroSprite)if(null!=e||this.heroSprite.battleCamp!=c.BATTLE_CAMP.Self){if(null!=e&&e.battleCamp!=c.BATTLE_CAMP.Gear&&e.battleCamp!=this.heroSprite.battleCamp&&e.heroStatus.canAttacked()){var a=e.heroNode.getHeroPos();if(!(Math.abs(a.y-this.heroSprite.node.y)>this.heroSprite.currSkill.injury_height/2)){var n=this.heroSprite.heroLogic.getOriginalNum(u.ATTRIBUTE_TYPE.Hit_Rate)-e.heroLogic.getOriginalNum(u.ATTRIBUTE_TYPE.Agl_Rate);if(n=n<0?0:n>1?1:n,Math.random()>n)e.heroNode.addEffect(c.EFFECT_TYPE.Show_Dodge1,cc.v2(0,e.roleInfo.height+50));else{this.heroSprite.heroStatus.hitTarget=!0;var i=this.heroSprite.heroStatus.hurtIndex-1,o=l.default.createNormalHurtData(this.heroSprite,e,this.heroSprite.currSkill);if(l.default.hurt(o),e.lifeStatus==c.LIFE_STATUS.Alive&&this.setLastAtkHero(e),this.heroSprite.battleCamp==c.BATTLE_CAMP.Self&&(h.default.Instance.combatLayer.uiLayer.showHurtEffect(Math.abs(o.hurtPoint)),this.heroSprite.currSkill==this.heroSprite.skills[0]&&this.heroSprite.heroShooter.shootBulletByBuff(e)),1==this.heroSprite.currSkill.break||e.lifeStatus==c.LIFE_STATUS.Dead||e.stateMachine.currState!=c.HEOR_STATE.Attack)if(0==e.roleInfo.is_fly&&this.heroSprite.currSkill.hitImpulseList1&&this.heroSprite.currSkill.hitTimeList1){var r=!1;(i=Math.min(i,this.heroSprite.currSkill.hitImpulseList1.length-1))==this.heroSprite.currSkill.hitImpulseList1.length-1&&(r=!0);var s=this.heroSprite.currSkill.hitEffect1.length?this.heroSprite.currSkill.hitEffect1[i]:1,p=this.heroSprite.currSkill.effectPriority.length?this.heroSprite.currSkill.effectPriority[i]:1,f=this.heroSprite.currSkill.hitImpulseList1[i];1==e.heroStatus.leaveGround&&(f=this.heroSprite.currSkill.hitSkyAttackEffect?this.heroSprite.currSkill.hitSkyAttackEffect[i]:[50,50,100]);var y=this.heroSprite.currSkill.hitTimeList1[i];d.SoundManager.Instance.playEffect(this.heroSprite.currSkill.hit_sound),e.hitEvent(this.heroSprite.heroStatus.face,f,y,r,s,this.heroSprite.currSkill.id,p,this.heroSprite)}else this.heroSprite.currSkill.hitImpulseList&&this.heroSprite.currSkill.hitTimeList?(r=!1,(i=Math.min(i,this.heroSprite.currSkill.hitImpulseList.length-1))==this.heroSprite.currSkill.hitImpulseList.length-1&&(r=!0),s=this.heroSprite.currSkill.hitEffect.length?this.heroSprite.currSkill.hitEffect[i]:1,p=this.heroSprite.currSkill.effectPriority.length?this.heroSprite.currSkill.effectPriority[i]:1,f=this.heroSprite.currSkill.hitImpulseList[i],1==e.heroStatus.leaveGround&&(f=this.heroSprite.currSkill.hitSkyAttackEffect?this.heroSprite.currSkill.hitSkyAttackEffect[i]:[50,50,100]),y=this.heroSprite.currSkill.hitTimeList[i],d.SoundManager.Instance.playEffect(this.heroSprite.currSkill.hit_sound),e.hitEvent(this.heroSprite.heroStatus.face,f,y,r,s,this.heroSprite.currSkill.id,p,this.heroSprite)):(d.SoundManager.Instance.playEffect(this.heroSprite.currSkill.hit_sound),e.hitEvent(this.heroSprite.heroStatus.face,[0,0],0,!0,1,this.heroSprite.currSkill.id,1,this.heroSprite))}}}}else{var m=this.getOtherGear(t);if(m&&m.lifeStatus!=c.LIFE_STATUS.Dead){var g=l.default.createNormalHurtData(this.heroSprite,m,this.heroSprite.currSkill);l.default.hurt(g)}}},e.prototype.setLastAtkHero=function(t){this.lastAtkedHeroSprite=t,this.lastAtkedTime=(new Date).getTime()},e.prototype.getLastAtkHero=function(){if(null!=this.lastAtkedHeroSprite){if(this.lastAtkedHeroSprite.lifeStatus!=c.LIFE_STATUS.Alive)return null;if((new Date).getTime()-this.lastAtkedTime>5e3)return null;var t=this.lastAtkedHeroSprite.node.getPosition().x-this.node.getPosition().x;return t>0&&-1==this.heroSprite.heroStatus.face?null:t<0&&1==this.heroSprite.heroStatus.face?null:this.lastAtkedHeroSprite}return null},e.prototype.getOtherGear=function(t){var e=t.node.parent;return null==e?(console.log("getOtherHero null"),null):e.getComponent("GearSprite")},e.prototype.getOtherHero=function(t){var e=t.node.parent;return null==e?(console.log("getOtherHero null"),null):e.getComponent("HeroSprite")},e.prototype.onCollisionStay=function(){},e.prototype.onCollisionExit=function(){},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],HeroControl:[function(t,e,a){"use strict";cc._RF.push(e,"1bba00r8lJH2K+Tzc+dN66R","HeroControl");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("MainLogic"),h=i("MyMathUtils"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.heroSprite=t,this.controlNode=cc.find("LogicNode/ControlNode",this.node)},e.prototype.resetData=function(){this.schedule(this.moveSchedule,0)},e.prototype.handleControlEvent=function(t,e){if(!(this.heroSprite.battleCamp==c.BATTLE_CAMP.Enemy&&this.heroSprite.heroStatus.hardAndStraight||l.default.Instance.combatLayer.gameStep!=c.GAME_STEP.Starting||this.heroSprite.stateMachine.currState==c.HEOR_STATE.Death||this.heroSprite.stateMachine.currState==c.HEOR_STATE.Birth||this.heroSprite.heroStatus.isForzen)){var a=l.default.Instance.combatScene.popLayer.guideLayer;switch(t){case c.CONTROL_EVENT.Control_Move:if(this.heroSprite.battleCamp==c.BATTLE_CAMP.Self&&null!=a&&l.default.Instance.combatLayer.isGuide&&(2!=a.guideTaskId||2!=a.guideTaskStep1))return this.heroSprite.heroStatus.isMove=!1,void this.heroSprite.heroNode.controlStand();if(0==this.heroSprite.heroStatus.nextAtkStatus&&this.heroSprite.heroStatus.hardAndStraight)return;this.heroSprite.heroStatus.isMove=!0,this.heroSprite.heroStatus.moveAngle=e;var n=Math.abs(e);this.heroSprite.heroStatus.face=n<90?1:-1,this.heroSprite.stateMachine.onStartMoveState();break;case c.CONTROL_EVENT.Control_Move_Cancel:if(this.heroSprite.heroStatus.isMove=!1,this.heroSprite.heroStatus.hardAndStraight)return;this.heroSprite.heroNode.controlStand(),this.heroSprite.stateMachine.onStartStandState();break;case c.CONTROL_EVENT.Control_Attack:if(this.heroSprite.heroStatus.hitSkillIndex=e,0==this.heroSprite.heroStatus.normalAtkStatus&&(this.heroSprite.heroStatus.normalAtkStatus=1,this.heroSprite.currSkill=this.heroSprite.skills[0]),0==this.heroSprite.heroStatus.nextAtkStatus&&this.heroSprite.heroStatus.hardAndStraight)return;if(this.heroSprite.battleCamp==c.BATTLE_CAMP.Self){if(!l.default.Instance.combatLayer.isGuide2)return;l.default.Instance.combatScene.popLayer.pointGuideFinish(2,3)}this.heroSprite.heroNode.controlStand(),this.heroSprite.currSkill=this.heroSprite.skills[0],this.heroSprite.stateMachine.onStartEarlyWarmState();break;case c.CONTROL_EVENT.Control_Skill:this.heroSprite.heroStatus.hitSkillIndex=e,this.heroSprite.heroStatus.hitSkillIndex<10||(e=Math.floor(this.heroSprite.heroStatus.hitSkillIndex/10));var i=this.heroSprite.skills[e];if(!i)return void console.log(" \u6ca1\u627e\u5230\u6280\u80fd ");if(this.heroSprite.battleCamp==c.BATTLE_CAMP.Self){if(!l.default.Instance.combatLayer.isGuide2)return;l.default.Instance.combatScene.popLayer.pointGuideFinish(2,5)}if(this.heroSprite.skillManager.getSkillObj(i.id).skillState==c.SKILL_STATE.ContinuouCd)return;if(0==this.heroSprite.heroStatus.nextAtkStatus&&this.heroSprite.heroStatus.hardAndStraight)return;this.heroSprite.heroNode.controlStand(),this.heroSprite.currSkill=i,this.heroSprite.stateMachine.onStartEarlyWarmState();break;case c.CONTROL_EVENT.Control_Big:if(this.heroSprite.battleCamp==c.BATTLE_CAMP.Self){if(!l.default.Instance.combatLayer.isGuide2)return;l.default.Instance.combatScene.popLayer.pointGuideFinish(2,6)}this.heroSprite.heroStatus.hitSkillIndex=e;var o=this.heroSprite.skills[e];if(this.heroSprite.skillManager.getSkillObj(o.id).skillState==c.SKILL_STATE.ContinuouCd)return;0==this.heroSprite.heroStatus.normalAtkStatus&&(this.heroSprite.heroStatus.normalAtkStatus=1),this.heroSprite.heroNode.controlStand(),this.heroSprite.currSkill=o,this.heroSprite.stateMachine.onStartEarlyWarmState();break;case c.CONTROL_EVENT.Control_Assault:if(this.heroSprite.heroStatus.hardAndStraight)return;this.heroSprite.stateMachine.onStartAssault();break;case c.CONTROL_EVENT.Control_Jump_Back:if(0==this.heroSprite.heroStatus.nextAtkStatus&&this.heroSprite.heroStatus.hardAndStraight)return;this.heroSprite.stateMachine.onStartJumpBack()}}},e.prototype.moveSchedule=function(t){this.heroSprite.heroStatus.hardAndStraight||(this.heroSprite.heroStatus.isMove&&this.heroSprite.heroNode.controlMove(t,h.default.toRadian(this.heroSprite.heroStatus.moveAngle)),this.heroSprite.combatLayer.canGoNextRoom&&this.heroSprite.heroNode.canGoNextRoom())},e.prototype.delete=function(){this.unschedule(this.moveSchedule)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],HeroEventData:[function(t,e,a){"use strict";cc._RF.push(e,"64f98mawDRIJ5z6cayMKn+D","HeroEventData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.HeroEventData=n.HeroEvent=void 0,function(t){t[t.Landing=0]="Landing",t[t.LeaveStage=1]="LeaveStage",t[t.Attack=2]="Attack",t[t.AttackEnd=3]="AttackEnd",t[t.Hited=4]="Hited",t[t.None=5]="None"}(n.HeroEvent||(n.HeroEvent={})),n.HeroEventData=function(){},cc._RF.pop()},{}],HeroLogic:[function(t,e,a){"use strict";cc._RF.push(e,"c437eshlg5DCZ2qeV9wTF0l","HeroLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PlayerAttribute"),r=n("GameData"),s=n("PublicEnum"),c=n("NumberMethod"),l=n("MainLogic"),h=n("ConfigData"),u=n("PublicConst"),d=function(){function t(t){this.heroSprite=t}return t.prototype.currrSkillLevel=function(){if(this.heroSprite.battleCamp==s.BATTLE_CAMP.Enemy)return 1;var t=l.default.Instance.roleLogic.getRoleData(r.default.Instance.playerData.roleId);if(null==t)return 1;for(var e=0;e<this.heroSprite.skills.length;++e)if(this.heroSprite.currSkill==this.heroSprite.skills[e]){var a=h.default.Instance.unlockSkillMap.get(this.heroSprite.skills[e].id),n=l.default.Instance.equipmentLogic.getSkillAddLevel(this.heroSprite.skills[e].id),i=t.skillLevel[a.skill_number-1];return i=0==i?r.default.Instance.playerData.level:i,(i+=n)>u.default.MAX_PLAYER_LEVEL&&(i=u.default.MAX_PLAYER_LEVEL),i}return 1},t.prototype.getOriginalNum=function(t,e){return void 0===e&&(e=0),this.getOriginalNumNormalMode(t,e)},t.prototype.getOriginalNumNormalMode=function(t,e){void 0===e&&(e=0);var a=0,n=null;l.default.Instance.combatScene.gameModel==s.GAME_MODEL.Normal&&(n=l.default.Instance.combatScene.combatLayer.dungeonInfo);var i=1,h=this.currrSkillLevel(),u=this.heroSprite,d=u.heroId,p=1;switch(u.battleCamp==s.BATTLE_CAMP.Self&&(d=r.default.Instance.playerData.roleId),t){case o.ATTRIBUTE_TYPE.HP:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[2],a+=u.roleInfo.hp*r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.HP_Rate)):(null!=n&&(i=n.hp_coefficient),a=u.roleInfo.hp*i*1);break;case o.ATTRIBUTE_TYPE.Attack:0==(p=u.heroStatus.hurtIndex)&&(p=1),u.currSkill.hurtRateList?(p=Math.min(p,u.currSkill.hurtRateList.length),u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d,5==this.heroSprite.combatLayer.dungeonInfo.type)[1],a=c.default.Instance.getAttackNum(a,u.battleCamp,u.heroAttri),a=(a=Math.max(a-e,.05*a))*u.currSkill.hurtRateList[p-1]*(1+(h-1)*u.currSkill.injury_coefficient_add)):(null!=n&&(i=n.atk_coefficient),a=u.roleInfo.atk*i,a=(a=Math.max(a-e,.05*a))*u.currSkill.hurtRateList[p-1]*1)):a=0;break;case o.ATTRIBUTE_TYPE.Attack_Speed:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[7],a=c.default.Instance.getAttackSpeed(a,u.battleCamp,u.heroAttri)):a=u.roleInfo.atk_speed;break;case o.ATTRIBUTE_TYPE.Crit_Rate:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[4],a=c.default.Instance.getCritRate(a,u.battleCamp,u.heroAttri)):a=u.roleInfo.crit_rate;break;case o.ATTRIBUTE_TYPE.Crit_Damage:u.battleCamp==s.BATTLE_CAMP.Self?(a=u.roleInfo.crit_damage,a=c.default.Instance.getCritDamage(a,u.battleCamp,u.heroAttri)):a=u.roleInfo.crit_damage;break;case o.ATTRIBUTE_TYPE.Def:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[3],a=c.default.Instance.getDefNum(a,u.battleCamp,u.heroAttri)):(null!=n&&(i=n.def_coefficient),a=u.roleInfo.def*i*1);break;case o.ATTRIBUTE_TYPE.Move_Speed:a=this.heroSprite.roleInfo.move_speed,a=c.default.Instance.getMoveSpeed(a,u.battleCamp,u.heroAttri);break;case o.ATTRIBUTE_TYPE.Hit_Rate:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[5],a*=1+r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Hit_Rate)):(null!=n&&(i=n.hit_coefficient),a=u.roleInfo.hit_rate*i*1);break;case o.ATTRIBUTE_TYPE.Agl_Rate:u.battleCamp==s.BATTLE_CAMP.Self?(a=l.default.Instance.roleLogic.getRoleAllAttr(d)[6],a*=1+r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Agl_Rate)):(null!=n&&(i=n.dodge_coeffcient),a=u.roleInfo.agl*i*1)}return a},t.prototype.getAtkBySkill=function(t,e){void 0===e&&(e=0);var a=0,n=r.default.Instance.playerData.roleId;if(this.heroSprite.battleCamp==s.BATTLE_CAMP.Self)a=l.default.Instance.roleLogic.getRoleAllAttr(n)[1],a=(a=Math.max(a-e,.05*a))*t.hurtRateList[0]*(1+0*t.injury_coefficient_add);else{var i=null,o=1;l.default.Instance.combatScene.gameModel==s.GAME_MODEL.Normal&&(i=l.default.Instance.combatScene.combatLayer.dungeonInfo),null!=i&&(o=i.atk_coefficient),a=this.heroSprite.roleInfo.atk*o,a=(a=Math.max(a-e,.05*a))*t.hurtRateList[0]*1}return a},t.prototype.selectControlEvent=function(){for(var t,e=null,a=1;a<this.heroSprite.skills.length;++a)if(this.heroSprite.skillManager.getSkillObj(this.heroSprite.skills[a].id).skillState==s.SKILL_STATE.CdOver&&null!=(e=this.findAttackByRadius(this.heroSprite.heroStatus.attackRadius,this.heroSprite.heroStatus.attackMinRadius)))return{event:t=s.CONTROL_EVENT.Control_Skill,target:e.target,atkType:a+1};return null!=(e=this.findAttackByRadius(this.heroSprite.heroStatus.attackRadius,this.heroSprite.heroStatus.attackMinRadius))?(t=s.CONTROL_EVENT.Control_Attack,e.isAssault&&(t=s.CONTROL_EVENT.Control_Assault),{event:t,target:e.target,atkType:1}):{event:t=s.CONTROL_EVENT.None,target:e}},t.prototype.findAttackByRadius=function(t,e){this.heroSprite=this.heroSprite;for(var a=null,n=!1,i=99999,o=l.default.Instance.mainLayer.heroSpriteList,r=0;r<o.length;r++){var c=o[r];if(c.lifeStatus!=s.LIFE_STATUS.Dead){if(-1==t){a=c;break}var h=this.heroSprite.node.getPosition().sub(c.node.getPosition()).mag();if(h<t){h<i&&(i=h,a=c,n=!(h<e));break}}}return{target:a,isAssault:n}},t.prototype.findAttackTarget=function(){if(this.heroSprite.battleCamp==s.BATTLE_CAMP.Enemy){var t=l.default.Instance.mainLayer.myHeroSprite;return t.lifeStatus==s.LIFE_STATUS.Dead?null:t}for(var e=l.default.Instance.mainLayer.heroSpriteList,a=0;a<e.length;a++)if(e[a].lifeStatus!=s.LIFE_STATUS.Dead)return e[a];return null},t.prototype.getExtraAttr=function(t,e,a){return l.default.Instance.equipmentLogic.getEquipmentExtraAttr(t,e,a)},t}();i.default=d,cc._RF.pop()},{}],HeroLog:[function(t,e,a){"use strict";cc._RF.push(e,"076507fe0hGH7JPv+RwglyD","HeroLog");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.log_stateMachine=!1,t.img_body_attack=!1,t.log_hurtData=!1,t.log_npc_ai=!1,t}();n.default=i,cc._RF.pop()},{}],HeroNode:[function(t,e,a){"use strict";cc._RF.push(e,"e95e7laviFGX7hsBLVWwa8N","HeroNode");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("HeroLog"),l=i("AssetUtils"),h=i("HeroEventData"),u=i("PublicEnum"),d=i("ConfigData"),p=i("NumberMethod"),f=i("PlayerAttribute"),y=i("MainLogic"),m=i("Dictionary"),g=i("MyMathUtils"),I=i("StringUtils"),_=i("SoundManager"),v=cc._decorator,S=v.ccclass,L=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeScale=1,e.loadFinish=!1,e.loadWingFinish=!1,e.loadTitleFinish=!1,e.slotMap=new m.Dictionary,e.runPath=[],e.runPathIndex=0,e.runFinish=!1,e.attackMoveSpeed=0,e.preHitHeroPos=cc.Vec2.ZERO,e.showWordCount=new Array,e.heroArmResId="",e.wingArmResId="",e.titleArmResId="",e.weaponId=0,e.weaponLevel=0,e.weaponShadowPoints=new Array,e.weaponTime=0,e}return r(e,t),e.prototype.init=function(t,e){var a=this;this.heroSprite=e,this.spineNode=cc.find("Spine",this.node),this.heroSpine=this.spineNode.getComponent(sp.Skeleton),this.wingNode=cc.find("Wing",this.node),this.wingDiplay=this.wingNode.getComponent(sp.Skeleton),this.effectNode=cc.find("Effect",this.node),this.bodyBox=cc.find("BodyBox",this.node),this.bodyBoxSprite=cc.find("sprite",this.bodyBox),this.titleNode=cc.find("Title",this.node),this.titleDiplay=this.titleNode.getComponent(sp.Skeleton);var n=this.heroSprite.roleInfo.res_id,i=null;if(t==u.BATTLE_CAMP.Self){var o=y.default.Instance.roleLogic.getRoleArmResId();if(n=o[0],i=o[1],this.wingArmResId=i,null!=i){var r=d.default.Instance.resourceMap.get(i).resource_way;this.wingNode.active=!0,l.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+r,null,function(){a.loadWingFinish=!0,a.playWingStand()},this)}else this.loadWingFinish=!1,this.wingNode.active=!1;this.titleArmResId=o[2],null!=this.titleArmResId?(this.titleNode.active=!0,l.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+this.titleArmResId,null,function(){a.loadTitleFinish=!0,a.playTitleStand()},this)):(this.loadTitleFinish=!1,this.titleNode.active=!1)}this.heroArmResId=n;var s=I.default.stringToStringListForRes(n),h=d.default.Instance.resourceMap.get(n),p=s[1]?s[1]:"";this.node.scale=h.scale,this.bodyHeight=this.heroSprite.roleInfo.height*h.scale,l.AssetUtils.loadSpine(this.heroSpine,"Animation/"+s[0],p,function(){a.loadFinish=!0,a.playStand(),a.heroSprite.battleCamp==u.BATTLE_CAMP.Self&&(a.weaponId=y.default.Instance.roleLogic.getRoleWeaponId(),y.default.Instance.roleLogic.changeWeaponSkin(a.heroSpine,a.weaponId),a.weaponLevel=y.default.Instance.roleLogic.getRoleWeaponLevel(),y.default.Instance.roleLogic.weaponUpgrade(a.heroSpine,a.weaponLevel,a.weaponId));var t=a;a.heroSpine.setEventListener(function(e,a){t.heroSprite.onFrameEvent1(a)})},this),c.default.img_body_attack?(cc.find("AttackBox/sprite",this.node).active=!0,cc.find("BodyBox/sprite",this.node).active=!0):(cc.find("AttackBox/sprite",this.node).active=!1,cc.find("BodyBox/sprite",this.node).active=!1)},e.prototype.say=function(){},e.prototype.resetData=function(){var t=this;if(this.heroSprite.battleCamp==u.BATTLE_CAMP.Enemy)this.node.zIndex=100;else{this.node.zIndex=9999;var e=y.default.Instance.roleLogic.getRoleArmResId();if(this.loadFinish){var a=e[0];if(a!=this.heroArmResId){this.heroArmResId=a;var n=I.default.stringToStringListForRes(a),i=d.default.Instance.resourceMap.get(a),o=n[1]?n[1]:"";this.node.scale=i.scale,this.heroSpine.setSkin(o),this.playStand(),this.weaponId=y.default.Instance.roleLogic.getRoleWeaponId(),y.default.Instance.roleLogic.changeWeaponSkin(this.heroSpine,this.weaponId),this.weaponLevel=y.default.Instance.roleLogic.getRoleWeaponLevel(),y.default.Instance.roleLogic.weaponUpgrade(this.heroSpine,this.weaponLevel,this.weaponId)}else{var r=y.default.Instance.roleLogic.getRoleWeaponId();r!=this.weaponId&&(this.weaponId=r,y.default.Instance.roleLogic.changeWeaponSkin(this.heroSpine,this.weaponId));var s=y.default.Instance.roleLogic.getRoleWeaponLevel();s!=this.weaponLevel&&(this.weaponLevel=s,y.default.Instance.roleLogic.weaponUpgrade(this.heroSpine,this.weaponLevel,r))}}if(this.loadWingFinish){var c=e[1];if(c!=this.wingArmResId&&null!=c){this.wingArmResId=c;var h=d.default.Instance.resourceMap.get(c).resource_way;this.loadWingFinish=!1,this.wingNode.active=!0,l.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+h,null,function(){t.loadWingFinish=!0,t.playWingStand()},this)}else c==this.wingArmResId&&null!=c?(this.loadWingFinish=!0,this.wingNode.active=!0):null==c&&(this.loadWingFinish=!1,this.wingNode.active=!1)}if(this.loadTitleFinish){var p=e[2];p!=this.titleArmResId&&null!=p?(this.titleArmResId=p,this.loadTitleFinish=!1,this.titleNode.active=!0,l.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+p,null,function(){t.loadTitleFinish=!0,t.playTitleStand()},this)):p==this.titleArmResId&&null!=p?(this.loadTitleFinish=!0,this.titleNode.active=!0):null==p&&(this.loadTitleFinish=!1,this.titleNode.active=!1)}this.schedule(this.heroWeaponShadow,0)}this.showWordCount=[],this.spineNode.scaleX=1,this.node.opacity=255,this.preHitHeroPos=cc.v2(this.node.x,this.node.y);var f=this.bodyBox.getComponent(cc.BoxCollider);f.offset=new cc.Vec2(0,this.heroSprite.roleInfo.bodyArea.height/2),f.size=this.heroSprite.roleInfo.bodyArea,this.heroSprite.heroStatus.bodyRadius=this.heroSprite.roleInfo.bodyArea.width,this.setNodeScale(),this.bodyBoxSprite.x=f.offset.x,this.bodyBoxSprite.y=f.offset.y,this.bodyBoxSprite.width=f.size.width,this.bodyBoxSprite.height=f.size.height,this.heroSprite.battleCamp==u.BATTLE_CAMP.Self?this.showBloodRateNum():this.spineNode.scaleX=this.heroSprite.heroStatus.face,this.showBody(),this.node.runAction(cc.sequence(cc.delayTime(5),cc.callFunc(function(){t.say()},this))),this.schedule(this.say,20),this.hideAttackBox()},e.prototype.updateHeroMoveSpeed=function(){this.heroSprite.heroStatus.moveSpeed=this.heroSprite.heroLogic.getOriginalNum(f.ATTRIBUTE_TYPE.Move_Speed)},e.prototype.setNodeScale=function(){var t=d.default.Instance.resourceMap.get(this.heroArmResId);this.node.scale=t.scale*this.heroSprite.heroAttri.getAttribute(f.ATTRIBUTE_TYPE.Body_size)},e.prototype.getRect=function(){var t=this.node.getPosition();return new cc.Rect(t.x-this.bodyBoxSprite.width/2,t.y-this.bodyBoxSprite.height/2,this.bodyBoxSprite.width,this.bodyBoxSprite.height)},e.prototype.getHeroPos=function(){return this.heroSprite.stateMachine.currState==u.HEOR_STATE.Hit?cc.v2(this.node.x,this.preHitHeroPos.y):cc.v2(this.node.x,this.node.y)},e.prototype.delete=function(){this.unscheduleAllCallbacks()},e.prototype.playStand=function(){this.timeScale=1,this.heroSpine.setAnimation(0,"stand",!0),this.heroSpine.timeScale=1,this.loadWingFinish&&this.playWingStand()},e.prototype.playMove=function(){4!=this.heroSprite.monsterType&&(this.timeScale=1,this.heroSpine.setAnimation(0,"move",!0),this.heroSpine.timeScale=1,this.loadWingFinish&&this.playWingMove())},e.prototype.playWingStand=function(){"stand"!=this.wingDiplay.animation&&(this.wingDiplay.setAnimation(0,"stand",!0),this.wingDiplay.timeScale=1)},e.prototype.playTitleStand=function(){this.titleDiplay.setAnimation(0,"stand",!0),this.titleDiplay.timeScale=1},e.prototype.playWingMove=function(){"move"!=this.wingDiplay.animation&&(this.wingDiplay.setAnimation(0,"move",!0),this.wingDiplay.timeScale=1)},e.prototype.playAssault=function(){4!=this.heroSprite.monsterType&&(this.timeScale=1,this.heroSpine.setAnimation(0,"move",!0),this.heroSpine.timeScale=1)},e.prototype.playJump=function(){4!=this.heroSprite.monsterType&&(this.timeScale=1,this.heroSpine.setAnimation(0,"jump",!0),this.heroSpine.timeScale=1)},e.prototype.playHit=function(t){4!=this.heroSprite.monsterType&&(this.timeScale=1,t=Math.max(t,1),this.heroSpine&&this.heroSpine.setAnimation(0,"hit"+t,!1),this.heroSpine.timeScale=1)},e.prototype.playAttack=function(){var t=this.heroSprite.battleCamp==u.BATTLE_CAMP.Self?this.heroSprite.heroStatus.normalAtkTimes2:1,e=this.heroSprite.heroLogic.getOriginalNum(f.ATTRIBUTE_TYPE.Attack_Speed);this.timeScale=p.default.Instance.getAttackSpeed(e,this.heroSprite.battleCamp,this.heroSprite.heroAttri),this.heroSpine.setAnimation(0,"attack"+t,!1),this.heroSpine.timeScale=this.timeScale,1==t&&this.heroSprite.battleCamp==u.BATTLE_CAMP.Self&&_.SoundManager.Instance.playEffect("pugong"+t),this.loadWingFinish&&this.playWingMove()},e.prototype.playSkill=function(t){var e=t||"skill";this.timeScale=1,this.heroSpine.setAnimation(0,e,!1),this.heroSpine.timeScale=this.timeScale,I.default.stringIsNull(this.heroSprite.currSkill.sound)||_.SoundManager.Instance.playEffect(this.heroSprite.currSkill.sound),this.loadWingFinish&&this.playWingMove()},e.prototype.playWarm=function(){this.timeScale=p.default.Instance.getAttackSpeed(this.heroSprite.roleInfo.atk_speed,this.heroSprite.battleCamp,this.heroSprite.heroAttri),this.heroSpine.setAnimation(0,"warning1",!0),this.heroSpine.timeScale=this.timeScale},e.prototype.moveToTargetEnemyPos=function(){var t=this.heroSprite.heroLogic.findAttackTarget(),e=cc.v2(this.node.x,this.node.y);t&&(e=t.heroNode.getHeroPos()),this.node.runAction(cc.moveTo(1.9,e))},e.prototype.controlMove=function(t,e,a){this.spineNode.scaleX=this.heroSprite.heroStatus.face,this.wingNode.scaleX=this.heroSprite.heroStatus.face;var n=.02*this.heroSprite.heroStatus.moveSpeed,i=.7;a&&(i=1);var o=this.node.x+Math.cos(e)*n,r=this.node.y+Math.sin(e)*n*i,s=y.default.Instance.mainLayer.currFightMap.fightMapData.objectInWall(o,r,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20),c=s.inWall,l=g.default.toAngle(s.angle);if(!(s.times>1)){var h=this.heroSprite.heroStatus.moveAngle;if(h<0&&(h+=360),l<0&&(l+=360),c){if(a)return;var u=l+180;return u>360&&(u-=360),void(Math.abs(l-h)<Math.abs(u-h)?this.controlMove(0,g.default.toRadian(l),!0):this.controlMove(0,g.default.toRadian(u),!0))}this.node.x=o,this.node.y=r}},e.prototype.heroWeaponShadow=function(t){if(this.loadFinish){var e=y.default.Instance.equipmentLogic.getEquipmentData(this.weaponId);if(null==e)return;if(5!=d.default.Instance.equipmentMap.get(e.equipmentId).type)return;if(this.weaponTime-=t,this.weaponTime>0)return;this.weaponTime=this.heroSprite.stateMachine.currState==u.HEOR_STATE.Attack?.1:.2;var a=this.getWeaponPoint();null!=a&&(this.weaponShadowPoints.length>0?this.weaponShadowPoints[this.weaponShadowPoints.length-1].pos.sub(a.pos).mag()>0&&(this.weaponShadowPoints.push(a),y.default.Instance.combatLayer.mainLayer.nodeManager.getWeaponShadow(this.heroSprite,this.weaponId,a)):(this.weaponShadowPoints.push(a),y.default.Instance.combatLayer.mainLayer.nodeManager.getWeaponShadow(this.heroSprite,this.weaponId,a))),this.weaponShadowPoints.length>6&&this.weaponShadowPoints.splice(0,1)}},e.prototype.getWeaponPoint=function(){var t=this.heroSpine.attachUtil,e=t.getAttachedNodes("dao211");0==e.length&&(t.generateAllAttachedNodes(),e=t.getAttachedNodes("dao211"));var a=e[0];if(a){var n=a.convertToWorldSpaceAR(cc.v2(0,0)),i=a.convertToWorldSpaceAR(cc.v2(1,0)),o=n.sub(i);return{pos:n,pos1:i,angle:180*cc.v2(1,0).signAngle(o)/Math.PI+180}}return null},e.prototype.canGoNextRoom=function(){var t=this.node.x,e=this.node.y,a=y.default.Instance.mainLayer.currFightMap.fightMapData.objectDoor(t,e,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20),n=a.inDoor,i=a.index;n&&(this.heroSprite.combatLayer.canGoNextRoom=!1,this.heroSprite.heroControl.handleControlEvent(u.CONTROL_EVENT.Control_Move_Cancel),this.heroSprite.combatLayer.goNextRoom(i))},e.prototype.findAccess=function(t){var e=this.heroSprite.combatLayer.mainLayer.currFightMap.fightMapData.getGridIndex(t);if(0==this.runPath.length)this.runPath=this.heroSprite.combatLayer.mainLayer.currFightMap.fightMapData.findAccess(cc.v2(this.node.x,this.node.y),t);else{var a=this.runPath[this.runPath.length-1];a.gridX==e.x&&a.gridY==e.y||(this.runPath=this.heroSprite.combatLayer.mainLayer.currFightMap.fightMapData.findAccess(cc.v2(this.node.x,this.node.y),t),this.runPathIndex=0)}for(var n=0;n<this.runPath.length;++n);},e.prototype.atkChangeFace=function(){var t=this.heroSprite.heroStatus.face;this.spineNode.scaleX=t,this.wingNode.scaleX=t},e.prototype.hitChangeFace=function(t){this.heroSprite.heroStatus.isMove=!1,this.spineNode.scaleX=t,this.wingNode.scaleX=t,this.heroSprite.heroStatus.face=t},e.prototype.controlFace=function(t){var e=1;t&&(e=-1),this.spineNode.scaleX=e,this.wingNode.scaleX=e,this.heroSprite.heroStatus.face=e},e.prototype.showAttackBox=function(t){if(null!=t){var e=1*t.scaleX,a=1*t.scaleY,n=1*t.x,i=1*-t.y;this.heroSprite.attackBox.x=n*this.heroSprite.heroStatus.face,this.heroSprite.attackBox.y=i,this.heroSprite.attackBoxSprite.width=100*e,this.heroSprite.attackBoxSprite.height=100*a,this.heroSprite.attackBoxCollider.size.width=100*e,this.heroSprite.attackBoxCollider.size.height=100*a,this.heroSprite.attackBox.active=!0;var o=new h.HeroEventData;o.x=this.heroSprite.attackBox.x*Math.abs(this.node.scaleX),o.y=this.heroSprite.attackBox.y*Math.abs(this.node.scaleY),this.heroSprite.triggerEvent(h.HeroEvent.Attack,o)}},e.prototype.showAttackBox1=function(t){if(null!=t){var e=1*t.scaleX,a=1*t.scaleY,n=1*t.x,i=1*t.y;this.heroSprite.attackBox.x=n*this.heroSprite.heroStatus.face,this.heroSprite.attackBox.y=i,this.heroSprite.attackBoxSprite.width=100*e,this.heroSprite.attackBoxSprite.height=100*a,this.heroSprite.attackBoxCollider.size.width=100*e,this.heroSprite.attackBoxCollider.size.height=100*a,this.heroSprite.attackBox.active=!0;var o=new h.HeroEventData;o.x=this.heroSprite.attackBox.x*Math.abs(this.node.scaleX),o.y=this.heroSprite.attackBox.y*Math.abs(this.node.scaleY),this.heroSprite.triggerEvent(h.HeroEvent.Attack,o)}},e.prototype.hideAttackBox=function(){this.heroSprite.attackBox.active=!1},e.prototype.controlStand=function(){this.heroSprite.heroStatus.isMove=!1,this.playStand()},e.prototype.controlAssault=function(){},e.prototype.assaultEnd=function(){},e.prototype.playJumpBack=function(){var t=cc.v2(this.node.x,this.preHitHeroPos.y),e=y.default.Instance.mainLayer.currFightMap.fightMapData.getJumpBackPos(t,this.heroSprite.heroStatus.face,150,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20).x-t.x,a=Math.abs(e)/(2*this.heroSprite.heroStatus.moveSpeed);return this.node.runAction(cc.moveBy(a,cc.v2(e,0)).easing(cc.easeSineOut())),a},e.prototype.hitMoveStart=function(t,e,a){var n=this;if(0==e[0]&&0==e[1])return 0;var i=e[0],o=e[1];0==this.heroSprite.roleInfo.is_fly&&(o=0),this.node.stopAllActions(),1==this.heroSprite.heroStatus.leaveGround||(this.preHitHeroPos=cc.v2(this.node.x,this.node.y));var r=cc.v2(this.node.x,this.preHitHeroPos.y),s=y.default.Instance.mainLayer.currFightMap.fightMapData.getHitRightPos(r,t,i,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20);return o>0?(this.heroSprite.heroStatus.leaveGround=1,this.node.runAction(cc.sequence(cc.jumpTo(.95*a,s.x,s.y,o,1),cc.callFunc(function(){n.heroSprite.heroStatus.leaveGround=0},this)))):this.node.runAction(cc.moveTo(.95*a,s)),a},e.prototype.hitMoveStart2=function(t,e){var a=this;if(0==e[0]&&0==e[1])return 0;var n=e[0],i=e[1];0==this.heroSprite.roleInfo.is_fly&&(i=0),this.preHitHeroPos=cc.v2(this.node.x,this.node.y);var o=cc.v2(this.node.x,this.node.y),r=y.default.Instance.mainLayer.currFightMap.fightMapData.getHitRightPos(o,t,n,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20),s=Math.abs(r.x-o.x)/(i<=0?100:i);return this.node.runAction(cc.sequence(cc.jumpTo(s,r.x,r.y,i,1),cc.delayTime(.3),cc.callFunc(function(){a.heroSprite.stateMachine.onStartDeadthState()},this))),s},e.prototype.hitMoveEnd=function(){this.effectNode.stopAllActions(),this.attackMoveEnd()},e.prototype.attackMoveStart=function(t){0!=t.x&&(this.attackMoveSpeed=t.x*this.heroSprite.heroStatus.face,this.schedule(this.scheduleAttackMove,0))},e.prototype.attackMoveEnd=function(){this.attackMoveSpeed=0,this.unschedule(this.scheduleAttackMove)},e.prototype.scheduleAttackMove=function(t){var e=this.attackMoveSpeed*t,a=this.node.x+e,n=this.node.y;y.default.Instance.mainLayer.currFightMap.fightMapData.objectInWall(a,n,this.heroSprite.heroStatus.bodyRadius*this.node.scale,20).inWall||(this.node.x=a,this.node.y=n)},e.prototype.showBloodRateNum=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0);var a=this.heroSprite.hp/this.heroSprite.hpMax;this.heroSprite.battleCamp==u.BATTLE_CAMP.Self?y.default.Instance.combatLayer.uiLayer.showBlood1(this.heroSprite.heroId,a):(y.default.Instance.combatLayer.mainLayer.hideHpTube(),0!=e&&this.heroSprite.hpTubeSprite.changeBlood(e))},e.prototype.addEffect_showNum=function(t,e){var a=this.node.getPosition(),n=y.default.Instance.mainLayer.nodeManager.getEffect(e,cc.v2(a.x,a.y+this.bodyHeight+50),1.5,t);this.heroSprite.combatLayer.mainLayer.currFightMap.effectLayer.addChild(n.node)},e.prototype.addEffect=function(t,e,a,n,i){t==u.EFFECT_TYPE.Show_Word&&(e.y=e.y+50*this.showWordCount.length,this.showWordCount.push({time:(new Date).getTime(),y:e.y}));var o=y.default.Instance.combatScene.combatLayer.mainLayer.nodeManager.getEffect(t,e,a,0,n,i);return t==u.EFFECT_TYPE.Effect_hit||t==u.EFFECT_TYPE.Effect_hit2||t==u.EFFECT_TYPE.Effect_wudi||t==u.EFFECT_TYPE.Efffect_forzen||t==u.EFFECT_TYPE.Effect_particle||t==u.EFFECT_TYPE.Show_Dodge1||t==u.EFFECT_TYPE.Effect_Stoic||t==u.EFFECT_TYPE.Show_Say||t==u.EFFECT_TYPE.Show_Word||t==u.EFFECT_TYPE.Show_Word2||t==u.EFFECT_TYPE.Effect_dead||t==u.EFFECT_TYPE.Effect_Upgrade?this.effectNode.addChild(o.node):t==u.EFFECT_TYPE.Effect_SKZ||t==u.EFFECT_TYPE.Effect_Boss_Light?this.heroSprite.combatLayer.mainLayer.currFightMap.shadowLayer.addChild(o.node):this.heroSprite.combatLayer.mainLayer.currFightMap.effectLayer.addChild(o.node),o},e.prototype.hideBody=function(){cc.find("Spine",this.node).active=!1},e.prototype.showBody=function(){cc.find("Spine",this.node).active=!0},e.prototype.birthAction=function(){var t=this;this.node.opacity=0,this.heroSprite.battleCamp==u.BATTLE_CAMP.Enemy?(this.hideBody(),this.scheduleOnce(function(){t.showBody(),t.playStand(),t.scheduleOnce(function(){t.node.opacity=255,t.heroSprite.stateMachine.onFinishBirthState(),3!=t.heroSprite.monsterType&&5!=t.heroSprite.monsterType||(t.effectSprite=t.addEffect(u.EFFECT_TYPE.Effect_Boss_Light,cc.v2(t.getHeroPos().x,t.getHeroPos().y),999999,1,""),t.effectSprite.node.scale=t.node.scale)},.1)},.1)):(_.SoundManager.Instance.playEffect("chuchang"),this.scheduleOnce(function(){t.showBody(),t.playStand(),t.scheduleOnce(function(){t.node.opacity=255,t.heroSprite.stateMachine.onFinishBirthState()},.1)},.1))},e.prototype.deadAction=function(){var t=this;if(this.wingNode&&(this.wingNode.active=!1),4==this.heroSprite.monsterType)return this.heroSpine.setAnimation(0,"skill1",!1),void this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.heroSpine.setAnimation(0,"skill2",!0)},this)));null!=this.effectSprite&&this.effectSprite.delete(),this.effectNode.runAction(cc.sequence(cc.callFunc(function(){t.addEffect(u.EFFECT_TYPE.Effect_dead,cc.v2(0,0),2,1,"").node.scaleX=-1*t.heroSprite.heroStatus.hitFlyDir},this),cc.delayTime(.1),cc.callFunc(function(){t.hideBody(),_.SoundManager.Instance.playEffect("siwangyinxiao")},this)))},e.prototype.scaleTo=function(t,e){var a=d.default.Instance.resourceMap.get(this.heroArmResId);this.node.runAction(cc.scaleTo(t,e*a.scale*this.heroSprite.heroAttri.getAttribute(f.ATTRIBUTE_TYPE.Body_size)))},e.prototype.getBodyCenter=function(){var t=new cc.Vec2(this.bodyBoxSprite.getPosition().x,this.bodyBoxSprite.getPosition().y+this.node.scaleY);return t.x+=this.node.getPosition().x,t.y+=this.node.getPosition().y,t},s([S],e)}(cc.Component));o.default=L,cc._RF.pop()},{}],HeroShooter:[function(t,e,a){"use strict";cc._RF.push(e,"edf9398s8hPoLTfMogklCHW","HeroShooter");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("ConfigData"),h=i("StringUtils"),u=i("MainLogic"),d=i("MyMathUtils"),p=i("SoundManager"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletSpriteList=new Array,e}return r(e,t),e.prototype.init=function(t){this.heroSprite=t},e.prototype.resetData=function(){},e.prototype.shootingBullet=function(){var t=this.heroSprite.currSkill;if(t.skill_type==c.SKILL_TYPE.Type_3){null==(m=this.findAtkPosition())&&(m=this.heroSprite.heroNode.getHeroPos()),this.bulletSpriteList.splice(0,this.bulletSpriteList.length);for(var e=0;e<this.heroSprite.currSkill.hurtStartList.length;e++){(n=this.heroSprite.heroNode.getHeroPos()).x=n.x+this.heroSprite.currSkill.hurtStartList[e][0]*this.heroSprite.heroStatus.face,n.y=n.y+this.heroSprite.currSkill.hurtStartList[e][1];var a=1==this.heroSprite.heroStatus.face?0:180;this.bulletSpriteList.push(u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,n,m,a))}}else if(t.skill_type==c.SKILL_TYPE.Type_2027)this.bulletSpriteList.splice(0,this.bulletSpriteList.length),null==(m=this.findAtkPosition())&&(m=this.heroSprite.heroNode.getHeroPos()),this.bulletSpriteList.push(u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,m,null,0));else if(t.skill_type==c.SKILL_TYPE.Type_1008){this.bulletSpriteList.splice(0,this.bulletSpriteList.length);var n=u.default.Instance.combatScene.mainCameraNode.convertToWorldSpaceAR(cc.Vec2.ZERO);for(n=u.default.Instance.mainLayer.currFightMap.objectLayer.convertToNodeSpaceAR(n),e=0;e<t.hurtStartList.length;e++){null==(f=this.findAtkPosition())&&(f=this.heroSprite.heroNode.getHeroPos()),(y=cc.v2(n.x,f.y)).x=y.x+this.heroSprite.currSkill.hurtStartList[e][0],y.y=y.y+this.heroSprite.currSkill.hurtStartList[e][1];var i=u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,y,null,0);this.bulletSpriteList.push(i)}}else if(t.skill_type==c.SKILL_TYPE.Type_1001){var o=this.heroSprite.heroStatus.face;this.bulletSpriteList.splice(0,this.bulletSpriteList.length),n=this.heroSprite.heroNode.getHeroPos();var r=t.shot_range;for(e=0;e<t.bulletAngleList.length;e++){var s,l=90-90*o+t.bulletAngleList[e]*o*-1,h=(.4*Math.random()+.8)*r,p=cc.v2(n.x+h*Math.cos(d.default.toRadian(l)),n.y+h*Math.sin(d.default.toRadian(l)));p=u.default.Instance.combatScene.homeLayer.streetLayer.currFightMap.fightMapData.getRightPos(p),a=90*o*-1+(a=t.bulletAngleList[e])*o*-1,s=Math.min(e,this.heroSprite.currSkill.hurtStartList.length-1),(y=cc.v2(n.x,n.y)).x=y.x+this.heroSprite.currSkill.hurtStartList[s][0]*this.heroSprite.heroStatus.face,y.y=y.y+this.heroSprite.currSkill.hurtStartList[s][1],i=u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,y,p,a),this.bulletSpriteList.push(i)}}else if(t.skill_type==c.SKILL_TYPE.Type_2028)for(this.bulletSpriteList.splice(0,this.bulletSpriteList.length),e=0;e<t.hurtStartList.length;e++){var f,y;null==(f=this.findAtkPosition())&&(f=this.heroSprite.heroNode.getHeroPos()),(y=cc.v2(f.x,f.y)).x=y.x+-1*this.heroSprite.heroStatus.face*this.heroSprite.currSkill.hurtStartList[e][0],y.y=y.y+this.heroSprite.currSkill.hurtStartList[e][1],i=u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,y,f,0),this.bulletSpriteList.push(i)}else if(t.skill_type==c.SKILL_TYPE.Type_2029){var m;this.bulletSpriteList.splice(0,this.bulletSpriteList.length),null==(m=this.findAtkPosition())&&(m=this.heroSprite.heroNode.getHeroPos());var g=this.getBulletPosList(m,t.shot_range,5);for(e=0;e<5;e++)this.bulletSpriteList.push(u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,this.heroSprite.currSkill.id,null,g[e],null,0))}},e.prototype.shootBulletByBuff=function(t){for(var e=this.heroSprite.buffManager.querySkillBuff(),a=0;a<e.length;a++){var n=e[a],i=l.default.Instance.skillMap.get(n);if(4==i.skill_condition){var o=Math.random();if(i.condition_value<o)continue}h.default.stringIsNull(i.sound)||p.SoundManager.Instance.playEffect(i.sound);var r=t.heroNode.getBodyCenter();null!=i.hurtStartList&&i.hurtStartList.length>0&&(r.x+=i.hurtStartList[0][0],r.y+=i.hurtStartList[0][1]),u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(this.heroSprite,n,t,r,null,0).mainStep()}},e.prototype.findAtkPosition=function(){var t,e=this.heroSprite.heroCollider.getLastAtkHero();if(null!=e)return cc.v2(e.node.x,e.node.y+80);this.heroSprite.battleCamp==c.BATTLE_CAMP.Self?t=u.default.Instance.combatLayer.mainLayer.heroSpriteList:(t=new Array).push(u.default.Instance.combatLayer.mainLayer.myHeroSprite);for(var a=this.heroSprite.node.getPosition(),n=this.heroSprite.heroStatus.face,i=cc.v2(0,0),o=0,r=0;r<t.length;r++){var s=t[r];if(null!=s&&s.lifeStatus==c.LIFE_STATUS.Alive){var l=s.node.getPosition();if(-1==n){if(l.x>a.x)continue}else if(l.x<a.x)continue;i.x+=l.x,i.y+=l.y,o++}}return 0==o?null:(i.x=i.x/o,i.y=i.y/o,i)},e.prototype.getBulletPosList=function(t,e,a){for(var n=new Array,i=!0;i;){var o=Math.random()*e,r=cc.v2(o,0),s=d.default.randomInt(0,360);s>180&&(s-=360);var c=r.rotate(s*Math.PI/180);c=cc.v2(t.x+c.x,t.y+c.y),u.default.Instance.mainLayer.currFightMap.fightMapData.objectInWall(c.x,c.y,30,30).inWall||(c=u.default.Instance.mainLayer.currFightMap.fightMapData.getItemDropPos(c),n.push(c)),n.length==a&&(i=!1)}return n},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],HeroSprite:[function(t,e,a){"use strict";cc._RF.push(e,"cd73fxuFkhEiJgY8xQ/waVL","HeroSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("HeroEventData"),h=i("PlayerAttribute"),u=i("HeroLogic"),d=i("ConfigData"),p=i("SkillManager"),f=i("BuffManager"),y=i("BuffEnum"),m=i("MainLogic"),g=i("MyMathUtils"),I=i("NumberMethod"),_=i("StringUtils"),v=cc._decorator,S=v.ccclass,L=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.battleCamp=c.BATTLE_CAMP.Self,e.lifeStatus=c.LIFE_STATUS.Init,e.skills=new Array,e.hpExp=0,e.preExp=0,e.monsterType=0,e.starStopAllEnemyAction=!1,e}return r(e,t),e.prototype.init=function(t,e,a){this.combatLayer=e,this.heroId=a,this.roleInfo=d.default.Instance.roleMap.get(this.heroId);for(var n=0;n<this.roleInfo.skillPools.length;++n){var i=d.default.Instance.skillMap.get(this.roleInfo.skillPools[n]);this.skills.push(i)}this.passiveSkill1=d.default.Instance.skillMap.get(this.roleInfo.skill_passive1),this.passiveSkill2=d.default.Instance.skillMap.get(this.roleInfo.skill_passive2),this.heroAttri=new h.PlayerAttribute,this.heroLogic=new u.default(this),this.skillManager=new p.default(this),this.buffManager=new f.default(this),this.heroStatus=this.node.getComponent("HeroStatus"),this.heroStatus.init(this),this.heroStatus.moveSpeed=this.heroLogic.getOriginalNum(h.ATTRIBUTE_TYPE.Move_Speed),this.heroNode=this.node.getComponent("HeroNode"),this.heroNode.init(t,this),this.stateMachine=this.node.getComponent("HeroStateMachine"),this.stateMachine.init(this),this.heroControl=this.node.getComponent("HeroControl"),this.heroControl.init(this),this.npcAi=this.node.getComponent("NpcAi"),this.npcAi.init(this),this.attackBox=cc.find("AttackBox",this.node),this.attackBoxSprite=cc.find("sprite",this.attackBox),this.attackBoxCollider=this.attackBox.getComponent(cc.BoxCollider),this.heroCollider=this.attackBox.getComponent("HeroCollider"),this.heroCollider.init(this),this.attackBox.active=!1,this.heroShooter=this.node.getComponent("HeroShooter"),this.heroShooter.init(this)},e.prototype.resetDataMain=function(t,e,a){this.resetData(t,e,a)},e.prototype.resetData=function(t,e,a){if(this.battleCamp=t,this.lifeStatus=c.LIFE_STATUS.Alive,this.monsterType=a,this.randomId=Math.floor(1e6*Math.random()),this.birthPosition=e,this.node.x=e.x,this.node.y=e.y,this.hpMax=this.heroLogic.getOriginalNum(h.ATTRIBUTE_TYPE.HP),this.hp=this.hpMax,this.preExp=0,this.battleCamp==c.BATTLE_CAMP.Enemy&&(this.hpTubeSprite=this.combatLayer.mainLayer.nodeManager.getHeroHpTubeSprite(this.heroId,this),1!=this.combatLayer.dungeonInfo.type&&5!=this.combatLayer.dungeonInfo.type)){var n=m.default.Instance.chapterLogic.getMonsterDeathReward(this.monsterType,!1);this.hpExp=n[0][1]/this.hpMax}this.heroAttri.reset(),this.heroStatus.resetData(),this.stateMachine.resetData(),this.heroControl.resetData(),this.skillManager.resetData(),this.buffManager.resetData(),this.heroNode.resetData(),this.heroCollider.resetData(),this.heroShooter.resetData(),this.npcAi.reset()},e.prototype.update=function(t){if(this.lifeStatus!=c.LIFE_STATUS.Dead&&(this.skillManager.logicUpdate(t),this.buffManager.logicUpdate(t),null!=this.heroNode.effectSprite&&(this.heroNode.effectSprite.node.x=this.heroNode.getHeroPos().x,this.heroNode.effectSprite.node.y=this.heroNode.getHeroPos().y),0!=this.heroNode.showWordCount.length)){for(var e=new Array,a=(new Date).getTime(),n=0;n<this.heroNode.showWordCount.length;++n)(a-this.heroNode.showWordCount[n].time)/1e3<1&&e.push(this.heroNode.showWordCount[n]);this.heroNode.showWordCount=e}},e.prototype.delete=function(){this.lifeStatus=c.LIFE_STATUS.Dead,this.battleCamp==c.BATTLE_CAMP.Enemy&&this.combatLayer.gameStep==c.GAME_STEP.Starting&&(this.combatLayer.uiLayer.currRoomdeadMonsterNum++,this.combatLayer.uiLayer.deadMonsterNum++,this.combatLayer.uiLayer.showMonsterNum(),m.default.Instance.equipmentLogic.recordArmKillMonster()),this.node.stopAllActions(),this.unscheduleAllCallbacks(),this.heroControl.delete(),this.heroNode.delete(),this.hpTubeSprite&&this.hpTubeSprite.delete(),this.combatLayer.mainLayer.nodeManager.putHeroSprite(this)},e.prototype.pauseHero=function(){this.node.pauseAllActions(),this.heroNode.effectNode.pauseAllActions(),this.stateMachine.stateNode.pauseAllActions(),this.npcAi.npcAiNode.pauseAllActions(),cc.director.getScheduler().pauseTarget(this),cc.director.getScheduler().pauseTarget(this.stateMachine),cc.director.getScheduler().pauseTarget(this.heroNode),cc.director.getScheduler().pauseTarget(this.heroStatus),cc.director.getScheduler().pauseTarget(this.heroControl),cc.director.getScheduler().pauseTarget(this.npcAi),this.pauseAnimation()},e.prototype.pauseAnimation=function(){this.heroNode.heroSpine.timeScale=0},e.prototype.resumeAnimation=function(){this.heroNode.heroSpine.timeScale=this.heroNode.timeScale},e.prototype.resumeHero=function(){this.node.resumeAllActions(),this.heroNode.effectNode.resumeAllActions(),this.stateMachine.stateNode.resumeAllActions(),this.npcAi.npcAiNode.resumeAllActions(),cc.director.getScheduler().resumeTarget(this),cc.director.getScheduler().resumeTarget(this.stateMachine),cc.director.getScheduler().resumeTarget(this.heroNode),cc.director.getScheduler().resumeTarget(this.heroStatus),cc.director.getScheduler().resumeTarget(this.heroControl),cc.director.getScheduler().resumeTarget(this.npcAi),this.resumeAnimation()},e.prototype.hitEvent=function(t,e,a,n,i,o,r,s){if(this.battleCamp==c.BATTLE_CAMP.Enemy){var h=new l.HeroEventData;this.npcAi.onEvent(l.HeroEvent.Hited,h)}if(this.stateMachine.currState!=c.HEOR_STATE.Flash&&(n?this.heroNode.addEffect(c.EFFECT_TYPE.Effect_hit2,cc.v2(0,this.roleInfo.height/2)):this.heroNode.addEffect(c.EFFECT_TYPE.Effect_hit,cc.v2(0,this.roleInfo.height/2)),(this.stateMachine.currState!=c.HEOR_STATE.Attack||0!=this.currSkill.be_break||this.lifeStatus!=c.LIFE_STATUS.Alive)&&!(0==this.roleInfo.is_beat&&this.lifeStatus!=c.LIFE_STATUS.Dead||this.heroStatus.stoicState>0&&this.lifeStatus==c.LIFE_STATUS.Alive))){var u=d.default.Instance.skillMap.get(o);this.skillManager.addEnergy(u.energy,7),u&&u.shakeScreen&&m.default.Instance.combatScene.mainCamera.run(u.shakeScreen),this.stateMachine.onStartHitState(t,e,a,i,r,s)}},e.prototype.onFrameEvent=function(t){var e=t.name,a=t.data,n=null;if(null!=e){null!=a&&(n=a.ints);var i=1;if(e.startsWith("hurtstart")){var o=e.indexOf("_");if(-1!=o){var r=e.substring(o+1,e.length);i=parseInt(r),e=e.substr(0,o),console.log("onFrameEvent parame , name:"+e+",num:"+i)}}var s=t.bone,h=null;null!=s&&(h=s.animationPose);var u=1;switch(null!=n&&n.length>0&&(u=n[0]),u=Math.max(1,u),e){case"hurtstart":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.hurtIndex=u,this.heroNode.showAttackBox(h));break;case"hurtend":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroNode.hideAttackBox(),this.triggerEvent(l.HeroEvent.AttackEnd));break;case"waitattack":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.normalAtkStatus=0);break;case"nextattack":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.nextAtkStatus=1,1==this.heroStatus.normalAtkStatus&&this.stateMachine.onStartAttackState());break;case"movestart":this.stateMachine.currState==c.HEOR_STATE.Attack&&this.heroNode.attackMoveStart(this.currSkill.move_impulse[u-1]);break;case"moveend":this.stateMachine.currState==c.HEOR_STATE.Attack&&this.heroNode.attackMoveEnd();break;case"over":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction&&(this.starStopAllEnemyAction=!1,this.combatLayer.mainLayer.resumeAllHero(!1)),this.stateMachine.onFinishAttackState());break;case"stop":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction=!0,this.combatLayer.mainLayer.pauseAllHero(!1));break;case"start":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction=!1,this.combatLayer.mainLayer.resumeAllHero(!1));break;case"shoot":if(this.heroShooter.bulletSpriteList.length>0){console.log("shoot bulletSpriteList");for(var d=0;d<this.heroShooter.bulletSpriteList.length;d++)this.heroShooter.bulletSpriteList[d].mainStep()}else console.log("shoot normal"),this.heroShooter.shootingBullet()}}},e.prototype.onFrameEvent1=function(t){var e=t.data.name;if(null!=e){var a=1;if(e.startsWith("hurtstart")){var n=e.indexOf("_");if(-1!=n){var i=e.substring(n+1,e.length);a=parseInt(i),e=e.substr(0,n),console.log("onFrameEvent parame , name:"+e+",num:"+a)}}var o=null;t.stringValue.length&&(o=this.heroNode.heroSpine.findSlot(t.stringValue).bone);var r=t.intValue;switch(null==r&&(r=0),r=Math.max(1,r),e){case"hurtstart":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.hurtIndex=r,this.heroNode.showAttackBox1(o));break;case"hurtend":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroNode.hideAttackBox(),this.triggerEvent(l.HeroEvent.AttackEnd));break;case"waitattack":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.normalAtkStatus=0);break;case"nextattack":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.heroStatus.nextAtkStatus=1,1==this.heroStatus.normalAtkStatus&&this.stateMachine.onStartAttackState());break;case"movestart":this.stateMachine.currState==c.HEOR_STATE.Attack&&this.heroNode.attackMoveStart(this.currSkill.move_impulse[r-1]);break;case"moveend":this.stateMachine.currState==c.HEOR_STATE.Attack&&this.heroNode.attackMoveEnd();break;case"over":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction&&(this.starStopAllEnemyAction=!1,this.combatLayer.mainLayer.resumeAllHero(!1)),this.stateMachine.onFinishAttackState());break;case"stop":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction=!0,this.combatLayer.mainLayer.pauseAllHero(!1));break;case"start":this.stateMachine.currState==c.HEOR_STATE.Attack&&(this.starStopAllEnemyAction=!1,this.combatLayer.mainLayer.resumeAllHero(!1));break;case"shoot":if(this.heroShooter.bulletSpriteList.length>0){console.log("shoot bulletSpriteList");for(var s=0;s<this.heroShooter.bulletSpriteList.length;s++)this.heroShooter.bulletSpriteList[s].mainStep()}else console.log("shoot normal"),this.heroShooter.shootingBullet()}}},e.prototype.triggerEvent=function(){},e.prototype.logPosition=function(){console.log("HeroSprite position:"+this.node.getPosition())},e.prototype.dropReward=function(){var t=m.default.Instance.combatLayer.dungeonInfo,e=d.default.Instance.chapterTypeMap.get(t.chapter);if(this.battleCamp==c.BATTLE_CAMP.Enemy&&4!=this.monsterType){var a=m.default.Instance.chapterLogic.getMonsterDeathReward(this.monsterType);if(a&&1==e)for(var n=this.getRandomPos(a.length),i=0;i<a.length;++i)this.combatLayer.mainLayer.nodeManager.getDropItemSprite(a[i][0],a[i][2],a[i][1],cc.v2(this.node.x,this.node.y),n[i])}},e.prototype.hurtData=function(t,e,a){switch(t){case h.ATTRIBUTE_TYPE.HP:if(this.heroNode.showBloodRateNum(!0),e=Math.floor(e),this.hp+=e,this.hp>this.hpMax&&(this.hp=this.hpMax),this.hp<=0&&(this.hp=0),this.heroNode.showBloodRateNum(!1,e),a?this.heroNode.addEffect_showNum(Math.abs(e),c.EFFECT_TYPE.Show_Crit_Num):this.battleCamp==c.BATTLE_CAMP.Enemy?this.heroNode.addEffect_showNum(Math.abs(e),c.EFFECT_TYPE.Show_Attack_Num):this.heroNode.addEffect_showNum(Math.abs(e),c.EFFECT_TYPE.Show_ReBlood),1!=m.default.Instance.combatLayer.dungeonInfo.type&&5!=m.default.Instance.combatLayer.dungeonInfo.type&&this.battleCamp==c.BATTLE_CAMP.Enemy&&0!=this.hp){var n=[1001,1001,1001,1005,1004][m.default.Instance.combatLayer.dungeonInfo.type],i=Math.floor(Math.abs(this.hpMax-this.hp)*this.hpExp),o=i-this.preExp;o>0&&(o=I.default.Instance.getExpNum(o,this.battleCamp,this.heroAttri),o=Math.floor(o),this.combatLayer.uiLayer.showMoney(o,!0)),this.preExp=i;var r=i;r=Math.max(4,r),r=Math.min(8,r);for(var s=0;s<r;s++)this.combatLayer.mainLayer.nodeManager.getItemSprite(n,this.heroNode.getHeroPos(),0,r,s+1)}break;case h.ATTRIBUTE_TYPE.Body_size:this.heroAttri.updateAttribute(t,e),this.heroNode.setNodeScale();break;case h.ATTRIBUTE_TYPE.ADD_HP:var l=this.hp;this.hp+=e,this.hp>this.hpMax&&(this.hp=this.hpMax),this.hp<=0&&(this.hp=0),e=this.hp-l,this.heroNode.showBloodRateNum(!1,e),e=Math.floor(e),this.battleCamp==c.BATTLE_CAMP.Self&&e>0&&this.heroNode.addEffect_showNum(e,c.EFFECT_TYPE.Show_Add_Hp);break;case h.ATTRIBUTE_TYPE.HP_Rate:var u=this.hp;e=this.hpMax*e,this.hpMax+=e,this.hp+=e,this.hp<=0&&(this.hp=0),e=this.hp-u,this.heroNode.showBloodRateNum(!1,e),this.battleCamp==c.BATTLE_CAMP.Self&&e>0&&this.heroNode.addEffect(c.EFFECT_TYPE.Show_Word,cc.v2(0,this.roleInfo.height+50),1,0,"\u8840\u91cf\u4e0a\u9650\u589e\u52a0"+Math.floor(e));break;case h.ATTRIBUTE_TYPE.Move_Speed:this.heroAttri.updateAttribute(t,e),this.heroNode.updateHeroMoveSpeed();break;case h.ATTRIBUTE_TYPE.Stoic:this.battleCamp==c.BATTLE_CAMP.Self&&e>0&&this.heroNode.addEffect(c.EFFECT_TYPE.Show_Word,cc.v2(0,this.roleInfo.height+50),1,0,"\u9738\u4f53"),this.heroStatus.stoicState=e;break;default:this.heroAttri.updateAttribute(t,e),this.addAttrWord(t,e)}},e.prototype.addAttrWord=function(t,e){var a="";switch(t){case h.ATTRIBUTE_TYPE.Attack:a="\u653b\u51fb\u529b\uff1a+"+e;break;case h.ATTRIBUTE_TYPE.Attack_Rate:a="\u653b\u51fb\u529b\u589e\u52a0"+_.default.intFormate(100*e)+"%";break;case h.ATTRIBUTE_TYPE.Attack_Speed:a="\u653b\u901f\uff1a+"+e;break;case h.ATTRIBUTE_TYPE.Crit_Rate:a="\u66b4\u51fb\u7387\uff1a+"+_.default.intFormate(100*e)+"%";break;case h.ATTRIBUTE_TYPE.Crit_Damage:a="\u66b4\u51fb\u4f24\u5bb3\uff1a+"+e;break;case h.ATTRIBUTE_TYPE.Move_Speed:a="\u79fb\u52a8\u901f\u5ea6\uff1a+"+e;break;case h.ATTRIBUTE_TYPE.Def:a="\u9632\u5fa1\u529b\uff1a+"+e;break;case h.ATTRIBUTE_TYPE.Def_Rate:a="\u9632\u5fa1\u529b\u589e\u52a0"+_.default.intFormate(100*e)+"%";break;case h.ATTRIBUTE_TYPE.Exp_Rate:a="\u7ecf\u9a8c\u589e\u52a0"+_.default.intFormate(100*e)+"%";break;case h.ATTRIBUTE_TYPE.Hit_Rate:a="\u547d\u4e2d\u7387\u589e\u52a0"+_.default.intFormate(100*e)+"%";break;case h.ATTRIBUTE_TYPE.Agl_Rate:a="\u95ea\u907f\u7387\u589e\u52a0"+_.default.intFormate(100*e)+"%"}a.length>0&&this.battleCamp==c.BATTLE_CAMP.Self&&e>0&&this.heroNode.addEffect(c.EFFECT_TYPE.Show_Word,cc.v2(0,this.roleInfo.height+50),1,0,a)},e.prototype.showBuffBiaoShi=function(){},e.prototype.hurtStatus=function(t,e,a){if(this.lifeStatus!=c.LIFE_STATUS.Dead)switch(t){case y.BUFF_TYPE.Forzen:if(3==this.monsterType||5==this.monsterType)break;e==y.BUFF_EFFECT_EVENT.Start?(this.heroStatus.isMove=!1,this.heroNode.controlStand(),this.stateMachine.onStartStandState(),this.heroNode.addEffect(c.EFFECT_TYPE.Efffect_forzen,cc.v2(0,this.roleInfo.height/2),a),this.heroStatus.isForzen=!0,this.heroNode.timeScale=0,this.heroNode.heroSpine.timeScale=0,this.battleCamp==c.BATTLE_CAMP.Enemy&&this.npcAi.stopAllAction()):e==y.BUFF_EFFECT_EVENT.End&&(this.heroStatus.isForzen=!1,this.stateMachine.onStartStandState());break;case y.BUFF_TYPE.Stoic:e==y.BUFF_EFFECT_EVENT.Start&&this.heroNode.addEffect(c.EFFECT_TYPE.Effect_Stoic,cc.v2(0,this.roleInfo.height/2),a);break;case y.BUFF_TYPE.Crit_Rate:e==y.BUFF_EFFECT_EVENT.Start?this.combatLayer.uiLayer.showBuffBiaoShi("Crit",a):y.BUFF_EFFECT_EVENT.End;break;case y.BUFF_TYPE.Exp_Rate:e==y.BUFF_EFFECT_EVENT.Start?this.combatLayer.uiLayer.showBuffBiaoShi("Exp",a):y.BUFF_EFFECT_EVENT.End;break;case y.BUFF_TYPE.ADD_ATK_RATE:e==y.BUFF_EFFECT_EVENT.Start?this.combatLayer.uiLayer.showBuffBiaoShi("Atk",a):y.BUFF_EFFECT_EVENT.End;break;case y.BUFF_TYPE.ADD_HP:case y.BUFF_TYPE.HP_RATE:e==y.BUFF_EFFECT_EVENT.Start?this.combatLayer.uiLayer.showBuffBiaoShi("Hp",a):y.BUFF_EFFECT_EVENT.End;break;case y.BUFF_TYPE.Def_Rate:e==y.BUFF_EFFECT_EVENT.Start?this.combatLayer.uiLayer.showBuffBiaoShi("Def",a):y.BUFF_EFFECT_EVENT.End}},e.prototype.hurtEvent=function(t){switch(t){case c.SKILL_EVENT.Dead:if(this.lifeStatus==c.LIFE_STATUS.Dead)return;this.battleCamp==c.BATTLE_CAMP.Enemy&&this.combatLayer.mainLayer.monsterManager.isLastWave&&(1!=this.combatLayer.getLifeEnemyCount()&&3!=this.monsterType||(this.heroNode.addEffect(c.EFFECT_TYPE.Effect_Jisha,cc.v2(this.node.x,this.node.y),2),m.default.Instance.combatScene.mainCamera.gameTimeScale())),this.lifeStatus=c.LIFE_STATUS.Dead}},e.prototype.cdOver=function(){},e.prototype.revived=function(){this.wudiAction(5),this.lifeStatus=c.LIFE_STATUS.Alive,this.hp=this.hpMax,this.heroNode.showBloodRateNum(!0),this.heroStatus.hardAndStraight=!1,this.stateMachine.onStartStandState(),this.skillManager.reviedSkillCd()},e.prototype.cancelRevived=function(){this.stateMachine.onStartDeadthState()},e.prototype.wudiAction=function(t){var e=this;this.heroStatus.isWudi=!0,this.heroNode.addEffect(c.EFFECT_TYPE.Effect_wudi,cc.v2(0,this.roleInfo.height/2),5),this.node.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){e.heroStatus.isWudi=!1},this)))},e.prototype.getRandomPos=function(t){var e=new Array,a=this.heroNode.getHeroPos();if(e.push(a),1==t)return e;for(var n=new Array,i=cc.v2(60,0),o=0,r=0;n.length+e.length<t;){var s=g.default.randomInt(0,360);s>180&&(s-=360);var c=i.rotate(s*Math.PI/180);c=cc.v2(a.x+c.x,a.y+c.y);for(var l=!0,h=0;h<n.length;++h){var u=n[h];if(c.sub(u).mag()<40){l=!1;break}if(m.default.Instance.mainLayer.currFightMap.fightMapData.objectInWall(u.x,u.y,40,40).inWall){l=!1;break}}l?(c=m.default.Instance.mainLayer.currFightMap.fightMapData.getItemDropPos(c),n.push(c),o=0):(o+=1)>10&&(r+=1,i=cc.v2(60+40*r,0),e=e.concat(n),n=[])}return e.concat(n)},s([S],e)}(cc.Component));o.default=L,cc._RF.pop()},{}],HeroStateMachine:[function(t,e,a){"use strict";cc._RF.push(e,"007d9oUKCxBTZSGaX8x1xtc","HeroStateMachine");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("HeroLog"),h=i("MainLogic"),u=i("ConfigData"),d=i("BuffUtil"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastState=c.HEOR_STATE.Birth,e.currState=c.HEOR_STATE.Birth,e.warmState=0,e}return r(e,t),e.prototype.init=function(t){this.heroSprite=t,this.stateNode=cc.find("LogicNode/StateNode",this.node)},e.prototype.resetData=function(){this.lastState=c.HEOR_STATE.Birth,this.currState=c.HEOR_STATE.Birth,this.warmState=0,this.clearDelayToDo(),this.onStartBirthState()},e.prototype.delayToDo=function(t,e){var a=this;this.stateNode.stopAllActions(),this.stateNode.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){e.call(a)},this)))},e.prototype.clearDelayToDo=function(){this.stateNode.stopAllActions()},e.prototype.onStartBirthState=function(){this.currState=c.HEOR_STATE.Birth,this.heroSprite.heroStatus.nextAtkStatus=0,this.heroSprite.heroNode.birthAction()},e.prototype.onFinishBirthState=function(){this.heroSprite.battleCamp==c.BATTLE_CAMP.Self&&h.default.Instance.combatLayer.readGo(),this.onStartStandState()},e.prototype.onStartStandState=function(){var t=!1;this.currState!=c.HEOR_STATE.Move&&this.currState!=c.HEOR_STATE.Attack&&this.currState!=c.HEOR_STATE.Stand&&this.currState!=c.HEOR_STATE.Hit&&this.currState!=c.HEOR_STATE.Dodge&&this.currState!=c.HEOR_STATE.Birth||(t=!0),this.heroSprite.heroStatus.isForzen&&(t=!1),0!=this.warmState&&(t=!1),t&&(this.currState==c.HEOR_STATE.Attack&&(this.heroSprite.heroNode.attackMoveEnd(),this.heroSprite.heroStatus.hardAndStraight=!1,this.heroSprite.heroNode.hideAttackBox()),l.default.log_stateMachine&&console.log("onStartStandState "+this.heroSprite.roleInfo.name),this.heroSprite.heroStatus.nextAtkStatus=0,this.heroSprite.heroStatus.hardAndStraight=!1,this.lastState=this.currState,this.currState=c.HEOR_STATE.Stand,this.heroSprite.heroNode.playStand())},e.prototype.onFinishStandState=function(){},e.prototype.onStartMoveState=function(){var t=!1;this.currState!=c.HEOR_STATE.Stand&&this.currState!=c.HEOR_STATE.Attack||(t=!0),this.heroSprite.heroStatus.isForzen&&(t=!1),0!=this.warmState&&(t=!1),t&&(this.currState==c.HEOR_STATE.Attack&&(l.default.log_stateMachine&&console.log("attackMoveEnd "+this.heroSprite.roleInfo.name),this.heroSprite.heroNode.attackMoveEnd(),this.heroSprite.heroStatus.hardAndStraight=!1,this.heroSprite.heroNode.hideAttackBox()),l.default.log_stateMachine&&console.log("onStartMoveState "+this.heroSprite.roleInfo.name),this.lastState=this.currState,this.currState=c.HEOR_STATE.Move,this.heroSprite.heroNode.playMove())},e.prototype.onFinishMoveState=function(){},e.prototype.onStartAssault=function(){var t=!1;t=!0,0!=this.warmState&&(t=!1),t&&(this.lastState=this.currState,this.currState=c.HEOR_STATE.Assault,this.heroSprite.heroStatus.hardAndStraight=!0,this.heroSprite.heroNode.playAssault(),this.heroSprite.heroNode.controlAssault(),this.delayToDo(.2,this.onFinishAssault))},e.prototype.onFinishAssault=function(){this.heroSprite.heroNode.assaultEnd(),this.heroSprite.heroStatus.hardAndStraight=!1,this.heroSprite.heroControl.handleControlEvent(c.CONTROL_EVENT.Control_Attack)},e.prototype.onStartHitState=function(t,e,a,n,i){var o=!0;if(this.heroSprite.lifeStatus!=c.LIFE_STATUS.Dead?(this.heroSprite.heroStatus.isForzen||0!=this.warmState)&&(o=!1):0!=this.warmState&&(this.warmState=0),o){if(l.default.log_stateMachine&&console.log("onStartHitState "+this.heroSprite.roleInfo.name),this.heroSprite.battleCamp==c.BATTLE_CAMP.Self)this.heroSprite.heroStatus.hitFlyDir=t;else{var r=1;this.node.x>h.default.Instance.mainLayer.myHeroSprite.node.getPosition().x&&(r=-1),this.heroSprite.heroNode.hitChangeFace(r),this.heroSprite.heroStatus.hitFlyDir=r}if(this.heroSprite.heroStatus.hardAndStraight=!0,this.heroSprite.heroStatus.clearAtkTimes(),this.heroSprite.heroNode.hideAttackBox(),1==this.heroSprite.heroStatus.leaveGround?this.heroSprite.heroNode.playHit(2):this.heroSprite.heroNode.playHit(n),this.heroSprite.lifeStatus==c.LIFE_STATUS.Dead){if(this.heroSprite.battleCamp==c.BATTLE_CAMP.Self)return h.default.Instance.combatLayer.isRevive=!0,void h.default.Instance.combatScene.popLayer.reviewRevivedLayer();if(this.currState==c.HEOR_STATE.Hit)return;a*=0}else{if(this.currState==c.HEOR_STATE.Hit&&i<=this.heroSprite.heroStatus.hitPriority&&0==this.heroSprite.heroStatus.leaveGround)return;this.heroSprite.heroNode.hitMoveStart(t,e,a),this.heroSprite.heroStatus.hitPriority=i}this.lastState=this.currState,this.currState=c.HEOR_STATE.Hit,this.delayToDo(a,this.onFinishHitState)}},e.prototype.onFinishHitState=function(){l.default.log_stateMachine&&console.log(" onFinishHitState "+this.heroSprite.roleInfo.name),this.heroSprite.heroStatus.hardAndStraight=!1,this.heroSprite.heroNode.hitMoveEnd(),this.heroSprite.heroStatus.hitPriority=0,1==this.heroSprite.heroStatus.leaveGround&&(this.heroSprite.heroStatus.leaveGround=0),this.heroSprite.lifeStatus!=c.LIFE_STATUS.Dead?this.onStartStandState():this.onStartDeadthState()},e.prototype.onStartDeadthState=function(){this.currState!=c.HEOR_STATE.Death&&(0!=this.warmState&&(this.warmState=0),this.currState=c.HEOR_STATE.Death,this.heroSprite.dropReward(),this.onStartStandState(),this.delayToDo(2,this.onFinishDeadthState),this.heroSprite.heroNode.deadAction())},e.prototype.onFinishDeadthState=function(){4!=this.heroSprite.monsterType&&this.heroSprite.delete(),h.default.Instance.combatScene.combatLayer.heroDeadEvent(this.heroSprite.battleCamp,this.heroSprite.monsterType,3==this.heroSprite.monsterType)},e.prototype.onStartEarlyWarmState=function(){var t=!1;this.currState!=c.HEOR_STATE.Stand&&this.currState!=c.HEOR_STATE.Move&&this.currState!=c.HEOR_STATE.Attack&&this.currState!=c.HEOR_STATE.Dodge&&this.currState!=c.HEOR_STATE.Assault||(t=!0),0!=this.warmState&&(t=!1),this.heroSprite.heroStatus.isForzen&&(t=!1),this.heroSprite.heroStatus.isMove&&(this.heroSprite.heroStatus.isMove=!1,this.heroSprite.heroNode.controlStand(),this.heroSprite.stateMachine.onStartStandState()),t&&(l.default.log_stateMachine&&console.log(this.heroSprite.roleInfo.name+" onStartEarlyWarmState"),this.heroSprite.currSkill.waring_time?(this.heroSprite.heroNode.atkChangeFace(),this.heroSprite.heroNode.controlStand(),this.heroSprite.heroNode.playWarm(),this.warmState=2,this.delayToDo(this.heroSprite.currSkill.waring_time,this.onEndEarlyWarmState)):(this.onStartAttackState(),this.warmState=0))},e.prototype.onEndEarlyWarmState=function(){console.log(this.heroSprite.roleInfo.name+" onEndEarlyWarmState"),this.onStartAttackState(),this.warmState=0},e.prototype.onStartAttackState=function(){var t=!1;if(this.currState!=c.HEOR_STATE.Stand&&this.currState!=c.HEOR_STATE.Move&&this.currState!=c.HEOR_STATE.Attack&&this.currState!=c.HEOR_STATE.Dodge&&this.currState!=c.HEOR_STATE.Assault||(t=!0),t){var e;if(l.default.log_stateMachine&&console.log("onStartAttackState "+this.heroSprite.roleInfo.name+"  "+this.heroSprite.currSkill.name),this.lastState=this.currState,this.currState=c.HEOR_STATE.Attack,this.heroSprite.heroNode.hideAttackBox(),this.heroSprite.heroNode.atkChangeFace(),this.heroSprite.heroStatus.nextAtkStatus=0,this.heroSprite.battleCamp==c.BATTLE_CAMP.Self&&(this.heroSprite.fromExtraEffect=this.heroSprite.heroLogic.getExtraAttr(1,1,this.heroSprite.currSkill.id),this.heroSprite.toExtraEffect=this.heroSprite.heroLogic.getExtraAttr(1,2,this.heroSprite.currSkill.id)),this.heroSprite.currSkill==this.heroSprite.skills[0])this.heroSprite.heroStatus.normalAtkStatus=-1,this.heroSprite.heroStatus.addAtkTimes(),this.heroSprite.heroNode.playAttack();else if(e=this.heroSprite.heroStatus.hitSkillIndex<10?"skill"+this.heroSprite.heroStatus.hitSkillIndex:"skill"+Math.floor(this.heroSprite.heroStatus.hitSkillIndex/10)+"_"+this.heroSprite.heroStatus.hitSkillIndex%10,this.heroSprite.heroStatus.clearAtkTimes(),this.heroSprite.heroNode.playSkill(e),2008==this.heroSprite.currSkill.id&&this.heroSprite.heroNode.addEffect(c.EFFECT_TYPE.Effect_SKZ,cc.v2(h.default.Instance.combatScene.mainCamera.node.x,-25),7,this.heroSprite.heroNode.timeScale),this.heroSprite.currSkill.skill_type==c.SKILL_TYPE.Type_2023&&this.heroSprite.heroNode.moveToTargetEnemyPos(),this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_1001&&this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_1008&&this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_2028&&this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_2029&&this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_3&&this.heroSprite.currSkill.skill_type!=c.SKILL_TYPE.Type_2027||this.heroSprite.heroShooter.shootingBullet(),this.heroSprite.skillManager.getSkillObj(this.heroSprite.currSkill.id).useSkill(),this.heroSprite.currSkill.buffPools.length)for(var a=this.heroSprite.currSkill.buffPools,n=0;n<a.length;++n){var i=u.default.Instance.buffItemMap.get(a[n]),o=d.default.createBuffBySpecialItem(i,this.heroSprite.heroLogic.currrSkillLevel());this.heroSprite.buffManager.addBuffList(o)}this.heroSprite.heroStatus.hitTarget=!1,this.heroSprite.heroStatus.hardAndStraight=!0}},e.prototype.onFinishAttackState=function(){this.heroSprite.heroStatus.hardAndStraight=!1,this.heroSprite.heroNode.attackMoveEnd(),this.heroSprite.heroStatus.atkDelay(),1==this.heroSprite.heroStatus.normalAtkStatus?this.onStartAttackState():this.heroSprite.combatLayer.pressAttack&&this.heroSprite.battleCamp==c.BATTLE_CAMP.Self?this.heroSprite.heroControl.handleControlEvent(c.CONTROL_EVENT.Control_Attack,0):this.heroSprite.heroStatus.isMove?this.onStartMoveState():this.onStartStandState()},e.prototype.onStartJumpBack=function(){var t=!0;if(0!=this.warmState&&(t=!1),this.heroSprite.heroStatus.isForzen&&(t=!1),this.currState==c.HEOR_STATE.Attack&&this.heroSprite.currSkill!=this.heroSprite.skills[0]&&(t=!1),t){l.default.log_stateMachine&&console.log("onStartFlashState "+this.heroSprite.roleInfo.name),this.heroSprite.heroStatus.hardAndStraight=!0;var e=this.heroSprite.heroNode.playJumpBack();this.heroSprite.heroNode.playJump(),this.delayToDo(e,this.onFinishJumpBack)}},e.prototype.onFinishJumpBack=function(){this.heroSprite.heroStatus.hardAndStraight=!1,this.onStartStandState()},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],HeroStatus:[function(t,e,a){"use strict";cc._RF.push(e,"baa223FuqJCvo0aZEV/Pmr8","HeroStatus");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMove=!1,e.face=1,e.moveAngle=0,e.moveSpeed=500,e.bodyRadius=50,e.hitSkillIndex=0,e.hardAndStraight=!1,e.hitTarget=!1,e.hurtIndex=0,e.hitPriority=0,e.leaveGround=0,e.stoicState=0,e.normalAtkStatus=-1,e.normalAtkTimes=0,e.normalAtkTimes2=0,e.nextAtkStatus=0,e.isWudi=!1,e.wudiContinue=0,e.isForzen=!1,e.autoAttack=!0,e.attackRadius=600,e.attackMinRadius=300,e.hitFlyDir=-1,e}return r(e,t),e.prototype.init=function(t){this.heroSprite=t,this.statusNode=cc.find("LogicNode/StatusNode",this.node)},e.prototype.resetData=function(){this.isForzen=!1,this.heroSprite.battleCamp==c.BATTLE_CAMP.Enemy?this.face=-1:this.face=1,this.hardAndStraight=!1,this.normalAtkTimes=0,this.normalAtkTimes2=0,this.stoicState=0,this.hitTarget=!1,this.hurtIndex=0,this.hitPriority=0,this.leaveGround=0,this.isWudi=!1,this.isMove=!1},e.prototype.addAtkTimes=function(){this.normalAtkTimes++,this.normalAtkTimes2=(this.normalAtkTimes-1)%2+1,this.statusNode.stopAllActions()},e.prototype.clearAtkTimes=function(){this.normalAtkTimes=0,this.normalAtkTimes2=0,this.normalAtkStatus=-1,this.statusNode.stopAllActions()},e.prototype.atkDelay=function(){var t=this;this.statusNode.stopAllActions(),this.statusNode.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){t.normalAtkTimes=0,t.normalAtkTimes2=0,t.normalAtkStatus=-1},this)))},e.prototype.canAttacked=function(){return!this.isWudi&&this.heroSprite.stateMachine.currState!=c.HEOR_STATE.Birth&&this.heroSprite.stateMachine.currState!=c.HEOR_STATE.Flash&&this.heroSprite.lifeStatus==c.LIFE_STATUS.Alive},e.prototype.getWudiScore=function(){return 5},s([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],HeroTitleLayer:[function(t,e,a){"use strict";cc._RF.push(e,"9dc86tSKH5LppCf3uKNk4WI","HeroTitleLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("SoundManager"),h=i("ConfigData"),u=i("GameData"),d=i("AssetUtils"),p=i("MainLogic"),f=i("HeroTitle"),y=cc._decorator,m=y.ccclass,g=y.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titlePrefab=null,e.titleScripts=new Array,e.currShowTitleId=50001,e}return r(e,t),e.prototype.init=function(){this.titleList=cc.find("Layer/TitleList",this.node).getComponent(cc.ScrollView),this.heroNode=cc.find("Layer/Hero",this.node),this.lastTimeNode=cc.find("Layer/Info/Time",this.node);for(var t=1;t<11;++t){var e=cc.instantiate(this.titlePrefab);this.titleList.content.addChild(e);var a=e.getComponent(f.default);a.init(this,5e4+t),1==t&&(this.currShowTitleId=5e4+t),this.titleScripts.push(a)}this.review()},e.prototype.review=function(){this.node.active=!0;var t=u.default.Instance.playerData.wearFashionList;null==this.heroScript&&(this.heroScript=p.default.Instance.sceneNodeManager.getHeroArmature(1001,t[0],t[1],t[2],this.currShowTitleId),this.heroNode.addChild(this.heroScript.node)),this.changeTitleEffect(this.currShowTitleId)},e.prototype.changeTitleEffect=function(t){for(var e=0;e<this.titleScripts.length;++e)this.titleScripts[e].selectedNode(t);var a=h.default.Instance.equipmentMap.get(t);this.currShowTitleId=t;var n=u.default.Instance.playerData.wearFashionList;for(this.heroScript.resetSlot(n[0],n[1],n[2],t),e=1;e<=3;++e){var i=cc.find("Layer/Info/Attr/Value"+e,this.node);1==e?i.getComponent(cc.Label).string="+"+a.atk:2==e?i.getComponent(cc.Label).string="+"+a.hp:3==e&&(i.getComponent(cc.Label).string="+"+a.def)}var o="\u6c38\u4e45";if(0!=a.last_time){o="";var r=a.last_time,s=Math.floor(r/86400);r-=86400*s;var c=Math.floor(r/3600);0!=s&&(o=s+"\u5929"),0!=c&&(o=o+c+"\u5c0f\u65f6")}this.lastTimeNode.getComponent(cc.Label).string=o;var l=cc.find("Layer/Info/Go/Go",this.node),f="";switch(a.get_way){case 1:f="\u901a\u884c\u8bc1\u83b7\u53d6";break;case 2:f="\u5927\u8f6c\u76d8\u83b7\u53d6";break;case 3:f="\u706d\u4e16\u9b54\u795e\u83b7\u53d6";break;case 4:f="\u5154\u5973\u90ce\u83b7\u53d6";break;case 5:f="\u4e2d\u79cb\u6d3b\u52a8\u83b7\u53d6";break;case 6:f="\u68a6\u9b47\u4e4b\u5854\u83b7\u53d6";break;case 7:f="\u68a6\u9b47\u5546\u57ce\u83b7\u53d6";break;case 8:f="\u9650\u65f6\u6d3b\u52a8\u83b7\u53d6"}l.getComponent(cc.Label).string=f;var y=p.default.Instance.roleLogic.getTitleData(t),m=1;for(m=1==a.composeWay[0]?1:2,null!=y&&y.continueTime>0&&(m=u.default.Instance.playerData.wearFashionList[3]==t?4:3),e=1;e<=4;++e){var g=cc.find("Layer/State"+e,this.node);if(g.active=e==m,1==e)cc.find("Go",g).getComponent(cc.Label).string=f;else if(2==e&&g.active){var I=cc.find("Cost/Item",g),_=cc.find("Frament",I),v=a.composeWay[2],S=h.default.Instance.itemMap.get(v);S&&(d.AssetUtils.loadSpriteFrame(I,"Common/"+S.icon),_.active=1==S.is_chip);var L=p.default.Instance.moneyLogic.getItemCount(v);cc.find("Cost/Count",g).getComponent(cc.Label).string="("+L+"/"+a.composeWay[3]+")"}}},e.prototype.onClickBtn=function(t,e){if(l.SoundManager.Instance.playEffect("anniu"),1==e)this.node.active=!1;else if(2==e)switch(this.node.active=!1,(a=h.default.Instance.equipmentMap.get(this.currShowTitleId)).get_way){case 1:p.default.Instance.combatScene.homeLayer.hideNode(),p.default.Instance.combatScene.popLayer.reviewPassCheckLayer();break;case 2:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewLotteryLayer(c.PAGE_NAME.Home);break;case 3:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(1);break;case 4:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(2);break;case 5:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewActivityLayer(1);break;case 6:if(u.default.Instance.playerData.level<20){p.default.Instance.combatScene.showMsgInfo("\u8fbe\u523020\u7ea7\u540e\u624d\u53ef\u6311\u6218");break}p.default.Instance.combatScene.homeLayer.hideNode(),p.default.Instance.combatScene.popLayer.reviewClimbTowerLayer();break;case 7:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewShopLayer(2);break;case 8:p.default.Instance.combatScene.homeLayer.hideBanner(),p.default.Instance.combatScene.popLayer.reviewMoreGameLayer(2)}else if(3==e){var a,n=(a=h.default.Instance.equipmentMap.get(this.currShowTitleId)).composeWay[2],i=p.default.Instance.moneyLogic.getItemCount(n),o=a.composeWay[3];if(o<=i){p.default.Instance.moneyLogic.addItemCount(n,-o);var r=0==a.last_time?999999999:a.last_time;p.default.Instance.roleLogic.addTitleData(this.currShowTitleId,r),this.changeTitleEffect(this.currShowTitleId)}else p.default.Instance.moneyLogic.showMoreMoney(c.PAGE_NAME.Home,n,!0)}else 4==e?(3==u.default.Instance.playerData.wearFashionList.length?u.default.Instance.playerData.wearFashionList.push(this.currShowTitleId):u.default.Instance.playerData.wearFashionList[3]=this.currShowTitleId,u.default.Instance.localStorage(p.default.Instance.combatScene.isGameStart()),this.changeTitleEffect(this.currShowTitleId),p.default.Instance.combatScene.homeLayer.streetLayer.streetHero.updateHeroArm()):5==e&&(3==u.default.Instance.playerData.wearFashionList.length?u.default.Instance.playerData.wearFashionList.push(0):u.default.Instance.playerData.wearFashionList[3]=0,u.default.Instance.localStorage(p.default.Instance.combatScene.isGameStart()),this.changeTitleEffect(this.currShowTitleId),p.default.Instance.combatScene.homeLayer.streetLayer.streetHero.updateHeroArm())},s([g(cc.Prefab)],e.prototype,"titlePrefab",void 0),s([m],e)}(cc.Component);o.default=I,cc._RF.pop()},{}],HeroTitle:[function(t,e,a){"use strict";cc._RF.push(e,"45f25OyGdZP75X+53p7Q0yA","HeroTitle");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("AssetUtils"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.heroTitleLayer=t,this.titleId=e,this.titleNode=cc.find("Item",this.node),this.lightNode=cc.find("Light",this.node);var a=l.default.Instance.equipmentMap.get(e);h.AssetUtils.loadSpriteFrame(this.titleNode,"Common/"+a.icon+"a")},e.prototype.selectedNode=function(t){this.lightNode.active=t==this.titleId},e.prototype.onClickBtn=function(t,e){c.SoundManager.Instance.playEffect("anniu"),1==e&&this.heroTitleLayer.changeTitleEffect(this.titleId)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],HomeLayer:[function(t,e,a){"use strict";cc._RF.push(e,"6016424qZlF1bDSSC2s3T6d","HomeLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("PublicEnum"),h=i("AssetUtils"),u=i("PublicConst"),d=i("StringUtils"),p=i("AdServer"),f=i("MainLogic"),y=i("TimeLogSerer"),m=i("ThreadTask"),g=i("MyMathUtils"),I=i("ConfigData"),_=i("GuideUtils"),v=i("SoundManager"),S=cc._decorator,L=S.ccclass,T=(S.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showInterCount=0,e.autoPopState=!0,e.mailTip=!0,e}return r(e,t),e.prototype.onLoad=function(){var t=this;f.default.Instance.combatScene.isFringe>0&&u.default.Platform!=l.PLAT_FORM.Opp?(console.log("\u5f53\u524d\u5218\u6d77\u5c4f"),cc.find("Left",this.node).getComponent(cc.Widget).left=f.default.Instance.combatScene.isFringe):console.log("\u5f53\u524d\u4e0d\u662f\u5218\u6d77\u5c4f"),this.money1Node=cc.find("Center/Money/Nums/Num1",this.node),this.money2Node=cc.find("Center/Money/Nums/Num2",this.node),this.money3Node=cc.find("Center/Money/Nums/Num3/Num",this.node),this.threadTask=cc.find("Left/ThreadTask",this.node).getComponent(m.default),this.threadTask.init(this),this.nameNode=cc.find("Left/Hero/Name",this.node),this.expNode=cc.find("Left/Hero/Exp",this.node),this.expNumNode=cc.find("Left/Hero/ExpNum",this.node),this.levelNode=cc.find("Left/Hero/Level",this.node),this.headNode=cc.find("Left/Hero/Img",this.node);var e=cc.find("Right/Fun3/Jar",this.node);if(this.freeAdTimeNode=cc.find("Center/Money/Nums/Ad",this.node),e.runAction(cc.sequence(cc.rotateTo(.3,10),cc.rotateTo(.6,-10),cc.rotateTo(.3,0)).repeatForever()),this.powerTimeNode=cc.find("Center/Money/Nums/Num3/PowerTime",this.node),this.showFreeAdTime(),this.showMoney(),this.showHeroInfo(),this.hideUiNode(),this.powerSchedule(),this.schedule(this.powerSchedule,1),this.streetLayer=cc.find("StreetLayer",this.node).getComponent("StreetLayer"),this.streetLayer.init(this),this.homeUiLayer=cc.find("UiLayer",this.node).getComponent("HomeUiLayer"),this.homeUiLayer.init(this),c.default.Instance.isNewPlayer&&1==c.default.Instance.playerData.dayLoginTimes){if(c.default.Instance.showModifyTip&&c.default.Instance.modifyDataCount>0&&c.default.Instance.modifyDataCount<3)return c.default.Instance.showModifyTip=!1,f.default.Instance.combatScene.popLayer.reviewGamePauseLayer(l.PAGE_NAME.Home,5),!0;if(c.default.Instance.showModifyTip&&c.default.Instance.modifyDataCount>=3)return c.default.Instance.showModifyTip=!1,f.default.Instance.combatScene.popLayer.reviewGamePauseLayer(l.PAGE_NAME.Home,6),!0}else this.scheduleOnce(function(){t.autoPopState=!1,f.default.Instance.combatScene.popLayer.autoPopLayer()},.3);u.default.Platform!=l.PLAT_FORM.Web?(cc.find("Left/ExpBtn",this.node).active=u.default.Is_Senior,cc.find("Left/EquipmentBtn",this.node).active=u.default.Is_Senior):(cc.find("Left/ExpBtn",this.node).active=!0,cc.find("Left/EquipmentBtn",this.node).active=!0),y.default.Instance.printCommonLog("HomeLayer load"),0==f.default.Instance.combatScene.adLoadStatus&&(p.default.Instance.load(),u.default.Share_Switch&&p.default.Instance.showShareMenu(),f.default.Instance.combatScene.adLoadStatus=1),this.showTips(),v.SoundManager.Instance.playMusic("home_bg"),f.default.Instance.equipmentLogic.checkRoleEquipData()},e.prototype.review=function(){var t=this;this.node.active=!0,this.showMoney(),this.showHeroInfo(),this.streetLayer.review(),v.SoundManager.Instance.playMusic("home_bg"),this.reviewThreadTask(),this.showBanner(),this.showTips(),this.hideUiNode(),this.showFreeAdTime(),u.default.Platform!=l.PLAT_FORM.Wx&&u.default.Platform!=l.PLAT_FORM.Douyin||(this.showInterCount++,this.showInterCount%2==0&&this.scheduleOnce(function(){p.default.Instance.showInterAd()},.3)),this.scheduleOnce(function(){t.guideAction()||t.autoPopState&&(t.autoPopState=!1,f.default.Instance.combatScene.popLayer.autoPopLayer())},.3),f.default.Instance.equipmentLogic.checkRoleEquipData()},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=d.default.stringToWord(f.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+d.default.stringToWord(f.default.Instance.moneyLogic.getItemCount(1002)),this.money3Node.getComponent(cc.Label).string=""+f.default.Instance.moneyLogic.getItemCount(1003)},e.prototype.powerSchedule=function(){if(f.default.Instance.moneyLogic.countPower(),f.default.Instance.moneyLogic.getItemCount(1003)>=u.default.Max_Power+c.default.Instance.powerAdd)this.powerTimeNode.active=!1;else{this.powerTimeNode.active=!0;var t=Math.round((c.default.Instance.playerData.nextPowerTime-(new Date).getTime())/1e3);this.powerTimeNode.getComponent(cc.Label).string=t+"s"}},e.prototype.showHeroInfo=function(){var t=c.default.Instance.playerData,e=f.default.Instance.moneyLogic.getItemCount(1005);this.nameNode.getComponent(cc.Label).string=t.nickName,this.levelNode.getComponent(cc.Label).string="Lv."+(t.level>u.default.MAX_PLAYER_LEVEL?u.default.MAX_PLAYER_LEVEL:t.level);var a=e/f.default.Instance.roleLogic.getNextLevelExp();this.expNode.scaleX=a>1?1:a,this.expNumNode.getComponent(cc.Label).string=e+"/"+f.default.Instance.roleLogic.getNextLevelExp(),t.headImg.length>0&&h.AssetUtils.loadRemoteUrl2(this.headNode,t.headImg)},e.prototype.showFreeAdTime=function(){if(1==c.default.Instance.playerData.cdActiveFreeAd){var t=((new Date).getTime()-c.default.Instance.playerData.cdActiveFreeAdTime)/1e3,e=Math.floor(t/3600);this.freeAdTimeNode.active=!0,this.freeAdTimeNode.getComponent(cc.Label).string="\u514d\u5e7f\u544a\u65f6\u957f\uff1a"+(24-e)+"\u5c0f\u65f6"}else this.freeAdTimeNode.active=!1},e.prototype.reviewThreadTask=function(){this.threadTask.review()},e.prototype.hideNode=function(){this.node.active=!1,this.hideBanner()},e.prototype.onClickEvent=function(t,e){if(v.SoundManager.Instance.playEffect("anniu"),1==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewSkillLayer(l.PAGE_NAME.Home,1001);else if(2==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(l.PAGE_NAME.Home,1001),f.default.Instance.combatScene.popLayer.pointGuideFinish();else if(3==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewStrengthLayer(l.PAGE_NAME.Home);else if(4==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewLotteryLayer(l.PAGE_NAME.Home);else if(5==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewSigninLayer(l.PAGE_NAME.Home);else if(6==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewTaskLayer(l.PAGE_NAME.Home);else if(7==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewEndlessLayer(l.PAGE_NAME.Home);else if(8==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewShakeJarLayer(l.PAGE_NAME.Home),f.default.Instance.combatScene.popLayer.pointGuideFinish();else if(9==e)f.default.Instance.combatScene.popLayer.reviewSettingLayer();else if(10==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewShopLayer(1);else if(11==e){if(!u.default.PassCheckSwitch)return void f.default.Instance.combatScene.showMsgInfo("\u901a\u884c\u8bc1\u6682\u672a\u5f00\u542f");this.hideNode(),f.default.Instance.combatScene.popLayer.reviewPassCheckLayer()}else if(12==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreGameLayer(2);else if(13==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreGameLayer(1);else if(14==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewDiamWelfareLayer();else if(15==e)this.hideNode(),f.default.Instance.combatScene.popLayer.reviewFashionLayer(l.PAGE_NAME.Home);else if(16==e){this.hideBanner();var a=cc.find("Right/Fun2/Mail/Tip",this.node);a.active&&(a.active=!1),f.default.Instance.combatScene.popLayer.reviewMailLayer()}else if(17==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewCdkeyLayer(4);else if(18==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(1);else if(19==e){if(0==c.default.Instance.playerData.friendHelpSeasionId)return void f.default.Instance.combatScene.showMsgInfo("\u597d\u53cb\u52a9\u529b\u6682\u672a\u5f00\u542f");this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewFriendsHelpLayer()}else if(20==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(2);else if(21==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewActivityLayer(1);else if(22==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewRankingLayer(1,1,!0);else if(23==e);else if(24==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewHeroTitleLayer();else if(25==e);else if(26==e)f.default.Instance.combatScene.setEventShowCallback(function(){f.default.Instance.giftBagLoigc.receiveGiftItems([[1002,1e3,2]],1)},this),p.default.Instance.openAwemeUserProfile();else if(100==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoneyMorePage(l.PAGE_NAME.Home,1,!u.default.isVivoOrOppo());else if(101==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoneyMorePage(l.PAGE_NAME.Home,2,!u.default.isVivoOrOppo());else if(102==e)this.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoneyMorePage(l.PAGE_NAME.Home,3,!u.default.isVivoOrOppo());else if(301==e)f.default.Instance.moneyLogic.addItemCount(1005,5e4),this.showHeroInfo();else if(302==e){var n=I.default.Instance.equipmentMap.getKeys(),i=g.default.randomInt(1,n.length);f.default.Instance.equipmentLogic.addEquipmentData(Number(n[i-1]))}},e.prototype.showTips=function(){var t=f.default.Instance.tipsLogic.homeTips,e=cc.find("Right/Fun2/Signin/Tip",this.node);e.active=1==t[1],e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var a=cc.find("Right/Fun1/Lottery/Tip",this.node);a.active=1==t[5],a.stopAllActions(),a.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var n=cc.find("Right/Fun1/Task/Tip",this.node);1==t[7]||1==t[8]?n.active=!0:n.active=!1,n.stopAllActions(),n.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var i=cc.find("Right/Fun2/Skill/Tip",this.node);i.active=1==t[4],i.stopAllActions(),i.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var o=cc.find("Right/Fun2/Equipment/Tip",this.node);o.active=1==t[3],o.stopAllActions(),o.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var r=cc.find("Right/Fun2/Strengthen/Tip",this.node);r.active=1==t[2],r.stopAllActions(),r.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var s=cc.find("Right/Fun2/Fuben/Tip",this.node);s.active=1==t[9],s.stopAllActions(),s.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var l=cc.find("Right/Fun3/Jar/Tip",this.node);l.active=1==t[10],l.stopAllActions(),l.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var h=cc.find("Right/Fun1/Diam/Tip",this.node);h.active=0==c.default.Instance.playerData.diamRewardStatus[0]||0==c.default.Instance.playerData.diamRewardStatus[1],h.stopAllActions(),h.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))))},e.prototype.hideUiNode=function(){u.default.Platform==l.PLAT_FORM.Douyin&&(cc.find("Right/Fun2/Kfhh",this.node).active=!1,cc.find("Right/Fun2/MoreGame",this.node).active=!1,cc.find("Right/Fun3/Invite",this.node).active=!1),u.default.Platform==l.PLAT_FORM.Web_4399&&(cc.find("Right/Fun2/Kfhh",this.node).active=!1,cc.find("Right/Fun2/MoreGame",this.node).active=!1,cc.find("Right/Fun3/Invite",this.node).active=!1)},e.prototype.showBanner=function(){this.node.active&&u.default.isVivoOrOppo()&&p.default.Instance.showBannerAd()},e.prototype.hideBanner=function(){u.default.isVivoOrOppo()&&p.default.Instance.hideBannerAd()},e.prototype.guideAction=function(t){if(!this.node.active)return!0;var e,a=1,n=1;a=1,n=1,e=this.streetLayer.portalNode.getPosition();var i=f.default.Instance.combatScene.mainCameraNode;return e=cc.v2(e.x-i.x,e.y-i.y),_.default.Instance.isHaveGuide(a,n,t)?(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0):(a=4,n=1,e=this.threadTask.node.convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),_.default.Instance.isHaveGuide(a,n,t)?(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0):(a=4,n=2,e=cc.find("Right/Fun2/Equipment",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),_.default.Instance.isHaveGuide(a,n,t)?(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0):(a=6,n=1,e=this.streetLayer.portalNode.getPosition(),e=cc.v2(e.x-i.x,e.y-i.y),_.default.Instance.isHaveGuide(a,n,t)?(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0):(a=7,n=1,_.default.Instance.isHaveGuide(a,n,t)?(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0):(a=7,n=2,e=cc.find("Right/Fun3/Jar",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),!!_.default.Instance.isHaveGuide(a,n,t)&&(f.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)),!0))))))},e.prototype.guideCallback=function(){this.node.active&&this.guideAction(!0)},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},s([L],e)}(cc.Component));o.default=T,cc._RF.pop()},{}],HomeUiLayer:[function(t,e,a){"use strict";cc._RF.push(e,"3557e8Ei+xKwrKB2/xO/hj+","HomeUiLayer");var n,i=a,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currPressKey=0,e}return o(e,t),e.prototype.init=function(t){this.homeLayer=t,this.touchLayer=cc.find("TouchLayer",this.node),this.leftNode=cc.find("Left",this.node),this.rockerLayer=cc.find("Left/RockerLayer",this.node).getComponent("StreetRockerLayer"),this.rockerLayer.init(this),this.openEvent()},e.prototype.openEvent=function(){this.touchLayer.on(cc.Node.EventType.TOUCH_START,this.touchStartEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_END,this.touchEndEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancelEventRocker,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},e.prototype.touchStartEventRocker=function(t){var e=t.getLocation();this.rockerLayer.touchMove(cc.v2(e.x,e.y))},e.prototype.touchMoveEventRocker=function(t){if(this.homeLayer.streetLayer.leaveNpc){var e=t.getLocation();this.rockerLayer.touchMove(cc.v2(e.x,e.y))}},e.prototype.touchEndEventRocker=function(){this.homeLayer.streetLayer.leaveNpc&&this.rockerLayer.resetPoint()},e.prototype.touchCancelEventRocker=function(){this.homeLayer.streetLayer.leaveNpc&&this.rockerLayer.resetPoint()},e.prototype.onKeyDown=function(t){if(this.homeLayer.streetLayer&&this.homeLayer.streetLayer.streetHero)switch(t.keyCode){case cc.macro.KEY.a:this.currPressKey=cc.macro.KEY.a,this.homeLayer.streetLayer.startMove(180);break;case cc.macro.KEY.d:this.currPressKey=cc.macro.KEY.d,this.homeLayer.streetLayer.startMove(0);break;case cc.macro.KEY.w:this.currPressKey=cc.macro.KEY.w,1==this.homeLayer.streetLayer.streetHero.face?this.homeLayer.streetLayer.startMove(89):this.homeLayer.streetLayer.startMove(91);break;case cc.macro.KEY.s:this.currPressKey=cc.macro.KEY.s,1==this.homeLayer.streetLayer.streetHero.face?this.homeLayer.streetLayer.startMove(-89):this.homeLayer.streetLayer.startMove(-90)}},e.prototype.onKeyUp=function(t){if(this.homeLayer.streetLayer&&this.homeLayer.streetLayer.streetHero)switch(t.keyCode){case cc.macro.KEY.a:this.currPressKey==cc.macro.KEY.a&&(this.homeLayer.streetLayer.isMove=!1,this.homeLayer.streetLayer.streetHero.playStand());break;case cc.macro.KEY.d:this.currPressKey==cc.macro.KEY.d&&(this.homeLayer.streetLayer.isMove=!1,this.homeLayer.streetLayer.streetHero.playStand());break;case cc.macro.KEY.w:this.currPressKey==cc.macro.KEY.w&&(this.homeLayer.streetLayer.isMove=!1,this.homeLayer.streetLayer.streetHero.playStand());break;case cc.macro.KEY.s:this.currPressKey==cc.macro.KEY.s&&(this.homeLayer.streetLayer.isMove=!1,this.homeLayer.streetLayer.streetHero.playStand());break;case cc.macro.KEY.j:case cc.macro.KEY.k:}},r([c],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],HpTube:[function(t,e,a){"use strict";cc._RF.push(e,"30c1aPShi1O0JQI9WfVFqWB","HpTube");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("AssetUtils"),h=i("MainLogic"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currOneBarBlood=50,e.oneBarBlood=50,e.colorIndex=0,e.nextColorIndex=0,e.slowSpeed=.1,e.quickSpeed=1,e.middleBarSpeed=.1,e.isBloodMove=!1,e}return r(e,t),e.prototype.init=function(t){this.heroId=t,this.colors=[cc.color(255,252,0),cc.color(0,145,255),cc.color(0,50,189),cc.color(64,239,255),cc.color(13,201,0),cc.color(255,132,0),cc.color(64,239,255)];var e=cc.find("Head",this.node),a=cc.find("Info/Name",this.node),n=c.default.Instance.roleMap.get(this.heroId),i=cc.find("Info/Type/Type",this.node);n.tag?(i.active=!0,i.getComponent(cc.Label).string={1:"\u4eba\u5f62",2:"\u91ce\u517d",3:"\u9f99\u65cf",4:"\u7ec4\u5408\u4f53"}[n.tag]):i.active=!1,l.AssetUtils.loadSpriteFrame(e,"Combat/fight_head_"+n.picture_id),a.getComponent(cc.Label).string=n.name,this.currHpBar=cc.find("Blood/CurrenTube",this.node),this.currHpBar.zIndex=3,this.middleHpBar=cc.find("Blood/MiddleTube",this.node),this.middleHpBar.zIndex=2,this.NextHpBar=cc.find("Blood/NextTube",this.node),this.NextHpBar.zIndex=1,this.hpLabelNode=cc.find("Count",this.node)},e.prototype.resetData=function(t){this.heroSprite=t,this.currOneBarBlood=h.default.Instance.combatLayer.dungeonInfo.hp_unit,this.oneBarBlood=this.currOneBarBlood;var e=cc.find("Info/Level",this.node);if(4==this.heroSprite.monsterType)e.active=!1;else{e.active=!0;var a=5==this.heroSprite.monsterType?3:this.heroSprite.monsterType,n=h.default.Instance.combatLayer.dungeonInfo.lvlList[a-1];e.getComponent(cc.Label).string="Lv."+n[1]}this.count=Math.floor(this.heroSprite.hp/this.currOneBarBlood),this.nowBlood=this.heroSprite.hp%this.currOneBarBlood,0==this.nowBlood?(this.nowBlood=this.currOneBarBlood,this.count--):this.currOneBarBlood=this.nowBlood,this.colorIndex=this.count%this.colors.length,this.currHpBar.scaleX=this.nowBlood/this.currOneBarBlood,0==this.count?this.currHpBar.color=cc.color(209,28,0):this.currHpBar.color=this.colors[this.colorIndex],0!=this.count?(this.nextColorIndex=(this.colorIndex-1+this.colors.length)%this.colors.length,this.NextHpBar.active=!0,1==this.count?this.NextHpBar.color=cc.color(209,28,0):this.NextHpBar.color=this.colors[this.nextColorIndex]):this.NextHpBar.active=!1,this.middleHpBar.active=!1,this.hpLabelNode.getComponent(cc.Label).string="x"+this.count,this.node.opacity=0},e.prototype.delete=function(){h.default.Instance.combatLayer.mainLayer.nodeManager.putHeroHpTubeSprite(this)},e.prototype.update=function(){this.moveNowBar(),this.moveMiddleBar()},e.prototype.changeBlood=function(t){this.node.opacity=255,this.nowBlood+=t,this.nowTargetValue=this.nowBlood/this.currOneBarBlood,this.isBloodMove=!0,t<0&&Math.abs(t)<=this.currOneBarBlood?(this.speed=this.quickSpeed,this.middleHpBar.active=!0,this.middleHpBar.zIndex=2,this.middleHpBar.scaleX=this.currHpBar.scaleX,this.middleTargetValue=this.nowTargetValue):(this.speed=this.slowSpeed,this.middleHpBar.active=!1)},e.prototype.moveNowBar=function(){if(this.isBloodMove){var t=cc.misc.lerp(this.currHpBar.scaleX,this.nowTargetValue,this.speed);this.currHpBar.scaleX=t<0?0:t>1?1:t,Math.abs(this.currHpBar.scaleX-this.nowTargetValue)<=.01&&(this.isBloodMove=!1),0==this.count?this.NextHpBar.active=!1:this.NextHpBar.active=!0,this.currHpBar.scaleX>=this.nowTargetValue?this.subBlood():this.addBlood()}},e.prototype.moveMiddleBar=function(){if(this.speed==this.quickSpeed){var t=cc.misc.lerp(this.middleHpBar.scaleX,this.middleTargetValue,this.middleBarSpeed);this.middleHpBar.scaleX=t<0?0:t>1?1:t,Math.abs(this.middleHpBar.scaleX-0)<.01&&(this.middleHpBar.zIndex=2,this.middleHpBar.scaleX=1,this.middleTargetValue+=1)}},e.prototype.addBlood=function(){Math.abs(this.currHpBar.scaleX-1)<=0&&(this.count++,this.hpLabelNode.getComponent(cc.Label).string="x"+this.count,this.currHpBar.scaleX=0,this.nowTargetValue-=1,this.nowBlood-=this.currOneBarBlood,this.NextHpBar.color=this.colors[this.colorIndex],this.colorIndex++,this.colorIndex%=this.colors.length,this.currHpBar.color=this.colors[this.colorIndex])},e.prototype.subBlood=function(){if(Math.abs(this.currHpBar.scaleX-0)<=0){if(this.middleHpBar.zIndex=4,this.count<=0)return void(this.middleHpBar.active=!1);this.count--,this.hpLabelNode.getComponent(cc.Label).string="x"+this.count,this.currHpBar.scaleX=1,this.nowTargetValue+=1,this.currOneBarBlood=this.oneBarBlood,this.nowBlood+=this.currOneBarBlood,this.colorIndex--,this.colorIndex+=this.colors.length,this.colorIndex%=this.colors.length,0==this.count?this.currHpBar.color=cc.color(209,28,0):this.currHpBar.color=this.colors[this.colorIndex],this.nextColorIndex=this.colorIndex-1+this.colors.length,this.nextColorIndex%=this.colors.length,1==this.count?this.NextHpBar.color=cc.color(209,28,0):this.NextHpBar.color=this.colors[this.nextColorIndex]}},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],HurtData:[function(t,e,a){"use strict";cc._RF.push(e,"37251Sv04hDs4wnaQ8uLnQc","HurtData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PlayerAttribute");i.default=function(t,e,a,n,i){this.hurtDataType=o.ATTRIBUTE_TYPE.HP,this.hurtPoint=0,this.extraHurt=0,this.isCrit=!1,this.from=t,this.skillInfo=i,this.to=e,this.hurtPoint=a,this.extraHurt=this.extraHurt},cc._RF.pop()},{}],HurtUtil:[function(t,e,a){"use strict";cc._RF.push(e,"36a56DDP/1Fc7F42GCrNfhR","HurtUtil");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("HurtData"),r=n("PublicEnum"),s=n("NumberMethod"),c=n("PlayerAttribute"),l=n("MainLogic"),h=n("BuffUtil"),u=function(){function t(){}return t.hurt=function(e){e.to.lifeStatus!=r.LIFE_STATUS.Dead&&t.hurtLogic(e)},t.hurtLogic=function(t){var e=t.hurtPoint;if(null!=t.from){var a=s.default.Instance.getCritDamage(t.from.heroLogic.getOriginalNum(c.ATTRIBUTE_TYPE.Crit_Damage),t.from.battleCamp,t.from.heroAttri),n=!1;a>0&&Math.random()<t.from.heroLogic.getOriginalNum(c.ATTRIBUTE_TYPE.Crit_Rate)&&(e*=a,n=!0),t.isCrit=n}if(e>0&&cc.warn("hurtNum:"+e),e>=0&&(e=.05*t.hurtPoint),t.to.hurtData(t.hurtDataType,e,t.isCrit),t.to.hp<=0)t.to.hurtEvent(r.SKILL_EVENT.Dead);else if(t.from.battleCamp==r.BATTLE_CAMP.Self){var i=l.default.Instance.equipmentLogic.getEquipmentExtraBuff(t.skillInfo.id,2);if(i.length>0){var o=h.default.createBuffByHit(i);t.to.buffManager.addBuffList(o)}}},t.createNormalHurtData=function(t,e,a,n){var i,s,h=0,u=e.heroLogic.getOriginalNum(c.ATTRIBUTE_TYPE.Def);t.battleCamp==r.BATTLE_CAMP.Self?(i=t.fromExtraEffect,s=t.toExtraEffect):e.battleCamp==r.BATTLE_CAMP.Self&&(s=e.heroLogic.getExtraAttr(2,1,a.id));var d=0;if(u=(u=u-s[1][0]-u*s[1][1]+s[2][0]+u*s[2][1])<0?0:u,null==n||n){var p=t.heroLogic.getOriginalNum(c.ATTRIBUTE_TYPE.Attack,u);p-=s[4][0],p*=0==s[4][1]?1:s[4][1],i&&(d=i[3][0],p=p+i[3][0]+p*i[3][1]),h=-Math.floor(p)}else p=t.heroLogic.getAtkBySkill(a,u),p-=s[4][0],p*=0==s[4][1]?1:s[4][1],i&&(d=i[3][0],p=p+i[3][0]+p*i[3][1]),h=-Math.floor(p);if(i&&0!=i[5][1]){var f=l.default.Instance.roleLogic.getRoleAllAttr(t.roleInfo.id)[1],y=Math.floor(i[5][1]*f);y&&t.hurtData(c.ATTRIBUTE_TYPE.ADD_HP,y),t.fromExtraEffect[5][1]=0}return new o.default(t,e,h,d,a)},t.createTrapHurtData=function(t,e,a){return new o.default(null,t,-a,0,e)},t.cloneHurtData=function(t){return new o.default(t.from,t.to,t.hurtPoint,t.extraHurt,t.skillInfo)},t}();i.default=u,cc._RF.pop()},{}],ItemInfo:[function(t,e,a){"use strict";cc._RF.push(e,"a9eb5zhKoJHjad6DK4WmxhV","ItemInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.type=o.default.stringToInt(t.type),this.type_key=o.default.stringToInt(t.type_key),this.use_lv=t.use_lv,this.useLv=o.default.config_stringToIntList(this.use_lv,"_"),this.quality=o.default.stringToInt(t.quality),this.name=t.name,this.icon=t.icon,this.name_pic=t.name_pic,this.buff_id=o.default.stringToInt(t.buff_id),this.introduce=t.introduce,this.is_show=o.default.stringToInt(t.is_show),this.last_time=o.default.stringToInt(t.last_time),this.item_type=t.item_type,this.is_chip=o.default.stringToInt(t.is_chip),this.compose_item=t.compose_item,this.composeItem=o.default.config_stringToIntList(this.compose_item,"_"),this.cost_num=o.default.stringToInt(t.cost_num)},cc._RF.pop()},{}],ItemSprite:[function(t,e,a){"use strict";cc._RF.push(e,"01bc5USletF26dpUToPgCkS","ItemSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("ConfigData"),h=i("MyMathUtils"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.initData=function(t,e){this.combatLayer=e,this.itemId=t;var a=l.default.Instance.itemMap.get(t);this.itemPath=a.icon,this.imageNode=cc.find("Image",this.node),this.imageNode.active=!1},e.prototype.resetData=function(t,e,a,n){console.log("start x "+t.x+" y "+t.y),this.node.x=t.x+this.getStartX(n),this.node.y=t.y+100,this.node.active=!0,this.node.scale=1,this.itemValue=Math.floor(e),this.imageNode.active=!0,c.AssetUtils.loadSpriteFrame(this.imageNode,"Common/"+this.itemPath),this.delayToMove(a,n)},e.prototype.delayToMove=function(t,e){var a=this.getEndPos(t,e),n=Math.abs(this.node.x-a.x),i=this.node.getPosition().sub(a).mag(),o=this.bezierAction(n/350,this.node.getPosition(),a,i,80);Math.random(),this.node.stopAllActions(),this.node.runAction(cc.sequence(o.easing(cc.easeIn(3)),cc.delayTime(.3),cc.callFunc(this.coinMove,this)))},e.prototype.coinMove=function(){var t=this,e=h.default.toRadian(360*Math.random());cc.tween(this.node).by(.15,{position:cc.v3(25*Math.cos(e),25*Math.sin(e),0)}).delay(.4).call(function(){t.schedule(t.coinMoveSchedule,.1)}).start()},e.prototype.coinMoveSchedule=function(){var t=this.combatLayer.uiLayer.coinImgNode;this.targetPostion=t.convertToWorldSpaceAR(cc.Vec2.ZERO),this.targetPostion.x-=cc.winSize.width/2,this.targetPostion.y-=cc.winSize.height/2;var e=u.default.Instance.combatScene.mainCameraNode.getPosition(),a=cc.v2(this.targetPostion.x+e.x,this.targetPostion.y+e.y),n=this.node.getPosition();if(n.sub(a).mag()<100)this.unschedule(this.coinMoveSchedule),this.delete();else{var i=Math.atan2(a.y-n.y,a.x-n.x),o=cc.tween().by(.1,{position:cc.v2(200*Math.cos(i),200*Math.sin(i))});cc.tween(this.node).then(o).start()}},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this)},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this)},e.prototype.delete=function(){cc.Tween.stopAllByTarget(this.node),this.unscheduleAllCallbacks(),this.combatLayer.mainLayer.nodeManager.putItemSprite(this)},e.prototype.getStartX=function(t){return t%2==0?0-50*Math.random():50*Math.random()},e.prototype.getEndPos=function(t,e){var a=cc.v2(this.node.x-250,this.node.y-100);if(e%2==0){var n=0-(250*Math.random()+100);a.x=this.node.x+n}else n=150*Math.random()+100,a.x=this.node.x+n;return a},e.prototype.bezierAction=function(t,e,a,n,i){var o=3.14159*i/180,r=e.x+(a.x-e.x)/4,s=cc.v2(r,n+e.y+Math.cos(o)*r),c=e.x+(a.x-e.x)/2,l=cc.v2(c,n+e.y+Math.cos(o)*c);return cc.bezierTo(t,[s,l,a])},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],KnapsackItem:[function(t,e,a){"use strict";cc._RF.push(e,"8561fwcYT5KFLQkKNBHeDey","KnapsackItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("SoundManager"),h=i("ConfigData"),u=i("GameData"),d=i("AssetUtils"),p=i("MainLogic"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,a,n){this.itemNode=cc.find("Item",this.node),this.levelNode=cc.find("Info/Level",this.node),this.addNode=cc.find("Info/Add",this.node),this.lockNode=cc.find("Lock",this.node),this.ccNode=cc.find("CC",this.node),this.selecteNode=cc.find("Selecte",this.node),this.bgNode=cc.find("ItemBg",this.node),this.dotNode=cc.find("Dot",this.node),this.effectNode=cc.find("Effect",this.node),this.framentNode=cc.find("Item/Fragment",this.node),this.review(t,e,a,n)},e.prototype.review=function(t,e,a,n){var i=this;this.equipmentLayer=t,this.itemType=e,this.itemId=a,this.itemIndex=n;var o=0;if(this.effectNode&&(this.effectNode.active=!1),this.framentNode.active=!1,0==this.itemType||0==a)this.itemNode.active=!1,this.levelNode.parent.active=!1,this.lockNode.active=!1,this.selecteNode.active=!1,cc.find("Btn",this.node).opacity=255,cc.find("Zb",this.node).active=!1,this.dotNode.active=!1;else{this.itemNode.active=!0,this.levelNode.parent.active=!0,this.lockNode.active=!1,this.selecteNode.active=!1,cc.find("Zb",this.node).active=!1;var r=void 0;if(2!=e&&7!=e){r=h.default.Instance.equipmentMap.get(this.itemId);var s=p.default.Instance.equipmentLogic.getEquipmentData(n);cc.find("Zb",this.node).active=1==s.equipState&&(5==this.itemType||6==this.itemType),this.addNode.active=0!=s.strengthLevel,this.levelNode.getComponent(cc.Label).string="Lv."+s.equipmentLevel,this.addNode.getComponent(cc.Label).string="+"+s.strengthLevel,this.lockNode.active=1==s.lockState}else{var l=p.default.Instance.equipmentLogic.getPropData(this.itemId);this.levelNode.active=!1;var f=l.count;this.addNode.getComponent(cc.Label).string=f+"",1==(r=h.default.Instance.itemMap.get(this.itemId)).is_chip&&(this.framentNode.active=!0)}if(1==e){if(r.equip_lvl<=u.default.Instance.playerData.level){var y=p.default.Instance.equipmentLogic.getMostSuitEquipment(r.place);0==y.length?this.dotNode.active=!1:(s=p.default.Instance.equipmentLogic.getEquipmentData(n),this.dotNode.active=y.indexOf(s.equipmentIndex)>=0)}}else 2==e&&(this.dotNode.active=(7==r.type||14==r.type)&&!u.default.Instance.playerData.showPropUseTip);1!=e&&3!=e&&4!=e&&5!=e&&6!=e||this.effectNode&&(this.effectNode.active=r.quality>=4),o=r.quality,4==this.itemType&&0!=this.itemId?cc.find("Btn",this.node).opacity=0:cc.find("Btn",this.node).opacity=255,this.itemType,d.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+r.icon)}0==o?this.bgNode.active=!1:(this.bgNode.active=!0,this.scheduleOnce(function(){d.AssetUtils.loadSpriteFrame(i.bgNode,"Common/common_quality_"+o)},0)),this.addNode.color=c.Quality_COLOR[o],this.addNode.getComponent(cc.Label).enableBold=!0,this.levelNode.color=c.Quality_COLOR[o],this.levelNode.getComponent(cc.Label).enableBold=!0,this.equipmentInfo=h.default.Instance.equipmentMap.get(this.itemId),this.ccNode.active=!1,this.equipmentInfo&&5==this.equipmentInfo.type&&(this.ccNode.active=!0,this.ccNode.color=c.Quality_COLOR[o])},e.prototype.showSelecteNode=function(t,e,a){if(this.equipmentInfo)if(a){var n=p.default.Instance.equipmentLogic.getEquipmentData(this.itemIndex),i=n.equipmentBasicScore?n.equipmentBasicScore:(1*n.equipmentAtk+.125*n.equipmentHp+1*n.equipmentDef)*(this.equipmentInfo.crit_rate+this.equipmentInfo.hit_rate+this.equipmentInfo.agl+this.equipmentInfo.atk_speed),o=p.default.Instance.equipmentLogic.getRoleEquipmentScore(u.default.Instance.playerData.roleId,this.equipmentInfo.place);o[0]<i||o[1]<n.equipmentScore?e||(this.selecteNode.active=!1):this.selecteNode.active=this.equipmentInfo.quality==t&&e}else this.selecteNode.active=this.equipmentInfo.quality==t&&e},e.prototype.showLockNode=function(t){this.lockNode.active=t},e.prototype.onClickEvent=function(){if(l.SoundManager.Instance.playEffect("anniu"),8!=this.itemType)if(0==this.itemType)this.equipmentLayer.hideInfoNode();else if(1==this.itemType){var t=cc.v2(this.node.x,this.node.y),e=this.node.parent.convertToWorldSpaceAR(t);this.equipmentLayer.showPropInfo(e,this.itemIndex,this.itemType)}else 2==this.itemType?(this.dotNode.active=!1,t=cc.v2(this.node.x,this.node.y),e=this.node.parent.convertToWorldSpaceAR(t),this.equipmentLayer.showPropInfo(e,this.itemId,this.itemType)):3==this.itemType?this.showSelecteNode(this.equipmentInfo.quality,!this.selecteNode.active,!1):4==this.itemType?0==this.itemId?this.equipmentLayer.hideInfoNode():this.equipmentLayer.showEquipmentInfo(this.itemIndex):5==this.itemType?this.equipmentLayer.showEquipment(this.itemIndex):6==this.itemType||this.itemType},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],KnifeShadow:[function(t,e,a){"use strict";cc._RF.push(e,"0b083KH6KJJg5BzFabohCcl","KnifeShadow");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("AssetUtils"),h=i("MainLogic"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.streetLayer=t,this.weaponNode=cc.find("Weapon",this.node)},e.prototype.review=function(t,e){var a=this,n=h.default.Instance.equipmentLogic.getEquipmentData(t),i=c.default.Instance.equipmentMap.get(n.equipmentId),o="Weapon/"+i.res_id+"_1",r=this.streetLayer.node.convertToNodeSpaceAR(e.pos);if(this.weaponNode.opacity=255,this.node.setPosition(r),this.node.angle=e.angle,this.weaponPath!=o){this.weaponPath=o;var s=h.default.Instance.roleLogic.getWeaponShadowPos(i.res_id);this.weaponNode.setPosition(cc.v2(s.x,0-s.y)),l.AssetUtils.loadSpriteFrame(this.weaponNode,this.weaponPath)}this.weaponNode.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){a.delete()},this)))},e.prototype.delete=function(){this.node.stopAllActions(),this.streetLayer.putKnifeShadow(this)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],LoadingScene:[function(t,e,a){"use strict";cc._RF.push(e,"438c6Olc4RDQYAxooaiVQDI","LoadingScene");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("GameData"),h=i("PublicConst"),u=i("TimeLogSerer"),d=i("SoundManager"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTest=!1,e.imgResArray=new Array,e.loadSceneFinish=!1,e.loadSceneRate=0,e.initStartTime=0,e.loadSoundSucc=!1,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.initPhysicsManager(),u.default.Instance.startTimeAction(),this.label=cc.find("Loading/label",this.node),this.progressBar=cc.find("Loading/progressBar",this.node),this.progressBar.getComponent(cc.ProgressBar).progress=0,this.label.getComponent(cc.Label).string="0%",this.totalWidth=cc.find("Loading",this.node).width,c.default.Instance,l.default.Instance.init(),console.log("\u5f53\u524d\u542f\u52a8\u5e73\u53f0\uff1a"+h.default.Platform),c.default.Instance.initMain(),this.doStep1(),l.default.Instance.detalPassCheckConfig({start_time:"2021.08.04",detal:30}),l.default.Instance.detalFriendsHelpConfig({start_time:"2021.09.13",detal:2}),l.default.Instance.detalTowerTimeConfig({start_time:"2021.09.30",detal:14}),d.SoundManager.Instance.loadStart(this,function(){d.SoundManager.Instance.loadBundleSounds(["home_bg","battle_bg","anniu"],t,function(){console.log(" end load sound ----------------------"),t.loadSoundSucc=!0})})},e.prototype.doStep1=function(){this.loadSceneCallback(),this.schedule(this.initFinishSchedule,.1)},e.prototype.initFinishSchedule=function(){var t=this;if(c.default.Instance.loadFinished&&this.loadSoundSucc){this.unschedule(this.initFinishSchedule),u.default.Instance.printCommonLog("\u914d\u7f6e\u6587\u4ef6\uff0c\u767b\u5f55\u52a0\u8f7d\u5b8c\u6bd5");var e=(new Date).getTime();cc.director.preloadScene("CombatScene",function(){},function(){console.log("\u52a0\u8f7d\u65f6\u95f4\uff1a"+Math.round(((new Date).getTime()-e)/10)),t.loadSceneFinish||(t.loadSceneFinish=!0,u.default.Instance.printCommonLog("Start load CombatScene"),cc.director.loadScene("CombatScene"))})}},e.prototype.loadSceneCallback=function(){var t=this;this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){if(t.loadSceneRate<.85?t.loadSceneRate+=.025:t.loadSceneRate+=.001,t.loadSceneRate=Math.min(t.loadSceneRate,.98),t.label.getComponent(cc.Label).string=Math.round(100*t.loadSceneRate)+"%",t.progressBar.getComponent(cc.ProgressBar).progress=t.loadSceneRate,t.loadSceneRate>=.85&&c.default.Instance.loadFinished&&t.loadSoundSucc)return console.log("\u8fdb\u5165\u65f6\u95f4\u5230\uff0c\u8fdb\u5165\u6e38\u620f"),void(t.loadSceneFinish||(t.loadSceneFinish=!0,u.default.Instance.printCommonLog("Start load CombatScene"),cc.director.loadScene("CombatScene")));t.loadSceneCallback()},this)))},e.prototype.initPhysicsManager=function(){var t=cc.director.getCollisionManager();t.enabled=!0,this.isTest&&(t.enabledDebugDraw=!0,t.enabledDrawBoundingBox=!0)},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],LoginLogic:[function(t,e,a){"use strict";cc._RF.push(e,"a9f74XxE01DIIVWuAryfTns","LoginLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("DateUtils"),s=n("ConfigData"),c=n("PublicConst"),l=function(){function t(){}return t.prototype.userLogin=function(){var e=o.default.Instance.playerData;if(null==e.currDiffculty&&(e.currDiffculty=1),null==e.maxChapterInfo){e.maxChapterInfo=new Array;for(var a=null==e.maxChapter?1:e.maxChapter,n=null==e.maxDungeon?1:e.maxDungeon,i=0;i<6;++i)0==i?e.maxChapterInfo.push([a,n]):e.maxChapterInfo.push([0,0])}if(null==e.itemList)for(e.itemList={},i=1001;i<1100;++i)e.itemList[i]=1001==i?1e3:1003==i?20:0;if(null==e.itemCostList)for(e.itemCostList={},i=1001;i<1100;++i)e.itemCostList[i]=0;if(null==e.endlessChallengeCount)for(e.endlessChallengeCount=new Array,i=0;i<21;i++)e.endlessChallengeCount.push(4);if(null==e.shakeJarCount&&(e.shakeJarCount=5),null==e.shakeJar1Count&&(e.shakeJar1Count=0),null==e.shakeJar2Count&&(e.shakeJar2Count=0),null==e.shakeJar3Count&&(e.shakeJar3Count=0),null==e.buffDataList&&(e.buffDataList=new Array),null==e.isTester&&(e.isTester=!1),null==e.shopDataList&&(e.shopDataList=new Array),null==e.myShopDataList&&(e.myShopDataList=new Array),null==e.shopPropUpdate&&(e.shopPropUpdate=3),null==e.fashionBuyStatus&&(e.fashionBuyStatus=new Array),null==e.fashionShareList&&(e.fashionShareList=new Array),null==e.fashionList&&(e.fashionList=new Array),null==e.fashionId&&(e.fashionId=0),null==e.subMessageStatus)for(e.subMessageStatus=new Array,i=0;i<20;++i)e.subMessageStatus.push(0);if(null==e.createAccountLevel&&(e.createAccountLevel=0),null==e.passCheckTaskData&&(e.passCheckTaskData=new Array),null==e.getIntegralVideoCount&&(e.getIntegralVideoCount=0),null==e.getCrystalVideoCount&&(e.getCrystalVideoCount=0),null==e.inviteNewPlayerCount&&(e.inviteNewPlayerCount=0),null==e.passCheckLevel&&(e.passCheckLevel=0),null==e.currPassCheckSeasonId&&(e.currPassCheckSeasonId=0),null==e.openCustomerService&&(e.openCustomerService=!1),null==e.customerServiceReward&&(e.customerServiceReward=!1),null==e.diamWelfareVideoCount&&(e.diamWelfareVideoCount=0),null==e.shareGetRewardCount&&(e.shareGetRewardCount=5),null==e.shopPropShareTime&&(e.shopPropShareTime=""),null==e.shopPropShareCount&&(e.shopPropShareCount=0),null==e.shopPropGetReward)for(e.shopPropGetReward=new Array,i=0;i<20;++i)e.shopPropGetReward.push(0);if(null==e.shopPropGetVideo)for(e.shopPropGetVideo=new Array,i=0;i<20;++i)e.shopPropGetVideo.push(0);if(null==e.diamRewardStatus&&(e.diamRewardStatus=new Array,e.diamRewardStatus.push(0),e.diamRewardStatus.push(0)),null==e.showPropUseTip&&(e.showPropUseTip=!1),null==e.showStrengthState&&(e.showStrengthState=!0),null==e.wearFashionList&&(e.wearFashionList=new Array,e.wearFashionList.push(0),e.wearFashionList.push(0),e.wearFashionList.push(0),e.wearFashionList.push(0)),null!=e.level&&e.level>c.default.MAX_PLAYER_LEVEL&&(e.level=c.default.MAX_PLAYER_LEVEL),null==e.lotterRewardIndex&&(e.lotterRewardIndex=1),null==e.playerDataMD5&&(e.playerDataMD5=""),null==e.cdActiveFreeAdTime&&(e.cdActiveFreeAdTime=0),null==e.friendHelpSeasionId&&(e.friendHelpSeasionId=1),null==e.friendHelpStatus)for(e.friendHelpStatus=new Array,i=0;i<20;++i)e.friendHelpStatus.push(0);if(null==e.bunnyDay&&(e.bunnyDay=1),null==e.bunnyStatus&&(e.bunnyStatus=[0,0,0,0]),null==e.bunnyVideoCount&&(e.bunnyVideoCount=0),null==e.dayLoginTimes&&(e.dayLoginTimes=0),null==e.towerSeasionId&&(e.towerSeasionId=0),null==e.maxTowerLayerCount&&(e.maxTowerLayerCount=0),null==e.tgTowerTime&&(e.tgTowerTime=0),null==e.towerLayerCount&&(e.towerLayerCount=1),null==e.towerCzCount&&(e.towerCzCount=2),null==e.towerRewardOrder&&(e.towerRewardOrder=1),null==e.towerRewardOver&&(e.towerRewardOver=0),null==e.heroTitleList&&(e.heroTitleList=new Array),null==e.talentSkill)for(e.talentSkill=new Array,i=0;i<6;++i){var s=new Array(20).fill(0);s[1]=1,s[2]=1,s[3]=1,e.talentSkill.push(s)}null==e.selfTalentVideoCount&&(e.selfTalentVideoCount=5),null==e.helpTalentVideoCount&&(e.helpTalentVideoCount=5),null==e.playerDataErrCount&&(e.playerDataErrCount=0),null==e.shareRecordCount&&(e.shareRecordCount=0),null==e.msdhqVideoCount&&(e.msdhqVideoCount=0),null==e.followAccountState&&(e.followAccountState=0),e.loginDayNum=Math.min(e.loginDayNum,t.SigninDayNum),e.bunnyDay=Math.min(e.bunnyDay,3);var l=r.default.getDayInYear();if(e.loginTimes++,e.dayLoginTimes++,l!=o.default.Instance.playerData.loginDate){if(o.default.Instance.todayFirstLogin=!0,e.loginDataNum0++,0==e.loginFirstData&&(e.loginFirstData=(new Date).getTime(),e.loginFirstDate=l),0==e.loginDayNum)e.loginDayNum++,e.signinTaskList[e.loginDayNum-1]=1;else if(2==e.signinTaskList[e.loginDayNum-1]||3==e.signinTaskList[e.loginDayNum-1])if(e.loginDayNum++,e.loginDayNum>t.SigninDayNum){for(e.signinTimes++,i=0;i<t.SigninDayNum;i++)e.signinTaskList[i]=0;e.loginDayNum=1,e.signinType=1,e.signinTaskList[o.default.Instance.playerData.loginDayNum-1]=1}else e.signinTaskList[o.default.Instance.playerData.loginDayNum-1]=1;for(2==e.bunnyStatus[e.bunnyDay]&&(e.bunnyDay++,e.bunnyVideoCount=0,e.bunnyDay>3?e.bunnyDay=3:e.signinTaskList[o.default.Instance.playerData.bunnyDay]=1),e.loginDate=l,e.bannerTimes=0,e.bannerTimes2=0,e.fightTip=1,e.shakeJarCount=5,e.shopPropUpdate=3,e.getIntegralVideoCount=0,e.getCrystalVideoCount=0,e.openCustomerService=!1,e.customerServiceReward=!1,e.shareGetRewardCount=5,e.showPropUseTip=!1,e.showStrengthState=!0,e.dayLoginTimes=1,e.towerCzCount=2,e.selfTalentVideoCount=5,e.helpTalentVideoCount=5,e.shareRecordCount=0,e.favourBoxTimes.splice(0,e.favourBoxTimes.length),i=1;i<=3;i++)e.favourBoxTimes.push(10);for(e.subMessageStatus.splice(0,e.subMessageStatus.length),i=0;i<20;++i)e.subMessageStatus.push(0);for(e.endlessChallengeCount.splice(0,e.endlessChallengeCount.length),i=0;i<21;++i)e.endlessChallengeCount.push(4);e.diamRewardStatus.splice(0,e.diamRewardStatus.length),e.diamRewardStatus.push(0),e.diamRewardStatus.push(0),this.resetEndlessChallenge(),e.daySelectedTimes=3,o.default.Instance.localStorage(!1)}this.checkFreeAdState(),console.log("loginDayNum:"+e.loginDayNum)},t.prototype.loginLogic=function(){var t=(new Date).getTime(),e=(t-o.default.Instance.playerData.weekCardDate)/864e5;e<=7&&(o.default.Instance.powerAdd+=50,o.default.Instance.coinAddRate+=.1,o.default.Instance.animaAddRate+=.1),(e=(t-o.default.Instance.playerData.monthCardDate)/864e5)<=30&&(o.default.Instance.powerAdd+=100,o.default.Instance.coinAddRate+=.2,o.default.Instance.animaAddRate+=.2)},t.prototype.resetEndlessChallenge=function(){for(var t=s.default.Instance.endlessMap.getKeys(),e=0;e<t.length;++e){var a=s.default.Instance.endlessMap.get(t[e]),n=Number(t[e]);o.default.Instance.playerData[n]=a.challengeCount+a.adChallengeCount}},t.prototype.checkFreeAdState=function(){1==o.default.Instance.playerData.cdActiveFreeAd&&((new Date).getTime()-o.default.Instance.playerData.cdActiveFreeAdTime)/1e3/3600>=24&&(o.default.Instance.playerData.cdActiveFreeAd=0)},t.SigninDayNum=7,t}();i.default=l,cc._RF.pop()},{}],LotteryLayer:[function(t,e,a){"use strict";cc._RF.push(e,"1ff7bPB33hJibOakEXGaZh2","LotteryLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("LotteryLogic"),h=i("StringUtils"),u=i("PublicConst"),d=i("ConfigData"),p=i("AssetUtils"),f=i("PublicEnum"),y=i("MainLogic"),m=i("AdServer"),g=i("TaskLogic"),I=i("SoundManager"),_=cc._decorator,v=_.ccclass,S=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLottery=!1,e.lotteryRewardIndex=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){y.default.Instance.lotteryLogic.initItemList(),this.turntableNode=cc.find("Turntable",this.node),this.nextTimeNode=cc.find("Countdown",this.node),this.progressBar=cc.find("Reward/progressBar",this.node);for(var e=d.default.Instance.giftTypeMap.get(5),a=function(t){var a=e[t],i=a.itemList[0];1==i[0]&&c.default.Instance.playerData.fashionList.indexOf(i[1])>=0&&a.itemList.length>=2&&(i=a.itemList[1]);var o=void 0,r=!1;1==i[0]?o=d.default.Instance.equipmentMap.get(i[1]):r=1==(o=d.default.Instance.itemMap.get(i[1])).is_chip;var s=i[2];if(1001==i[1]){var l=y.default.Instance.chapterLogic.getMaxChapterInfo(1);s*=d.default.Instance.dungeonMap.get(l[0]).get(l[1]).get(1).gold_reward}else 1004==i[1]&&(l=y.default.Instance.chapterLogic.getMaxChapterInfo(1),s*=d.default.Instance.dungeonMap.get(l[0]).get(l[1]).get(1).crystal_reward);var h=cc.find("Turntable/Item"+t,n.node),u=cc.find("Name",h),f=cc.find("Img",h),m=cc.find("Num",h),g=cc.find("Img/Fragment",h);m.getComponent(cc.Label).string="x"+s,g.active=r,p.AssetUtils.loadSpriteFrame(f,"Common/"+o.icon,function(){f.height>45&&f.height<60||(f.scale=60/f.height)},n),u.getComponent(cc.Label).string=o.name},n=this,i=0;i<8;i++)a(i);c.default.Instance.playerData.lotteryTimesStatus.length<5&&(c.default.Instance.playerData.lotteryTimesStatus.push(0),c.default.Instance.playerData.lotteryTimesStatus.push(0));var o=d.default.Instance.giftTypeMap.get(8),r=c.default.Instance.playerData.lotterRewardIndex%2==0?6:1;for(this.lotteryRewardIndex=r,i=1;i<=5;i++){var s=cc.find("Reward/Reward"+i+"/RewardItem",this.node),l=s.getComponent("RewardItem"),h=o[r+i-2],u=h.itemList[0];1==u[0]&&c.default.Instance.playerData.fashionList.indexOf(u[1])>=0&&h.itemList.length>=2&&(u=h.itemList[1]),l.init(u,!1);var f=u[2];if(1001==u[1]){var m=y.default.Instance.chapterLogic.getMaxChapterInfo(1);f*=d.default.Instance.dungeonMap.get(m[0]).get(m[1]).get(1).gold_reward}else 1004==u[1]&&(m=y.default.Instance.chapterLogic.getMaxChapterInfo(1),f*=d.default.Instance.dungeonMap.get(m[0]).get(m[1]).get(1).crystal_reward);l.resetData(f,i-1,!1,!1,!1,!0,!1),s.y=23;for(var g=c.default.Instance.playerData.lotteryTimesStatus[i-1],I=0;I<2;I++)cc.find("Reward/Reward"+i+"/Status"+I,this.node).active=g==I}this.progressBar.getComponent(cc.ProgressBar).progress=c.default.Instance.playerData.lotteryAdTimes/30,this.review(t)},e.prototype.review=function(t){if(this.pageName=t,y.default.Instance.lotteryLogic.freshFreeTimes(),y.default.Instance.lotteryLogic.updateLotterAdTimes(),0==c.default.Instance.playerData.nextFreeTime)this.nextTimeNode.active=!1;else{this.nextTimeNode.active=!0;var e=(c.default.Instance.playerData.nextFreeTime+1e3*l.default.REFLESH_TIME-(new Date).getTime())/1e3;this.nextTimeNode.getComponent(cc.Label).string="\u514d\u8d39\u5012\u8ba1\u65f6\uff1a"+h.default.secondToStringFormat(e)}this.unschedule(this.freshTimeSchedule),0!=c.default.Instance.playerData.nextFreeTime&&this.schedule(this.freshTimeSchedule,1);for(var a=d.default.Instance.giftTypeMap.get(5),n=function(t){var e,n=a[t],o=n.itemList[0];if(1!=o[0])return"continue";c.default.Instance.playerData.fashionList.indexOf(o[1])>=0&&n.itemList.length>=2&&(o=n.itemList[1]),e=1==o[0]?d.default.Instance.equipmentMap.get(o[1]):d.default.Instance.itemMap.get(o[1]);var r=o[2];if(1001==o[1]){var s=y.default.Instance.chapterLogic.getMaxChapterInfo(1);r*=d.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).gold_reward}else 1004==o[1]&&(s=y.default.Instance.chapterLogic.getMaxChapterInfo(1),r*=d.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).crystal_reward);var l=cc.find("Turntable/Item"+t,i.node),h=cc.find("Name",l),u=cc.find("Img",l);cc.find("Num",l).getComponent(cc.Label).string="x"+r,p.AssetUtils.loadSpriteFrame(u,"Common/"+e.icon,function(){u.height>45&&u.height<60||(u.scale=60/u.height)},i),h.getComponent(cc.Label).string=e.name},i=this,o=0;o<8;o++)n(o);for(o=1;o<=5;o++)for(var r=c.default.Instance.playerData.lotteryTimesStatus[o-1],s=0;s<3;s++)cc.find("Reward/Reward"+o+"/Status"+s,this.node).active=r==s;var u=c.default.Instance.playerData.lotterRewardIndex%2==0?6:1;this.lotteryRewardIndex=u;var g=d.default.Instance.giftTypeMap.get(8);for(o=1;o<=5;o++){var I=cc.find("Reward/Reward"+o+"/RewardItem",this.node),_=I.getComponent("RewardItem"),v=g[u+o-2],S=v.itemList[0];if(1==S[0]){c.default.Instance.playerData.fashionList.indexOf(S[1])>=0&&v.itemList.length>=2&&(S=v.itemList[1]);var L=S[2];if(1001==S[1]){var T=y.default.Instance.chapterLogic.getMaxChapterInfo(1);L*=d.default.Instance.dungeonMap.get(T[0]).get(T[1]).get(1).gold_reward}else 1004==S[1]&&(T=y.default.Instance.chapterLogic.getMaxChapterInfo(1),L*=d.default.Instance.dungeonMap.get(T[0]).get(T[1]).get(1).crystal_reward);for(_.init(S,!1),_.resetData(L,o-1,!1,!1,!1,!0,!1),I.y=23,r=c.default.Instance.playerData.lotteryTimesStatus[o-1],s=0;s<2;s++)cc.find("Reward/Reward"+o+"/Status"+s,this.node).active=r==s}}this.progressBar.getComponent(cc.ProgressBar).progress=c.default.Instance.playerData.lotteryAdTimes/30,this.isLottery=!1,c.default.Instance.playerData.freeLotteryTimes>0?(cc.find("FreeBtn",this.node).active=!0,cc.find("AdBtn",this.node).active=!1):(cc.find("FreeBtn",this.node).active=!1,cc.find("AdBtn",this.node).active=!0),this.pageName==f.PAGE_NAME.Home?this.scheduleOnce(function(){m.default.Instance.showCustomAd(1),m.default.Instance.showCustomAd(2)},0):(this.pageName,f.PAGE_NAME.Task)},e.prototype.freshTimeSchedule=function(){var t=(c.default.Instance.playerData.nextFreeTime+1e3*l.default.REFLESH_TIME-(new Date).getTime())/1e3;t<0?(y.default.Instance.lotteryLogic.freshFreeTimes(),this.review(this.pageName)):this.nextTimeNode.getComponent(cc.Label).string="\u514d\u8d39\u5012\u8ba1\u65f6\uff1a"+h.default.secondToStringFormat(t)},e.prototype.randomLotteryEvent=function(t){var e=this,a=y.default.Instance.lotteryLogic.getLotteryDrawIndex();console.log("lotteryIndex:"+a);for(var n=Math.floor(25*Math.random())+10,i=45*-a-n+this.turntableNode.angle;i<0;)i+=360;i+=1080,this.turntableNode.runAction(cc.sequence(cc.rotateBy(1*i/360,i).easing(cc.easeOut(3)),cc.delayTime(.5),cc.callFunc(function(){e.isLottery=!1,y.default.Instance.lotteryLogic.gainPrize(a,t),e.review(e.pageName)},this)))},e.prototype.onClickEvent=function(t,e){if(I.SoundManager.Instance.playEffect("anniu"),0==e)this.node.active=!1,this.pageName==f.PAGE_NAME.Home?(m.default.Instance.hideBannerAd(),m.default.Instance.hideCustomAd(1),m.default.Instance.hideCustomAd(2),y.default.Instance.combatScene.homeLayer.showBanner()):(this.pageName,f.PAGE_NAME.Task);else if(1==e){if(this.isLottery)return void y.default.Instance.combatScene.showMsgInfo("\u64cd\u4f5c\u592a\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01");this.isLottery=!0,this.randomLotteryEvent(!0),y.default.Instance.taskLogic.finishAllTask(g.default.type_lottery_count,0,1)}else 101==e?(y.default.Instance.lotteryLogic.gainReward(1),y.default.Instance.lotteryLogic.updateLotterAdTimes(),this.review(this.pageName)):102==e?(y.default.Instance.lotteryLogic.gainReward(2),y.default.Instance.lotteryLogic.updateLotterAdTimes(),this.review(this.pageName)):103==e?(y.default.Instance.lotteryLogic.gainReward(3),y.default.Instance.lotteryLogic.updateLotterAdTimes(),this.review(this.pageName)):104==e?(y.default.Instance.lotteryLogic.gainReward(4),y.default.Instance.lotteryLogic.updateLotterAdTimes(),this.review(this.pageName)):105==e?(y.default.Instance.lotteryLogic.gainReward(5),y.default.Instance.lotteryLogic.updateLotterAdTimes(),this.review(this.pageName)):2==e&&m.default.Instance.adHandler(m.default.AD_TYPE_LOTTERY,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){if(0==e){if(this.isLottery)return void y.default.Instance.combatScene.showMsgInfo("\u64cd\u4f5c\u592a\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01");this.isLottery=!0,this.randomLotteryEvent(!1),y.default.Instance.taskLogic.finishAllTask(g.default.type_lottery_count,0,1),0!=c.default.Instance.playerData.cdActiveFreeAd&&a||y.default.Instance.taskLogic.finishAllTask(g.default.type_see_ad_count1,0,1)}else this.isLottery=!1,-1==e?(y.default.Instance.combatScene.showMsgInfo(u.default.NO_AD),m.default.Instance.noVideoToShare()&&(this.shareType=m.default.SHARE_TYPE_TASK_TYPE1,u.default.Platform==f.PLAT_FORM.Douyin?m.default.Instance.shareAppCallBack(this,this.shareAppCallback2):y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),m.default.Instance.shareApp())):y.default.Instance.combatScene.showMsgInfo(u.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(u.default.SUCCESS_SHARE,1),m.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else y.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-m.default.Instance.adServer.shareDateTime)/1e3);if(m.default.Instance.shareState(e)){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(u.default.SUCCESS_SHARE,1),m.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else m.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){this.isLottery=!1,0==t&&(y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),m.default.Instance.shareApp())},s([v],e)}(cc.Component));o.default=S,cc._RF.pop()},{}],LotteryLogic:[function(t,e,a){"use strict";cc._RF.push(e,"a510cFoT75DS5K9xXZi1R4+","LotteryLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0}),i.LotteryItem=void 0;var o=n("GameData"),r=n("ConfigData"),s=n("MainLogic"),c=function(t,e){this.giftInfo=t,this.itemId=this.giftInfo.itemList[0][0],this.amount=this.giftInfo.itemList[0][1],this.weight=e};i.LotteryItem=c;var l=function(){function t(){this.lotteryItemList=new Array}return t.prototype.initItemList=function(){if(0==this.lotteryItemList.length){for(var t=r.default.Instance.giftTypeMap.get(5),e=0;e<t.length;e++){var a=s.default.Instance.giftBagLoigc.getGiftInfoByIndex(t[e].jsonIndex);this.lotteryItemList.push(new c(a,a.weight))}var n=0;for(e=0;e<this.lotteryItemList.length;e++){var i=this.lotteryItemList[e];i.startRandom=n,n+=i.weight,i.endRandom=n}}},t.prototype.getLotteryDrawIndex=function(){var t=Math.floor(100*Math.random()),e=0;console.log("random:"+t);for(var a=0;a<this.lotteryItemList.length;a++){var n=this.lotteryItemList[a];if(t>=n.startRandom&&t<n.endRandom){e=a;break}}return e},t.prototype.gainPrize=function(e,a){for(var n=this.lotteryItemList[e],i=s.default.Instance.giftBagLoigc.getGiftInfoByIndex(n.giftInfo.jsonIndex),c=new Array,l=0;l<i.itemList.length;++l){var h=i.itemList[l][1],u=i.itemList[l][0];if(1!=u){var d=i.itemList[l][2];if(1001==h){var p=s.default.Instance.chapterLogic.getMaxChapterInfo(1);d*=r.default.Instance.dungeonMap.get(p[0]).get(p[1]).get(1).gold_reward}else 1004==h&&(p=s.default.Instance.chapterLogic.getMaxChapterInfo(1),d*=r.default.Instance.dungeonMap.get(p[0]).get(p[1]).get(1).crystal_reward);c.push([h,d,u]);break}if(!(o.default.Instance.playerData.fashionList.indexOf(h)>=0)){c.push([i.itemList[l][1],i.itemList[l][2],i.itemList[l][0]]);break}}for(s.default.Instance.chapterLogic.receiveCombatBox(c),a?(o.default.Instance.playerData.freeLotteryTimes--,o.default.Instance.playerData.lotteryAdTimes++,o.default.Instance.playerData.freeLotteryTimes==t.MAX_FREE_TIMES-1&&(o.default.Instance.playerData.nextFreeTime=(new Date).getTime())):o.default.Instance.playerData.lotteryAdTimes++,l=0;l<t.LOTTERY_REWARD_TIMES.length;l++)d=t.LOTTERY_REWARD_TIMES[l],o.default.Instance.playerData.lotteryAdTimes>=d&&0==o.default.Instance.playerData.lotteryTimesStatus[l]&&(o.default.Instance.playerData.lotteryTimesStatus[l]=1);o.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart())},t.prototype.updateLotterAdTimes=function(){var e=o.default.Instance.playerData.lotteryTimesStatus;if(2==e[0]&&2==e[1]&&2==e[2]&&2==e[3]&&2==e[4]){1==o.default.Instance.playerData.lotterRewardIndex&&(o.default.Instance.playerData.lotterRewardIndex+=1),o.default.Instance.playerData.lotteryAdTimes-=t.LOTTERY_REWARD_TIMES[t.LOTTERY_REWARD_TIMES.length-1];for(var a=0;a<t.LOTTERY_REWARD_TIMES.length;a++){var n=t.LOTTERY_REWARD_TIMES[a];o.default.Instance.playerData.lotteryAdTimes>=n?0==o.default.Instance.playerData.lotteryTimesStatus[a]&&(o.default.Instance.playerData.lotteryTimesStatus[a]=1):o.default.Instance.playerData.lotteryTimesStatus[a]=0}o.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart())}},t.prototype.gainReward=function(t){for(var e=r.default.Instance.giftTypeMap.get(8),a=new Array,n=1==o.default.Instance.playerData.lotterRewardIndex?[1,2,3,4,5][t-1]:[6,7,8,9,10][t-1],i=s.default.Instance.giftBagLoigc.getGiftInfoByIndex(e[n-1].jsonIndex),c=0;c<i.itemList.length;++c){var l=i.itemList[c][0],h=i.itemList[c][1],u=i.itemList[c][2];if(1==l){if(!(o.default.Instance.playerData.fashionList.indexOf(h)>=0)){a.push([i.itemList[c][1],i.itemList[c][2],i.itemList[c][0]]);break}}else{if(1001==h){var d=s.default.Instance.chapterLogic.getMaxChapterInfo(1);u*=r.default.Instance.dungeonMap.get(d[0]).get(d[1]).get(1).gold_reward}else 1004==h&&(d=s.default.Instance.chapterLogic.getMaxChapterInfo(1),u*=r.default.Instance.dungeonMap.get(d[0]).get(d[1]).get(1).crystal_reward);a.push([h,u,l])}}s.default.Instance.chapterLogic.receiveCombatBox(a),o.default.Instance.playerData.lotteryTimesStatus[t-1]=2,o.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart())},t.prototype.freshFreeTimes=function(){if(o.default.Instance.playerData.freeLotteryTimes=Math.min(o.default.Instance.playerData.freeLotteryTimes,1),0!=o.default.Instance.playerData.nextFreeTime){var e=((new Date).getTime()-o.default.Instance.playerData.nextFreeTime)/1e3,a=Math.floor(e/t.REFLESH_TIME);a>=1&&(o.default.Instance.playerData.freeLotteryTimes+=a,o.default.Instance.playerData.freeLotteryTimes>=t.MAX_FREE_TIMES?(o.default.Instance.playerData.freeLotteryTimes=t.MAX_FREE_TIMES,o.default.Instance.playerData.nextFreeTime=0):o.default.Instance.playerData.nextFreeTime+=a*t.REFLESH_TIME*1e3)}},t.MAX_FREE_TIMES=1,t.MAX_ONEDAY_TIMES=9999,t.REFLESH_TIME=1800,t.LOTTERY_REWARD_TIMES=[3,7,14,20,30],t}();i.default=l,cc._RF.pop()},{}],MailLayer:[function(t,e,a){"use strict";cc._RF.push(e,"762b1IDMQtMFYPCU0kl2kSE","MailLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("GameData"),h=i("StringUtils"),u=i("MainLogic"),d=i("MailTitle"),p=cc._decorator,f=p.ccclass,y=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mailTitlePrefab=null,e.mailInfo=new Array,e.startMailIndex=0,e.mailTitleScripts=new Array,e.mailTotalCount=0,e.mailTotalPage=0,e.mailCurrPage=1,e.currMailId=0,e.rewardList=new Array,e.rewardItemList=new Array,e.equipmentCount=0,e.reqState=!1,e}return r(e,t),e.prototype.init=function(){this.titleView=cc.find("Layer/TitleList",this.node).getComponent(cc.ScrollView),this.noMailNode=cc.find("Layer/TitleList/Tip",this.node),this.contentTitle=cc.find("Layer/Content/Title",this.node).getComponent(cc.Label),this.contentCon=cc.find("Layer/Content/Content",this.node).getComponent(cc.Label),this.rewardListNode=cc.find("Layer/Content/Reward/List/view/content",this.node),this.rewardGetNode=cc.find("Layer/Content/Reward/Get",this.node),this.rewardGetedNode=cc.find("Layer/Content/Reward/Geted",this.node),this.review()},e.prototype.review=function(){this.node.active=!0},e.prototype.showMailList=function(t){if(t){this.contentTitle.getComponent(cc.Label).string="",this.contentCon.getComponent(cc.Label).string="",this.rewardGetNode.active=!1,this.rewardGetedNode.active=!1,this.rewardListNode.active=!1;for(var e=0;e<this.mailTitleScripts.length;++e)(i=this.mailTitleScripts[e]).node.active=!1}this.noMailNode.active=0==this.mailInfo.length;var a=this.startMailIndex;for(e=this.startMailIndex;e<this.mailInfo.length;++e){var n=this.mailInfo[e];if(3!=n.usedType){var i;if(null==(i=this.mailTitleScripts[a])){var o=cc.instantiate(this.mailTitlePrefab);this.titleView.content.addChild(o),(i=o.getComponent(d.default)).init(this),this.mailTitleScripts.push(i)}i.node.active=!0,i.review(n),t&&0==a&&this.showMailInfo(n),a++}}this.startMailIndex=a},e.prototype.showMailInfo=function(t){this.equipmentCount=0;for(var e=0;e<this.mailTitleScripts.length;++e)(a=this.mailTitleScripts[e]).node.active&&a.mailInfo.id==t.id&&(this.currMailId=a.mailInfo.id);for(this.rewardListNode.active=!0,e=0;e<this.rewardItemList.length;e++){var a=this.rewardItemList[e];u.default.Instance.sceneNodeManager.putRewardItem(a)}for(this.rewardItemList.splice(0,this.rewardItemList.length),this.rewardList.splice(0,this.rewardList.length),t.mailInfo.reward.length>0?(this.rewardGetedNode.active=2==t.status,this.rewardGetNode.active=1==t.status):(this.rewardGetedNode.active=!1,this.rewardGetNode.active=!1,t.status),this.contentTitle.getComponent(cc.Label).string=t.mailInfo.title,this.contentCon.getComponent(cc.Label).string=t.mailInfo.info,this.rewardList=h.default.config_stringToIntListOfList(t.mailInfo.reward,"_"),null==this.rewardList&&(this.rewardList=new Array),e=0;e<this.rewardList.length;e++){var n=this.rewardList[e];1==n[0]&&(this.equipmentCount+=1),a=u.default.Instance.sceneNodeManager.getRewardItem(n[1],n[2],n[0],e,!1,!1,!1,!1,!1),this.rewardItemList.push(a),this.rewardListNode.addChild(a.node)}},e.prototype.getRewardState=function(t,e){if(1==t){for(var a=void 0,n=0;n<this.mailTitleScripts.length;++n){var i=this.mailTitleScripts[n];if(i.node.active&&i.mailInfo.id==e){i.mailInfo.status=2,i.review(i.mailInfo),a=i.mailInfo;break}}if(a.mailInfo.reward.length>0?(this.rewardGetedNode.active=2==a.status,this.rewardGetNode.active=1==a.status):(this.rewardGetedNode.active=!1,this.rewardGetNode.active=!1),this.rewardList.length>0){var o=new Array;for(n=0;n<this.rewardList.length;++n)o.push([this.rewardList[n][1],this.rewardList[n][2],this.rewardList[n][0]]);u.default.Instance.giftBagLoigc.receiveGiftItems(o,1)}l.default.Instance.localStorage2()}},e.prototype.deleteMail=function(){},e.prototype.onViewEvent=function(t){var e=t.getScrollOffset(),a=t.getMaxScrollOffset();e.y>=a.y&&!this.reqState&&this.mailCurrPage<=this.mailTotalPage&&(this.reqState=!0)},e.prototype.onClickBtn=function(t,e){if(c.SoundManager.Instance.playEffect("anniu"),1==e)this.node.active=!1;else if(2==e)this.deleteMail(0);else if(3==e){if(0==this.currMailId)return;this.deleteMail(this.currMailId)}else if(4==e){if(0==this.currMailId)return;if(l.default.Instance.playerData.equipmentGridCount-u.default.Instance.roleLogic.getUnEquipmentCount()<this.equipmentCount)return void u.default.Instance.combatScene.showMsgInfo("\u88c5\u5907\u683c\u5b50\u6570\u91cf\u4e0d\u8db3")}},s([y(cc.Prefab)],e.prototype,"mailTitlePrefab",void 0),s([f],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],MailTitle:[function(t,e,a){"use strict";cc._RF.push(e,"bd90dwpTplOlr3HaTU5Wd/X","MailTitle");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.mailLayer=t,this.closeNode=cc.find("Close",this.node),this.openNode=cc.find("Open",this.node),this.titleNode=cc.find("Title",this.node),this.senderNode=cc.find("Sender",this.node),this.timeNode=cc.find("Time",this.node),this.getNode1=cc.find("Get1",this.node),this.getNode2=cc.find("Get2",this.node),this.readNode=cc.find("Read",this.node),this.readNode.active=!1},e.prototype.review=function(t){this.mailInfo=t,1==t.status?(this.closeNode.active=!0,this.openNode.active=!1,this.getNode1.active=!0,this.getNode2.active=!1):2==t.status&&(this.closeNode.active=!1,this.openNode.active=!0,this.getNode1.active=!1,this.getNode2.active=!0);var e=t.mailInfo.end_time-(new Date).getTime()/1e3,a=Math.ceil(e/86400);this.titleNode.getComponent(cc.Label).string=t.mailInfo.title,this.senderNode.getComponent(cc.Label).string=t.mailInfo.send,this.timeNode.getComponent(cc.Label).string=a+"\u5929\u5230\u671f"},e.prototype.getReward=function(){},e.prototype.onClickBtn=function(){c.SoundManager.Instance.playEffect("anniu"),1==this.mailInfo.status&&this.mailInfo.mailInfo.reward.length,this.mailLayer.showMailInfo(this.mailInfo)},s([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],MainCamera:[function(t,e,a){"use strict";cc._RF.push(e,"90c75wd6BNHUIsRkVTn1WSp","MainCamera");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("MainLogic"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zoomRationStart=1,e.zoomRatioResult=1,e.heroShootIntervalRate=1,e.screenWidth=640,e.scaleFinish=!1,e.startY=130,e.timeSpeed=0,e.timeScale=0,e.timeScaleState=!1,e}return r(e,t),e.prototype.onLoad=function(){this.screenWidth=cc.winSize.width,this.shakeComponent=this.node.getComponent("ShakeComponent")},e.prototype.run=function(){},e.prototype.gameOver=function(){this.node.x=0,this.node.y=-25,this.node.getComponent(cc.Camera).zoomRatio=this.zoomRationStart,this.unschedule(this.scheduleMoveFollowHero),this.unscheduleAllCallbacks(),cc.director.getScheduler().setTimeScale(1)},e.prototype.gameInit=function(){this.node.x=0,this.node.y=-25,this.node.getComponent(cc.Camera).zoomRatio=this.zoomRationStart},e.prototype.gameStart=function(){this.node.x=0,this.node.y=-25,this.node.getComponent(cc.Camera).zoomRatio=this.zoomRationStart,this.heroShootIntervalRate=1,this.unschedule(this.scheduleMoveFollowHero),this.schedule(this.scheduleMoveFollowHero,0)},e.prototype.heroBirth=function(){this.node.getComponent(cc.Camera).zoomRatio=this.zoomRationStart,this.scaleFinish=!1},e.prototype.gameTimeScale=function(){var t=this;console.log(" \u653e\u6162\u901f\u5ea6 "),cc.director.getScheduler().setTimeScale(.4),this.scheduleOnce(function(){l.default.Instance.combatLayer.gameStep==c.GAME_STEP.Starting&&(console.log(" \u56de\u590d\u901f\u5ea6 "),t.timeScale=.4,t.timeSpeed=.6/.2,t.schedule(t.gameTimeSchdule,0))},.8)},e.prototype.gameTimeSchdule=function(t){this.timeScale+=this.timeSpeed*t,this.timeScale>=1&&(this.timeScale=1,this.unschedule(this.gameTimeSchdule)),cc.director.getScheduler().setTimeScale(this.timeScale)},e.prototype.scheduleMoveFollowHero=function(){var t,e=null,a=0;if(l.default.Instance.combatScene.homeLayer.node.active)e=l.default.Instance.combatScene.homeLayer.streetLayer.streetHero,a=l.default.Instance.combatScene.homeLayer.streetLayer.currFightMap.maxLeft,t=l.default.Instance.combatScene.homeLayer.streetLayer.currFightMap.maxRight;else if(l.default.Instance.combatScene.combatLayer&&l.default.Instance.combatScene.combatLayer.node.active){if(null==(e=l.default.Instance.combatScene.combatLayer.mainLayer.myHeroSprite)||e.stateMachine.currState==c.HEOR_STATE.Birth)return;a=l.default.Instance.mainLayer.currFightMap.maxLeft,t=l.default.Instance.mainLayer.currFightMap.maxRight}if(e){var n=e.node.convertToWorldSpaceAR(cc.v2(0,0)),i=this.node.parent.convertToNodeSpaceAR(n),o=this.node.x;o=Math.abs(i.x-a)<=this.screenWidth/2?a+this.screenWidth/2:Math.abs(t-i.x)<=this.screenWidth/2?t-this.screenWidth/2:i.x,this.node.x=o}},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],MainLayer:[function(t,e,a){"use strict";cc._RF.push(e,"6428cGw8SZO8qKyFs3vBMCv","MainLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("GameData"),h=i("ConfigData"),u=i("BuffUtil"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroSpriteList=new Array,e}return r(e,t),e.prototype.init=function(t){this.combatLayer=t,this.nodeManager=this.node.getComponent("NodeManager"),this.nodeManager.init(this),this.monsterManager=this.node.getComponent("MonsterManager"),this.monsterManager.init(this)},e.prototype.gameInit=function(){this.tryHeroId=l.default.Instance.playerData.roleId,this.tryHeroId=1001,this.nodeManager.gameInit(),this.combatLayer.uiLayer.currRoomdeadMonsterNum=0,this.combatLayer.uiLayer.deadMonsterNum=0},e.prototype.gameRestart=function(){var t=this;this.nodeManager.getHeroSprite(this.tryHeroId,c.BATTLE_CAMP.Self,cc.v2(0,-180)),this.scheduleOnce(function(){t.addBuff()},1)},e.prototype.gameOver=function(){this.monsterManager.gameOver(),null!=this.myHeroSprite&&this.myHeroSprite.delete();for(var t=this.heroSpriteList.length-1;t>=0;t--)this.heroSpriteList[t].delete();this.clearNode()},e.prototype.clearNode=function(){for(var t=this.nodeManager.effectSpriteList,e=t.length-1;e>=0;e--)t[e].delete();var a=this.nodeManager.bulletSpriteList;for(e=a.length-1;e>=0;e--)a[e].delete();var n=this.nodeManager.dropItemSpriteList;for(e=n.length-1;e>=0;e--)n[e].delete();var i=this.nodeManager.dropEquipmentSpriteList;for(e=i.length-1;e>=0;e--)i[e].delete(!0);var o=this.nodeManager.trapSpriteList;for(e=o.length-1;e>=0;e--)o[e].delete();var r=this.nodeManager.buffBoxList;for(e=r.length-1;e>=0;e--)r[e].delete();var s=this.nodeManager.warnSpriteList;for(e=s.length-1;e>=0;e--)s[e].delete();var c=this.nodeManager.itemSpriteList;for(e=c.length-1;e>=0;e--)c[e].delete();var l=this.nodeManager.rewardTipList;for(e=l.length-1;e>=0;e--)l[e].delete()},e.prototype.pauseAllHero=function(t){for(var e=0;e<this.heroSpriteList.length;e++)this.heroSpriteList[e].pauseHero();t&&null!=this.myHeroSprite&&this.myHeroSprite.pauseHero()},e.prototype.resumeAllHero=function(t){for(var e=0;e<this.heroSpriteList.length;e++)this.heroSpriteList[e].resumeHero();t&&null!=this.myHeroSprite&&this.myHeroSprite.resumeHero()},e.prototype.updateHeroPos=function(t){var e=this.currFightMap.getHeroBirthPosition(t);this.myHeroSprite.node.x=e.x,this.myHeroSprite.node.y=e.y},e.prototype.hideHpTube=function(){for(var t=0;t<this.heroSpriteList.length;t++)this.heroSpriteList[t].hpTubeSprite.node.opacity=0},e.prototype.addBuff=function(){for(var t=l.default.Instance.playerData.buffDataList,e=0;e<t.length;++e){var a=t[e];if(a.continueTime>0){var n=h.default.Instance.buffItemMap.get(a.buffId),i=u.default.createBuffBySpecialItem(n,1);this.myHeroSprite.buffManager.addBuffList(i)}}},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],MainLogic:[function(t,e,a){"use strict";cc._RF.push(e,"bb480btsftOUbQ/P6HitKIc","MainLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("RoleLogic"),r=n("SigninLogic"),s=n("MoneyLogic"),c=n("ChapterLogic"),l=n("GiftBagLogic"),h=n("TipsLogic"),u=n("LotteryLogic"),d=n("ActionTagLogic"),p=n("AdOrDiamondLogic"),f=n("TaskLogic"),y=n("ShopLogic"),m=n("EquipmentLogic"),g=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t,this._instance.init()),this._instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.roleLogic=new o.default,this.chapterLogic=new c.default,this.moneyLogic=new s.default,this.signinLogic=new r.default,this.chapterLogic=new c.default,this.giftBagLoigc=new l.default,this.tipsLogic=new h.default,this.lotteryLogic=new u.default,this.actionTagLogic=new d.default,this.adDiamondLogic=new p.default,this.taskLogic=new f.default,this.shopLogic=new y.default,this.equipmentLogic=new m.default},t}();i.default=g,cc._RF.pop()},{}],MoneyLogic:[function(t,e,a){"use strict";cc._RF.push(e,"33a86Ruw9ZHgoaUzlAa3P89","MoneyLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("PublicConst"),s=n("MainLogic"),c=n("ConfigData"),l=function(){function t(){}return t.prototype.countPower=function(){var t=Math.round((o.default.Instance.playerData.nextPowerTime-(new Date).getTime())/1e3);if(t<=0){var e=1;e+=(t=Math.abs(t))/600;var a=t%600;o.default.Instance.playerData.nextPowerTime=(new Date).getTime()+6e5-1e3*a,this.addItemCount(1003,e)}},t.prototype.addRecharge=function(t){s.default.Instance.actionTagLogic.rechargedEvent(),o.default.Instance.playerData.rechargeTotalNum+=t,o.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart()),t=Math.floor(t/100)},t.prototype.addItemCount=function(t,e,a){var n=o.default.Instance.playerData.itemList[t];if(null==n&&(o.default.Instance.playerData.itemList[t]=0,n=0),(1003==t||1014==t)&&e<0&&n<-e)return!1;switch(n=Math.floor(e)+n,n=Math.max(0,n),1003==t&&null==a&&e>0&&(n=Math.min(n,r.default.Max_Power+o.default.Instance.powerAdd)),o.default.Instance.playerData.itemList[t]=n,1==c.default.Instance.itemMap.get(t).is_show&&s.default.Instance.equipmentLogic.addPropData(t,n),t){case 1001:null!=s.default.Instance.combatScene.homeLayer&&s.default.Instance.combatScene.homeLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.chapterLayer&&s.default.Instance.combatScene.popLayer.chapterLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.skillLayer&&s.default.Instance.combatScene.popLayer.skillLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.equipmentLayer&&s.default.Instance.combatScene.popLayer.equipmentLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.strengthenLayer&&s.default.Instance.combatScene.popLayer.strengthenLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.endlessLayer&&s.default.Instance.combatScene.popLayer.endlessLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.shakeJarLayer&&s.default.Instance.combatScene.popLayer.shakeJarLayer.showMoney();break;case 1002:null!=s.default.Instance.combatScene.homeLayer&&s.default.Instance.combatScene.homeLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.skillLayer&&s.default.Instance.combatScene.popLayer.skillLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.shakeJarLayer&&s.default.Instance.combatScene.popLayer.shakeJarLayer.showMoney();break;case 1003:null!=s.default.Instance.combatScene.homeLayer&&s.default.Instance.combatScene.homeLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.chapterLayer&&s.default.Instance.combatScene.popLayer.chapterLayer.showMoney();break;case 1004:null!=s.default.Instance.combatScene.popLayer.equipmentLayer&&s.default.Instance.combatScene.popLayer.equipmentLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.equipmentLayer&&s.default.Instance.combatScene.popLayer.equipmentLayer.updatePropInfo(1004),null!=s.default.Instance.combatScene.popLayer.strengthenLayer&&s.default.Instance.combatScene.popLayer.strengthenLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.skillLayer&&s.default.Instance.combatScene.popLayer.skillLayer.showMoney(),null!=s.default.Instance.combatScene.popLayer.endlessLayer&&s.default.Instance.combatScene.popLayer.endlessLayer.showMoney();break;case 1005:e>0&&s.default.Instance.roleLogic.roleUpgrade();break;case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:break;case 1015:e>0&&s.default.Instance.roleLogic.passCheckLevel();break;case 1016:case 1017:case 1018:case 1019:case 1020:case 1021:case 1022:case 1023:case 1024:case 1025:case 1026:break;case 1036:null!=s.default.Instance.combatScene.popLayer.shopLayer&&s.default.Instance.combatScene.popLayer.shopLayer.showMoney();break;case 1042:e>0&&(o.default.Instance.playerData.cdActiveFreeAd=1,o.default.Instance.playerData.cdActiveFreeAdTime=(new Date).getTime())}return o.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart()),!0},t.prototype.getItemCount=function(t){var e=o.default.Instance.playerData.itemList[t];return s.default.Instance.moneyLogic.getItemCostCount(t),null==e&&(e=0),e},t.prototype.getItemCostCount=function(t){var e=o.default.Instance.playerData.itemCostList[t];return null==e&&(o.default.Instance.playerData.itemCostList[t]=0,e=0),e},t.prototype.showMoreMoney=function(t,e,a){var n=c.default.Instance.itemMap.get(e);switch(n.type){case 2:s.default.Instance.combatScene.popLayer.reviewMoneyMorePage(t,1,a);break;case 3:s.default.Instance.combatScene.popLayer.reviewMoneyMorePage(t,2,a);break;case 4:s.default.Instance.combatScene.popLayer.reviewMoneyMorePage(t,3,a);break;case 5:s.default.Instance.combatScene.popLayer.reviewMoneyMorePage(t,4,a);break;default:s.default.Instance.combatScene.showMsgInfo(n.name+"\u4e0d\u8db3")}},t}();i.default=l,cc._RF.pop()},{}],MoneyMorePage:[function(t,e,a){"use strict";cc._RF.push(e,"a71e8qRlVJMRrUEmZM2ch4p","MoneyMorePage");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("StringUtils"),h=i("MainLogic"),u=i("AdServer"),d=i("ConfigData"),p=i("PublicEnum"),f=i("GameData"),y=i("SoundManager"),m=i("TaskLogic"),g=cc._decorator,I=g.ccclass,_=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hideBanner=!1,e.rewardDatas=[1e3,150,5,4],e.recommentPanel1=null,e.recommentPanel2=null,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e,a){this.review(t,e,a)},e.prototype.review=function(t,e,a){if(this.pageType=e,this.hideBanner=a,this.pageName=t,this.node.active=!0,1==this.pageType){var n=h.default.Instance.chapterLogic.getMaxChapterInfo(1),i=d.default.Instance.dungeonMap.get(n[0]).get(n[1]).get(1);this.rewardDatas[0]=8*i.gold_reward}for(var o=1;o<=4;o++){var r=cc.find("Page"+o,this.node);r.active=e==o;var s=this.rewardDatas[this.pageType-1];c.default.Is_Senior&&(s*=100),cc.find("RewardNum",r).getComponent(cc.Label).string="x"+l.default.stringToWord(s)}this.scheduleOnce(function(){u.default.Instance.showCustomAd(1),u.default.Instance.showCustomAd(2)},0)},e.prototype.onClickEvent=function(t,e){if(y.SoundManager.Instance.playEffect("anniu"),0==e)this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd();else if(1==e)this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd(),h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewShopLayer(1,[1,1,1,3][this.pageType-1]);else if(2==e){if(!c.default.PassCheckSwitch)return void h.default.Instance.combatScene.showMsgInfo("\u901a\u884c\u8bc1\u6682\u672a\u5f00\u542f");this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd(),h.default.Instance.combatScene.homeLayer.hideNode(),h.default.Instance.combatScene.popLayer.reviewPassCheckLayer()}else 3==e?(this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd(),h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewLotteryLayer(this.pageName)):4==e?(this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd(),h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewDiamWelfareLayer()):101==e?u.default.Instance.adHandler(u.default.AD_TYPE_ADD_COIN,this,this.adCallback):201==e?u.default.Instance.adHandler(u.default.AD_TYPE_ADD_COUNTING,this,this.adCallback):301==e&&u.default.Instance.adHandler(u.default.AD_TYPE_ADD_POWER,this,this.adCallback)},e.prototype.nextStepShowAd=function(){switch(this.pageName){case p.PAGE_NAME.Home:case p.PAGE_NAME.ShakeJar:case p.PAGE_NAME.Endless:case p.PAGE_NAME.Equipment:case p.PAGE_NAME.Shop:u.default.Instance.hideCustomAd(1),u.default.Instance.hideCustomAd(2);break;case p.PAGE_NAME.ChapterStart:case p.PAGE_NAME.Task:case p.PAGE_NAME.Revived:break;case p.PAGE_NAME.Skill:case p.PAGE_NAME.Strengthen:case p.PAGE_NAME.Chapter:u.default.Instance.hideCustomAd(2);break;case p.PAGE_NAME.Combat:case p.PAGE_NAME.CombatResult:}},e.prototype.adCallback=function(t,e,a){if(0==e){var n=this.rewardDatas[this.pageType-1];c.default.Is_Senior&&(n*=100),t==u.default.AD_TYPE_ADD_COIN||t==u.default.SHARE_TYPE_ADD_COIN?(h.default.Instance.moneyLogic.addItemCount(1001,n),h.default.Instance.combatScene.addRewardEffect(1001,n,1)):t==u.default.AD_TYPE_ADD_COUNTING||t==u.default.SHARE_TYPE_ADD_COUNTING?(h.default.Instance.moneyLogic.addItemCount(1002,n),h.default.Instance.combatScene.addRewardEffect(1002,n,1)):t!=u.default.AD_TYPE_ADD_POWER&&t!=u.default.SHARE_TYPE_ADD_POWER||(h.default.Instance.moneyLogic.addItemCount(1003,n,!1),h.default.Instance.combatScene.addRewardEffect(1003,n,1)),this.node.active=!1,this.hideBanner&&u.default.Instance.hideBannerAd(),this.nextStepShowAd(),0!=f.default.Instance.playerData.cdActiveFreeAd&&a||h.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)}else-1==e?(h.default.Instance.combatScene.showMsgInfo(c.default.NO_AD),u.default.Instance.noVideoToShare()&&(t==u.default.AD_TYPE_ADD_COIN?this.shareType=u.default.SHARE_TYPE_ADD_COIN:t==u.default.AD_TYPE_ADD_COUNTING?this.shareType=u.default.SHARE_TYPE_ADD_COUNTING:t==u.default.AD_TYPE_ADD_POWER&&(this.shareType=u.default.SHARE_TYPE_ADD_POWER),c.default.Platform==p.PLAT_FORM.Douyin?u.default.Instance.shareAppCallBack(this,this.shareAppCallback2):h.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())):h.default.Instance.combatScene.showMsgInfo(c.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(f.default.Instance.playerData.shareGetRewardCount>0))return void h.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");f.default.Instance.playerData.shareGetRewardCount-=1,h.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else h.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-u.default.Instance.adServer.shareDateTime)/1e3);if(u.default.Instance.shareState(e)){if(!(f.default.Instance.playerData.shareGetRewardCount>0))return void h.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");f.default.Instance.playerData.shareGetRewardCount-=1,h.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else u.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(h.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())},s([I],e)}(cc.Component));o.default=_,cc._RF.pop()},{}],MonsterManager:[function(t,e,a){"use strict";cc._RF.push(e,"a744cftCjpGZLWg0/Ky28De","MonsterManager");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("PublicEnum"),h=i("MainLogic"),u=i("MyMathUtils"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currRoomNum=new Array,e.currRoomMonsterNum=new Array,e.passRoom=new Array,e.guideClose=!0,e.isLastWave=!1,e.isCreateSyBoss=!1,e}return r(e,t),e.prototype.init=function(t){this.mainLayer=t},e.prototype.gameStart=function(){var t=h.default.Instance.combatScene;this.passRoom=[],this.isCreateSyBoss=!1,this.roomNum=t.combatLayer.dungeonInfo.stagePosList.length,this.currRoomNum=t.combatLayer.dungeonInfo.firstStagePos,this.currRoomMonsterNum=this.countCurrRoomMonsterNum(),h.default.Instance.combatLayer.uiLayer.currRoommonsterTotalNum=this.currRoomMonsterNum[3],h.default.Instance.combatLayer.uiLayer.currRoomdeadMonsterNum=0,h.default.Instance.combatLayer.uiLayer.showMonsterNum();var e=t.combatLayer.dungeonInfo.getDoors([this.currRoomNum[0],this.currRoomNum[1]]);this.dispatchMonster(e)},e.prototype.countCurrRoomMonsterNum=function(){var t=h.default.Instance.combatScene.combatLayer.dungeonInfo.getRoomInfo(this.currRoomNum[0],this.currRoomNum[1]);this.isLastWave=3==t[2],this.currRoomType=t[2];var e=c.default.Instance.stageInfoMap.get(t[1]),a=u.default.randomInt(e.monster_num_min,e.monster_num_max),n=0;1==e.is_elite_monster&&(n=u.default.randomInt(e.elite_monster_num_min,e.elite_monster_num_max));var i=this.isLastWave?1:0;return[a,n,i,a+n+i]},e.prototype.passCurrRoom=function(){var t=this.currRoomNum[0]+"_"+this.currRoomNum[1];return this.passRoom.indexOf(t)<0&&(this.passRoom.push(t),!0)},e.prototype.gameOver=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks()},e.prototype.dispatchMonster=function(t){var e=this,a=h.default.Instance.combatScene;if(a.combatLayer.uiLayer.smallMapLayer.showHeroNode(this.currRoomNum),!this.passCurrRoom())return a.combatLayer.canGoNextRoom=!0,void this.mainLayer.currFightMap.showDoor(t,!1);if(this.mainLayer.currFightMap.showDoor(t,!0),this.isLastWave&&a.combatLayer.uiLayer.currRoommonsterTotalNum==a.combatLayer.uiLayer.currRoomdeadMonsterNum)a.combatLayer.gameOver(l.GAME_RESULT.Success);else if(this.currRoomMonsterNum=this.countCurrRoomMonsterNum(),h.default.Instance.combatLayer.uiLayer.currRoommonsterTotalNum=this.currRoomMonsterNum[3],h.default.Instance.combatLayer.uiLayer.currRoomdeadMonsterNum=0,h.default.Instance.combatLayer.uiLayer.showMonsterNum(),this.isLastWave&&this.mainLayer.combatLayer.uiLayer.startRecord(),0!=this.currRoomMonsterNum[3]){var n=!1;if(4==a.combatLayer.dungeonInfo.difficulty&&a.combatLayer.dungeonInfo.getRoomIndex(this.currRoomNum[0],this.currRoomNum[1])+1==a.combatLayer.dungeonInfo.getRoomCount()-1&&(n=!0,this.isCreateSyBoss=!0),this.currRoomMonsterNum[0]>0)for(var i=this.mainLayer.currFightMap.fightMapData.getMonsterPosList(this.currRoomMonsterNum[0],1),o=function(t){r.node.runAction(cc.sequence(cc.delayTime(.1+.05*t),cc.callFunc(function(){e.addMonster(e.countHeroId(),i[t],1)},r)))},r=this,s=0;s<this.currRoomMonsterNum[0];++s)o(s);if(this.currRoomMonsterNum[1]>0&&a.combatLayer.dungeonInfo.eliteMonsterList){var c=this.mainLayer.currFightMap.fightMapData.getMonsterPosList(this.currRoomMonsterNum[1],2),u=function(t){d.node.runAction(cc.sequence(cc.delayTime(.1+.05*t),cc.callFunc(function(){e.addMonster(e.countEliteId(),c[t],2)},d)))},d=this;for(s=0;s<this.currRoomMonsterNum[1];++s)u(s)}if(this.currRoomMonsterNum[2]>0&&a.combatLayer.dungeonInfo.boss_id){var p=this.mainLayer.currFightMap.fightMapData.getMonsterPosList(this.currRoomMonsterNum[2],3),f=function(t){y.node.runAction(cc.sequence(cc.delayTime(.1+.05*t),cc.callFunc(function(){e.addMonster(a.combatLayer.dungeonInfo.boss_id,p[t],3)},y)))},y=this;for(s=0;s<this.currRoomMonsterNum[2];++s)f(s)}if(n){var m=this.mainLayer.currFightMap.fightMapData.getMonsterPosList(1,4),g=cc.v2(170,-45);null==m||0==m.length||(g=m[0]),this.addMonster(5001,g,4)}}else a.combatLayer.canGoNextRoom=!0},e.prototype.createSyBoss=function(){var t=this.mainLayer.currFightMap.fightMapData.getMonsterPosList(1,4);this.addMonster(this.mainLayer.combatLayer.dungeonInfo.chasm_boss_id,t[0],5)},e.prototype.countHeroId=function(){for(var t=h.default.Instance.combatScene,e=Math.random(),a=0;a<t.combatLayer.dungeonInfo.monsterIdList.length;a++){var n=t.combatLayer.dungeonInfo.monsterIdList[a],i=n[2],o=n[3];if(e>=i&&e<o)return n[0]}return console.log("addMonsterSchedule fail..."),0},e.prototype.countEliteId=function(){for(var t=h.default.Instance.combatScene,e=Math.random(),a=0;a<t.combatLayer.dungeonInfo.eliteMonsterList.length;a++){var n=t.combatLayer.dungeonInfo.eliteMonsterList[a],i=n[2],o=n[3];if(e>=i&&e<o)return n[0]}return console.log("addMonsterSchedule fail..."),0},e.prototype.addMonster=function(t,e,a){var n=this,i=e;1==c.default.Instance.roleMap.get(t).is_boss?this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){n.mainLayer.nodeManager.getHeroSprite(t,l.BATTLE_CAMP.Enemy,i,a),5==a&&(n.isCreateSyBoss=!1)},this))):(this.mainLayer.nodeManager.getHeroSprite(t,l.BATTLE_CAMP.Enemy,i,a),5==a&&(this.isCreateSyBoss=!1))},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],MoreFashionLayer:[function(t,e,a){"use strict";cc._RF.push(e,"a23e9PGXQVBZL1HQ7NFU+NT","MoreFashionLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("GameData"),p=i("MainLogic"),f=i("TaskLogic"),y=i("BunnyFashion"),m=i("FashionGrid"),g=cc._decorator,I=g.ccclass,_=g.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fashionPrefa=null,e.bunnyFashionPrefab=null,e.equipItems=new Array,e.bunnyItems=new Array,e.pageType=1,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.heroNode=cc.find("Layer1/Hero",this.node),this.equipNode=cc.find("Layer1/Equip",this.node),this.dhqCountNode=cc.find("Layer1/Have/Count",this.node);var e=cc.find("Layer1/Exchange1",this.node);this.exchangeButton1=e.getComponent(cc.Button);var a=cc.find("Layer1/Exchange2",this.node);this.exchangeButton2=a.getComponent(cc.Button);var n=cc.find("Layer1/Exchange3",this.node);this.exchangeButton3=n.getComponent(cc.Button),this.bunnyNode=cc.find("Layer2/Hero",this.node),this.bunnyListNode=cc.find("Layer2/Equip",this.node);for(var i=0;i<3;++i){var o=cc.instantiate(this.fashionPrefa),r=o.getComponent(m.default);r.init(null,2,1+i,30007+i,0),this.equipNode.addChild(o),o.x=0,this.equipItems.push(r);var s=cc.instantiate(this.bunnyFashionPrefab),c=s.getComponent(y.default);c.init(30010+i,i+1),this.bunnyListNode.addChild(s),this.bunnyItems.push(c)}var u=cc.find("Layer1/Share",this.node),d=cc.find("Layer1/TipShare",this.node),p=cc.find("Layer1/Video",this.node),f=cc.find("Layer1/TipVideo",this.node);this.videoCountNode=cc.find("Count",p),l.default.Platform==h.PLAT_FORM.Web_4399?(u.active=!1,d.active=!1,p.active=!0,f.active=!0):(u.active=!0,d.active=!0,p.active=!1,f.active=!1),this.review(t)},e.prototype.review=function(t){this.pageType=t,this.node.active=!0;for(var e=1;e<=2;++e)cc.find("Layer"+e,this.node).active=this.pageType==e;if(1==this.pageType)null==this.heroScript&&(this.heroScript=p.default.Instance.sceneNodeManager.getHeroArmature(1001,30007,30008,30009,0),this.heroNode.addChild(this.heroScript.node)),this.showDhqLabel(),d.default.Instance.playerData.fashionList.indexOf(30007)>=0&&(this.exchangeButton1.interactable=!1),d.default.Instance.playerData.fashionList.indexOf(30008)>=0&&(this.exchangeButton2.interactable=!1),d.default.Instance.playerData.fashionList.indexOf(30009)>=0&&(this.exchangeButton3.interactable=!1);else if(2==this.pageType){null==this.bunnyScript&&(this.bunnyScript=p.default.Instance.sceneNodeManager.getHeroArmature(1001,30010,30011,30012,0),this.bunnyNode.addChild(this.bunnyScript.node));var a=cc.find("Layer2/Video",this.node),n=cc.find("Layer2/Tip",this.node),i=cc.find("Layer2/Tip2",this.node);if(d.default.Instance.playerData.fashionList.indexOf(30010)>=0&&d.default.Instance.playerData.fashionList.indexOf(30011)>=0&&d.default.Instance.playerData.fashionList.indexOf(30012)>=0)a.active=!1,n.active=!1,i.active=!0;else{var o=d.default.Instance.playerData.bunnyStatus[d.default.Instance.playerData.bunnyDay];0==o&&(o=1,d.default.Instance.playerData.bunnyStatus[d.default.Instance.playerData.bunnyDay]=1),cc.find("Count",a).getComponent(cc.Label).string="("+d.default.Instance.playerData.bunnyVideoCount+"/2)",1==o?(a.active=!0,n.active=!1):(a.active=!1,n.active=!0)}for(e=0;e<this.bunnyItems.length;++e)this.bunnyItems[e].review();this.scheduleOnce(function(){c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2)},0)}},e.prototype.showDhqLabel=function(){this.dhqCountNode.getComponent(cc.Label).string="x"+p.default.Instance.moneyLogic.getItemCount(1026),this.videoCountNode.getComponent(cc.Label).string="("+d.default.Instance.playerData.msdhqVideoCount+"/2)"},e.prototype.onClickBtn=function(t,e){u.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,p.default.Instance.combatScene.popLayer.autoPopLayer(),2==this.pageType&&(c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2))):2==e?p.default.Instance.moneyLogic.getItemCount(1026)>=2?(d.default.Instance.playerData.fashionList.push(30007),p.default.Instance.moneyLogic.addItemCount(1026,-2),p.default.Instance.combatScene.addRewardEffect(30007,1,0,1),this.exchangeButton1.interactable=!1,this.showDhqLabel()):p.default.Instance.combatScene.showMsgInfo("\u5151\u6362\u5238\u4e0d\u8db3"):3==e?p.default.Instance.moneyLogic.getItemCount(1026)>=2?(d.default.Instance.playerData.fashionList.push(30008),p.default.Instance.moneyLogic.addItemCount(1026,-2),p.default.Instance.combatScene.addRewardEffect(30008,1,0,1),this.exchangeButton2.interactable=!1,this.showDhqLabel()):p.default.Instance.combatScene.showMsgInfo("\u5151\u6362\u5238\u4e0d\u8db3"):4==e?p.default.Instance.moneyLogic.getItemCount(1026)>=3?(d.default.Instance.playerData.fashionList.push(30009),p.default.Instance.moneyLogic.addItemCount(1026,-3),p.default.Instance.combatScene.addRewardEffect(30009,1,0,1),this.exchangeButton3.interactable=!1,this.showDhqLabel()):p.default.Instance.combatScene.showMsgInfo("\u5151\u6362\u5238\u4e0d\u8db3"):5==e?(c.default.Instance.shareAppCallBack(this,function(){}),c.default.Instance.shareApp(d.default.Instance.playerData.openid,1,1e6)):6==e?c.default.Instance.adHandler(c.default.AD_TYPE_BUNNY_GIRL,this,this.adCallback):7==e&&c.default.Instance.adHandler(c.default.AD_TYPE_GET_MSDHQ,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){0==e?(t==c.default.AD_TYPE_BUNNY_GIRL||t==c.default.SHARE_TYPE_BUNNY_GIRL?(d.default.Instance.playerData.bunnyVideoCount+=1,d.default.Instance.playerData.bunnyVideoCount>=2?(d.default.Instance.playerData.bunnyStatus[d.default.Instance.playerData.bunnyDay]=2,p.default.Instance.giftBagLoigc.receiveGiftItems([[30009+d.default.Instance.playerData.bunnyDay,1,1]],1),p.default.Instance.combatScene.homeLayer.hideUiNode()):p.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,1e4,2]],1),this.review(this.pageType)):t!=c.default.AD_TYPE_GET_MSDHQ&&t!=c.default.SHARE_TYPE_GET_MSDHQ||(d.default.Instance.playerData.msdhqVideoCount+=1,d.default.Instance.playerData.msdhqVideoCount>=2?(d.default.Instance.playerData.msdhqVideoCount-=2,p.default.Instance.giftBagLoigc.receiveGiftItems([[1026,1,2]],1)):p.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,1e4,2]],1),this.showDhqLabel()),0!=d.default.Instance.playerData.cdActiveFreeAd&&a||p.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1)):-1==e?(p.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_BUNNY_GIRL?this.shareType=c.default.SHARE_TYPE_BUNNY_GIRL:t==c.default.AD_TYPE_GET_MSDHQ&&(this.shareType=c.default.SHARE_TYPE_GET_MSDHQ),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):p.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(d.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");d.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else p.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(d.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");d.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([_(cc.Prefab)],e.prototype,"fashionPrefa",void 0),s([_(cc.Prefab)],e.prototype,"bunnyFashionPrefab",void 0),s([I],e)}(cc.Component);o.default=v,cc._RF.pop()},{}],MoreGameLayer:[function(t,e,a){"use strict";cc._RF.push(e,"1bcc2tIOahMTrUSjX4HKUDy","MoreGameLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("SoundManager"),h=i("MainLogic"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layerType=0,e}return r(e,t),e.prototype.init=function(t){this.review(t)},e.prototype.review=function(t){this.layerType=t,this.node.active=!0;for(var e=1;e<=2;++e)cc.find("Layer"+e,this.node).active=t==e;1==t&&c.default.Instance.showCustomAd(4),c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2)},e.prototype.onClickBtn=function(t,e){l.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2),1==this.layerType&&c.default.Instance.hideCustomAd(4),h.default.Instance.combatScene.popLayer.autoPopLayer()):c.default.Instance.openCustomerServiceConversation({sessionFrom:"reward=1",sendMessageTitle:"\u5173\u6ce8\u8d26\u53f7\u6709\u5956\u52b1"},function(){},this)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],MyMathUtils:[function(t,e,a){"use strict";cc._RF.push(e,"00babB7HPhKm537vmwrXqeg","MyMathUtils");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.toRadian=function(e){return e*t.RADIAN_PER_ANGLE},t.toAngle=function(e){return e/t.RADIAN_PER_ANGLE},t.atan2=function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)},t.getDistance=function(t,e,a,n){var i=t-a,o=e-n;return Math.sqrt(i*i+o*o)},t.IsCircleIntersectFan=function(e,a,n,i,o,r,s,c){var l=r-i,h=s-o,u=Math.sqrt(l*l+h*h);if((e-i)*(e-i)+(a-o)*(a-o)>(u+n)*(u+n))return!1;var d=.5*c,p=Math.cos(d),f=Math.sin(d),y=i+(l*p-h*f),m=o+(l*f+h*p),g=i+(l*p+h*f),I=o+(-l*f+h*p),_=t.EvaluatePointToLine(e,a,i,o,y,m),v=t.EvaluatePointToLine(e,a,g,I,i,o);return _>=0&&v>=0||!!t.IsCircleIntersectLineSeg(e,a,n,i,o,y,m)||!!t.IsCircleIntersectLineSeg(e,a,n,i,o,g,I)},t.EvaluatePointToLine=function(t,e,a,n,i,o){return(o-n)*t+(a-i)*e+(i*n-a*o)},t.IsCircleIntersectLineSeg=function(t,e,a,n,i,o,r){var s=t-n,c=e-i,l=o-n,h=r-i,u=Math.sqrt(l*l+h*h),d=s*(l/=u)+c*(h/=u),p=0,f=0;return d<=0?(p=n,f=i):d>=u?(p=o,f=r):(p=n+l*d,f=i+h*d),(t-p)*(t-p)+(e-f)*(e-f)<=a*a},t.random=function(t,e){return null==t&&null!=e?e:null!=t&&null==e?t:(t>e?(a=e,n=t):(a=t,n=e),Math.random()*(n-a)+a);var a,n},t.randomInt=function(t,e){var a,n;return t>e?(a=e,n=t):(a=t,n=e),Math.floor(Math.random()*(n-a)+a)},t.getBezierAction=function(t,e,a,n,i){var o=3.14159*i/180,r=Math.cos(o),s=e.x+(a.x-e.x)/4,c=cc.v2(s,n+e.y+r*Math.abs(s)),l=e.x+(a.x-e.x)/2,h=cc.v2(l,n+e.y+r*Math.abs(l));return cc.bezierTo(t,[c,h,a])},t.RADIAN_PER_ANGLE=Math.PI/180,t}();n.default=i,cc._RF.pop()},{}],MyPlatUtils:[function(t,e,a){"use strict";cc._RF.push(e,"873332V4hBALpHHK5V4tOKS","MyPlatUtils");var n=a,i=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(n,"__esModule",{value:!0});var o=cc._decorator,r=o.ccclass,s=(o.property,function(){function t(){}return Object.defineProperty(t,"IsNativeAndroid",{get:function(){return cc.sys.os==cc.sys.OS_ANDROID&&!1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsNativeIOS",{get:function(){return cc.sys.os==cc.sys.OS_IOS&&!1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ISUC",{get:function(){return window.uc},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ISCocos",{get:function(){return window.loadRuntime&&!this.IsOPPO&&!this.IsVIVO&&!window.kwaigame},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsAndroid",{get:function(){return cc.sys.os==cc.sys.OS_ANDROID},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsIOS",{get:function(){return cc.sys.os==cc.sys.OS_IOS},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsWechat",{get:function(){return cc.sys.platform==cc.sys.WECHAT_GAME&&!this.IsDouyin&&!this.IsQQ},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsOPPO",{get:function(){return cc.sys.platform==cc.sys.OPPO_GAME},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsBaidu",{get:function(){return cc.sys.platform==cc.sys.BAIDU_GAME},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsVIVO",{get:function(){return cc.sys.platform==cc.sys.VIVO_GAME},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsDouyin",{get:function(){return window.tt},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsQQ",{get:function(){return window.qq},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsQTT",{get:function(){return window.qttGame},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsXiaoMi",{get:function(){return!(PlatUtils.IsOPPO||PlatUtils.IsVIVO||!window.qg)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Is4399",{get:function(){return window.h5api},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsBili",{get:function(){return window.bl},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsKwai",{get:function(){return window.kwaigame},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IsTest",{get:function(){return cc.sys.isBrowser&&!this.IsQTT},enumerable:!1,configurable:!0}),i([r],t)}());n.default=s,cc._RF.pop()},{}],NodeManager:[function(t,e,a){"use strict";cc._RF.push(e,"72e719kcXNMl7sjUWV4P32k","NodeManager");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("Dictionary"),l=i("AssetUtils"),h=i("PublicEnum"),u=cc._decorator,d=u.ccclass,p=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroSpritePrefab=null,e.effectSpritePrefab=null,e.bulletSpritePrefab=null,e.dropItemSpritePrefab=null,e.trapSpritePrefab=null,e.buffBoxPrefab=null,e.warnSpritePrefab=null,e.smallMapItemPrefab=null,e.shadowPrefab=null,e.hpTubePrefab=null,e.itemSpritePrefab=null,e.rewardTipPrefab=null,e.weaponShadowPrefab=null,e.fightMapPrefabMap=new c.Dictionary,e.fightMapNodePoolMap=new c.Dictionary,e.heroSprietNodePoolMap=new c.Dictionary,e.effectSpriteNodePoolMap=new c.Dictionary,e.bulletSpriteNodePoolMap=new c.Dictionary,e.dropItemSpriteNodePoolMap=new c.Dictionary,e.dropEquipmentSpriteNodePoolMap=new c.Dictionary,e.trapSpriteNodePoolMap=new c.Dictionary,e.buffBoxPoolMap=new c.Dictionary,e.warnSpriteNodePoolMap=new c.Dictionary,e.hpTubePoolMap=new c.Dictionary,e.itemNodePoolMap=new c.Dictionary,e.rewardTipPool=new cc.NodePool,e.weaponPool=new cc.NodePool,e.effectSpriteList=new Array,e.bulletSpriteList=new Array,e.dropItemSpriteList=new Array,e.dropEquipmentSpriteList=new Array,e.trapSpriteList=new Array,e.buffBoxList=new Array,e.warnSpriteList=new Array,e.itemSpriteList=new Array,e.rewardTipList=new Array,e.weaponShadow=new Array,e}return r(e,t),e.prototype.init=function(t){this.mainLayer=t,this.fightMapNode=cc.find("FightMapNode",this.node)},e.prototype.pauseNode=function(){for(var t=0;t<this.effectSpriteList.length;t++)this.effectSpriteList[t].pauseNode();for(t=0;t<this.bulletSpriteList.length;t++)this.bulletSpriteList[t].pauseNode();for(t=0;t<this.dropItemSpriteList.length;t++)this.dropItemSpriteList[t].pauseNode();for(t=0;t<this.dropEquipmentSpriteList.length;t++)this.dropEquipmentSpriteList[t].pauseNode();for(t=0;t<this.trapSpriteList.length;t++)this.trapSpriteList[t].pauseNode();for(t=0;t<this.warnSpriteList.length;++t)this.warnSpriteList[t].pauseNode();for(t=0;t<this.itemSpriteList.length;++t)this.itemSpriteList[t].pauseNode();for(t=0;t<this.rewardTipList.length;t++)this.rewardTipList[t].pauseNode()},e.prototype.resumeNode=function(){for(var t=0;t<this.effectSpriteList.length;t++)this.effectSpriteList[t].resumeNode();for(t=0;t<this.bulletSpriteList.length;t++)this.bulletSpriteList[t].resumeNode();for(t=0;t<this.dropItemSpriteList.length;t++)this.dropItemSpriteList[t].resumeNode();for(t=0;t<this.dropEquipmentSpriteList.length;t++)this.dropEquipmentSpriteList[t].resumeNode();for(t=0;t<this.trapSpriteList.length;t++)this.trapSpriteList[t].resumeNode();for(t=0;t<this.warnSpriteList.length;++t)this.warnSpriteList[t].resumeNode();for(t=0;t<this.itemSpriteList.length;++t)this.itemSpriteList[t].resumeNode();for(t=0;t<this.rewardTipList.length;++t)this.rewardTipList[t].resumeNode()},e.prototype.gameInit=function(){var t,e=this,a=this.mainLayer.combatLayer.dungeonInfo;a.getRoomInfo(a.firstStagePos[0],a.firstStagePos[1]),t=a.stage,this.changeBgStage(t,a.getDoors(a.firstStagePos),function(){e.mainLayer.combatLayer.gameReStart()},this)},e.prototype.changeBgStage=function(t,e,a,n){var i=this;this.mainLayer.currFightMapName!=t?(this.mainLayer.currFightMapName=t,null==this.fightMapPrefabMap.get(t)?(this.fightMapNode.active=!1,l.AssetUtils.loadPrefab(this.getMapPrefab(t),function(t){i.fightMapPrefabMap.put(i.mainLayer.currFightMapName,t),i.fightMapNode.active=!0,i.createBgState(e),a.call(n)},this)):(this.createBgState(e),a.call(n))):(this.mainLayer.currFightMap.resetData(e),a.call(n))},e.prototype.createBgState=function(t){null!=this.mainLayer.currFightMap&&this.putFigthMap(this.mainLayer.currFightMap),this.getFightMap(this.mainLayer.currFightMapName,t)},e.prototype.getMapPrefab=function(t){return"Prefab/Map/"+t},e.prototype.getHeroSprite=function(t,e,a,n,i,o){void 0===n&&(n=0);var r,s,c=this.heroSprietNodePoolMap.get(t);return null==c&&(c=new cc.NodePool,this.heroSprietNodePoolMap.put(t,c)),c.size()>0?s=(r=c.get()).getComponent("HeroSprite"):(s=(r=cc.instantiate(this.heroSpritePrefab)).getComponent("HeroSprite")).init(e,this.mainLayer.combatLayer,t),s.resetDataMain(e,a,n,i,o),e==h.BATTLE_CAMP.Self?this.mainLayer.myHeroSprite=s:this.mainLayer.heroSpriteList.push(s),this.mainLayer.currFightMap.objectLayer.addChild(r),s},e.prototype.putHeroSprite=function(t){this.heroSprietNodePoolMap.get(t.heroId).put(t.node),t.battleCamp==h.BATTLE_CAMP.Self?this.mainLayer.myHeroSprite=null:this.mainLayer.heroSpriteList.splice(this.mainLayer.heroSpriteList.indexOf(t),1)},e.prototype.getHeroHpTubeSprite=function(t,e){var a,n,i=this.hpTubePoolMap.get(t);return null==i&&(i=new cc.NodePool,this.hpTubePoolMap.put(t,i)),i.size()>0?n=(a=i.get()).getComponent("HpTube"):(n=(a=cc.instantiate(this.hpTubePrefab)).getComponent("HpTube")).init(t),n.resetData(e),this.mainLayer.combatLayer.uiLayer.blood2Node.addChild(a),n},e.prototype.putHeroHpTubeSprite=function(t){this.hpTubePoolMap.get(t.heroId).put(t.node)},e.prototype.getFightMap=function(t,e){var a,n,i=this.fightMapNodePoolMap.get(t);null==i&&(i=new cc.NodePool,this.fightMapNodePoolMap.put(t,i)),i.size()>0?n=(a=i.get()).getComponent("FightMap"):(n=(a=cc.instantiate(this.fightMapPrefabMap.get(t))).getComponent("FightMap")).init(t),n.resetData(e),this.fightMapNode.addChild(a),this.mainLayer.currFightMap=n},e.prototype.putFigthMap=function(t){this.fightMapNodePoolMap.get(t.fightMapName).put(t.node),this.mainLayer.currFightMap=null},e.prototype.getEffect=function(t,e,a,n,i,o){var r,s=this.effectSpriteNodePoolMap.get(t);return null==s&&(s=new cc.NodePool,this.effectSpriteNodePoolMap.put(t,s)),s.size()>0?r=s.get().getComponent("EffectSprite"):(r=cc.instantiate(this.effectSpritePrefab).getComponent("EffectSprite")).init(t),r.resetData(e,a,n,i,o),this.effectSpriteList.push(r),r},e.prototype.pubEffect=function(t){this.effectSpriteList.splice(this.effectSpriteList.indexOf(t),1),this.effectSpriteNodePoolMap.get(t.effectType).put(t.node)},e.prototype.getWarnSprite=function(t,e,a){var n,i=this.warnSpriteNodePoolMap.get(t);return null==i&&(i=new cc.NodePool,this.warnSpriteNodePoolMap.put(t,i)),i.size()>0?n=i.get().getComponent("WarnSprite"):(n=cc.instantiate(this.warnSpritePrefab).getComponent("WarnSprite")).init(t),n.resetData(e,a),this.warnSpriteList.push(n),n},e.prototype.pubWarnSprite=function(t){this.warnSpriteList.splice(this.warnSpriteList.indexOf(t),1),this.warnSpriteNodePoolMap.get(t.warnName).put(t.node)},e.prototype.getBullet=function(t,e,a,n,i,o){var r,s,c=this.bulletSpriteNodePoolMap.get(e);return null==c&&(c=new cc.NodePool,this.bulletSpriteNodePoolMap.put(e,c)),c.size()>0?s=(r=c.get()).getComponent("BulletSprite"):(s=(r=cc.instantiate(this.bulletSpritePrefab)).getComponent("BulletSprite")).init(e),s.resetData(t,a,n,i,o),this.bulletSpriteList.push(s),this.mainLayer.currFightMap.objectLayer.addChild(r),s},e.prototype.putBullet=function(t){this.bulletSpriteList.splice(this.bulletSpriteList.indexOf(t),1),this.bulletSpriteNodePoolMap.get(t.skillId).put(t.node)},e.prototype.getDropItemSprite=function(t,e,a,n,i){var o,r,s=1==e?this.dropEquipmentSpriteNodePoolMap.get(t):this.dropItemSpriteNodePoolMap.get(t);return null==s&&(s=new cc.NodePool,1==e?this.dropEquipmentSpriteNodePoolMap.put(t,s):this.dropItemSpriteNodePoolMap.put(t,s)),s.size()>0?r=(o=s.get()).getComponent("DropItemSprite"):(r=(o=cc.instantiate(this.dropItemSpritePrefab)).getComponent("DropItemSprite")).init(t,e),r.resetData(n,i,a),1==e?this.dropEquipmentSpriteList.push(r):this.dropItemSpriteList.push(r),this.mainLayer.currFightMap.objectLayer.addChild(o),r},e.prototype.putDropItemSprite=function(t,e){1==e?(this.dropEquipmentSpriteList.splice(this.dropEquipmentSpriteList.indexOf(t),1),this.dropEquipmentSpriteNodePoolMap.get(t.dropItemId).put(t.node)):(this.dropItemSpriteList.splice(this.dropItemSpriteList.indexOf(t),1),this.dropItemSpriteNodePoolMap.get(t.dropItemId).put(t.node))},e.prototype.getTrapSprite=function(t,e){var a,n=this.trapSpriteNodePoolMap.get(t);return null==n&&(n=new cc.NodePool,this.trapSpriteNodePoolMap.put(t,n)),n.size()>0?a=n.get().getComponent("TrapSprite"):(a=cc.instantiate(this.trapSpritePrefab).getComponent("TrapSprite")).init(t),a.resetData(e),this.trapSpriteList.push(a),a},e.prototype.putTrapSprite=function(t){this.trapSpriteList.splice(this.trapSpriteList.indexOf(t),1),this.trapSpriteNodePoolMap.get(t.trapId).put(t.node)},e.prototype.getBuffBox=function(t){var e,a=this.buffBoxPoolMap.get(t);return null==a&&(a=new cc.NodePool,this.buffBoxPoolMap.put(t,a)),a.size()>0?e=a.get().getComponent("BuffBox"):(e=cc.instantiate(this.buffBoxPrefab).getComponent("BuffBox")).init(t),e.resetData(),this.buffBoxList.push(e),e},e.prototype.putBuffBox=function(t){this.buffBoxList.splice(this.buffBoxList.indexOf(t),1),this.buffBoxPoolMap.get(t.type).put(t.node)},e.prototype.getSmallMapItem=function(t){var e;return null==this.smallMapNodePool&&(this.smallMapNodePool=new cc.NodePool),this.smallMapNodePool.size()>0?e=this.smallMapNodePool.get().getComponent("SmallMapItem"):(e=cc.instantiate(this.smallMapItemPrefab).getComponent("SmallMapItem")).init(),e.review(t),e},e.prototype.putSmallMapItem=function(t){this.smallMapNodePool.put(t.node)},e.prototype.getItemSprite=function(t,e,a,n,i){var o=this.itemNodePoolMap.get(t);null==o&&(o=new cc.NodePool,this.itemNodePoolMap.put(t,o));var r=null,s=null;return o.size()>0?s=(r=o.get()).getComponent("ItemSprite"):(s=(r=cc.instantiate(this.itemSpritePrefab)).getComponent("ItemSprite")).initData(t,this.mainLayer.combatLayer),s.resetData(e,a,n,i),this.mainLayer.currFightMap.effectLayer.addChild(r),this.itemSpriteList.push(s),s},e.prototype.putItemSprite=function(t){this.itemNodePoolMap.get(t.itemId).put(t.node),this.itemSpriteList.splice(this.itemSpriteList.indexOf(t),1)},e.prototype.getRewardTip=function(t,e,a){var n;return(n=this.rewardTipPool.size()>0?this.rewardTipPool.get().getComponent("RewardTip"):cc.instantiate(this.rewardTipPrefab).getComponent("RewardTip")).init(t,e,a),this.rewardTipList.push(n),n},e.prototype.putRewardTip=function(t){this.rewardTipPool.put(t.node),this.rewardTipList.splice(this.rewardTipList.indexOf(t),1)},e.prototype.getWeaponShadow=function(t,e,a){var n,i;return(i=this.weaponPool.size()>0?(n=this.weaponPool.get()).getComponent("WeaponShadow"):(n=cc.instantiate(this.weaponShadowPrefab)).getComponent("WeaponShadow")).init(t),i.review(e,a),this.mainLayer.currFightMap.objectLayer.addChild(n),i},e.prototype.putWeaponShadow=function(t){this.weaponPool.put(t.node),this.weaponShadow.splice(this.weaponShadow.indexOf(t),1)},s([p(cc.Prefab)],e.prototype,"heroSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"effectSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"bulletSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"dropItemSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"trapSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"buffBoxPrefab",void 0),s([p(cc.Prefab)],e.prototype,"warnSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"smallMapItemPrefab",void 0),s([p(cc.Prefab)],e.prototype,"shadowPrefab",void 0),s([p(cc.Prefab)],e.prototype,"hpTubePrefab",void 0),s([p(cc.Prefab)],e.prototype,"itemSpritePrefab",void 0),s([p(cc.Prefab)],e.prototype,"rewardTipPrefab",void 0),s([p(cc.Prefab)],e.prototype,"weaponShadowPrefab",void 0),s([d],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],NoticeItem:[function(t,e,a){"use strict";cc._RF.push(e,"a537dDChjZJzZRG2OnpQhpP","NoticeItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,a){this.noticeLayer=a,this.noticeInfo=t,this.noticeIndex=e,this.selectedNode=cc.find("Selected",this.node),this.selectedNode.active=0==e,cc.find("Title",this.node).getComponent(cc.Label).string=t.title},e.prototype.selectedStatus=function(t){this.selectedNode.active=this.noticeIndex==t},e.prototype.onClickBtn=function(){c.SoundManager.Instance.playEffect("anniu"),this.noticeLayer.selectedBtns(this.noticeIndex,this.noticeInfo)},s([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],NoticeLayer:[function(t,e,a){"use strict";cc._RF.push(e,"bed01tu8YRIxIV5Ees5JCdE","NoticeLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("GameData"),h=i("MainLogic"),u=i("NoticeItem"),d=cc._decorator,p=d.ccclass,f=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.noticeItemPrefab=null,e.noticeItem=new Array,e}return r(e,t),e.prototype.init=function(){var t=cc.find("Layer/Btns/view/content",this.node);this.descNode=cc.find("Layer/Content/view/content/Desc",this.node);for(var e=[],a=0;a<e.length;++a){var n=cc.instantiate(this.noticeItemPrefab);t.addChild(n);var i=n.getComponent(u.default);i.init(e[a],a,this),this.noticeItem.push(i),0==a&&(this.descNode.getComponent(cc.RichText).string=e[a].desc)}this.review()},e.prototype.review=function(){this.node.active=!0},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},e.prototype.selectedBtns=function(t,e){for(var a=0;a<this.noticeItem.length;++a)this.noticeItem[a].selectedStatus(t);this.descNode.getComponent(cc.RichText).string=e.desc},e.prototype.onClickBtn=function(t,e){c.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,l.default.Instance.playerData.isTester=!0,h.default.Instance.combatScene.popLayer.autoPopLayer()):2==e&&(this.node.active=!1,h.default.Instance.combatScene.popLayer.reviewMoreGameLayer(2))},s([f(cc.Prefab)],e.prototype,"noticeItemPrefab",void 0),s([p],e)}(cc.Component);o.default=y,cc._RF.pop()},{}],NpcAbility:[function(t,e,a){"use strict";cc._RF.push(e,"6ef55uFG11BZ5bFv+n858RQ","NpcAbility");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){this.moveSpeed=500,this.oneJumpHeight=300,this.oneJumpTopTime=.3,this.attackPosition=new cc.Vec2(84,67),this.attackMovePosition=new cc.Vec2(54,0),this.attackTime=.3,this.skillPosition=new cc.Vec2(84,67),this.skillMovePosition=new cc.Vec2(54,0),this.skillTime=.4},cc._RF.pop()},{}],NpcAction:[function(t,e,a){"use strict";cc._RF.push(e,"beb94wI1zJDqLrehOtsF4Mf","NpcAction");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0}),i.NpcAction=void 0;var o=n("PublicEnum"),r=n("HeroLog"),s=function(){function t(t){this.errorX=150,this.errorY=25,this.updateTime=0,this.controlType=o.CONTROL_EVENT.None,this.npcActionStatus=-1,this.maxTime=6,this.hurtArea=[],this.npcAi=t,this.npcActionStatus=-1}return t.prototype.initByTime=function(t,e,a){this.finishType=1,this.totalTime=t,this.controlType=e,this.atkType=a},t.prototype.initByTimes=function(t,e,a){this.finishType=2,this.totalTimes=t,this.controlType=e,this.atkType=a},t.prototype.initByPosition=function(t,e,a){this.finishType=3,this.targetPosition=t,this.hurtArea=e,null==this.targetPosition&&console.log("targetPosition is null"),this.controlType=a},t.prototype.initByFace=function(t){this.finishType=4,this.faceX=t},t.prototype.initByTarget=function(t,e,a){this.finishType=5,this.targetScript=t,this.targetPosition=cc.v2(this.targetScript.node.x,this.targetScript.node.y),this.hurtArea=e,null==this.targetScript&&console.log("targetScript is null"),this.controlType=a},t.prototype.doNpcAction=function(){if(this.npcActionStatus=0,1==this.finishType)this.controlType!=o.CONTROL_EVENT.None&&this.npcAi.heroSprite.heroControl.handleControlEvent(this.controlType,this.atkType-1),0==this.totalTime?this.npcActionFinish():this.npcAi.delayToDo(this.totalTime,this.npcActionFinish,this);else if(2==this.finishType)this.doTimes();else if(3==this.finishType){if(this.controlType!=o.CONTROL_EVENT.None){var t=180*Math.atan2(this.targetPosition.y-this.npcAi.node.y,this.targetPosition.x-this.npcAi.node.x)/Math.PI;this.npcAi.heroSprite.heroControl.handleControlEvent(this.controlType,t)}var e=this.npcAi.node.getPosition().x,a=this.npcAi.node.getPosition().y;if(this.hurtArea){var n=Math.abs(this.targetPosition.x-e),i=Math.abs(this.targetPosition.y-a);n<this.hurtArea[0]&&i<this.hurtArea[1]&&this.npcActionFinish()}else n=Math.abs(this.targetPosition.x-e),i=Math.abs(this.targetPosition.y-a),n<this.errorX&&i<this.errorY&&this.npcActionFinish()}else 4==this.finishType?((e=this.npcAi.node.getPosition().x)<this.faceX?this.isLeft=!1:this.isLeft=!0,this.npcAi.heroSprite.heroNode.controlFace(this.isLeft),this.npcActionFinish()):5==this.finishType?(this.controlType!=o.CONTROL_EVENT.None&&(t=180*Math.atan2(this.targetPosition.y-this.npcAi.node.y,this.targetPosition.x-this.npcAi.node.x)/Math.PI,this.npcAi.heroSprite.heroControl.handleControlEvent(this.controlType,t)),this.updateTime=1,e=this.npcAi.node.getPosition().x,a=this.npcAi.node.getPosition().y,this.hurtArea?(n=Math.abs(this.targetPosition.x-e),i=Math.abs(this.targetPosition.y-a),n<this.hurtArea[0]&&i<this.hurtArea[1]&&this.npcActionFinish()):(n=Math.abs(this.targetPosition.x-e),i=Math.abs(this.targetPosition.y-a),n<this.errorX&&i<this.errorY&&this.npcActionFinish())):console.log("ss");this.npcAi.delayToDo(this.maxTime,this.npcActionFinish,this)},t.prototype.update=function(t){if(1!=this.npcActionStatus&&(3==this.finishType||5==this.finishType)){var e=this.npcAi.node.getPosition().x,a=this.npcAi.node.getPosition().y,n=!1;if(this.hurtArea){var i=Math.abs(this.targetPosition.x-e),r=Math.abs(this.targetPosition.y-a);i<this.hurtArea[0]&&r<this.hurtArea[1]&&(this.npcActionFinish(),n=!0)}else i=Math.abs(this.targetPosition.x-e),r=Math.abs(this.targetPosition.y-a),i<this.errorX&&r<this.errorY&&(this.npcActionFinish(),n=!0);if(5==this.finishType&&(this.updateTime-=t,!n&&this.updateTime<=0)){this.updateTime=1;var s=cc.v2(this.targetScript.node.x,this.targetScript.node.y).sub(this.targetPosition).mag();if(this.controlType!=o.CONTROL_EVENT.None&&s>this.errorY){var c=180*Math.atan2(this.targetPosition.y-this.npcAi.node.y,this.targetPosition.x-this.npcAi.node.x)/Math.PI;this.npcAi.heroSprite.heroControl.handleControlEvent(this.controlType,c)}}}},t.prototype.doTimes=function(){this.controlType!=o.CONTROL_EVENT.None&&this.npcAi.heroSprite.heroControl.handleControlEvent(this.controlType,this.atkType),this.totalTimes--,this.totalTimes<=0?this.npcActionFinish():this.controlType==o.CONTROL_EVENT.Control_Attack&&this.npcAi.delayToDo(this.npcAi.npcAbility.attackTime,this.doTimes,this)},t.prototype.npcActionFinish=function(){if(1!=this.npcActionStatus){this.npcActionStatus=1,r.default.log_npc_ai&&this.npcAi.log("type:"+this.getTypeStr()+",finish --- controlType:"+this.getControlStr()+",\u786c\u76f4\uff1a"+this.npcAi.heroSprite.heroStatus.hardAndStraight);var t=this.getControlCalcel();t!=o.CONTROL_EVENT.None&&this.npcAi.heroSprite.heroControl.handleControlEvent(t),this.npcAi.npcActionFinish(this)}},t.prototype.getControlCalcel=function(){switch(this.controlType){case o.CONTROL_EVENT.Control_Move:return o.CONTROL_EVENT.Control_Move_Cancel;default:return o.CONTROL_EVENT.None}},t.prototype.log=function(){r.default.log_npc_ai&&this.npcAi.log("type:"+this.getTypeStr()+"--- controlType:"+this.getControlStr())},t.prototype.logDesc=function(){r.default.log_npc_ai&&this.npcAi.log("\u4efb\u52a1 type:"+this.getTypeStr()+"--- controlType:"+this.getControlStr())},t.prototype.getTypeStr=function(){switch(this.finishType){case 1:return"\u65f6\u95f4("+Math.floor(100*this.totalTime)/100+")";case 2:return"\u6b21\u6570("+this.totalTimes+")";case 3:return"\u76ee\u6807\u4f4d\u7f6e("+this.targetPosition+")";case 4:return"\u9762\u5411("+this.isLeft+")"}},t.prototype.getControlStr=function(){switch(this.controlType){case o.CONTROL_EVENT.Control_Attack:return"\u653b\u51fb";case o.CONTROL_EVENT.Control_Skill:return"\u6280\u80fd";default:return""}},t}();i.NpcAction=s,cc._RF.pop()},{}],NpcAi:[function(t,e,a){"use strict";cc._RF.push(e,"eff54CXDGhDXIz5uiz8PMTX","NpcAi");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("NpcAbility"),l=i("NpcAction"),h=i("HeroEventData"),u=i("PublicEnum"),d=i("NpcBrain"),p=i("ConfigData"),f=i("HeroLog"),y=i("MainLogic"),m=cc._decorator,g=m.ccclass,I=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.npcActionQueue=new Array,e.hatredVal=0,e}return r(e,t),e.prototype.init=function(t){this.heroSprite=t,this.npcAbility=new c.default,this.npcBrain=new d.default,this.npcBrain.init(this),this.npcAiNode=cc.find("LogicNode/NpcAi",this.node),y.default.Instance.combatScene.gameModel==u.GAME_MODEL.Normal&&(this.robotInfo=p.default.Instance.robotMap.get(this.heroSprite.roleInfo.AI)),this.schedule(this.think,.1)},e.prototype.reset=function(){y.default.Instance.combatScene.gameModel==u.GAME_MODEL.Normal&&(this.robotInfo=p.default.Instance.robotMap.get(this.heroSprite.roleInfo.AI)),this.npcBrain.resetData(),this.hatredVal=0,this.stopAllAction()},e.prototype.update=function(t){if(this.heroSprite.battleCamp!=u.BATTLE_CAMP.Self&&this.heroSprite.heroNode.loadFinish&&4!=this.heroSprite.monsterType)if(this.heroSprite.stateMachine.currState!=u.HEOR_STATE.Birth&&this.heroSprite.stateMachine.currState!=u.HEOR_STATE.Death){if(this.npcBrain.thinkSeekLiveByPosition(),this.npcActionQueue.length>0)for(var e=this.npcActionQueue[0],a=0;a<e.length;a++)1!=e[a].npcActionStatus&&e[a].update(t)}else this.stopAllAction()},e.prototype.think=function(){this.heroSprite.battleCamp!=u.BATTLE_CAMP.Self&&this.heroSprite.heroNode.loadFinish&&4!=this.heroSprite.monsterType&&(this.heroSprite.heroStatus.hardAndStraight||this.heroSprite.heroStatus.isForzen||0==this.heroSprite.stateMachine.warmState&&y.default.Instance.combatLayer.gameStep==u.GAME_STEP.Starting&&this.npcActionQueue.length<=0&&this.npcBrain.thinkMain())},e.prototype.stopAllAction=function(){this.npcAiNode.stopAllActions(),this.npcActionQueue.splice(0,this.npcActionQueue.length)},e.prototype.delayToDo=function(t,e,a){this.npcAiNode.runAction(cc.sequence(cc.delayTime(t),cc.callFunc(function(){e.call(a)},this)))},e.prototype.onEvent=function(t){t==h.HeroEvent.LeaveStage||t==h.HeroEvent.Hited&&this.hatredVal++},e.prototype.npcActionFinish=function(t){var e=null;if(null!=t?(this.npcActionQueue.length>0&&null!=(e=this.npcActionQueue[0])&&this.actionListIsFinishOver(e)&&this.npcActionQueue.splice(0,1),t.controlType!=u.CONTROL_EVENT.Control_Attack&&t.controlType!=u.CONTROL_EVENT.Control_Skill&&t.controlType!=u.CONTROL_EVENT.Control_Big||(this.hatredVal=0)):this.logAllAction(),this.npcActionQueue.length>0){e=this.npcActionQueue[0];for(var a=0;a<e.length;a++)-1==e[a].npcActionStatus&&(e[a].log(),e[a].doNpcAction())}},e.prototype.logAllAction=function(){this.log("\u65b0\u4efb\u52a1");for(var t=0;t<this.npcActionQueue.length;t++){var e=this.npcActionQueue[t];this.log("\u4efb\u52a1index\uff1a"+t+",size:"+e.length);for(var a=0;a<e.length;a++)-1==e[a].npcActionStatus&&e[a].logDesc()}},e.prototype.actionListIsFinishOver=function(t){for(var e=!0,a=0;a<t.length;a++)t[a].npcActionStatus<1&&(e=!1);return e},e.prototype.createDelayAction=function(t){var e,a=new Array;(e=new l.NpcAction(this)).initByTime(t,u.CONTROL_EVENT.None),a.push(e),this.npcActionQueue.push(a)},e.prototype.createMoveActionByTime=function(t,e){var a,n=new Array;(a=new l.NpcAction(this)).initByTime(t,e),n.push(a),this.npcActionQueue.push(n)},e.prototype.createMoveActionByTargetPosition=function(t,e){var a,n=new Array;(a=new l.NpcAction(this)).initByPosition(t,e,u.CONTROL_EVENT.Control_Move),n.push(a),this.npcActionQueue.push(n)},e.prototype.createMoveActionByTarget=function(t,e){var a,n=new Array;(a=new l.NpcAction(this)).initByTarget(t,e,u.CONTROL_EVENT.Control_Move),n.push(a),this.npcActionQueue.push(n)},e.prototype.createAttackAction=function(t){var e,a=new Array;e=new l.NpcAction(this);var n=u.CONTROL_EVENT.Control_Attack,i=1;1!=t?n=u.CONTROL_EVENT.Control_Skill:3!=this.heroSprite.monsterType&&5!=this.heroSprite.monsterType||(i=Math.floor(3*Math.random())+1),e.initByTimes(i,n,t-1),a.push(e),this.npcActionQueue.push(a)},e.prototype.createBigSkill=function(){var t,e=new Array;t=new l.NpcAction(this);var a=u.CONTROL_EVENT.Control_Big;t.initByTimes(1,a),e.push(t),this.npcActionQueue.push(e)},e.prototype.createFaceAction=function(t){var e,a=new Array;(e=new l.NpcAction(this)).initByFace(t),a.push(e),this.npcActionQueue.push(a)},e.prototype.log=function(t){f.default.log_npc_ai&&console.log("---"+this.heroSprite.heroId+"---"+t)},s([g],e)}(cc.Component));o.default=I,cc._RF.pop()},{}],NpcBrain:[function(t,e,a){"use strict";cc._RF.push(e,"5e241TLh6BMBJv9L5JaDAkq","NpcBrain");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o,r=n("PublicEnum"),s=n("MainLogic"),c=n("ConfigData"),l=n("BuffUtil");(function(t){t[t.Attack=1]="Attack",t[t.Move=2]="Move",t[t.Stand=3]="Stand"})(o||(o={}));var h=function(){function t(){this.isNormalAi=!0,this.times=0,this.lastThinkSeekTime=0,this.attackLastTime=0,this.lastLeaveGroundTime=0,this.moveSpeedRate=1,this.nextAction=0}return t.prototype.init=function(t){this.npcAi=t},t.prototype.resetData=function(){this.times=0,this.lastThinkSeekTime=0,this.attackLastTime=0,this.lastLeaveGroundTime=0},t.prototype.thinkMain=function(){this.times++;var t=this.npcAi.heroSprite;if(0==this.nextAction){var e=t.roleInfo;if(e.skill_passive1&&t.skillManager.getSkillObj(e.skill_passive1).skillState==r.SKILL_STATE.CdOver){if(t.passiveSkill1.buffPools.length)for(var a=t.passiveSkill1.buffPools,n=0;n<a.length;++n){var i=c.default.Instance.buffItemMap.get(a[n]),s=l.default.createBuffBySpecialItem(i,1);t.buffManager.addBuffList(s)}t.skillManager.addEnergy(-t.passiveSkill1.condition_value,t.passiveSkill1.skill_condition)}if(e.skill_passive2&&this.npcAi.heroSprite.skillManager.getSkillObj(e.skill_passive2).skillState==r.SKILL_STATE.CdOver){if(t.passiveSkill2.buffPools.length)for(a=t.passiveSkill2.buffPools,n=0;n<a.length;++n)i=c.default.Instance.buffItemMap.get(a[n]),s=l.default.createBuffBySpecialItem(i,1),t.buffManager.addBuffList(s);t.skillManager.addEnergy(-t.passiveSkill2.condition_value,t.passiveSkill2.skill_condition)}var h=Math.random();this.actionIntention=h<=.6?1:h<=.8?3:2}else this.actionIntention=this.nextAction,this.nextAction=0;switch(this.actionIntention){case o.Attack:var u=!1;for(n=1;n<t.skills.length;++n)if(t.skillManager.getSkillObj(t.skills[n].id).skillState==r.SKILL_STATE.CdOver){this.thinkAttack(n+1),u=!0;break}u||this.thinkAttack(1);break;case o.Move:this.thinkWait();break;default:this.thinkStand()}},t.prototype.thinkStand=function(){this.npcAi.createDelayAction(1),this.npcAi.npcActionFinish(null)},t.prototype.thinkAttack=function(t){if(this.targetHero=this.findTarget(),null!=this.targetHero){var e=this.npcAi.heroSprite,a=e.skills[t-1],n=e.node.getPosition(),i=this.targetHero.node.getPosition();null==this.findMoveTargetPosition(i,n,t)?(this.npcAi.createFaceAction(i.x),this.npcAi.createAttackAction(t)):(this.nextAction=o.Attack,this.npcAi.createMoveActionByTarget(this.targetHero,a.lockArea)),this.npcAi.createDelayAction(.2),this.npcAi.npcActionFinish(null)}},t.prototype.thinkWait=function(){this.npcAi.heroSprite;var t=this.findTarget().node.getPosition();this.npcAi.log("\u6e38\u8d70");var e=100*(2*Math.random()-1),a=100*(2*Math.random()-1),n=cc.v2(t.x+e,t.y+a);this.npcAi.createMoveActionByTargetPosition(n,null),this.npcAi.createDelayAction(.5*Math.random()),this.npcAi.npcActionFinish(null)},t.prototype.thinkSeekLiveByPosition=function(){},t.prototype.findTarget=function(){if(s.default.Instance.combatScene.gameModel==r.GAME_MODEL.Normal)return s.default.Instance.combatScene.combatLayer.mainLayer.myHeroSprite},t.prototype.findMoveTargetPosition=function(t,e,a){var n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),o=this.npcAi.heroSprite.skills[a-1];if(n<o.lockArea[0]&&i<o.lockArea[1])return null;var r=-1;t.x<e.x&&(r=1);var s=.5*Math.random()+.5,c=t.x+r*o.lockArea[0]*s;return cc.v2(c,t.y)},t}();i.default=h,cc._RF.pop()},{}],NumberMethod:[function(t,e,a){"use strict";cc._RF.push(e,"b8ef1WMPgxF/I9yXjY8CjWv","NumberMethod");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PlayerAttribute"),r=n("GameData"),s=n("PublicEnum"),c=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getAttackSpeed=function(t,e,a){var n=a.getAttribute(o.ATTRIBUTE_TYPE.Attack_Speed);return e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Attack_Speed)),t*(1+n)},t.prototype.getCritRate=function(t,e,a){var n=a.getAttribute(o.ATTRIBUTE_TYPE.Crit_Rate);return e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Crit_Rate)),t+n},t.prototype.getCritDamage=function(t,e,a){var n=a.getAttribute(o.ATTRIBUTE_TYPE.Crit_Damage);return e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Crit_Damage)),t+n},t.prototype.getAttackNum=function(t,e,a){var n=t+a.getAttribute(o.ATTRIBUTE_TYPE.Attack);e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Attack));var i=a.getAttribute(o.ATTRIBUTE_TYPE.Attack_Rate);return e==s.BATTLE_CAMP.Self&&(i+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Attack_Rate)),n*(1+i)},t.prototype.getMoveSpeed=function(t,e,a){var n=a.getAttribute(o.ATTRIBUTE_TYPE.Move_Speed);return e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Move_Speed)),n=1+n,t*Math.max(.4,n)},t.prototype.getDefNum=function(t,e,a){var n=t+a.getAttribute(o.ATTRIBUTE_TYPE.Def);e==s.BATTLE_CAMP.Self&&(n+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Def));var i=a.getAttribute(o.ATTRIBUTE_TYPE.Def_Rate);return e==s.BATTLE_CAMP.Self&&(i+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Def_Rate)),n*(1+i)},t.prototype.getExpNum=function(t,e,a){var n=t,i=a.getAttribute(o.ATTRIBUTE_TYPE.Exp_Rate);return e==s.BATTLE_CAMP.Self&&(i+=r.default.Instance.playerAttr.getAttribute(o.ATTRIBUTE_TYPE.Exp_Rate)),n*(1+i)},t}();i.default=c,cc._RF.pop()},{}],OppAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"c5019SlAHFGc5pDk8B9rcTS","OppAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0}),o.OppAdServer=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.loadRewardAd=function(){},e.prototype.login=function(){},e.prototype.showInterAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(){},e.prototype.shareApp=function(){},e.prototype.showShareMenu=function(){},e.prototype.showNativeAd=function(){},e.prototype.showNativeAd2=function(){},e.prototype.adReportEvent=function(){},e.prototype.adReportEvent2=function(){},e.prototype.adHandler=function(){},e.prototype.showPort=function(){},e.prototype.showGameIcon=function(){},e.prototype.hideGameIcon=function(){},e.prototype.vibrateShort=function(){},e.prototype.setKeepScreen=function(){},e.prototype.navigateToMiniProgram=function(){},e}(i("BaseAdServer").default);o.OppAdServer=s,cc._RF.pop()},{}],PassCheckLayer:[function(t,e,a){"use strict";cc._RF.push(e,"e7737Jq4NVHZJ+2mFcDHZKE","PassCheckLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("MainLogic"),m=i("TaskLogic"),g=i("GuestItem"),I=i("SuperItem"),_=cc._decorator,v=_.ccclass,S=_.property,L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.guestItemPrefab=null,e.superItemPrefab=null,e.guestItems=new Array,e.superItems=new Array,e.superJsonIndex=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(){if(this.seasonTimesNode=cc.find("Layer/Content/Season/Times/Num",this.node),this.seasonTimeNode=cc.find("Layer/Content/Season/Time",this.node),this.ultimateItemNode=cc.find("Layer/Content/Ultimate/Item",this.node),this.ultimateLevelNode=cc.find("Layer/Content/Ultimate/Tip/Str",this.node),this.ultimateBtnNode=cc.find("Layer/Content/Ultimate/Btn",this.node),this.ultimateGetNode=cc.find("Layer/Content/Ultimate/Get",this.node),this.videoGetIntegralNumNode=cc.find("Layer/Content/IntegralBtn/Num",this.node),this.integralNumNode=cc.find("Layer/Content/IntegralPro/Num",this.node),this.levelNode=cc.find("Layer/Content/Level",this.node),this.integralProgress=cc.find("Layer/Content/LevelPro",this.node).getComponent(cc.ProgressBar),this.videoGetCrystalNumNode=cc.find("Layer/Content/Video/Num",this.node),this.crystalNumzNode=cc.find("Layer/Content/Crystal/Num",this.node),this.guestList=cc.find("Layer/Content/List/view/content/List/Guest",this.node),this.superList=cc.find("Layer/Content/List/view/content/List/Super",this.node),this.ruleNode=cc.find("Rule",this.node),this.ruleNode.active=!1,0==this.superItems.length&&0==this.guestItems.length){for(var t=d.default.Instance.passCheckTaskMap,e=0;e<t.length;++e)if(11==t[e].order){var a=l.default.PassCheckSeasonId%4;0==a&&(a=4);var n=t[e].awardList[a-1],i=d.default.Instance.giftMap.get(n);this.superJsonIndex=i.jsonIndex,this.ultimateItemNode.angle=0;for(var o=0;o<i.itemList.length;++o){var r,s=i.itemList[o][0],c=i.itemList[o][1];(r=1==s?d.default.Instance.equipmentMap.get(c):d.default.Instance.itemMap.get(c)).res_id?(this.ultimateItemNode.angle=-90,f.AssetUtils.loadSpriteFrame(this.ultimateItemNode,"Weapon/"+r.res_id)):(this.ultimateItemNode.scale=1.5,f.AssetUtils.loadSpriteFrame(this.ultimateItemNode,"Common/"+r.icon))}var h=y.default.Instance.taskLogic.queryPassCheckTaskData(11,18,!0);2==h.status?(this.ultimateGetNode.active=!0,this.ultimateBtnNode.active=!1):1==h.status?(this.ultimateGetNode.active=!1,this.ultimateBtnNode.active=!0):(this.ultimateGetNode.active=!1,this.ultimateBtnNode.active=!1)}else{var u=t[e].type,p=t[e].order,m=y.default.Instance.taskLogic.queryPassCheckTaskData(p,u,!0);if(null==m)continue;var _=cc.instantiate(this.guestItemPrefab);this.guestList.addChild(_);var v=_.getComponent(g.default);v.init(this,m),this.guestItems.push(v);var S=cc.instantiate(this.superItemPrefab);this.superList.addChild(S);var L=S.getComponent(I.default);L.init(this,m),this.superItems.push(L)}this.guestList.parent.width=160*(t.length-1)}this.seasonTimesNode.getComponent(cc.Label).string=l.default.PassCheckSeasonId+"",this.seasonTimeNode.getComponent(cc.Label).string=l.default.PassCheckTime[0]+"-"+l.default.PassCheckTime[1],this.review()},e.prototype.review=function(){this.node.active=!0;for(var t=0;t<this.guestItems.length;++t)this.guestItems[t].review();for(t=0;t<this.superItems.length;++t)this.superItems[t].review();this.ultimateLevelNode.getComponent(cc.Label).string="\u901a\u884c\u8bc1\u7b49\u7ea7\u8fbe\u523010\u7ea7\uff08"+p.default.Instance.playerData.passCheckLevel+"/10\uff09",this.videoGetIntegralNumNode.getComponent(cc.Label).string="("+p.default.Instance.playerData.getIntegralVideoCount+"/5)";var e=[110,110,130,170,210,250,310,350,410,510,1e6][p.default.Instance.playerData.passCheckLevel],a=y.default.Instance.moneyLogic.getItemCount(1015);this.integralProgress.progress=a/e,this.integralNumNode.getComponent(cc.Label).string="("+a+"/"+e+")",this.levelNode.getComponent(cc.Label).string=p.default.Instance.playerData.passCheckLevel+"",this.videoGetCrystalNumNode.getComponent(cc.Label).string="("+p.default.Instance.playerData.getCrystalVideoCount+"/3)",this.crystalNumzNode.getComponent(cc.Label).string="x"+y.default.Instance.moneyLogic.getItemCount(1016);var n=y.default.Instance.taskLogic.queryPassCheckTaskData(11,18);2==n.status?(this.ultimateGetNode.active=!0,this.ultimateBtnNode.active=!1):1==n.status?(this.ultimateGetNode.active=!1,this.ultimateBtnNode.active=!0):(this.ultimateGetNode.active=!1,this.ultimateBtnNode.active=!1)},e.prototype.updateCryTal=function(t){if(t!=p.default.Instance.playerData.inviteNewPlayerCount){var e=t-p.default.Instance.playerData.inviteNewPlayerCount;p.default.Instance.playerData.inviteNewPlayerCount=t,y.default.Instance.moneyLogic.addItemCount(1016,e)}},e.prototype.showCrytalNum=function(){this.crystalNumzNode.getComponent(cc.Label).string="x"+y.default.Instance.moneyLogic.getItemCount(1016)},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},e.prototype.onClickBtn=function(t,e){u.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,y.default.Instance.combatScene.gotoHomeLayer(),y.default.Instance.combatScene.popLayer.autoPopLayer()):2==e?c.default.Instance.adHandler(c.default.AD_TYPE_GET_INTEGRAL,this,this.adCallback):3==e?this.ruleNode.active=!0:4==e?l.default.Platform==h.PLAT_FORM.Web?(y.default.Instance.moneyLogic.addItemCount(1016,1),this.review()):(this.shareType=c.default.SHARE_TYPE_PASS_CHECK_CRYTRAL,c.default.Instance.shareAppCallBack(this,function(){}),c.default.Instance.shareApp(p.default.Instance.playerData.openid,l.default.PassCheckSeasonId,102)):5==e?c.default.Instance.adHandler(c.default.AD_TYPE_GET_CRYTAL,this,this.adCallback):6==e?c.default.Instance.adHandler(c.default.AD_TYPE_GET_SUPER_REWARD,this,this.adCallback):7==e&&(this.ruleNode.active=!1)},e.prototype.adCallback=function(t,e,a){if(0==e){if(t==c.default.AD_TYPE_GET_INTEGRAL||t==c.default.SHARE_TYPE_GET_INTEGRAL)p.default.Instance.playerData.getIntegralVideoCount+=1,y.default.Instance.moneyLogic.addItemCount(1015,20),this.review();else if(t==c.default.AD_TYPE_GET_CRYTAL||t==c.default.SHARE_TYPE_GET_CRYTAL)p.default.Instance.playerData.getCrystalVideoCount+=1,p.default.Instance.playerData.getCrystalVideoCount>=3?(p.default.Instance.playerData.getCrystalVideoCount-=3,y.default.Instance.moneyLogic.addItemCount(1016,1)):y.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,1e4,2]],1),this.review();else if(t==c.default.AD_TYPE_GET_SUPER_REWARD||t==c.default.SHARE_TYPE_GET_SUPER_REWARD){var n=y.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.superJsonIndex);y.default.Instance.giftBagLoigc.receiveGiftItems(n,1),y.default.Instance.taskLogic.receivePassCheckReward(11,18,0),this.review()}0!=p.default.Instance.playerData.cdActiveFreeAd&&a||y.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)}else-1==e?(y.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_GET_INTEGRAL?this.shareType=c.default.SHARE_TYPE_GET_INTEGRAL:t==c.default.AD_TYPE_GET_CRYTAL?this.shareType=c.default.SHARE_TYPE_GET_CRYTAL:t==c.default.AD_TYPE_GET_SUPER_REWARD&&(this.shareType=c.default.SHARE_TYPE_GET_SUPER_REWARD),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):y.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else y.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([S(cc.Prefab)],e.prototype,"guestItemPrefab",void 0),s([S(cc.Prefab)],e.prototype,"superItemPrefab",void 0),s([v],e)}(cc.Component);o.default=L,cc._RF.pop()},{}],PlayerAttribute:[function(t,e,a){"use strict";cc._RF.push(e,"8851b4RQ7RF04K//n+os5cl","PlayerAttribute");var n,i=a;Object.defineProperty(i,"__esModule",{value:!0}),i.PlayerAttribute=i.ATTRIBUTE_TYPE=void 0,function(t){t[t.None=0]="None",t[t.Attack=1]="Attack",t[t.Attack_Rate=2]="Attack_Rate",t[t.Def=3]="Def",t[t.Def_Rate=4]="Def_Rate",t[t.Crit_Rate=5]="Crit_Rate",t[t.Crit_Damage=6]="Crit_Damage",t[t.Attack_Speed=7]="Attack_Speed",t[t.Move_Speed=8]="Move_Speed",t[t.HP=9]="HP",t[t.ADD_HP=10]="ADD_HP",t[t.HP_Rate=11]="HP_Rate",t[t.Atk_Dist=12]="Atk_Dist",t[t.Coin_Rate=13]="Coin_Rate",t[t.Exp_Rate=14]="Exp_Rate",t[t.Body_size=15]="Body_size",t[t.Stoic=16]="Stoic",t[t.Hit_Rate=17]="Hit_Rate",t[t.Agl_Rate=18]="Agl_Rate"}(n=i.ATTRIBUTE_TYPE||(i.ATTRIBUTE_TYPE={}));var o=function(){function t(){this.addAttack=0,this.addAttackRate=0,this.addAttackSpeed=0,this.addMoveSpeed=0,this.addCritRate=0,this.addCritDamage=0,this.addDef=0,this.addDefRate=0,this.addHPRate=0,this.addAtkDistRate=0,this.addCoinRate=0,this.addExpRate=0,this.addBodySizeRate=1,this.addHitRate=0,this.addAglRate=0}return t.prototype.reset=function(){this.addAttack=0,this.addAttackRate=0,this.addAttackSpeed=0,this.addCritDamage=0,this.addCritRate=0,this.addMoveSpeed=0,this.addDef=0,this.addDefRate=0,this.addHPRate=0,this.addAtkDistRate=0,this.addCoinRate=0,this.addExpRate=0,this.addBodySizeRate=1,this.addHitRate=0,this.addAglRate=0},t.prototype.getAttribute=function(t){switch(t){case n.Attack:return this.addAttack;case n.Attack_Rate:return this.addAttackRate;case n.Attack_Speed:return this.addAttackSpeed;case n.Crit_Rate:return this.addCritRate;case n.Crit_Damage:return this.addCritDamage;case n.Move_Speed:return this.addMoveSpeed;case n.Def:return this.addDef;case n.Def_Rate:return this.addDefRate;case n.HP_Rate:return this.addHPRate;case n.Atk_Dist:return this.addAtkDistRate;case n.Coin_Rate:return this.addCoinRate;case n.Exp_Rate:return this.addExpRate;case n.Body_size:return this.addBodySizeRate;case n.Hit_Rate:return this.addHitRate;case n.Agl_Rate:return this.addAglRate}return 0},t.prototype.updateAttribute=function(t,e){switch(t){case n.Attack:this.addAttack+=e;break;case n.Attack_Rate:this.addAttackRate+=e;break;case n.Attack_Speed:this.addAttackSpeed+=e;break;case n.Crit_Rate:this.addCritRate+=e;break;case n.Crit_Damage:this.addCritDamage+=e;break;case n.Move_Speed:this.addMoveSpeed+=e;break;case n.Def:this.addDef+=e;break;case n.Def_Rate:this.addDefRate+=e;break;case n.HP_Rate:this.addHPRate+=e;break;case n.Atk_Dist:this.addAtkDistRate+=e;break;case n.Coin_Rate:this.addCoinRate+=e;break;case n.Exp_Rate:this.addExpRate+=e;break;case n.Body_size:this.addBodySizeRate+=e;break;case n.Hit_Rate:this.addHitRate+=e;break;case n.Agl_Rate:this.addAglRate+=e}},t}();i.PlayerAttribute=o,cc._RF.pop()},{}],PlayerData:[function(t,e,a){"use strict";cc._RF.push(e,"04df8srW3pKbZpfG2byDwBT","PlayerData");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("RoleData"),r=n("DateUtils"),s=n("GameData");i.default=function(){this.userId=0,this.openid="",this.nickName="\u5251\u5b97",this.headImg="",this.roleId=1001,this.level=1,this.itemList={},this.itemCostList={},this.currChapter=1,this.currDungeon=1,this.currDiffculty=1,this.maxChapterInfo=new Array,this.loginDataNum0=0,this.loginTimes=0,this.dayLoginTimes=0,this.loginDate="",this.loginDayNum=0,this.loginFirstData=0,this.loginFirstDate="",this.signinType=0,this.signinTaskList=[0,0,0,0,0,0,0],this.signinTimes=1,this.isWxAuth=!1,this.isWxAuthPay=!1,this.musicStatus=1,this.soundEffectStatus=1,this.roleDataList=new Array,this.chapterDataList=new Array,this.equipmentIndex=1e4,this.equipmentList=new Array,this.equipmentGridCount=20,this.getNewEquipment=!1,this.roleEquipInfo=new Array,this.propList=new Array,this.propGridCount=20,this.showPropUseTip=!1,this.guideTaskList=new Array,this.nextFreeTime=0,this.freeLotteryTimes=1,this.lotterRewardIndex=1,this.lotteryAdTimes=0,this.lotteryTimesStatus=new Array,this.shakeJarCount=5,this.shakeJar1Count=0,this.shakeJar2Count=0,this.shakeJar3Count=0,this.bannerTimes=0,this.bannerTimes2=0,this.fightTip=1,this.isFirstPay=1,this.isFirstPayForHome=1,this.isFirstPayForShop=new Array,this.weekCardDate=0,this.monthCardDate=0,this.rechargeTotalNum=0,this.actionTags=new Array,this.acheveTaskList=new Array,this.dailyTaskList=new Array,this.threadTaskList=new Array,this.showThreadTaskOrder=1,this.favourBoxTimes=new Array,this.daySelectedTimes=3,this.daySelectedIndexs=new Array,this.daySelectedStatus=new Array,this.endlessChallengeCount=new Array,this.buffDataList=new Array,this.isTester=!1,this.shopDataList=new Array,this.myShopDataList=new Array,this.shopPropUpdate=3,this.fashionBuyStatus=new Array,this.fashionShareList=new Array,this.fashionList=new Array,this.wearFashionList=new Array,this.fashionId=0,this.subMessageStatus=new Array,this.cdActiveSenior=0,this.cdActiveFreeAd=0,this.cdActiveFreeAdTime=0,this.createAccountLevel=0,this.passCheckTaskData=new Array,this.getIntegralVideoCount=0,this.getCrystalVideoCount=0,this.inviteNewPlayerCount=0,this.passCheckLevel=0,this.currPassCheckSeasonId=0,this.diamWelfareVideoCount=0,this.openCustomerService=!1,this.customerServiceReward=!1,this.shareGetRewardCount=5,this.diamRewardStatus=new Array,this.showStrengthState=!0,this.playerDataMD5="",this.friendHelpSeasionId=1,this.friendHelpStatus=new Array,this.bunnyDay=1,this.bunnyStatus=[0,0,0,0],this.bunnyVideoCount=0,this.msdhqVideoCount=0,this.towerSeasionId=0,this.maxTowerLayerCount=0,this.tgTowerTime=0,this.towerLayerCount=1,this.towerCzCount=2,this.towerRewardOrder=1,this.towerRewardOver=0,this.selfTalentVideoCount=5,this.helpTalentVideoCount=5,this.heroTitleList=new Array,this.talentSkill=new Array,this.playerDataErrCount=0,this.shareRecordCount=0,this.followAccountState=0,this.lotteryTimesStatus.push(0),this.lotteryTimesStatus.push(0),this.lotteryTimesStatus.push(0),this.lotteryTimesStatus.push(0),this.lotteryTimesStatus.push(0),this.wearFashionList.push(0),this.wearFashionList.push(0),this.wearFashionList.push(0),this.wearFashionList.push(0),this.diamRewardStatus.push(0),this.diamRewardStatus.push(0);var t=new o.default(this.roleId);t.status=2,this.roleDataList.push(t),this.nextPowerTime=(new Date).getTime()+6e4,this.createAccountTime=r.default.getDayInYear();for(var e=1001;e<1100;++e)this.itemList[e]=1001==e?1e3:1003==e?20:0,this.itemCostList[e]=0;for(e=0;e<=10;e++)this.isFirstPayForShop.push(1);for(e=0;e<=30;e++)this.actionTags.push(0);for(e=0;e<21;e++)this.endlessChallengeCount.push(4);for(e=0;e<6;++e)0==e?this.maxChapterInfo.push([1,1]):this.maxChapterInfo.push([0,0]);for(e=0;e<20;++e)this.subMessageStatus.push(0);for(e=0;e<20;++e)this.friendHelpStatus.push(0);for(e=0;e<6;++e){var a=new Array(20).fill(0);a[1]=1,a[2]=1,a[3]=1,this.talentSkill.push(a)}this.createAccountLevel=s.default.Instance.accountLevel},cc._RF.pop()},{}],PopLayer:[function(t,e,a){"use strict";cc._RF.push(e,"d171akIPaRGWqjPL+qeLCMI","PopLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("PublicEnum"),h=i("MainLogic"),u=i("GameData"),d=i("PublicConst"),p=cc._decorator,f=p.ccclass,y=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currLayerIndex=100,e.currLayer=null,e.guideLayerPrefab=null,e.autoPopLayerState=[0,0,0,0,0,0,0,0,0,0,0,0,0],e}return r(e,t),e.prototype.initLayer=function(t){this._scene=t},e.prototype.layerResetZIndex=function(t){t.active=!0,this.currLayerIndex+=2,this.currLayer=t,t.zIndex=this.currLayerIndex},e.prototype.loadPrefab=function(t,e){(null==e||e)&&h.default.Instance.combatScene.showLoadPrefab(),c.AssetUtils.loadPrefab(t,this.loadCallback,this)},e.prototype.loadCallback=function(t,e){switch(e){case"Prefab/ChapterLayer":this.chapterLayerPrefab=t,this.reviewChapterLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/ChapterMorePage":this.chapterMorePagePrefab=t,this.reviewChapterMorePage(this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/SettingLayer":this.settingLayerPrefab=t,this.reviewSettingLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/RewardLayer":this.rewardLayerPrefab=t,this.reviewRewardLayer(this.fromPageName,this.pageType,this.data,this.hideBanner),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/MoneyMorePage":this.moneyMorePagePrefab=t,this.reviewMoneyMorePage(this.fromPageName,this.pageType,this.hideBanner),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/SigninLayer":this.signinLayerPrefab=t,this.reviewSigninLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/LotteryLayer":this.lotteryLayerPrefab=t,this.reviewLotteryLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/RankingLayer":this.rankingLayerPrefab=t,this.reviewRankingLayer(this.pageType,this.fromPageName,this.hideBanner),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/GamePauseLayer":this.gamePauseLayerPrefab=t,this.reviewGamePauseLayer(this.fromPageName,this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/CombatResultLayer":this.combatResultPrefab=t,this.reviewCombatResultLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/RevivedLayer":this.revivedLayerPrefab=t,this.reviewRevivedLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/TaskLayer":this.taskLayerPrefab=t,this.reviewTaskLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/SkillLayer":this.skillLayerPrefab=t,this.reviewSkillLayer(this.fromPageName,this.skillLayerHeroId),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/EquipmentLayer":this.equipmentLayerPrefab=t,this.reviewEquipmentlLayer(this.pageType,this.equipmentHeroId),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/StrengthenLayer":this.strengthenPrefab=t,this.reviewStrengthLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/EndlessLayer":this.endlessPrefab=t,this.reviewEndlessLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/ShakeJarLayer":this.shakeJarPrefab=t,this.reviewShakeJarLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/CdkeyLayer":this.cdkeyPrefab=t,this.reviewCdkeyLayer(this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/NoticeLayer":this.noticePrefab=t,this.reviewNoticeLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/ShopLayer":this.shopPrefab=t,this.reviewShopLayer(this.fromPageName,this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/PassCheckLayer":this.passCheckPrefab=t,this.reviewPassCheckLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/MoreGameLayer":this.moreGamePrefab=t,this.reviewMoreGameLayer(this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/DiamWelfareLayer":this.diamWelfarePrefab=t,this.reviewDiamWelfareLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/FashionLayer":this.fashionPrefab=t,this.reviewFashionLayer(this.fromPageName),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/MailLayer":this.mailPrefab=t,this.reviewMailLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/MoreFashionLayer":this.moreFashionPrefab=t,this.reviewMoreFashionLayer(this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/FriendsHelpLayer":this.friendsHelpPrefab=t,this.reviewFriendsHelpLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/ActivityLayer":this.activityPrefab=t,this.reviewActivityLayer(this.pageType),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/ClimbTowerLayer":this.climbTowerPrefab=t,this.reviewClimbTowerLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/HeroTitleLayer":this.heroTitlePrefab=t,this.reviewHeroTitleLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/TalentLayer":this.talentPrefab=t,this.reviewTalentLayer(),h.default.Instance.combatScene.hideLoadPrefab();break;case"Prefab/GameRecordLayer":this.gameRecordPrefab=t,this.reviewGameRecordLayer(),h.default.Instance.combatScene.hideLoadPrefab()}},e.prototype.reviewCombatResultLayer=function(){if(null==this.combatResultLayer){if(null==this.combatResultPrefab)return void this.loadPrefab("Prefab/CombatResultLayer");var t=cc.instantiate(this.combatResultPrefab);this.combatResultLayer=t.getComponent("CombatResultLayer"),this.combatResultLayer.init(),this.node.addChild(t)}else this.combatResultLayer.review();this.layerResetZIndex(this.combatResultLayer.node)},e.prototype.reviewGameRecordLayer=function(){if(null==this.gameRecordLayer){if(null==this.gameRecordPrefab)return void this.loadPrefab("Prefab/GameRecordLayer");var t=cc.instantiate(this.gameRecordPrefab);this.gameRecordLayer=t.getComponent("GameRecordLayer"),this.gameRecordLayer.init(),this.node.addChild(t)}else this.gameRecordLayer.review();this.layerResetZIndex(this.gameRecordLayer.node)},e.prototype.reviewChapterLayer=function(){if(null==this.chapterLayer){if(null==this.chapterLayerPrefab)return void this.loadPrefab("Prefab/ChapterLayer");var t=cc.instantiate(this.chapterLayerPrefab);this.chapterLayer=t.getComponent("ChapterLayer"),this.chapterLayer.init(),this.node.addChild(t)}else this.chapterLayer.review();this.layerResetZIndex(this.chapterLayer.node)},e.prototype.reviewChapterMorePage=function(t){if(this.pageType=t,null==this.chapterMorePage){if(null==this.chapterMorePagePrefab)return void this.loadPrefab("Prefab/ChapterMorePage");var e=cc.instantiate(this.chapterMorePagePrefab);this.chapterMorePage=e.getComponent("ChapterMorePage"),this.chapterMorePage.init(t),this.node.addChild(e)}else this.chapterMorePage.review(t);this.layerResetZIndex(this.chapterMorePage.node)},e.prototype.reviewSettingLayer=function(){if(null==this.settingLayer){if(null==this.settingLayerPrefab)return void this.loadPrefab("Prefab/SettingLayer");var t=cc.instantiate(this.settingLayerPrefab);this.settingLayer=t.getComponent("SettingLayer"),this.settingLayer.init(),this.node.addChild(t)}else this.settingLayer.review();this.layerResetZIndex(this.settingLayer.node,!0)},e.prototype.reviewGamePauseLayer=function(t,e){if(4!=e){if(this.pageType=e,this.fromPageName=t,null==this.gamePauseLayer){if(null==this.gamePauseLayerPrefab)return void this.loadPrefab("Prefab/GamePauseLayer");var a=cc.instantiate(this.gamePauseLayerPrefab);this.gamePauseLayer=a.getComponent("GamePauseLayer"),this.gamePauseLayer.init(this.fromPageName,this.pageType),this.node.addChild(a)}else this.gamePauseLayer.review(this.fromPageName,this.pageType);this.layerResetZIndex(this.gamePauseLayer.node)}},e.prototype.reviewRevivedLayer=function(){if(null==this.revivedLayer){if(null==this.revivedLayerPrefab)return void this.loadPrefab("Prefab/RevivedLayer");var t=cc.instantiate(this.revivedLayerPrefab);this.revivedLayer=t.getComponent("RevivedLayer"),this.revivedLayer.init(),this.node.addChild(t)}else this.revivedLayer.review();this.layerResetZIndex(this.revivedLayer.node)},e.prototype.reviewRewardLayer=function(t,e,a,n){if(this.fromPageName=t,this.pageType=e,this.data=a,this.hideBanner=n,null==this.rewardLayer){if(null==this.rewardLayerPrefab)return void this.loadPrefab("Prefab/RewardLayer");var i=cc.instantiate(this.rewardLayerPrefab);this.rewardLayer=i.getComponent("RewardLayer"),this.rewardLayer.init(this.fromPageName,e,a,this.hideBanner),this.node.addChild(i)}else this.rewardLayer.review(this.fromPageName,e,a,this.hideBanner);this.layerResetZIndex(this.rewardLayer.node)},e.prototype.reviewMoneyMorePage=function(t,e,a){if(this.fromPageName=t,this.pageType=e,this.hideBanner=a,null==this.moneyMorePage){if(null==this.moneyMorePagePrefab)return void this.loadPrefab("Prefab/MoneyMorePage");var n=cc.instantiate(this.moneyMorePagePrefab);this.moneyMorePage=n.getComponent("MoneyMorePage"),this.moneyMorePage.init(this.fromPageName,this.pageType,a),this.node.addChild(n)}else this.moneyMorePage.review(this.fromPageName,this.pageType,a);this.layerResetZIndex(this.moneyMorePage.node,!0)},e.prototype.reviewSigninLayer=function(t){if(this.fromPageName=t,null==this.signinLayer){if(null==this.signinLayerPrefab)return void this.loadPrefab("Prefab/SigninLayer");var e=cc.instantiate(this.signinLayerPrefab);this.signinLayer=e.getComponent("SigninLayer"),this.signinLayer.init(this.fromPageName),this.node.addChild(e)}else this.signinLayer.review(this.fromPageName);this.layerResetZIndex(this.signinLayer.node,!0)},e.prototype.reviewLotteryLayer=function(t){if(this.fromPageName=t,null==this.lotteryLayer){if(null==this.lotteryLayerPrefab)return void this.loadPrefab("Prefab/LotteryLayer");var e=cc.instantiate(this.lotteryLayerPrefab);this.lotteryLayer=e.getComponent("LotteryLayer"),this.lotteryLayer.init(this.fromPageName),this.node.addChild(e)}else this.lotteryLayer.review(this.fromPageName);this.layerResetZIndex(this.lotteryLayer.node,!0)},e.prototype.reviewRankingLayer=function(t,e,a){if(void 0===a&&(a=!1),this.pageType=t,this.fromPageName=e,this.hideBanner=a,null==this.rankingLayer){if(null==this.rankingLayerPrefab)return void this.loadPrefab("Prefab/RankingLayer");var n=cc.instantiate(this.rankingLayerPrefab);this.rankingLayer=n.getComponent("RankingLayer"),this.rankingLayer.init(t,e,a),this.node.addChild(n)}else this.rankingLayer.review(t,e,a);this.layerResetZIndex(this.rankingLayer.node)},e.prototype.reviewGuideLayer=function(t,e,a,n,i,o,r,s){if(null==this.guideLayer){var c=cc.instantiate(this.guideLayerPrefab);this.guideLayer=c.getComponent("GuideLayer"),this.guideLayer.init(this._scene),this.node.addChild(c)}this.guideLayer.node.active=!0,this.guideLayer.review(t,e,a,n,i,o,r,s)},e.prototype.reviewTaskLayer=function(t){if(this.fromPageName=t,null==this.taskLayer){if(null==this.taskLayerPrefab)return void this.loadPrefab("Prefab/TaskLayer");var e=cc.instantiate(this.taskLayerPrefab);this.taskLayer=e.getComponent("TaskLayer"),this.taskLayer.init(this.fromPageName),this.node.addChild(e)}else this.taskLayer.review(this.fromPageName);this.layerResetZIndex(this.taskLayer.node)},e.prototype.reviewSkillLayer=function(t,e){if(this.fromPageName=t,this.skillLayerHeroId=e,null==this.skillLayer){if(null==this.skillLayerPrefab)return void this.loadPrefab("Prefab/SkillLayer");var a=cc.instantiate(this.skillLayerPrefab);this.skillLayer=a.getComponent("SkillLayer"),this.skillLayer.init(this.fromPageName,e),this.node.addChild(a)}else this.skillLayer.review(this.fromPageName,e);this.layerResetZIndex(this.skillLayer.node)},e.prototype.reviewEquipmentlLayer=function(t,e){if(this.equipmentHeroId=e,this.pageType=t,null==this.equipmentLayer){if(null==this.equipmentLayerPrefab)return void this.loadPrefab("Prefab/EquipmentLayer");var a=cc.instantiate(this.equipmentLayerPrefab);this.equipmentLayer=a.getComponent("EquipmentLayer"),this.equipmentLayer.init(this.pageType,e),this.node.addChild(a)}else this.equipmentLayer.review(this.pageType,e);this.layerResetZIndex(this.equipmentLayer.node)},e.prototype.reviewStrengthLayer=function(t){if(this.fromPageName=t,null==this.strengthenLayer){if(null==this.strengthenPrefab)return void this.loadPrefab("Prefab/StrengthenLayer");var e=cc.instantiate(this.strengthenPrefab);this.strengthenLayer=e.getComponent("StrengthenLayer"),this.strengthenLayer.init(this.fromPageName),this.node.addChild(e)}else this.strengthenLayer.review(this.fromPageName);this.layerResetZIndex(this.strengthenLayer.node)},e.prototype.reviewEndlessLayer=function(t){if(this.fromPageName=t,null==this.endlessLayer){if(null==this.endlessPrefab)return void this.loadPrefab("Prefab/EndlessLayer");var e=cc.instantiate(this.endlessPrefab);this.endlessLayer=e.getComponent("EndlessLayer"),this.endlessLayer.init(this.fromPageName),this.node.addChild(e)}else this.endlessLayer.review(this.fromPageName);this.layerResetZIndex(this.endlessLayer.node)},e.prototype.reviewShakeJarLayer=function(t){if(this.fromPageName=t,null==this.shakeJarLayer){if(null==this.shakeJarPrefab)return void this.loadPrefab("Prefab/ShakeJarLayer");var e=cc.instantiate(this.shakeJarPrefab);this.shakeJarLayer=e.getComponent("ShakeJarLayer"),this.shakeJarLayer.init(this.fromPageName),this.node.addChild(e)}else this.shakeJarLayer.review(this.fromPageName);this.layerResetZIndex(this.shakeJarLayer.node)},e.prototype.reviewCdkeyLayer=function(t){if(this.pageType=t,null==this.cdkeyLayer){if(null==this.cdkeyPrefab)return void this.loadPrefab("Prefab/CdkeyLayer");var e=cc.instantiate(this.cdkeyPrefab);this.cdkeyLayer=e.getComponent("CdkeyLayer"),this.cdkeyLayer.init(this.pageType),this.node.addChild(e)}else this.cdkeyLayer.review(this.pageType);this.layerResetZIndex(this.cdkeyLayer.node)},e.prototype.reviewNoticeLayer=function(){if(null==this.noticeLayer){if(null==this.noticePrefab)return void this.loadPrefab("Prefab/NoticeLayer");var t=cc.instantiate(this.noticePrefab);this.noticeLayer=t.getComponent("NoticeLayer"),this.noticeLayer.init(),this.node.addChild(t)}else this.noticeLayer.review();this.layerResetZIndex(this.noticeLayer.node)},e.prototype.reviewShopLayer=function(t,e){if(void 0===e&&(e=0),this.fromPageName=t,this.pageType=e,null==this.shopLayer){if(null==this.shopPrefab)return void this.loadPrefab("Prefab/ShopLayer");var a=cc.instantiate(this.shopPrefab);this.shopLayer=a.getComponent("ShopLayer"),this.shopLayer.init(t,e),this.node.addChild(a)}else this.shopLayer.review(t,e);this.layerResetZIndex(this.shopLayer.node)},e.prototype.reviewPassCheckLayer=function(){if(null==this.passCheckLayer){if(null==this.passCheckPrefab)return void this.loadPrefab("Prefab/PassCheckLayer");var t=cc.instantiate(this.passCheckPrefab);this.passCheckLayer=t.getComponent("PassCheckLayer"),this.passCheckLayer.init(),this.node.addChild(t)}else this.passCheckLayer.review();this.layerResetZIndex(this.passCheckLayer.node)},e.prototype.reviewMoreGameLayer=function(t){if(this.pageType=t,null==this.moreGameLayer){if(null==this.moreGamePrefab)return void this.loadPrefab("Prefab/MoreGameLayer");var e=cc.instantiate(this.moreGamePrefab);this.moreGameLayer=e.getComponent("MoreGameLayer"),this.moreGameLayer.init(this.pageType),this.node.addChild(e)}else this.moreGameLayer.review(this.pageType);this.layerResetZIndex(this.moreGameLayer.node)},e.prototype.reviewDiamWelfareLayer=function(){if(null==this.diamWelfareLayer){if(null==this.diamWelfarePrefab)return void this.loadPrefab("Prefab/DiamWelfareLayer");var t=cc.instantiate(this.diamWelfarePrefab);this.diamWelfareLayer=t.getComponent("DiamWelfareLayer"),this.diamWelfareLayer.init(),this.node.addChild(t)}else this.diamWelfareLayer.review();this.layerResetZIndex(this.diamWelfareLayer.node)},e.prototype.reviewFashionLayer=function(t){if(this.fromPageName=t,null==this.fashionLayer){if(null==this.fashionPrefab)return void this.loadPrefab("Prefab/FashionLayer");var e=cc.instantiate(this.fashionPrefab);this.fashionLayer=e.getComponent("FashionLayer"),this.fashionLayer.init(this.fromPageName),this.node.addChild(e)}else this.fashionLayer.review(this.fromPageName);this.layerResetZIndex(this.fashionLayer.node)},e.prototype.reviewMailLayer=function(){if(null==this.mailLayer){if(null==this.mailPrefab)return void this.loadPrefab("Prefab/MailLayer");var t=cc.instantiate(this.mailPrefab);this.mailLayer=t.getComponent("MailLayer"),this.mailLayer.init(),this.node.addChild(t)}else this.mailLayer.review();this.layerResetZIndex(this.mailLayer.node)},e.prototype.reviewMoreFashionLayer=function(t){if(this.pageType=t,null==this.moreFashionLayer){if(null==this.moreFashionPrefab)return void this.loadPrefab("Prefab/MoreFashionLayer");var e=cc.instantiate(this.moreFashionPrefab);this.moreFashionLayer=e.getComponent("MoreFashionLayer"),this.moreFashionLayer.init(t),this.node.addChild(e)}else this.moreFashionLayer.review(t);this.layerResetZIndex(this.moreFashionLayer.node)},e.prototype.reviewFriendsHelpLayer=function(){if(null==this.friendsHelpLayer){if(null==this.friendsHelpPrefab)return void this.loadPrefab("Prefab/FriendsHelpLayer");var t=cc.instantiate(this.friendsHelpPrefab);this.friendsHelpLayer=t.getComponent("FriendsHelpLayer"),this.friendsHelpLayer.init(),this.node.addChild(t)}else this.friendsHelpLayer.review();this.layerResetZIndex(this.friendsHelpLayer.node)},e.prototype.reviewActivityLayer=function(t){if(this.pageType=t,null==this.activityLayer){if(null==this.activityPrefab)return void this.loadPrefab("Prefab/ActivityLayer");var e=cc.instantiate(this.activityPrefab);this.activityLayer=e.getComponent("ActivityLayer"),this.activityLayer.init(this.pageType),this.node.addChild(e)}else this.activityLayer.review(this.pageType);this.layerResetZIndex(this.activityLayer.node)},e.prototype.reviewClimbTowerLayer=function(){if(null==this.climbTowerLayer){if(null==this.climbTowerPrefab)return void this.loadPrefab("Prefab/ClimbTowerLayer");var t=cc.instantiate(this.climbTowerPrefab);this.climbTowerLayer=t.getComponent("ClimbTowerLayer"),this.climbTowerLayer.init(),this.node.addChild(t)}else this.climbTowerLayer.review();this.layerResetZIndex(this.climbTowerLayer.node)},e.prototype.reviewHeroTitleLayer=function(){if(null==this.heroTitleLayer){if(null==this.heroTitlePrefab)return void this.loadPrefab("Prefab/HeroTitleLayer");var t=cc.instantiate(this.heroTitlePrefab);this.heroTitleLayer=t.getComponent("HeroTitleLayer"),this.heroTitleLayer.init(),this.node.addChild(t)}else this.heroTitleLayer.review();this.layerResetZIndex(this.heroTitleLayer.node)},e.prototype.reviewTalentLayer=function(){if(null==this.talentLayer){if(null==this.talentPrefab)return void this.loadPrefab("Prefab/TalentLayer");var t=cc.instantiate(this.talentPrefab);this.talentLayer=t.getComponent("TalentLayer"),this.talentLayer.init(),this.node.addChild(t)}else this.talentLayer.review();this.layerResetZIndex(this.talentLayer.node)},e.prototype.autoPopLayer=function(){return console.log(u.default.Instance.modifyDataCount,u.default.Instance.showModifyTip),u.default.Instance.showModifyTip&&u.default.Instance.modifyDataCount>0&&u.default.Instance.modifyDataCount<3?(u.default.Instance.showModifyTip=!1,h.default.Instance.combatScene.popLayer.reviewGamePauseLayer(l.PAGE_NAME.Home,5),!0):u.default.Instance.showModifyTip&&u.default.Instance.modifyDataCount>=3?(u.default.Instance.showModifyTip=!1,h.default.Instance.combatScene.popLayer.reviewGamePauseLayer(l.PAGE_NAME.Home,6),!0):0==this.autoPopLayerState[1]&&d.default.Is_Senior&&0==u.default.Instance.playerData.cdActiveSenior?(this.autoPopLayerState[1]=1,h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewCdkeyLayer(2),!0):0==this.autoPopLayerState[2]&&1==u.default.Instance.playerData.dayLoginTimes&&d.default.PassCheckSwitch?(this.autoPopLayerState[2]=1,h.default.Instance.combatScene.homeLayer.hideNode(),h.default.Instance.combatScene.popLayer.reviewPassCheckLayer(),!0):0==this.autoPopLayerState[3]&&1==u.default.Instance.playerData.dayLoginTimes&&(u.default.Instance.playerData.fashionList.indexOf(30007)<0||u.default.Instance.playerData.fashionList.indexOf(30008)<0||u.default.Instance.playerData.fashionList.indexOf(30009)<0)?(this.autoPopLayerState[3]=1,h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(1),!0):0==this.autoPopLayerState[4]&&2==u.default.Instance.playerData.dayLoginTimes&&(u.default.Instance.playerData.fashionList.indexOf(30010)<0||u.default.Instance.playerData.fashionList.indexOf(30011)<0||u.default.Instance.playerData.fashionList.indexOf(30012)<0)&&(this.autoPopLayerState[4]=1,h.default.Instance.combatScene.homeLayer.hideBanner(),h.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(2),!0)},e.prototype.pointGuideFinish=function(t,e){null!=this.guideLayer&&(null!=t&&this.guideLayer.guideTaskId!=t||null!=e&&this.guideLayer.guideTaskStep1!=e||this.guideLayer.doStep())},s([y(cc.Prefab)],e.prototype,"guideLayerPrefab",void 0),s([f],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],PropData:[function(t,e,a){"use strict";cc._RF.push(e,"5c415XbBlVHvo7q625cLUqw","PropData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,a){this.propId=t,this.propQuality=e,this.propLevel=a,this.count=0},cc._RF.pop()},{}],PublicConst:[function(t,e,a){"use strict";cc._RF.push(e,"4e322mkoKtME71SYk8xEx11","PublicConst");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=function(){function t(){}return t.getPlatForm=function(){return o.PLAT_FORM.Web_4399},t.isVivoOrOppo=function(){return t.Platform==o.PLAT_FORM.Vivo||t.Platform==o.PLAT_FORM.Opp||t.Platform==o.PLAT_FORM.Android},t.isWxOrQq=function(){return t.Platform==o.PLAT_FORM.Wx||t.Platform==o.PLAT_FORM.QQ},t.ERROR_AD="\u63d0\u524d\u5173\u95ed\u5e7f\u544a\uff0c\u4e0d\u80fd\u83b7\u53d6\u5956\u52b1!",t.NO_AD="\u60a8\u7684\u89c6\u9891\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u8bf7\u8fc7\u6bb5\u65f6\u95f4\u518d\u6765",t.SUCCESS_AD="\u89c2\u770b\u89c6\u9891\u6210\u529f\uff0c\u83b7\u53d6\u5956\u52b1\uff01",t.ERROR_SHARE="\u5206\u4eab\u5931\u8d25!",t.SUCCESS_SHARE="\u5206\u4eab\u6210\u529f!",t.ERROR_FUN_NOT="\u529f\u80fd\u5f00\u53d1\u4e2d!",t.ERROR_DATA="<color=#ff0000>\u6570\u636e\u5f02\u5e38!!!!!</color>",t.ERROR_CONFIG="<color=#ff0000>\u914d\u7f6e\u5f02\u5e38!!!!!</color>",t.Platform=t.getPlatForm(),t.AccountKey="qmDnfHasAccount01",t.PlayerDataKey="qmDnfPlayerData01",t.Max_Jump_Times=3,t.SHOW_NUM_RATE=1,t.MAX_CHAPTER=6,t.MAX_STRENGTH_LEVEL=21,t.MAX_PLAYER_LEVEL=60,t.Gravity_Scale=7,t.Hit_Gravity_Scale=3,t.Max_Power=20,t.Is_Senior=!1,t.Share_Switch=!0,t.PassCheckSeasonId=0,t.PassCheckSwitch=!1,t.PassCheckTime=new Array,t.FriendsHelpId=0,t.FriendsHelpTime=new Array,t.MAX_TOWER_LAYER=200,t.ClimbTowerSeasionId=1,t.ClimbTowerTime=new Array,t.WxSubscribeKeys=["EyysS0ei_rnXkxxLCSV-tGTgRZbDKTPj4droTn_BKS0","ZoJyIGQpr7GjwXjtva3FnukiZLFLk8U-4mIoh-GrKLs","IGGw430y6LOagCE4G6B3mKOlzRPklUagCP_wan-GZuM","0WiaTKe5ufITeiZfTcG-2M08oDtNv6xsCv0pOGDz2wQ","lUxkrDly8J3bwMi8MKSibtw4kWyOd2Kb188JNfJx_k4"],t}();i.default=r,cc._RF.pop()},{}],PublicEnum:[function(t,e,a){"use strict";cc._RF.push(e,"0706fDD+aBIn7Pd9i8Yf4ny","PublicEnum");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.Quality_COLOR=n.FIGHT_OBJECT=n.BULLET_MOVE_TYPE=n.SKILL_TYPE=n.COLLIDE_SHAPE=n.BULLET_EXPLODE_TYPE=n.BULLET_HURT_TYPE=n.GearType=n.BULLET_STEP=n.GUIDE_TYPE=n.SKILL_STATE=n.EFFECT_TYPE=n.SKILL_EVENT=n.CONTROL_EVENT=n.HEOR_STATE=n.BATTLE_CAMP=n.LIFE_STATUS=n.GAME_MODEL=n.GAME_RESULT=n.GAME_STEP=n.PAGE_NAME=n.PLAT_FORM=void 0,function(t){t[t.Wx=1]="Wx",t[t.QQ=2]="QQ",t[t.Vivo=3]="Vivo",t[t.Opp=4]="Opp",t[t.UC=5]="UC",t[t.Qtt=6]="Qtt",t[t.Douyin=7]="Douyin",t[t.Android=8]="Android",t[t.Web_4399=9]="Web_4399",t[t.Web=20]="Web"}(n.PLAT_FORM||(n.PLAT_FORM={})),function(t){t[t.Home=0]="Home",t[t.Task=1]="Task",t[t.ShakeJar=2]="ShakeJar",t[t.Shop=3]="Shop",t[t.Strengthen=4]="Strengthen",t[t.Equipment=5]="Equipment",t[t.Skill=6]="Skill",t[t.Endless=7]="Endless",t[t.Chapter=8]="Chapter",t[t.ChapterStart=9]="ChapterStart",t[t.Combat=10]="Combat",t[t.Revived=11]="Revived",t[t.CombatResult=12]="CombatResult"}(n.PAGE_NAME||(n.PAGE_NAME={})),function(t){t[t.Init=0]="Init",t[t.Starting=1]="Starting",t[t.Over=2]="Over"}(n.GAME_STEP||(n.GAME_STEP={})),function(t){t[t.None=0]="None",t[t.Success=1]="Success",t[t.Fail=2]="Fail"}(n.GAME_RESULT||(n.GAME_RESULT={})),function(t){t[t.Normal=1]="Normal",t[t.Endless=2]="Endless"}(n.GAME_MODEL||(n.GAME_MODEL={})),function(t){t[t.Init=0]="Init",t[t.Alive=1]="Alive",t[t.Dead=2]="Dead"}(n.LIFE_STATUS||(n.LIFE_STATUS={})),function(t){t[t.Self=1]="Self",t[t.Enemy=2]="Enemy",t[t.Gear=3]="Gear"}(n.BATTLE_CAMP||(n.BATTLE_CAMP={})),function(t){t[t.Birth=0]="Birth",t[t.Stand=1]="Stand",t[t.Move=2]="Move",t[t.Hit=3]="Hit",t[t.Death=4]="Death",t[t.Attack=5]="Attack",t[t.Dodge=6]="Dodge",t[t.Flash=7]="Flash",t[t.Assault=8]="Assault"}(n.HEOR_STATE||(n.HEOR_STATE={})),function(t){t[t.None=0]="None",t[t.Control_Move=1]="Control_Move",t[t.Control_Move_Cancel=2]="Control_Move_Cancel",t[t.Control_Jump_Back=3]="Control_Jump_Back",t[t.Control_Attack=4]="Control_Attack",t[t.Control_Skill=5]="Control_Skill",t[t.Control_Big=6]="Control_Big",t[t.Control_Assault=7]="Control_Assault"}(n.CONTROL_EVENT||(n.CONTROL_EVENT={})),function(t){t[t.None=0]="None",t[t.Attack=1]="Attack",t[t.Attacked=2]="Attacked",t[t.Dead=3]="Dead",t[t.Born=4]="Born",t[t.Kill=5]="Kill"}(n.SKILL_EVENT||(n.SKILL_EVENT={})),function(t){t[t.Effect_hit=0]="Effect_hit",t[t.Effect_hit2=1]="Effect_hit2",t[t.Effect_dead=2]="Effect_dead",t[t.Effect_wudi=3]="Effect_wudi",t[t.Effect_particle=4]="Effect_particle",t[t.Efffect_forzen=5]="Efffect_forzen",t[t.Effect_Jisha=6]="Effect_Jisha",t[t.Effect_Stoic=7]="Effect_Stoic",t[t.Effect_SKZ=8]="Effect_SKZ",t[t.Effect_Boss_Light=9]="Effect_Boss_Light",t[t.Effect_Upgrade=10]="Effect_Upgrade",t[t.Show_Attack_Num=11]="Show_Attack_Num",t[t.Show_Crit_Num=12]="Show_Crit_Num",t[t.Show_ReBlood=13]="Show_ReBlood",t[t.Show_Add_Hp=14]="Show_Add_Hp",t[t.Show_Dodge1=15]="Show_Dodge1",t[t.Show_Say=16]="Show_Say",t[t.Show_Word=17]="Show_Word",t[t.Show_Word2=18]="Show_Word2"}(n.EFFECT_TYPE||(n.EFFECT_TYPE={})),function(t){t[t.ContinuouCd=0]="ContinuouCd",t[t.CdOver=1]="CdOver"}(n.SKILL_STATE||(n.SKILL_STATE={})),function(t){t[t.Dialogue=1]="Dialogue",t[t.Point=2]="Point"}(n.GUIDE_TYPE||(n.GUIDE_TYPE={})),function(t){t[t.Warn=0]="Warn",t[t.Fly=1]="Fly",t[t.Explode=2]="Explode",t[t.Delete=3]="Delete"}(n.BULLET_STEP||(n.BULLET_STEP={})),function(t){t[t.Type_1001=1001]="Type_1001"}(n.GearType||(n.GearType={})),function(t){t[t.Normal=0]="Normal",t[t.Scope=1]="Scope",t[t.Continue=2]="Continue",t[t.Through=3]="Through",t[t.Target=4]="Target"}(n.BULLET_HURT_TYPE||(n.BULLET_HURT_TYPE={})),function(t){t[t.None=0]="None",t[t.Collide_Explode=1]="Collide_Explode",t[t.Target_Position_Explode=2]="Target_Position_Explode",t[t.Delay_Explode=3]="Delay_Explode"}(n.BULLET_EXPLODE_TYPE||(n.BULLET_EXPLODE_TYPE={})),function(t){t[t.Circle_Circle=0]="Circle_Circle",t[t.Rect_Circle=1]="Rect_Circle"}(n.COLLIDE_SHAPE||(n.COLLIDE_SHAPE={})),function(t){t[t.Type_1=1]="Type_1",t[t.Type_2=2]="Type_2",t[t.Type_3=3]="Type_3",t[t.Type_4=4]="Type_4",t[t.Type_5=5]="Type_5",t[t.Type_1001=1001]="Type_1001",t[t.Type_1003=1003]="Type_1003",t[t.Type_2027=2027]="Type_2027",t[t.Type_1005=1005]="Type_1005",t[t.Type_1008=1008]="Type_1008",t[t.Type_2028=2028]="Type_2028",t[t.Type_2029=2029]="Type_2029",t[t.Type_1010=1010]="Type_1010",t[t.Type_2023=2023]="Type_2023"}(n.SKILL_TYPE||(n.SKILL_TYPE={})),function(t){t[t.None=0]="None",t[t.Angle=1]="Angle",t[t.Curve=2]="Curve"}(n.BULLET_MOVE_TYPE||(n.BULLET_MOVE_TYPE={})),function(t){t[t.Tree=0]="Tree",t[t.Vat=1]="Vat",t[t.Reward=2]="Reward",t[t.Role=3]="Role"}(n.FIGHT_OBJECT||(n.FIGHT_OBJECT={})),n.Quality_COLOR=[cc.color(255,255,255),cc.color(104,213,237),cc.color(198,107,255),cc.color(253,74,173),cc.color(207,147,45)],cc._RF.pop()},{}],QmLocalStorage:[function(t,e,a){"use strict";cc._RF.push(e,"a472c3EHTVK+pLo+bPu2hlp","QmLocalStorage");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=n("PublicConst"),s=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.getItem=function(t){var e=!0;return r.default.Platform!=o.PLAT_FORM.Wx&&r.default.Platform!=o.PLAT_FORM.QQ&&r.default.Platform!=o.PLAT_FORM.Douyin||(e=!1),e?cc.sys.localStorage.getItem(t):r.default.Platform==o.PLAT_FORM.Wx?wx.getStorageSync(t):r.default.Platform==o.PLAT_FORM.QQ?qq.getStorageSync(t):r.default.Platform==o.PLAT_FORM.Douyin?tt.getStorageSync(t):void 0},t.prototype.setItem=function(t,e){var a=!0;r.default.Platform!=o.PLAT_FORM.Wx&&r.default.Platform!=o.PLAT_FORM.QQ&&r.default.Platform!=o.PLAT_FORM.Douyin||(a=!1),a?cc.sys.localStorage.setItem(t,e):r.default.Platform==o.PLAT_FORM.Wx?wx.setStorage({key:t,data:e}):r.default.Platform==o.PLAT_FORM.QQ?qq.setStorage({key:t,data:e}):r.default.Platform==o.PLAT_FORM.Douyin&&tt.setStorage({key:t,data:e,success:function(){console.log("set seen ad flag")},fail:function(){console.log("setStorage\u8c03\u7528\u5931\u8d25")}})},t}();i.default=s,cc._RF.pop()},{}],QqAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"22eb3twG8FCVJapdLaMDsx0","QqAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.loadRewardAd=function(){},e.prototype.showShareMenu=function(){},e.prototype.showInterAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(t,e){this.component2=t,this.func2=e},e.prototype.shareApp=function(){},e.prototype.adHandler=function(){},e.prototype.vibrateShort=function(){},e.prototype.navigateToMiniProgram=function(){},e.prototype.showModal=function(){},e.prototype.getSetting=function(){},e.prototype.openSetting=function(){},e.prototype.getUserInfo=function(){},e.prototype.createUserInfoButton=function(){},e.prototype.setKeepScreen=function(){},e.prototype.login=function(){},e.prototype.showAppBoxAd=function(){},e.prototype.showBlockAd=function(){},e.prototype.hideBlockAd=function(){},e.prototype.virtualPayment=function(){},e}(i("BaseAdServer").default);o.default=s,cc._RF.pop()},{}],RankArmItem:[function(t,e,a){"use strict";cc._RF.push(e,"4b157FI5IpI063giH691JON","RankArmItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("ConfigData"),h=i("AssetUtils"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){if(this.itemNode=cc.find("Item",this.node),this.levelNode=cc.find("Info/Level",this.node),this.addNode=cc.find("Info/Add",this.node),this.ccNode=cc.find("CC",this.node),this.bgNode=cc.find("ItemBg",this.node),this.effectNode=cc.find("Effect",this.node),0==t)this.bgNode.active=!1,this.itemNode.active=!1,this.levelNode.active=!1,this.addNode.active=!1,this.ccNode.active=!1,this.effectNode.active=!1;else{this.bgNode.active=!0,this.itemNode.active=!0,this.levelNode.active=!0,this.addNode.active=!0;var a=l.default.Instance.equipmentMap.get(t),n=a.quality;this.levelNode.getComponent(cc.Label).string="Lv."+e.equipmentLevel,this.addNode.getComponent(cc.Label).string="+"+e.strengthLevel,h.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+a.icon),h.AssetUtils.loadSpriteFrame(this.bgNode,"Common/common_quality_"+n),this.addNode.color=c.Quality_COLOR[n],this.addNode.getComponent(cc.Label).enableBold=!0,this.levelNode.color=c.Quality_COLOR[n],this.levelNode.getComponent(cc.Label).enableBold=!0,this.effectNode&&(this.effectNode.active=a.quality>=4),this.ccNode.active=!1,5==a.type&&(this.ccNode.active=!0,this.ccNode.color=c.Quality_COLOR[n])}},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],RankingItem:[function(t,e,a){"use strict";cc._RF.push(e,"2352bY61VRISpbxvuj+UFaI","RankingItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("StringUtils"),l=i("AssetUtils"),h=i("GameData"),u=i("PublicConst"),d=i("PublicEnum"),p=i("RankArmItem"),f=i("ConfigData"),y=i("AdServer"),m=i("SoundManager"),g=cc._decorator,I=g.ccclass,_=g.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.KnapsackPrefab=null,e.rankingNum="",e.heOpenId="",e}return r(e,t),e.prototype.init=function(t,e,a,n){var i=this;if(this.myOrOther=t,this.combatOrTower=e,this.rankingIndex=a,1==this.myOrOther?(cc.find("Other",this.node).active=!0,cc.find("My",this.node).active=!1,c.default.stringIsNull(n.nickname)?this.name="\u672a\u77e5":this.name=n.nickname,this.imgUrl=n.avatar_url):(cc.find("Other",this.node).active=!1,cc.find("My",this.node).active=!0,c.default.stringIsNull(h.default.Instance.playerData.nickName)?this.name="\u672a\u77e5":this.name=h.default.Instance.playerData.nickName,u.default.Platform!=d.PLAT_FORM.Android&&(this.imgUrl=h.default.Instance.playerData.headImg)),this.name=c.default.stringToSubStr(this.name),null!=n.score){var o=n.score;1==this.combatOrTower||2==this.combatOrTower&&(o=Math.floor(o/1e10)),this.rankingNum=o+(1==this.combatOrTower?"":"\u5c42")}if("false"==this.rankingNum&&(this.rankingNum=""),this.imgNode=cc.find("Head/Item",this.node),this.nameNode=cc.find("Name",this.node),this.rankNode=cc.find("Rank/Num4",this.node),this.combatNode=cc.find("Combat",this.node),this.armNode=cc.find("Arms",this.node),this.titleNode=cc.find("Title",this.node),this.superNode=cc.find("Super",this.node),this.titleDiplay=this.titleNode.getComponent(sp.Skeleton),this.nameNode.getComponent(cc.Label).string=this.name,this.rankNode.getComponent(cc.Label).string=this.rankingIndex+"",""==this.rankingNum?this.combatNode.getComponent(cc.Label).string="\u672a\u77e5":this.combatNode.getComponent(cc.Label).string=this.rankingNum+"",c.default.stringIsNull(this.imgUrl))l.AssetUtils.loadSpriteFrame(this.imgNode,"Common/home_suitu_09");else{var r=.1*t+a%10*.1+.2*Math.random();2==t&&(r=.3*Math.random()),this.node.runAction(cc.sequence(cc.delayTime(r),cc.callFunc(function(){1==i.myOrOther?l.AssetUtils.loadRemoteUrl(i.imgNode,i.imgUrl):l.AssetUtils.loadRemoteUrl2(i.imgNode,i.imgUrl)},this)))}var s=this.rankingIndex;s>3&&(s=4);for(var y=1;y<=4;y++)cc.find("Rank/Num"+y,this.node).active=y==s;if(n.user_detail&&n.user_detail.length>0){var m=JSON.parse(n.user_detail);if(this.heOpenId=m.openid,1==this.combatOrTower){this.titleNode.active=!1,this.armNode.active=!0,this.armNode.destroyAllChildren();for(var g=m.equipmentList,I=1;I<7;++I)for(y=0;y<g.length;++y){var _=g[y];if(1==_.equipState&&_.equipPlace==I){var v=cc.instantiate(this.KnapsackPrefab);v.zIndex=_.equipPlace,this.armNode.addChild(v),v.getComponent(p.default).init(_.equipmentId,_);break}}}else if(this.titleNode.active=!0,this.armNode.active=!1,m.wearFashionList){var S=m.wearFashionList[3];if(S){var L=f.default.Instance.equipmentMap.get(S);l.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+L.res_id,null,function(){i.titleDiplay.setAnimation(0,"stand",!0)},this)}else this.titleNode.active=!1}else this.titleNode.active=!1}this.superNode.active=u.default.Is_Senior},e.prototype.show=function(){var t=this;this.name=h.default.Instance.playerData.nickName,this.imgUrl=h.default.Instance.playerData.headImg,this.name=c.default.stringToSubStr(this.name),this.nameNode.getComponent(cc.Label).string=this.name;var e=.3*Math.random();this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){u.default.Platform!=d.PLAT_FORM.Android&&l.AssetUtils.loadRemoteUrl2(t.imgNode,t.imgUrl)},this)))},e.prototype.onCopyBtn=function(){m.SoundManager.Instance.playEffect("anniu"),y.default.Instance.setClipboardData(this.heOpenId)},s([_(cc.Prefab)],e.prototype,"KnapsackPrefab",void 0),s([I],e)}(cc.Component);o.default=v,cc._RF.pop()},{}],RankingLayer:[function(t,e,a){"use strict";cc._RF.push(e,"709197TmcpLHLGMhkTKYJmG","RankingLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("GameData"),h=i("PublicConst"),u=i("DataUtils"),d=i("MainLogic"),p=i("AdServer"),f=i("SoundManager"),y=cc._decorator,m=y.ccclass,g=y.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankingItemPrefab=null,e.worldOrFriend=1,e.combatOrTower=1,e.worldCombatScripts=new Array,e.worldTowerScripts=new Array,e.worldCombatScript=null,e.worldTowerScript=null,e.isWxAuth=!1,e.onceShowNum=10,e.requestRankTime=0,e}return r(e,t),e.prototype.init=function(t,e,a){void 0===a&&(a=!1),this.worldNode=cc.find("Layer/World",this.node),this.worldCombatNode=cc.find("Layer/World/Combat",this.node),this.worldTowerNode=cc.find("Layer/World/Tower",this.node),this.worldCombatList=cc.find("Layer/World/Combat/List",this.node).getComponent(cc.ScrollView),this.worldTowerList=cc.find("Layer/World/Tower/List",this.node).getComponent(cc.ScrollView),this.worldCombatMyNode=cc.find("Layer/World/Combat/My",this.node),this.worldTowerMyNode=cc.find("Layer/World/Tower/My",this.node),this.friendNode=cc.find("Layer/Friend",this.node),this.isWxAuth=l.default.Instance.playerData.isWxAuth,this.nums=u.default.sortListByIndex(50),this.requestRankTime=(new Date).getTime(),this.review(t,e,a);var n=cc.find("Layer/Btn2/toggle2",this.node);h.default.Platform==c.PLAT_FORM.Wx?n.active=!0:n.active=!1},e.prototype.initList1=function(){if(!(this.worldCombatList.content.childrenCount>0)){var t=[];if(null!=t){var e=t.own;e.user_detail=JSON.stringify(l.default.Instance.playerData);for(var a=0;a<this.onceShowNum&&!(a>t.rank.length);a++){var n,i,o=t.rank[a];null!=o&&((i=(n=cc.instantiate(this.rankingItemPrefab)).getComponent("RankingItem")).init(1,1,a+1,o),this.worldCombatList.content.addChild(n),this.worldCombatScripts.push(i))}this.worldCombatList.node.on("scrolling",this.loadList1,this),null!=e&&((i=(n=cc.instantiate(this.rankingItemPrefab)).getComponent("RankingItem")).init(2,1,e.rank,e),this.worldCombatMyNode.addChild(n),this.worldCombatScript=i)}}},e.prototype.loadList1=function(){console.log("\u6ed1\u5230\u5e95\u90e8\uff0c\u518d\u52a0\u8f7d\u4e00\u6b21");var t=[];if(null!=t)for(var e=this.worldCombatList.content.childrenCount,a=0;a<this.onceShowNum&&!(a+e>=t.rank.length);a++){var n=t.rank[a+e];if(null!=n){var i=cc.instantiate(this.rankingItemPrefab),o=i.getComponent("RankingItem");o.init(1,1,a+1+e,n),this.worldCombatList.content.addChild(i),this.worldCombatScripts.push(o)}}},e.prototype.initList2=function(){if(!(this.worldTowerList.content.childrenCount>0)){var t=[];if(null!=t){var e=t.own;e.user_detail=JSON.stringify(l.default.Instance.playerData);for(var a=0;a<this.onceShowNum&&!(a>t.rank.length);a++){var n,i,o=t.rank[a];null!=o&&((i=(n=cc.instantiate(this.rankingItemPrefab)).getComponent("RankingItem")).init(1,2,a+1,o),this.worldTowerList.content.addChild(n),this.worldTowerScripts.push(i))}this.worldTowerList.node.on("scroll-to-bottom",this.loadList2,this),null!=e&&((i=(n=cc.instantiate(this.rankingItemPrefab)).getComponent("RankingItem")).init(2,2,e.rank,e),this.worldTowerMyNode.addChild(n),this.worldTowerScript=i)}}},e.prototype.loadList2=function(){console.log("\u6ed1\u5230\u5e95\u90e8\uff0c\u518d\u52a0\u8f7d\u4e00\u6b21");var t=[];if(null!=t)for(var e=this.worldTowerList.content.childrenCount,a=0;a<this.onceShowNum&&!(a+e>=t.rank.length);a++){var n=t.rank[a+e];if(null!=n){var i=cc.instantiate(this.rankingItemPrefab),o=i.getComponent("RankingItem");o.init(1,2,a+1+e,n),this.worldTowerList.content.addChild(i),this.worldTowerScripts.push(o)}}},e.prototype.review=function(t,e,a){var n=this;void 0===a&&(a=!1),this.node.active=!0,this.worldOrFriend=t,this.combatOrTower=e,2==this.worldOrFriend?(this.worldNode.active=!1,this.friendNode.active=!0,this.combatOrTower):(this.worldNode.active=!0,this.friendNode.active=!1,1==this.combatOrTower?(this.initList1(),this.worldCombatNode.active=!0,this.worldTowerNode.active=!1):(this.initList2(),this.worldCombatNode.active=!1,this.worldTowerNode.active=!0)),h.default.Platform==c.PLAT_FORM.Wx||h.default.Platform==c.PLAT_FORM.QQ?this.isWxAuth||this.wxSettingStep1():l.default.Instance.playerData.isWxAuth,a&&this.scheduleOnce(function(){for(var t=1;t<=2;t++)cc.find("Layer/Btn1/toggle"+t,n.node).getComponent(cc.Toggle).isChecked=n.combatOrTower==t,cc.find("Layer/Btn2/toggle"+t,n.node).getComponent(cc.Toggle).isChecked=n.worldOrFriend==t},0),d.default.Instance.roleLogic.getCombatAtk(l.default.Instance.playerData.roleId,1),l.default.Instance.playerData.maxTowerLayerCount,l.default.Instance.playerData.tgTowerTime},e.prototype.updateWorldCombatList=function(){if(console.log(" update world combat list "),this.worldCombatScripts.length>0){console.log(" update world combat list ");var t=[];if(null==t)return;for(var e=10*Math.ceil(this.worldCombatScripts.length/10),a=t.own,n=0;n<e&&!(n>t.rank.length);n++){var i=t.rank[n];if(null!=i){var o=this.worldCombatScripts[n];if(null!=o)o.init(1,1,n+1,i);else{var r=cc.instantiate(this.rankingItemPrefab),s=r.getComponent("RankingItem");s.init(1,1,n+1,i),this.worldCombatList.content.addChild(r),this.worldCombatScripts.push(s)}}}null!=a&&(a.user_detail=JSON.stringify(l.default.Instance.playerData),this.worldCombatScript.init(2,1,a.rank,a))}},e.prototype.updateWorldTowerList=function(){if(console.log(" update world tower list "),this.worldTowerScripts.length>0){console.log(" update world tower list ");var t=[];if(null==t)return;for(var e=10*Math.ceil(this.worldTowerScripts.length/10),a=t.own,n=0;n<e&&!(n>t.rank.length);n++){var i=t.rank[n];if(null!=i){var o=this.worldTowerScripts[n];if(null!=o)o.init(1,2,n+1,i);else{var r=cc.instantiate(this.rankingItemPrefab),s=r.getComponent("RankingItem");s.init(1,2,n+1,i),this.worldCombatList.content.addChild(r),this.worldTowerScripts.push(s)}}}null!=a&&(a.user_detail=JSON.stringify(l.default.Instance.playerData),this.worldTowerScript.init(2,2,a.rank,a))}},e.prototype.showHeadImg=function(){null!=this.worldCombatScript&&this.worldCombatScript.show(),null!=this.worldTowerScript&&this.worldTowerScript.show()},e.prototype.wxSettingStep1=function(){console.log("\u5fae\u4fe1\u6388\u67431"),p.default.Instance.getSetting(this,this.wxSettingStep1Callback)},e.prototype.wxSettingStep1Callback=function(t){0==t?(console.log("\u5fae\u4fe1\u6388\u67431\u8fd4\u56de\u6210\u529f"),this.wxSettingStep3()):(console.log("\u5fae\u4fe1\u6388\u67431\u8fd4\u56de\u5931\u8d25"),this.wxSettingStep2())},e.prototype.wxSettingStep2=function(){console.log("\u5fae\u4fe1\u6388\u67432"),p.default.Instance.openSetting(this,this.wxSettingStep2Callback)},e.prototype.wxSettingStep2Callback=function(t){0==t?(this.wxSettingStep3(),console.log("\u5fae\u4fe1\u6388\u67432\u8fd4\u56de\u6210\u529f")):console.log("\u5fae\u4fe1\u6388\u67432\u8fd4\u56de\u5931\u8d25")},e.prototype.wxSettingStep3=function(){console.log("\u5fae\u4fe1\u6388\u67433"),p.default.Instance.createUserInfoButton(this,this.wxSettingStep3Callback)},e.prototype.wxSettingStep3Callback=function(t,e){if(0==t){console.log("\u5fae\u4fe1\u6388\u67433\u8fd4\u56de\u6210\u529f"),this.isWxAuth=!0,l.default.Instance.playerData.isWxAuth=!0;var a=e[0],n=e[1];console.log("nickName:"+a+",avatarUrl:"+n),l.default.Instance.playerData.nickName=a,l.default.Instance.playerData.headImg=n,this.showHeadImg()}},e.prototype.pointInBtn=function(t,e,a){var n=cc.find(t,this.node),i=n.convertToWorldSpaceAR(cc.v2(0,0)),o=i.x-n.width/2,r=i.x+n.width/2,s=720-i.y-n.height/2,c=720-i.y+n.height/2;return e>=o&&e<=r&&a>=s&&a<=c},e.prototype.onClickEvent=function(t,e){f.SoundManager.Instance.playEffect("anniu"),0==e?(this.node.active=!1,d.default.Instance.combatScene.homeLayer.showBanner(),p.default.Instance.hideUserInfoBtn()):1==e?(this.worldOrFriend=1,this.review(this.worldOrFriend,this.combatOrTower)):2==e?(this.worldOrFriend=2,this.review(this.worldOrFriend,this.combatOrTower)):10==e?(this.combatOrTower=1,this.review(this.worldOrFriend,this.combatOrTower)):11==e&&(this.combatOrTower=2,this.review(this.worldOrFriend,this.combatOrTower))},s([g(cc.Prefab)],e.prototype,"rankingItemPrefab",void 0),s([m],e)}(cc.Component);o.default=I,cc._RF.pop()},{}],RectCircle:[function(t,e,a){"use strict";cc._RF.push(e,"20a091EAMBHWLDyjqQwn5ER","RectCircle");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return t.newRect=function(t,e,a){return new cc.Rect(t.x-e/2,t.y-a/2,e,a)},t.newCircle=function(t,e){var a=new cc.Collider.Circle;return a.offset=t,a.radius=e,a},t.collide=function(e,a,n){var i,o,r=Math.cos(a)*(n.offset.x-e.center.x)+Math.sin(a)*(n.offset.y-e.center.y)+e.center.x,s=Math.sin(a)*(n.offset.x-e.center.x)-Math.cos(a)*(n.offset.y-e.center.y)+e.center.y;return i=r<e.x?e.x:r>e.x+e.width?e.x+e.width:r,o=s<e.y?e.y:s>e.y+e.height?e.y+e.height:s,t.findDistance(r,s,i,o)<n.radius},t.rectCollideRect=function(e,a,n,i){var o=t.rotateRect(e,a),r=t.rectXYToWorld(e,a),s=t.rotateRect(n,i),c=t.rectXYToWorld(n,i);return!!(t.detectAxisCollision(r[0],s)&&t.detectAxisCollision(r[1],s)&&t.detectAxisCollision(c[0],o)&&t.detectAxisCollision(c[1],o))},t.findDistance=function(t,e,a,n){var i=Math.abs(t-a),o=Math.abs(e-n);return Math.sqrt(i*i+o*o)},t.rotateRect=function(t,e){var a=[],n=t.center.x,i=t.center.y,o=n-t.width/2,r=i-t.height/2,s=(o-n)*Math.cos(e)-(r-i)*Math.sin(e)+n,c=(o-n)*Math.sin(e)+(r-i)*Math.cos(e)+i;a.push(cc.v2(s,c));var l=n-t.width/2,h=i+t.height/2,u=(l-n)*Math.cos(e)-(h-i)*Math.sin(e)+n,d=(l-n)*Math.sin(e)+(h-i)*Math.cos(e)+i;a.push(cc.v2(u,d));var p=n+t.width/2,f=i+t.height/2,y=(p-n)*Math.cos(e)-(f-i)*Math.sin(e)+n,m=(p-n)*Math.sin(e)+(f-i)*Math.cos(e)+i;a.push(cc.v2(y,m));var g=n+t.width/2,I=i-t.height/2,_=(g-n)*Math.cos(e)-(I-i)*Math.sin(e)+n,v=(g-n)*Math.sin(e)+(I-i)*Math.cos(e)+i;return a.push(cc.v2(_,v)),a},t.rectXYToWorld=function(t,e){var a=[],n=t.center.x,i=t.center.y,o=n-t.width/2,r=i,s=(o-n)*Math.cos(e)-(r-i)*Math.sin(e)+n,c=(o-n)*Math.sin(e)+(r-i)*Math.cos(e)+i,l=n+t.width/2,h=i,u=(l-n)*Math.cos(e)-(h-i)*Math.sin(e)+n,d=(l-n)*Math.sin(e)+(h-i)*Math.cos(e)+i;a.push([cc.v2(s,c),cc.v2(u,d)]);var p=n,f=i-t.height/2,y=(p-n)*Math.cos(e)-(f-i)*Math.sin(e)+n,m=(p-n)*Math.sin(e)+(f-i)*Math.cos(e)+i,g=n,I=i+t.height/2,_=(g-n)*Math.cos(e)-(I-i)*Math.sin(e)+n,v=(g-n)*Math.sin(e)+(I-i)*Math.cos(e)+i;return a.push([cc.v2(y,m),cc.v2(_,v)]),a},t.detectAxisCollision=function(e,a){var n=[];if(e[0].x==e[1].x)for(var i=0;i<a.length;++i){var o=a[i],r=e[1].x,s=o.y;n.push(cc.v2(r,s))}else if(e[0].y==e[1].y)for(i=0;i<a.length;++i)r=(o=a[i]).x,s=e[1].y,n.push(cc.v2(r,s));else{var c=(e[1].y-e[0].y)/(e[1].x-e[0].x),l=(e[0].y,e[0].x,-1/c);for(i=0;i<a.length;++i)o=a[i],r=(e[1].y-o.y+l*o.x-c*e[1].x)/(l-c),s=o.y-l*(o.x-r),n.push(cc.v2(r,s))}for(i=0;i<n.length;++i){var h,u=i;if(h=i==n.length-1?0:i+1,t.isLineOverlap(e[0],e[1],n[u],n[h]))return!0}return!1},t.isLineOverlap=function(t,e,a,n){var i=t.x<e.x?t.x:e.x,o=t.x<e.x?e.x:t.x,r=t.y<e.y?t.y:e.y,s=t.y<e.y?e.y:t.y,c=a.x<n.x?a.x:n.x,l=a.x<n.x?n.x:a.x,h=a.y<n.y?a.y:n.y,u=a.y<n.y?n.y:a.y;return i>c&&i<l||i<c&&l<o||o<l&&o>c||c>i&&c<o||c<i&&o<l||l<o&&l>i||r>h&&r<u||r<h&&u<s||s<u&&s>h||h>r&&h<s||h<r&&s<u||u<s&&u>r},t.dotInRect=function(t,e){return e.contains(t)},t}();n.default=i,cc._RF.pop()},{}],ResolveLayer:[function(t,e,a){"use strict";cc._RF.push(e,"83000TPoP5PWYTPoYQvjRrK","ResolveLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicEnum"),h=i("SoundManager"),u=i("ConfigData"),d=i("GameData"),p=i("MainLogic"),f=i("TaskLogic"),y=i("KnapsackItem"),m=cc._decorator,g=m.ccclass,I=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.knapsackPrefab=null,e.knapsackList=new Array,e.pzToggle=new Array,e}return r(e,t),e.prototype.init=function(){this.equipmentList=cc.find("EquipmentList",this.node).getComponent(cc.ScrollView);for(var t=1;t<5;++t){var e=cc.find("PingZhi/Pz"+t,this.node);this.pzToggle.push(e.getComponent(cc.Toggle))}},e.prototype.review=function(){this.node.active=!0;for(var t=0;t<this.pzToggle.length;++t)this.pzToggle[t].isChecked=!1;var e=d.default.Instance.playerData.equipmentList,a=d.default.Instance.playerData.equipmentGridCount-this.equipmentList.content.childrenCount;for(t=0;t<a;++t){var n=cc.instantiate(this.knapsackPrefab);this.equipmentList.content.addChild(n),(o=n.getComponent(y.default)).init(this,0,0,0),this.knapsackList.push(o)}for(t=0;t<this.knapsackList.length;++t)this.knapsackList[t].review(this,0,0,0);var i=0;for(t=0;t<e.length;++t){var o,r=e[t];0==r.equipState&&0==r.lockState&&((o=this.knapsackList[i]).review(this,3,r.equipmentId,r.equipmentIndex),i+=1)}},e.prototype.hideInfoNode=function(){},e.prototype.selecteItemByPz=function(t,e){for(var a=0;a<this.knapsackList.length;++a)3==this.knapsackList[a].itemType&&u.default.Instance.equipmentMap.get(this.knapsackList[a].itemId).quality==t&&this.knapsackList[a].showSelecteNode(t,e,!0)},e.prototype.resolveEquipment=function(){for(var t=[],e=0,a=0;a<this.knapsackList.length;++a)if(3==this.knapsackList[a].itemType&&this.knapsackList[a].selecteNode.active){e+=1;var n=p.default.Instance.equipmentLogic.getEquipmentData(this.knapsackList[a].itemIndex);if(null==n)continue;var i=0==n.strengthLevel?1:n.strengthLevel,o=u.default.Instance.equipmentGrowMap.get(i).costValue,r=p.default.Instance.equipmentLogic.resolveEquipmentReward(o,n.equipmentIndex);p.default.Instance.equipmentLogic.removeEquipmentData(this.knapsackList[a].itemIndex);for(var s=0;s<r.length;++s){for(var c=!1,h=0;h<t.length;++h)t[h][0]==r[s][0]&&(c=!0,t[h][1]+=r[s][1]);c||t.push([r[s][0],r[s][1]])}}if(t.length>0){p.default.Instance.taskLogic.finishAllTask(f.default.type_resolve_equipment_count,0,e);var d={itemList:t};p.default.Instance.combatScene.popLayer.reviewRewardLayer(l.PAGE_NAME.Equipment,2,d,!0)}},e.prototype.onClickEvent=function(t,e){h.SoundManager.Instance.playEffect("anniu"),1==e?(this.node.active=!1,c.default.Instance.hideCustomAd(1)):2==e?this.resolveEquipment():3==e?this.selecteItemByPz(1,this.pzToggle[0].isChecked):4==e?this.selecteItemByPz(2,this.pzToggle[1].isChecked):5==e?this.selecteItemByPz(3,this.pzToggle[2].isChecked):6==e&&this.selecteItemByPz(4,this.pzToggle[3].isChecked)},s([I(cc.Prefab)],e.prototype,"knapsackPrefab",void 0),s([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{}],ResourceInfo:[function(t,e,a){"use strict";cc._RF.push(e,"21285BnvRxHqqV8o6eIFyrh","ResourceInfo");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.id=parseInt(t.id),this.effect_name=t.effect_name,this.resource_way=t.resource_way,this.scale=parseFloat(t.scale)},cc._RF.pop()},{}],ResultCardItem:[function(t,e,a){"use strict";cc._RF.push(e,"bb7ccoSo3hJ8rZkBBoWFRHz","ResultCardItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("MainLogic"),m=i("TaskLogic"),g=cc._decorator,I=g.ccclass,_=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coinNum=0,e.isAd=0,e.isOpne=!1,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.resultLayer=t,this.bgNode=cc.find("Bg",this.node),this.rewardNode=cc.find("Reward",this.node),this.itemBgNode=cc.find("common_suitu_07",this.rewardNode),this.itemNode=cc.find("Reward/Item",this.node),this.countNode=cc.find("Reward/Count",this.node),this.coinNumNode=cc.find("Reward/Coin/Num",this.node),this.adTip=cc.find("Bg/AdTip",this.node),this.coinTip=cc.find("Bg/CoinTip",this.node)},e.prototype.review=function(t,e,a){var n,i,o=this;this.coinNum=e,this.bgNode.scaleX=1,this.isOpne=!1,this.isAd=t,this.reward=a,this.adTip.active=2==t,this.coinTip.active=1==t,this.rewardNode.scaleX=0,this.coinTip.active&&(cc.find("Num",this.coinTip).getComponent(cc.Label).string=2*e+"\u91d1\u5e01"),1==this.reward[2]?(n=d.default.Instance.equipmentMap.get(this.reward[0]),this.countNode.getComponent(cc.Label).string=n.name):(n=d.default.Instance.itemMap.get(this.reward[0]),this.countNode.getComponent(cc.Label).string="x"+this.reward[1]),i=n.quality,this.coinNumNode.getComponent(cc.Label).string="x"+this.coinNum+"\u91d1\u5e01",f.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+n.icon,function(){o.scheduleOnce(function(){o.itemNode.width>50&&(o.itemNode.scale=50/o.itemNode.width)},0)},this),this.scheduleOnce(function(){f.AssetUtils.loadSpriteFrame(o.itemBgNode,"Common/common_quality_"+i)},0)},e.prototype.flopCard=function(){var t=this;if(!this.isOpne){this.isOpne=!0,this.resultLayer.openCard(this.isAd),this.adTip.active=!1,this.coinTip.active=!1;var e=cc.sequence(cc.scaleTo(.2,0,1),cc.callFunc(function(){t.rewardNode.runAction(cc.sequence(cc.scaleTo(.2,1,1),cc.callFunc(t.rewardAction,t)))}));this.bgNode.runAction(e)}},e.prototype.rewardAction=function(){var t=new Array;t.push(this.reward),t.push([1001,this.coinNum,2]),y.default.Instance.chapterLogic.receiveCombatBox(t)},e.prototype.onClickEvent=function(){u.SoundManager.Instance.playEffect("anniu"),this.resultLayer.clickGuid(),!y.default.Instance.combatLayer.popEquipmentGridTip&&(y.default.Instance.combatLayer.popEquipmentGridTip=!0,p.default.Instance.playerData.equipmentGridCount-y.default.Instance.roleLogic.getUnEquipmentCount()<=0)?y.default.Instance.combatScene.popLayer.reviewGamePauseLayer(h.PAGE_NAME.CombatResult,3):this.isOpne||(1==this.isAd?y.default.Instance.moneyLogic.getItemCount(1001)>=2*this.coinNum?(y.default.Instance.moneyLogic.addItemCount(1001,2*-this.coinNum),this.flopCard()):y.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.CombatResult,1,!0):2==this.isAd?c.default.Instance.adHandler(c.default.AD_COMBAT_RESULT_FLOP_CARD,this,this.adCallback):this.flopCard())},e.prototype.adCallback=function(t,e,a){0==e?(this.flopCard(),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||y.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)):-1==e?(y.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(this.shareType=c.default.SHARE_COMBAT_RESULT_FLOP_CARD,l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):y.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else y.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([I],e)}(cc.Component));o.default=_,cc._RF.pop()},{}],RevivedLayer:[function(t,e,a){"use strict";cc._RF.push(e,"fb99bS0DfVPN4x55uZClw8N","RevivedLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("MainLogic"),h=i("AdServer"),u=i("GameData"),d=i("PublicEnum"),p=i("SoundManager"),f=i("TaskLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inAd=!1,e.shareType=0,e}return r(e,t),e.prototype.init=function(){this.yesNode=cc.find("ADBtn1",this.node),this.revivedCount=cc.find("Count",this.yesNode),this.review()},e.prototype.review=function(){this.node.active=!0,this.inAd=!1,l.default.Instance.combatLayer.uiLayer.pauseAndResume(!0,!0),this.node.stopAllActions(),this.revivedCount.getComponent(cc.Label).string="\u590d\u6d3b\u5269\u4f59\u6b21\u6570\uff1a"+l.default.Instance.combatLayer.revivedCount,this.yesNode.getComponent(cc.Button).interactable=l.default.Instance.combatLayer.revivedCount>0,this.scheduleOnce(function(){h.default.Instance.showCustomAd(2)},0)},e.prototype.clickEvent=function(t,e){if(p.SoundManager.Instance.playEffect("anniu"),0==e)l.default.Instance.combatLayer.uiLayer.pauseAndResume(!1,!0),this.node.active=!1,l.default.Instance.combatLayer.isRevive=!1,l.default.Instance.mainLayer.myHeroSprite.cancelRevived(),l.default.Instance.actionTagLogic.closeEvent(2),h.default.Instance.hideCustomAd(2);else if(2==e){if(l.default.Instance.moneyLogic.getItemCount(1002)<1)return void l.default.Instance.combatScene.popLayer.reviewMoneyMorePage(d.PAGE_NAME.Revived,2,!0);l.default.Instance.actionTagLogic.diamondCostEvent(2),l.default.Instance.moneyLogic.addItemCount(1002,-1),l.default.Instance.combatLayer.uiLayer.pauseAndResume(!1,!0),this.node.active=!1,l.default.Instance.combatLayer.isRevive=!1,l.default.Instance.mainLayer.myHeroSprite.revived(),l.default.Instance.combatLayer.uiLayer.resetGameTime(),h.default.Instance.hideCustomAd(2)}else 1==e&&(h.default.Instance.adHandler(h.default.AD_TYPE_REVIVED,this,this.adCallback),this.inAd=!0)},e.prototype.adCallback=function(t,e,a){this.inAd=!1,0==e?(l.default.Instance.combatLayer.uiLayer.pauseAndResume(!1,!0),this.node.active=!1,l.default.Instance.combatLayer.isRevive=!1,l.default.Instance.mainLayer.myHeroSprite.revived(),l.default.Instance.combatLayer.revivedCount-=1,l.default.Instance.combatLayer.uiLayer.resetGameTime(),h.default.Instance.hideCustomAd(2),0!=u.default.Instance.playerData.cdActiveFreeAd&&a||l.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1)):-1==e?(l.default.Instance.combatScene.showMsgInfo(c.default.NO_AD),h.default.Instance.noVideoToShare()&&(this.shareType=h.default.SHARE_TYPE_REVIVED,c.default.Platform==d.PLAT_FORM.Douyin?h.default.Instance.shareAppCallBack(this,this.shareAppCallback2):l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),h.default.Instance.shareApp())):l.default.Instance.combatScene.showMsgInfo(c.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(u.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");u.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),h.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else l.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-h.default.Instance.adServer.shareDateTime)/1e3);if(h.default.Instance.shareState(e)){if(!(u.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");u.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),h.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else h.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),h.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],RewardEffectSprite:[function(t,e,a){"use strict";cc._RF.push(e,"61a84YVQU9Fa4n5mfg+F6lV","RewardEffectSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("ConfigData"),h=i("AssetUtils"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.rewardType=e,this.itemId=t,this.imgNode=cc.find("Bg/Img",this.node),this.nameNode=cc.find("Bg/Name",this.node),this.numNode=cc.find("Bg/Num",this.node),this.framentNode=cc.find("Bg/Img/Fragment",this.node),this.framentNode.active=!1,1==e?this.itemInfo=l.default.Instance.equipmentMap.get(this.itemId):(this.itemInfo=l.default.Instance.itemMap.get(this.itemId),this.framentNode.active=1==this.itemInfo.is_chip),null==this.itemInfo?console.log(" \u6ca1\u627e\u5230\u88c5\u5907\u6216\u9053\u5177 "+this.itemId):(h.AssetUtils.loadSpriteFrame(this.imgNode,"Common/"+this.itemInfo.icon),this.nameNode.getComponent(cc.Label).string=this.itemInfo.name,this.nameNode.color=c.Quality_COLOR[this.itemInfo.quality])},e.prototype.resetData=function(t,e){var a=this;this.node.active=!0,this.num=t,this.node.y=0,this.node.opacity=0,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(.5*e),cc.fadeIn(.1),cc.moveTo(.8,cc.v2(0,120)),cc.delayTime(.2),cc.fadeOut(.1),cc.moveTo(.1,cc.v2(0,0)))),this.numNode.getComponent(cc.Label).string="x"+t,this.node.runAction(cc.sequence(cc.delayTime(.5*e+2),cc.callFunc(function(){a.delete()},this)))},e.prototype.delete=function(){u.default.Instance.sceneNodeManager.putRewardEffectSpriet(this)},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],RewardItem:[function(t,e,a){"use strict";cc._RF.push(e,"b65e0rXWG5Jq6QGROavyttL","RewardItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("ConfigData"),h=i("PublicEnum"),u=i("SoundManager"),d=i("StringUtils"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e){this.contextNode=cc.find("Context",this.node),this.bgNode=cc.find("Context/Bg",this.node),this.imgNode=cc.find("Context/Img",this.node),this.numNode=cc.find("Context/Nums/Num",this.node),this.nameNode=cc.find("Context/Name",this.node),this.IsAdNode=cc.find("Context/IsAd",this.node),this.EffectNode=cc.find("Context/Effect",this.node),this.ccNode=cc.find("Context/CC",this.node),this.levelNode=cc.find("Context/Level/Level",this.node),this.framentNode=cc.find("Context/Img/Fragment",this.node),this.framentNode.active=!1,this.type=t[0],this.id=t[1],this.num=t[2],1==this.type?(this.itemInfo=l.default.Instance.equipmentMap.get(this.id),this.itemInfo&&(this.ccNode.active=5==this.itemInfo.type)):(this.itemInfo=l.default.Instance.itemMap.get(this.id),this.ccNode.active=!1,this.framentNode.active=1==this.itemInfo.is_chip),null==this.itemInfo&&console.log(" \u6ca1\u627e\u5230\u88c5\u5907\u6216\u9053\u5177 "+this.id),this.IsAdNode.active=!!e;var a=this.itemInfo.quality;c.AssetUtils.loadSpriteFrame(this.bgNode,"Common/common_quality_"+a),c.AssetUtils.loadSpriteFrame(this.imgNode,"Common/"+this.itemInfo.icon,function(){},this),this.nameNode.active=!0,this.nameNode.getComponent(cc.Label).string=this.itemInfo.name},e.prototype.resetData=function(t,e,a,n,i,o,r){var s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===o&&(o=!0),void 0===r&&(r=!0),this.num=t,this.node.active=!0,this.node.x=0,this.node.y=0,this.IsAdNode.active=!!a,this.node.stopAllActions(),this.contextNode.opacity=0,this.setMark(1);var c=cc.find("Context/Mark",this.node);c.active=!1,null==n||n?null==i||i?this.node.runAction(cc.sequence(cc.delayTime(.1*e),cc.callFunc(function(){u.SoundManager.Instance.playEffect("huodedaoju")},this),cc.delayTime(.1),cc.callFunc(function(){c.active=!0,s.contextNode.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1.3),cc.fadeIn(.1)),cc.scaleTo(.1,1)))},this))):this.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.callFunc(function(){c.active=!0,s.contextNode.runAction(cc.sequence(cc.spawn(cc.scaleTo(.1,1.3),cc.fadeIn(.1)),cc.scaleTo(.1,1)))},this))):this.contextNode.opacity=255,this.numNode.getComponent(cc.Label).string="x"+d.default.stringToWord(this.num),this.numNode.active=this.num>0,this.nameNode.color=h.Quality_COLOR[this.itemInfo.quality-1],this.nameNode.active=o,r?(this.levelNode.active=!0,this.levelNode.getComponent(cc.Label).string="lv."+this.itemInfo.equip_lvl,this.levelNode.color=h.Quality_COLOR[this.itemInfo.quality-1]):this.levelNode.active=!1},e.prototype.setMark=function(t){for(var e=cc.find("Context/Mark",this.node),a=1;a<10;a++){var n=cc.find("M"+a,e);null!=n&&(n.active=a==t)}},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],RewardLayer:[function(t,e,a){"use strict";cc._RF.push(e,"626410qvuBJsY2vmOpdFSHf","RewardLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("MainLogic"),h=i("AdServer"),u=i("GameData"),d=i("PublicEnum"),p=i("SoundManager"),f=i("TaskLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItemList=new Array,e.hideBanner=!1,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e,a,n){this.pageType=e,this.data=a,this.itemList=cc.find("Context/Items",this.node).getComponent(cc.ScrollView),this.itemList2=cc.find("Context/Items2",this.node).getComponent(cc.ScrollView),this.review(t,e,a,n)},e.prototype.review=function(t,e,a,n){this.node.active=!0,this.pageType=e,this.pageName=t,this.hideBanner=n,this.data=a;for(var i=1;i<=20;i++){var o=cc.find("Context/Page"+i,this.node);null!=o&&(o.active=i==e)}for(i=0;i<this.rewardItemList.length;i++){var r=this.rewardItemList[i];l.default.Instance.sceneNodeManager.putRewardItem(r)}if(this.rewardItemList.splice(0,this.rewardItemList.length),2==e||5==e||6==e||7==e||8==e||12==e||13==e){this.itemList.node.active=!0,this.itemList2.node.active=!1;var s=this.data.itemList;for(i=0;i<s.length;i++){var c=s[i];r=l.default.Instance.sceneNodeManager.getRewardItem(c[0],c[1],2,i,!1,!0,!0,!0,!1),this.rewardItemList.push(r),this.itemList.content.addChild(r.node)}var u=Math.min(500,130*s.length);this.itemList.node.width=u,2==e&&l.default.Instance.chapterLogic.receiveCombatBox(s)}else if(11==e){for(this.itemList.node.active=!1,this.itemList2.node.active=!0,s=this.data.itemList,i=0;i<s.length;i++)c=s[i],r=l.default.Instance.sceneNodeManager.getRewardItem(c[0],c[1],c[2],i,!1,!0,!0,!0,!1),this.rewardItemList.push(r),this.itemList2.content.addChild(r.node);l.default.Instance.giftBagLoigc.receiveGiftItems(s,1,!1)}h.default.Instance.showBannerAd()},e.prototype.nextStepShowAd=function(){switch(this.pageName){case d.PAGE_NAME.Home:case d.PAGE_NAME.ShakeJar:case d.PAGE_NAME.Endless:case d.PAGE_NAME.Equipment:case d.PAGE_NAME.Shop:h.default.Instance.hideCustomAd(1),h.default.Instance.hideCustomAd(2);break;case d.PAGE_NAME.ChapterStart:case d.PAGE_NAME.Task:case d.PAGE_NAME.Revived:break;case d.PAGE_NAME.Skill:case d.PAGE_NAME.Strengthen:case d.PAGE_NAME.Chapter:h.default.Instance.hideCustomAd(2);break;case d.PAGE_NAME.Combat:case d.PAGE_NAME.CombatResult:}},e.prototype.onClickEvent=function(t,e){if(p.SoundManager.Instance.playEffect("anniu"),101==e);else if(201==e)h.default.Instance.adHandler(h.default.AD_TYPE_RESOLVE_REWQRD_DOUBLE,this,this.adCallback);else if(202==e)this.node.active=!1,this.nextStepShowAd(),l.default.Instance.combatScene.popLayer.equipmentLayer.resolveSucc();else if(301==e);else if(302==e)this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),l.default.Instance.combatScene.homeLayer.showBanner(),this.nextStepShowAd();else if(401==e);else if(501==e){this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),l.default.Instance.combatScene.homeLayer.showBanner();var a=this.data.itemList;l.default.Instance.chapterLogic.receiveCombatBox(a),this.nextStepShowAd()}else if(601==e);else if(701==e)a=this.data.itemList,l.default.Instance.chapterLogic.receiveCombatBox(a),u.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),this.node.active=!1,this.nextStepShowAd();else if(801==e)a=this.data.itemList,l.default.Instance.chapterLogic.receiveCombatBox(a),u.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),l.default.Instance.combatScene.homeLayer.review(),this.nextStepShowAd();else if(901==e){var n=this.data.index,i=this.data.giftInfo;l.default.Instance.chapterLogic.receiveCombatBox(i.itemList),u.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),this.nextStepShowAd()}else 1001==e?(n=this.data.index,i=this.data.giftInfo,console.log("reward index:"+n),l.default.Instance.chapterLogic.receiveCombatBox(i.itemList),u.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),this.nextStepShowAd()):1101==e?(this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),this.nextStepShowAd(),l.default.Instance.combatScene.popLayer.shakeJarLayer&&l.default.Instance.combatScene.popLayer.shakeJarLayer.node.active&&l.default.Instance.combatScene.popLayer.shakeJarLayer.guideAction()):1201==e?(this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),a=this.data.itemList,l.default.Instance.giftBagLoigc.receiveGiftItems(a,1),this.nextStepShowAd()):1301==e&&(this.node.active=!1,this.nextStepShowAd(),this.hideBanner&&h.default.Instance.hideBannerAd())},e.prototype.adCallback=function(t,e,a){if(l.default.Instance.combatScene.popLayer.pointGuideFinish(),0==e){if(this.nextStepShowAd(),t==h.default.AD_TYPE_RESOLVE_REWQRD_DOUBLE||t==h.default.SHARE_TYPE_RESOLVE_REWQRD_DOUBLE){var n=this.data.itemList;l.default.Instance.chapterLogic.receiveCombatBox(n),l.default.Instance.combatScene.popLayer.equipmentLayer.resolveSucc()}this.node.active=!1,this.hideBanner&&h.default.Instance.hideBannerAd(),l.default.Instance.combatScene.homeLayer.showBanner(),0!=u.default.Instance.playerData.cdActiveFreeAd&&a||l.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1)}else-1==e?(l.default.Instance.combatScene.showMsgInfo(c.default.NO_AD),h.default.Instance.noVideoToShare()&&(t==h.default.AD_TYPE_RESOLVE_REWQRD_DOUBLE&&(this.shareType=h.default.SHARE_TYPE_RESOLVE_REWQRD_DOUBLE),c.default.Platform==d.PLAT_FORM.Douyin?h.default.Instance.shareAppCallBack(this,this.shareAppCallback2):l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),h.default.Instance.shareApp())):l.default.Instance.combatScene.showMsgInfo(c.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(u.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");u.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),h.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else l.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-h.default.Instance.adServer.shareDateTime)/1e3);if(h.default.Instance.shareState(e)){if(!(u.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");u.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(c.default.SUCCESS_SHARE,1),h.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else h.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),h.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],RewardTip:[function(t,e,a){"use strict";cc._RF.push(e,"beed85q4O5G7oVXvvlu97P2","RewardTip");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("ConfigData"),h=i("MainLogic"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,a){var n,i=this;1==e?(n=l.default.Instance.equipmentMap.get(t),this.getComponent(cc.Label).string="\u83b7\u5f97\uff1a"+n.name):(n=l.default.Instance.itemMap.get(t),this.getComponent(cc.Label).string="\u83b7\u5f97\uff1a"+a+n.name),this.node.color=c.Quality_COLOR[n.quality],this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){i.delete()},this)))},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this)},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this)},e.prototype.delete=function(){this.unscheduleAllCallbacks(),h.default.Instance.combatLayer.mainLayer.nodeManager.putRewardTip(this)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],RobotInfo:[function(t,e,a){"use strict";cc._RF.push(e,"13be2ytiEZI1q/g8Drz6ieu","RobotInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.difficulty_level=o.default.stringToInt(t.difficulty_level),this.normal_AI=t.normal_AI,this.rampage_AI=t.rampage_AI,this.trigger_condition=o.default.stringToInt(t.trigger_condition),this.trigger_key=o.default.stringToFloat(t.trigger_key),this.normalAiList=o.default.config_stringToIntListOfList(this.normal_AI),this.rampageAiList=o.default.config_stringToIntListOfList(this.rampage_AI)},cc._RF.pop()},{}],RockerLayer:[function(t,e,a){"use strict";cc._RF.push(e,"82c018yhTxFAqB8Ye8pXA8v","RockerLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("MainLogic"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.r1=152,e.r2=55,e.moveAngle=0,e}return r(e,t),e.prototype.onLoad=function(){this.rockerNode=cc.find("RockerNode",this.node),this.directionNode=cc.find("Direction",this.node),this.directionNode.active=!1,this.originalPosition=this.node.getPosition()},e.prototype.resetPoint=function(){this.node.x=this.originalPosition.x,this.node.y=this.originalPosition.y,this.rockerNode.x=0,this.rockerNode.y=0,this.directionNode.active=!1;var t=l.default.Instance.combatScene.combatLayer.mainLayer.myHeroSprite;null!=t&&t.heroStatus.isMove&&t.heroControl.handleControlEvent(c.CONTROL_EVENT.Control_Move_Cancel,0)},e.prototype.setPoint=function(t){this.node.x=t.x,this.node.y=t.y},e.prototype.touchMove=function(t){var e=t.sub(this.node.getPosition()).mag();null==this.lastTouchPositon&&(this.lastTouchPositon=t),t.y,this.lastTouchPositon.y,this.lastTouchPositon=t,this.moveAngle=Math.atan2(t.y-this.node.y,t.x-this.node.x),this.rockerNode.active=!0;var a=180*this.moveAngle/Math.PI-90;this.rockerNode.angle=a,this.rockerNode.x=Math.cos(this.moveAngle)*Math.min(e,this.r1-this.r2),this.rockerNode.y=Math.sin(this.moveAngle)*Math.min(e,this.r1-this.r2);var n=l.default.Instance.combatScene.combatLayer.mainLayer.myHeroSprite;if(null!=n){var i=180*this.moveAngle/Math.PI;n.heroControl.handleControlEvent(c.CONTROL_EVENT.Control_Move,i),this.directionNode.active=!0,this.directionNode.angle=i}},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],RoleAdTimesData:[function(t,e,a){"use strict";cc._RF.push(e,"5f1b7x2f8xN35ZmUzZdxmqu","RoleAdTimesData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.times=0,this.roleId=t,this.times=0},cc._RF.pop()},{}],RoleData:[function(t,e,a){"use strict";cc._RF.push(e,"b57daUmUb9KYJV30HnMSTEf","RoleData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.slotStatus=[0,0,0,0,0,0,0,0,0,0],this.equipmentList=[0,0,0,0,0,0],this.heroId=t,this.status=0,this.skillLevel=new Array(10).fill(0)},cc._RF.pop()},{}],RoleEquipData:[function(t,e,a){"use strict";cc._RF.push(e,"8ad118EdgdJ6p0MH1gNQD5n","RoleEquipData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.equipment=[0,0,0,0,0,0,0],this.roleId=t},cc._RF.pop()},{}],RoleGrowInfo:[function(t,e,a){"use strict";cc._RF.push(e,"e0866MyZuJHnauwlKimpLdi","RoleGrowInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.role_id=o.default.stringToInt(t.role_id),this.lvl=o.default.stringToInt(t.lvl),this.grow_value=o.default.stringToFloat(t.grow_value),this.cost_exp=o.default.stringToInt(t.cost_exp)},cc._RF.pop()},{}],RoleInfo:[function(t,e,a){"use strict";cc._RF.push(e,"ef40dPDJpdC4IPLA2qC8Ud9","RoleInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.abbr=t.abbr,this.tag=o.default.stringToInt(t.tag),this.type=o.default.stringToInt(t.type),this.picture_id=o.default.stringToInt(t.picture_id),this.is_boss=o.default.stringToInt(t.is_boss),this.is_beat=o.default.stringToInt(t.is_beat),this.is_fly=o.default.stringToInt(t.is_fly),this.AI=o.default.stringToInt(t.AI),this.atk=o.default.stringToFloat(t.atk),this.hp=o.default.stringToFloat(t.hp),this.extra_hp=o.default.stringToFloat(t.extra_hp),this.extra_atk=o.default.stringToFloat(t.extra_atk),this.def=o.default.stringToFloat(t.def),this.crit_rate=o.default.stringToFloat(t.crit_rate),this.crit_damage=o.default.stringToFloat(t.crit_damage),this.hit_rate=o.default.stringToFloat(t.hit_rate),this.agl=o.default.stringToFloat(t.agl),this.atk_speed=o.default.stringToFloat(t.atk_speed),this.move_speed=o.default.stringToInt(t.move_speed),this.res_id=t.res_id,this.sound=t.sound,this.dead_sound=t.dead_sound,this.skill_normal=t.skill_normal;var e=o.default.config_stringToIntList(this.skill_normal);this.skillPools=e||[],this.skill_passive1=o.default.stringToInt(t.skill_passive1),this.skill_passive2=o.default.stringToInt(t.skill_passive2),this.collide_area=t.collide_area,this.height=o.default.stringToInt(t.height),this.dialogue=t.dialogue,this.Grade=o.default.stringToInt(t.Grade),this.unlocked_tips=t.unlocked_tips;var a=o.default.config_stringToIntList(this.collide_area);this.bodyArea=new cc.Size(a[0],a[1])},cc._RF.pop()},{}],RoleLogic:[function(t,e,a){"use strict";cc._RF.push(e,"3cfd3gy2qNIg6HX3bvQwkrv","RoleLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("RoleData"),r=n("GameData"),s=n("ConfigData"),c=n("TaskLogic"),l=n("MainLogic"),h=n("BuffData"),u=n("AssetUtils"),d=n("PublicConst"),p=function(){function t(){this.roleArmConfig={"0_0":"role01_pifu1_tou1","30001_0":"role01_pifu1_tou2","30004_0":"role01_pifu1_tou3","30007_0":"role01_pifu1_tou4","30010_0":"role01_pifu1_tou5","30013_0":"role01_pifu1_tou6","30016_0":"role01_pifu1_tou7","0_30002":"role01_pifu2_tou1","30001_30002":"role01_pifu2_tou2","30004_30002":"role01_pifu2_tou3","30007_30002":"role01_pifu2_tou4","30010_30002":"role01_pifu2_tou5","30013_30002":"role01_pifu2_tou6","30016_30002":"role01_pifu2_tou7","0_30005":"role01_pifu3_tou1","30001_30005":"role01_pifu3_tou2","30004_30005":"role01_pifu3_tou3","30007_30005":"role01_pifu3_tou4","30010_30005":"role01_pifu3_tou5","30013_30005":"role01_pifu3_tou6","30016_30005":"role01_pifu3_tou7","0_30008":"role01_pifu4_tou1","30001_30008":"role01_pifu4_tou2","30004_30008":"role01_pifu4_tou3","30007_30008":"role01_pifu4_tou4","30010_30008":"role01_pifu4_tou5","30013_30008":"role01_pifu4_tou6","30016_30008":"role01_pifu4_tou7","0_30011":"role01_pifu5_tou1","30001_30011":"role01_pifu5_tou2","30004_30011":"role01_pifu5_tou3","30007_30011":"role01_pifu5_tou4","30010_30011":"role01_pifu5_tou5","30013_30011":"role01_pifu5_tou6","30016_30011":"role01_pifu5_tou7","0_30014":"role01_pifu6_tou1","30001_30014":"role01_pifu6_tou2","30004_30014":"role01_pifu6_tou3","30007_30014":"role01_pifu6_tou4","30010_30014":"role01_pifu6_tou5","30013_30014":"role01_pifu6_tou6","30016_30014":"role01_pifu6_tou7","0_30017":"role01_pifu7_tou1","30001_30017":"role01_pifu7_tou2","30004_30017":"role01_pifu7_tou3","30007_30017":"role01_pifu7_tou4","30010_30017":"role01_pifu7_tou5","30013_30017":"role01_pifu7_tou6","30016_30017":"role01_pifu7_tou7"},this.wingArmConfig={30003:"role01_chibang01",30006:"role01_chibang02",30009:"role01_chibang03",30012:"role01_chibang04",30015:"role01_chibang05",30018:"role01_chibang06"}}return t.prototype.getRoleData=function(t){for(var e=r.default.Instance.playerData.roleDataList,a=0;a<e.length;a++){var n=e[a];if(n.heroId==t)return n}return null},t.prototype.unlockHero=function(t){var e=this.getRoleData(t);null==e&&(e=new o.default(t),r.default.Instance.playerData.roleDataList.push(e)),e.status=1,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.ownHero=function(t){var e=this.getRoleData(t);null==e&&(e=new o.default(t),r.default.Instance.playerData.roleDataList.push(e)),e.status=2,this.gotoBattleHero(t),r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.gotoBattleHero=function(t){r.default.Instance.playerData.roleId=t,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.getRoleAttr=function(t,e){var a=new Array,n=s.default.Instance.roleMap.get(t),i=1;null!=this.getRoleData(t)&&(i=r.default.Instance.playerData.level);var o=1;if(e>=1&&e<=3){var c=s.default.Instance.roleGrowMap.get(t);if(c)for(var l=1;l<=i;l++)o+=c.get(l).grow_value}if(0==e){var h=this.getCombatAtk(t,2);a.push(Math.round(h))}else if(1==e){var u=o;a.push((n.atk+n.extra_atk)*u)}else 2==e?(u=o,a.push((n.hp+n.extra_hp)*u)):3==e?(u=o,a.push(n.def*u)):4==e?a.push(n.crit_rate):5==e?a.push(n.hit_rate):6==e?a.push(n.agl):7==e?a.push(n.atk_speed):8==e&&a.push(n.move_speed);return a},t.prototype.getRoleAllAttr=function(t,e){void 0===e&&(e=!1);var a,n=l.default.Instance.equipmentLogic.getAllEquipmentAttr(t),i=l.default.Instance.equipmentLogic.getAllEquipmentExtraAttr(t),o=l.default.Instance.equipmentLogic.getFashionAttr(t),r=l.default.Instance.equipmentLogic.getHeroTitleAttr(t);e&&(a=l.default.Instance.equipmentLogic.getTalentAttr());for(var s=[0,0,0,0,0,0,0,0,0],c=1;c<9;++c){var h=this.getRoleAttr(t,c);s[c]+=h[0],8!=c&&(s[c]+=n[c],s[c]+=i[c][0],s[c]+=o[c][0],s[c]*=i[c][1]+o[c][1],s[c]+=r[c][0],e&&a&&(s[c]+=a[c][0]))}return s},t.prototype.roleUpgrade=function(){var t=r.default.Instance.playerData.level;if(t>=d.default.MAX_PLAYER_LEVEL)console.log(" \u60a8\u5df2\u5347\u5230\u6700\u9ad8\u7ea7 ");else{for(var e=t,a=l.default.Instance.moneyLogic.getItemCount(1005),n=0,i=r.default.Instance.playerData.roleId,o=t+1;o<=d.default.MAX_PLAYER_LEVEL;++o){var h=s.default.Instance.roleGrowMap.get(i).get(o);if(a>=h.cost_exp&&h.lvl>t){e=o,n=h.cost_exp;break}}e>t?(l.default.Instance.moneyLogic.addItemCount(1005,-n),r.default.Instance.playerData.level=e,l.default.Instance.taskLogic.finishAllTask(c.default.type_role_level,e,1),l.default.Instance.moneyLogic.getItemCount(1005)>n?this.roleUpgrade():l.default.Instance.combatLayer&&l.default.Instance.combatLayer.node.active&&l.default.Instance.combatLayer.uiLayer.setRoleLevel(!0)):l.default.Instance.combatLayer&&l.default.Instance.combatLayer.node.active&&l.default.Instance.combatLayer.uiLayer.setRoleLevel(!1)}},t.prototype.getNextLevelExp=function(){var t=r.default.Instance.playerData.level+1;return t>d.default.MAX_PLAYER_LEVEL?l.default.Instance.moneyLogic.getItemCount(1005):s.default.Instance.roleGrowMap.get(r.default.Instance.playerData.roleId).get(t).cost_exp},t.prototype.getCombatAtk=function(t,e){var a=0,n=0,i=this.getRoleData(t),o=s.default.Instance.roleMap.get(t);a+=this.getRoleAllAttr(t)[1],a+=.25*this.getRoleAllAttr(t)[2];var r=1;1==e?r=1:2==e&&(r=2);for(var c=0;c<o.skillPools.length;++c){var l=s.default.Instance.skillMap.get(o.skillPools[c]),h=s.default.Instance.unlockSkillMap.get(l.id),u=i.skillLevel[h.skill_number-1];u>d.default.MAX_PLAYER_LEVEL&&(u=d.default.MAX_PLAYER_LEVEL),n+=l.injury_coefficient_show*(1+l.injury_coefficient_add_show*(u-r))*.1}return a*=n,Math.round(a)},t.prototype.unlockHeroSkill=function(t,e){var a=this.getRoleData(t),n=s.default.Instance.unlockSkillMap.get(e);a.skillLevel[n.skill_number-1]=1,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.upgradeHeroSkillLevel=function(t,e){var a=this.getRoleData(t),n=s.default.Instance.unlockSkillMap.get(e);a.skillLevel[n.skill_number-1]++,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.getSkillLevel=function(t,e){var a=this.getRoleData(t),n=s.default.Instance.unlockSkillMap.get(e);if(null==a)return 1==n.unlock_condition1?1:0;var i=a.skillLevel[n.skill_number-1];return i>d.default.MAX_PLAYER_LEVEL&&(i=d.default.MAX_PLAYER_LEVEL),i},t.prototype.getAdvanceCost=function(t){return this.getRoleData(t),s.default.Instance.roleMap.get(t),1},t.prototype.getBreakCost=function(t,e){var a=s.default.Instance.roleMap.get(t);return Math.floor(e*[1,1,1.2,1.5,2][a.Grade-1])},t.prototype.getSkillBookCostBySkillUpgrade=function(t,e,a){var n=s.default.Instance.roleMap.get(t);return Math.floor((a+.5*(e-1))*[1,1,1.5,2,3][n.Grade-1])},t.prototype.getSkillUpgradeUnlockIndex=function(t){for(var e=new Array,a=s.default.Instance.roleMap.get(t),n=l.default.Instance.roleLogic.getRoleData(t),i=0;i<a.skillPools.length;++i){var o=s.default.Instance.unlockSkillMap.get(a.skillPools[i]),c=l.default.Instance.roleLogic.getSkillLevel(t,a.skillPools[i]);if(0==n.skillLevel[o.skill_number-1])0==n.skillLevel[o.skill_number-1]&&l.default.Instance.roleLogic.canUnlockSkill(t,o.unlock_condition1,o.value1List)&&l.default.Instance.roleLogic.canUnlockSkill(t,o.unlock_condition2,o.value2List)&&e.push(o.skill_number);else{var h=n.skillLevel[o.skill_number-1];h>d.default.MAX_PLAYER_LEVEL&&(h=d.default.MAX_PLAYER_LEVEL,n.skillLevel[o.skill_number-1]=h);var u=s.default.Instance.skillGrowMap.get(h).costList[o.skill_number];l.default.Instance.moneyLogic.getItemCount(1001)>=u&&c<r.default.Instance.playerData.level&&e.push(o.skill_number)}}return e},t.prototype.getMoneyCostBySkillUpgrade=function(t,e,a,n){var i=s.default.Instance.roleMap.get(t),o=[1,1,1.5,2,3];return 1==n?Math.floor((a+100*(e-1))*o[i.Grade-1]):Math.floor((a+20*(e-1))*o[i.Grade-1])},t.prototype.canUnlockSkill=function(t,e,a){switch(e){case 1:return!0;case 2:var n=l.default.Instance.roleLogic.getRoleData(t),i=a[0],o=a[1],c=s.default.Instance.unlockSkillMap.get(i);return n.skillLevel[c.skill_number-1]>=o;case 3:var h=a[0];return r.default.Instance.playerData.level>=h;case 4:var u=a[0],d=Math.floor(u/100),p=u%100,f=a[1];return l.default.Instance.chapterLogic.getDungeonStarNum(d,p)>=f;default:return!0}},t.prototype.getUnlockSkillDesc=function(t,e,a,n){var i=new Array;switch(a){case 1:break;case 2:var o=n[0],c=n[1],h=s.default.Instance.unlockSkillMap.get(o),u=l.default.Instance.roleLogic.getSkillLevel(t,o);i.push(h.name),i.push(u+"/"+c);break;case 3:var d=n[0];i.push("\u89d2\u8272\u7b49\u7ea7"),i.push(r.default.Instance.playerData.level+"/"+d);break;case 4:var p=n[0],f=Math.floor(p/100),y=p%100,m=n[1],g=s.default.Instance.chapterMap.get(f),I=s.default.Instance.dungeonMap.get(f).get(y).get(1),_=l.default.Instance.chapterLogic.getDungeonStarNum(f,y,1);i.push("\u901a\u5173"+g.guide_tips+"-"+I.name+":"),i.push(_+"/"+m)}return i},t.prototype.updateBuffDataTime=function(t){for(var e=r.default.Instance.playerData.buffDataList,a=0;a<e.length;++a){var n=e[a];n.continueTime-=t,n.continueTime<0&&(n.continueTime=0)}r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.getBuffData=function(t){for(var e=r.default.Instance.playerData.buffDataList,a=0;a<e.length;++a)if(e[a].buffId==t)return e[a];return null},t.prototype.getBuffTime=function(t){for(var e=s.default.Instance.buffItemMap.get(t),a=r.default.Instance.playerData.buffDataList,n=0,i=0;i<a.length;++i)s.default.Instance.buffItemMap.get(a[i].buffId).buff_type==e.buff_type&&(n+=a[i].continueTime);return n},t.prototype.addBuffData=function(t,e){var a=this.getBuffData(t);null==a?(a=new h.default(t,e),r.default.Instance.playerData.buffDataList.push(a)):a.continueTime+=e,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.getFashionShareCount=function(t){for(var e=r.default.Instance.playerData.fashionShareList,a=0;a<e.length;++a){var n=e[a];if(n[0]==t)return n[1]}return 0},t.prototype.addFashionShareCount=function(t,e){for(var a=r.default.Instance.playerData.fashionShareList,n=!1,i=0,o=0;o<a.length;++o){var s=a[o];s[0]==t&&(s[1]+=e,n=!0,i=s[1])}return n||(a.push([t,e]),i=e),r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),i},t.prototype.getRoleWeaponId=function(){var t=l.default.Instance.equipmentLogic.getRoleEquipData(r.default.Instance.playerData.roleId);return null==t?0:t.equipment[1]},t.prototype.getRoleWeaponLevel=function(){var t=l.default.Instance.equipmentLogic.getRoleEquipData(r.default.Instance.playerData.roleId);if(null==t)return 0;var e=l.default.Instance.equipmentLogic.getEquipmentData(t.equipment[1]);return null==e?0:e.strengthLevel},t.prototype.getWeaponShadowPos=function(t){var e,a=l.default.Instance.combatScene.knifeDiplay.getAttachment("weapon01",t);return a&&(e=cc.v2(a.x,a.y)),null==e&&(e=cc.v2(43,0)),e},t.prototype.changeWeaponSkin=function(t,e){if(0!=e){var a=l.default.Instance.equipmentLogic.getEquipmentData(e);if(null!=a){var n=s.default.Instance.equipmentMap.get(a.equipmentId);n&&n.res_id&&(i=t.findSlot("dao21"),o=l.default.Instance.combatScene.knifeDiplay.getAttachment("weapon01",n.res_id),i.setAttachment(o))}}else{var i=t.findSlot("dao21"),o=t.getAttachment("dao211","dao1");i.setAttachment(o)}},t.prototype.addWingNode=function(t,e,a,n){var i=t.attachUtil,o=i.getAttachedNodes("chibang");0==o.length&&(i.generateAllAttachedNodes(),o=i.getAttachedNodes("chibang"));var r=o[0];if(r)if(r.destroyAllChildren(),null==e);else{var s=new cc.Node,c=s.addComponent(sp.Skeleton);u.AssetUtils.loadSpine(c,"Animation/"+e,null,function(){a.call(n,c)},this),s.x=0,s.y=0,s.angle=-90,r.addChild(s)}},t.prototype.weaponUpgrade=function(t,e,a){var n=t.attachUtil,i=n.getAttachedNodes("dao211");0==i.length&&(n.generateAllAttachedNodes(),i=n.getAttachedNodes("dao211"));var o=i[0];if(o){if(o.destroyAllChildren(),0==e)return;e>15&&(e=15);var r=l.default.Instance.equipmentLogic.getEquipmentData(a);if(null==r)return;var c=s.default.Instance.equipmentMap.get(r.equipmentId),h=new cc.Node,d=h.addComponent(sp.Skeleton);u.AssetUtils.loadSpine(d,"Effect/"+["","baiguang","baiguang","lvguang","lvguang","lvguang","lvguang","languang","languang","languang","ziguang","huangguang","hongguang","heiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang","caiguang"][e],null,function(){d.setAnimation(0,"stand",!0)},this),h.scaleX=1,c&&(h.scaleX=c.effect_scale?c.effect_scale:1),o.addChild(h)}},t.prototype.passCheckLevel=function(){var t=[110,110,130,170,210,250,310,350,410,510,1e6][r.default.Instance.playerData.passCheckLevel];l.default.Instance.moneyLogic.getItemCount(1015)>=t&&(l.default.Instance.moneyLogic.addItemCount(1015,-t),r.default.Instance.playerData.passCheckLevel+=1,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart()),l.default.Instance.taskLogic.finishAllTask(c.default.type_pass_check_level,r.default.Instance.playerData.passCheckLevel,1))},t.prototype.getUnEquipmentCount=function(){for(var t=r.default.Instance.playerData.equipmentList,e=0,a=0;a<t.length;++a)0==t[a].equipState&&(e+=1);return e},t.prototype.getRoleArmResId=function(){var t=new Array,e=r.default.Instance.playerData.wearFashionList,a=e[0],n=e[1],i=e[2],o=e[3],c=a+"_"+n;this.roleArmConfig[c]?t.push(this.roleArmConfig[c]):t.push("role01_pifu1_tou1"),this.wingArmConfig[i]?t.push(this.wingArmConfig[i]):t.push(null);var l=s.default.Instance.equipmentMap.get(o);return l?t.push(l.res_id):t.push(null),t},t.prototype.getRoleWingResId=function(t,e,a,n){var i=new Array,o=t+"_"+e;this.roleArmConfig[o]?i.push(this.roleArmConfig[o]):i.push("role01_pifu1_tou1"),this.wingArmConfig[a]?i.push(this.wingArmConfig[a]):i.push(null);var r=s.default.Instance.equipmentMap.get(n);return r?i.push(r.res_id):i.push(null),i},t.prototype.updateTitleDataTime=function(t){for(var e=r.default.Instance.playerData.heroTitleList,a=0;a<e.length;++a){var n=e[a];n.continueTime-=t,n.continueTime<0&&(n.continueTime=0)}r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.getTitleData=function(t){for(var e=r.default.Instance.playerData.heroTitleList,a=0;a<e.length;++a)if(e[a].buffId==t)return e[a];return null},t.prototype.getTitleTime=function(t){for(var e=r.default.Instance.playerData.heroTitleList,a=0,n=0;n<e.length;++n)if(s.default.Instance.equipmentMap.get(e[n].buffId).id==t){a+=e[n].continueTime;break}return a},t.prototype.addTitleData=function(t,e){var a=this.getTitleData(t);null==a?(a=new h.default(t,e),r.default.Instance.playerData.heroTitleList.push(a)):a.continueTime+=e,r.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t}();i.default=p,cc._RF.pop()},{}],SceneNodeManager:[function(t,e,a){"use strict";cc._RF.push(e,"7e8b823q2RNOrRPe8OjqsWz","SceneNodeManager");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("Dictionary"),l=i("GameData"),h=cc._decorator,u=h.ccclass,d=h.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroArmaturePrefab=null,e.rewardItemPrefab=null,e.rewardEffectPrefab=null,e.heroArmatureNodePoolMap=new c.Dictionary,e.rewardItemNodePoolMap=new c.Dictionary,e.rewardEffectNodePoolMap=new c.Dictionary,e}return r(e,t),e.prototype.load=function(){var t=l.default.Instance.playerData.wearFashionList,e=this.getHeroArmature(l.default.Instance.playerData.roleId,t[0],t[1],t[2],t[3]);this.putHeroArmature(e)},e.prototype.getHeroArmature=function(t,e,a,n,i){var o,r=this.heroArmatureNodePoolMap.get(t);return null==r&&(r=new cc.NodePool,this.heroArmatureNodePoolMap.put(t,r)),r.size()>0?o=r.get().getComponent("HeroArmature"):(o=cc.instantiate(this.heroArmaturePrefab).getComponent("HeroArmature")).init(t,e,a,n,i),o.resetData(e,a,n,i),o},e.prototype.putHeroArmature=function(t){this.heroArmatureNodePoolMap.get(t.heroId).put(t.node)},e.prototype.getRewardItem=function(t,e,a,n,i,o,r,s,l){var h=this.rewardItemNodePoolMap.get(a);null==h&&(h=new c.Dictionary,this.rewardItemNodePoolMap.put(a,h));var u,d=h.get(t);return null==d&&(d=new cc.NodePool,h.put(t,d)),d.size()>0?u=d.get().getComponent("RewardItem"):(u=cc.instantiate(this.rewardItemPrefab).getComponent("RewardItem")).init([a,t,e],i),u.resetData(e,n,i,o,r,s,l),u},e.prototype.putRewardItem=function(t){this.rewardItemNodePoolMap.get(t.type).get(t.id).put(t.node)},e.prototype.getRewardEffectSprite=function(t,e,a,n){var i=this.rewardEffectNodePoolMap.get(n);null==i&&(i=new c.Dictionary,this.rewardEffectNodePoolMap.put(n,i));var o,r=i.get(t);return null==r&&(r=new cc.NodePool,i.put(t,r)),r.size()>0?o=r.get().getComponent("RewardEffectSprite"):(o=cc.instantiate(this.rewardEffectPrefab).getComponent("RewardEffectSprite")).init(t,n),o.resetData(e,a),o},e.prototype.putRewardEffectSpriet=function(t){this.rewardEffectNodePoolMap.get(t.rewardType).get(t.itemId).put(t.node)},s([d(cc.Prefab)],e.prototype,"heroArmaturePrefab",void 0),s([d(cc.Prefab)],e.prototype,"rewardItemPrefab",void 0),s([d(cc.Prefab)],e.prototype,"rewardEffectPrefab",void 0),s([u],e)}(cc.Component);o.default=p,cc._RF.pop()},{}],SettingLayer:[function(t,e,a){"use strict";cc._RF.push(e,"bc41fZdV49ItJVz0rDh2v2P","SettingLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("SoundManager"),h=i("GameData"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){this.bgSoundNode=cc.find("BgSound/Background",this.node),this.effectNode=cc.find("Effect/Background",this.node),cc.find("OpenId",this.node).getComponent(cc.Label).string="OpenId:"+h.default.Instance.playerData.openid,this.review()},e.prototype.review=function(){this.node.active=!0,1==h.default.Instance.playerData.musicStatus?this.bgSoundNode.active=!0:this.bgSoundNode.active=!1,1==h.default.Instance.playerData.soundEffectStatus?this.effectNode.active=!0:this.effectNode.active=!1,this.scheduleOnce(function(){c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2)},0)},e.prototype.onClickEvent=function(t,e){l.SoundManager.Instance.playEffect("anniu"),0==e?(this.node.active=!1,c.default.Instance.hideCustomAd(1),c.default.Instance.hideCustomAd(2)):1==e?(1==h.default.Instance.playerData.musicStatus?l.SoundManager.Instance.pauseMusic():l.SoundManager.Instance.resumeMusic(),this.review()):2==e?(1==h.default.Instance.playerData.soundEffectStatus?l.SoundManager.Instance.pauseAllEffects():l.SoundManager.Instance.resumeAllEffects(),this.review()):3==e?c.default.Instance.setClipboardData(h.default.Instance.playerData.openid):4==e?u.default.Instance.combatScene.popLayer.reviewCdkeyLayer(4):5==e&&u.default.Instance.combatScene.popLayer.reviewCdkeyLayer(3)},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],ShadowEffect:[function(t,e,a){"use strict";cc._RF.push(e,"56cb8z5vZRB+aTTe6pzBNwT","ShadowEffect");var n,i=a,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.init=function(){this.shadowNode=cc.find("Shadow",this.node),this.shadowNode.active=!1,this.dragonNode=cc.find("Dragon",this.node),this.dragonNode.active=!1},e.prototype.review=function(t,e,a){switch(this.node.active=!0,this.shadowNode.active=!1,this.dragonNode.active=!1,t){case 1:this.shadowNode.active=!0,this.node.scale=e}this.node.x=a.x,this.node.y=a.y},e.prototype.updatePos=function(t){this.node.x=t.x,this.node.y=t.y},r([c],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],ShakeComponent:[function(t,e,a){"use strict";cc._RF.push(e,"9c9fb10ispNdpIu2f7gXK5V","ShakeComponent");var n,i=a,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.ShakeComponent=void 0;var s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeInitialPos=null,e.nodeShakeStrengthX=0,e.nodeShakeStrengthY=0,e.duration=0,e.totalTime=0,e.lastTime=0,e}return o(e,t),e.prototype.run=function(t){var e=(new Date).getTime();e-this.lastTime<1e3*t[0]+20||(this.lastTime=e,this.duration=t[0],this.nodeShakeStrengthX=t[2],this.nodeShakeStrengthY=t[3],this._target=this.node,null==this.nodeInitialPos&&(this.nodeInitialPos=this._target.getPosition()),this.totalTime=0,this.schedule(this.scheduleUpdate,t[1]))},e.prototype.getRandomStrength=function(t,e){return Math.random()*(e-t+1)+t},e.prototype.scheduleUpdate=function(t){if(this._target){if(this.totalTime+=t,this.totalTime>this.duration)return void this.stop();var e=this.getRandomStrength(-this.nodeShakeStrengthX,this.nodeShakeStrengthX)*t,a=this.getRandomStrength(-this.nodeShakeStrengthY,this.nodeShakeStrengthY)*t;this.nodeInitialPos=this._target.getPosition(),this._target.x=this.nodeInitialPos.x+e,this._target.y=this.nodeInitialPos.y+a}},e.prototype.stop=function(){this._target&&(this._target.x=this.nodeInitialPos.x,this._target.y=-25,this.unschedule(this.scheduleUpdate))},r([c],e)}(cc.Component));i.ShakeComponent=l,cc._RF.pop()},{}],ShakeJarLayer:[function(t,e,a){"use strict";cc._RF.push(e,"627111xTNFJmaxC8Y8sPpcC","ShakeJarLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("MainLogic"),l=i("GameData"),h=i("StringUtils"),u=i("AdServer"),d=i("PublicConst"),p=i("PublicEnum"),f=i("AssetUtils"),y=i("ConfigData"),m=i("GuideUtils"),g=i("SoundManager"),I=i("TaskLogic"),_=cc._decorator,v=_.ccclass,S=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.costNum1=200,e.costNum2=1800,e.freeCj=!1,e.showEquipmentTime=0,e.giftIndex=0,e.giftProgress=0,e.preItemId=0,e.smallLayerType=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.smallLayer=cc.find("Layer2",this.node),this.smallLayerRewardName=cc.find("Name",this.smallLayer),this.smallLayerRewardItemBg=cc.find("ItemBg",this.smallLayer),this.smallLayerRewardItem=cc.find("Item",this.smallLayer),this.smallLayerProgress=cc.find("Progress",this.smallLayer).getComponent(cc.ProgressBar),this.smallLayer.active=!1,this.ruleNode=cc.find("Rule",this.node),this.ruleNode.active=!1,this.freeNumNode=cc.find("Layer/Center/Jar1/Num",this.node),this.freeBtnNode=cc.find("Layer/Center/Jar1/Reward",this.node),this.costNumNode2=cc.find("Layer/Center/Jar2/Reward/Num",this.node),this.costNumNode3=cc.find("Layer/Center/Jar3/Reward/Num",this.node),this.review(t)},e.prototype.review=function(t){var e=this;this.pageName=t,this.node.active=!0,this.freeNumNode.getComponent(cc.Label).string="\u5269\u4f59\u6b21\u6570\uff1a"+l.default.Instance.playerData.shakeJarCount+"/5",this.costNumNode2.getComponent(cc.Label).string="x"+this.costNum1,this.costNumNode3.getComponent(cc.Label).string="x"+this.costNum2,this.freeBtnNode.getComponent(cc.Button).interactable=l.default.Instance.playerData.shakeJarCount>0,this.showMoney(),this.showJar3Tip(),this.pageName==p.PAGE_NAME.Home||this.pageName==p.PAGE_NAME.Task&&this.scheduleOnce(function(){u.default.Instance.hideCustomAd(1),u.default.Instance.hideCustomAd(2)},0),this.scheduleOnce(function(){e.guideAction()},0)},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=h.default.stringToWord(c.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+h.default.stringToWord(c.default.Instance.moneyLogic.getItemCount(1002))},e.prototype.showJar3Tip=function(){var t=c.default.Instance.giftBagLoigc.getJarCCWeaponInfo(l.default.Instance.playerData.shakeJar3Count),e=cc.find("Layer/Center/Jar3/Tip1",this.node),a=cc.find("Layer/Center/Jar3/fuben_suitu_13",this.node);if(0==t)return e.active=!1,void(a.active=!1);e.getComponent(cc.Label).string="\u7b2c"+l.default.Instance.playerData.shakeJar3Count+"/"+t+"\u6b21\u5341\u8fde\u62bd\u5fc5\u5f97"},e.prototype.reviewSmallLayer=function(t){this.smallLayerType=t,this.smallLayer.active=!0,this.giftList=c.default.Instance.giftBagLoigc.getJatGiftList([9,10,11][t-1]),this.giftIndex=0,cc.find("Title",this.smallLayer).getComponent(cc.Label).string=["\u666e\u901a\u8896\u73cd\u7f50","\u9ad8\u7ea7\u8896\u73cd\u7f50","\u9ad8\u7ea7\u8896\u73cd\u7f50"][t-1],cc.find("Desc",this.smallLayer).getComponent(cc.Label).string="\u6b63\u5728\u5f00\u542f\u8896\u73cd\u7f50...",this.smallLayerProgress.progress=0,this.giftProgress=0;for(var e=1;e<=3;++e){var a=cc.find("Jar"+e,this.smallLayer);a.active=e==t,a.active&&a.getComponent(sp.Skeleton).setAnimation(0,["kaiguanzi1","kaiguanzi2","kaiguanzi2"][t-1],!1)}this.giftSchedule(0),this.schedule(this.giftSchedule,.1)},e.prototype.giftSchedule=function(){var t=this;this.giftIndex>=this.giftList.itemList.length&&(this.giftIndex=0),this.giftProgress+=.05;for(var e=this.giftIndex;this.giftIndex<this.giftList.itemList.length;++e){if(this.giftList.itemList[e][1]!=this.preItemId){this.giftIndex=e;break}e+1==this.giftList.itemList.length&&(e=-1)}var a=this.giftList.itemList[this.giftIndex],n=a[1];this.preItemId=n;var i,o=a[0];if(null!=(i=1==o?y.default.Instance.equipmentMap.get(n):y.default.Instance.itemMap.get(n))){if(this.giftProgress<1&&(f.AssetUtils.loadSpriteFrame(this.smallLayerRewardItemBg,"Common/common_quality_"+i.quality),f.AssetUtils.loadSpriteFrame(this.smallLayerRewardItem,"Common/"+i.icon),this.smallLayerRewardName.getComponent(cc.Label).string=i.name),this.smallLayerProgress.progress=this.giftProgress,this.giftIndex+=1,this.preItemId=n,this.giftProgress>=1){this.unschedule(this.giftSchedule);var r=void 0;if(1==this.smallLayerType?(l.default.Instance.playerData.shakeJar1Count+=1,r=c.default.Instance.giftBagLoigc.getJarGiftBag(9,l.default.Instance.playerData.shakeJar1Count,1),l.default.Instance.playerData.shakeJarCount-=1,c.default.Instance.tipsLogic.updateShakeJar(),this.review(this.pageName)):2==this.smallLayerType?(l.default.Instance.playerData.shakeJar2Count+=1,r=c.default.Instance.giftBagLoigc.getJarGiftBag(10,l.default.Instance.playerData.shakeJar2Count,1),c.default.Instance.moneyLogic.addItemCount(1002,-this.costNum1)):(l.default.Instance.playerData.shakeJar3Count+=1,r=c.default.Instance.giftBagLoigc.getJarGiftBag(11,l.default.Instance.playerData.shakeJar3Count,10),this.freeCj?this.freeCj=!1:c.default.Instance.moneyLogic.addItemCount(1002,-this.costNum2),this.showJar3Tip()),r){if(n=(a=this.giftList.itemList[r[0]])[1],null==(i=1==(o=a[0])?y.default.Instance.equipmentMap.get(n):y.default.Instance.itemMap.get(n)))return void(this.giftIndex+=1);f.AssetUtils.loadSpriteFrame(this.smallLayerRewardItemBg,"Common/common_quality_"+i.quality),f.AssetUtils.loadSpriteFrame(this.smallLayerRewardItem,"Common/"+i.icon),this.smallLayerRewardName.getComponent(cc.Label).string=i.name}this.scheduleOnce(function(){t.smallLayer.active=!1},1)}}else this.giftIndex+=1},e.prototype.onClickBtn=function(t,e){if(g.SoundManager.Instance.playEffect("anniu"),1==e)this.node.active=!1,c.default.Instance.combatScene.gotoHomeLayer(),this.pageName==p.PAGE_NAME.Home||this.pageName==p.PAGE_NAME.Task&&this.scheduleOnce(function(){u.default.Instance.showCustomAd(1),u.default.Instance.showCustomAd(2)},0),c.default.Instance.combatScene.popLayer.pointGuideFinish();else if(2==e){if(((a=(new Date).getTime())-this.showEquipmentTime)/1e3>60&&l.default.Instance.playerData.equipmentGridCount-c.default.Instance.roleLogic.getUnEquipmentCount()<=0)return this.showEquipmentTime=a,void c.default.Instance.combatScene.popLayer.reviewGamePauseLayer(p.PAGE_NAME.Home,3);u.default.Instance.adHandler(u.default.AD_TYPE_SHAKE_JAR,this,this.adCallback)}else if(3==e){if(((a=(new Date).getTime())-this.showEquipmentTime)/1e3>60&&l.default.Instance.playerData.equipmentGridCount-c.default.Instance.roleLogic.getUnEquipmentCount()<=0)return this.showEquipmentTime=a,void c.default.Instance.combatScene.popLayer.reviewGamePauseLayer(p.PAGE_NAME.Home,3);if(c.default.Instance.moneyLogic.getItemCount(1002)<this.costNum1)return void c.default.Instance.combatScene.popLayer.reviewMoneyMorePage(p.PAGE_NAME.ShakeJar,2,!0);this.reviewSmallLayer(2)}else if(4==e){if(c.default.Instance.combatScene.popLayer.pointGuideFinish(),this.freeCj)return void this.reviewSmallLayer(3);var a;if(((a=(new Date).getTime())-this.showEquipmentTime)/1e3>60&&l.default.Instance.playerData.equipmentGridCount-c.default.Instance.roleLogic.getUnEquipmentCount()<5)return this.showEquipmentTime=a,void c.default.Instance.combatScene.popLayer.reviewGamePauseLayer(p.PAGE_NAME.Home,2);if(c.default.Instance.moneyLogic.getItemCount(1002)<this.costNum2)return void c.default.Instance.combatScene.popLayer.reviewMoneyMorePage(p.PAGE_NAME.ShakeJar,2,!0);this.reviewSmallLayer(3)}else 5==e?this.smallLayer.active=!1:6==e?this.ruleNode.active=!0:7==e?this.ruleNode.active=!1:100==e?c.default.Instance.combatScene.popLayer.reviewMoneyMorePage(p.PAGE_NAME.ShakeJar,1,!0):101==e&&c.default.Instance.combatScene.popLayer.reviewMoneyMorePage(p.PAGE_NAME.ShakeJar,2,!0)},e.prototype.adCallback=function(t,e,a){0==e?t!=u.default.AD_TYPE_SHAKE_JAR&&t!=u.default.SHARE_TYPE_SHAKE_JAR||(this.reviewSmallLayer(1),0!=l.default.Instance.playerData.cdActiveFreeAd&&a||c.default.Instance.taskLogic.finishAllTask(I.default.type_see_ad_count1,0,1)):-1==e?(c.default.Instance.combatScene.showMsgInfo(d.default.NO_AD),u.default.Instance.noVideoToShare()&&(t==u.default.AD_TYPE_SHAKE_JAR&&(this.shareType=u.default.SHARE_TYPE_SHAKE_JAR),d.default.Platform==p.PLAT_FORM.Douyin?u.default.Instance.shareAppCallBack(this,this.shareAppCallback2):c.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())):c.default.Instance.combatScene.showMsgInfo(d.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void c.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,c.default.Instance.combatScene.showMsgInfo(d.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-u.default.Instance.adServer.shareDateTime)/1e3);if(u.default.Instance.shareState(e)){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void c.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,c.default.Instance.combatScene.showMsgInfo(d.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else u.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(c.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())},e.prototype.guideAction=function(t){var e,a=1,n=1;if(a=8,n=1,e=e=cc.find("Layer/Center/Jar3/Reward",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),m.default.Instance.isHaveGuide(a,n,t))return m.default.Instance.isHaveGuide(7,1)&&m.default.Instance.finishGuideTask(7),this.freeCj=!0,void c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100));a=9,n=1,m.default.Instance.isHaveGuide(a,n,t)?c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)):(a=9,n=2,m.default.Instance.isHaveGuide(a,n,t)?c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100)):(a=9,n=3,e=cc.find("Layer/Top/Close",this.node).convertToWorldSpaceAR(cc.v2(0,0)),e=cc.v2(e.x-cc.winSize.width/2,e.y-cc.winSize.height/2),m.default.Instance.isHaveGuide(a,n,t)&&c.default.Instance.combatScene.popLayer.reviewGuideLayer(a,n,this,this.guideCallback,e,cc.size(100,100))))},e.prototype.guideCallback=function(t){this.node.active&&(8==t[0]&&1==t[1]||this.guideAction(!0))},s([v],e)}(cc.Component));o.default=S,cc._RF.pop()},{}],ShopData:[function(t,e,a){"use strict";cc._RF.push(e,"bfb9enldJ9IoYUANaUxAE3p","ShopData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,a,n,i){this.shopType=1,this.type=0,this.order=0,this.limitType=0,this.getType=0,this.shareId=0,this.seasionId=0,this.shareCount=0,this.shareTime="",this.rewardCount=0,this.videoCount=0,this.shopType=t,this.type=e,this.order=a,this.limitType=n,this.getType=i,this.shareId=1e3*this.type+this.order,this.seasionId+=1},cc._RF.pop()},{}],ShopFashionItem:[function(t,e,a){"use strict";cc._RF.push(e,"aa09aM9w8NOm4UgGtEEjtsQ","ShopFashionItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicEnum"),h=i("SoundManager"),u=i("ConfigData"),d=i("GameData"),p=i("AssetUtils"),f=i("MainLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.shopInfo=t,this.shopLayer=e,this.equipType=this.shopInfo.itemList[0][0],this.equipId=this.shopInfo.itemList[0][1],this.nameNode=cc.find("Name",this.node),this.heroNode=cc.find("Hero",this.node);var a=u.default.Instance.equipmentMap.get(this.equipId);this.equipPlace=a.place,p.AssetUtils.loadSpriteFrame(this.nameNode,"Fasion/fashion_name_"+a.id),p.AssetUtils.loadSpriteFrame(this.heroNode,"Fasion/fashion_"+a.id);for(var n=1;n<=6;++n){var i=cc.find("Attr/Attr"+n,this.node);if(n<=a.extraEffectId.length){i.active=!0;for(var o=a.extraEffectId[n-1],r=u.default.Instance.extroEffectMap.get(o),s=r.introduce,c=["{probability}","{effect_value}"],l=0;l<c.length;++l)if(s.indexOf(c[l])>=0)switch(l){case 0:s=s.replace(c[l],r.probabilityNum[0]+"%");break;case 1:s=1==r.mode?s.replace(c[l],r.effectValue[0]+"%"):s.replace(c[l],r.effectValue[0]+"")}i.getComponent(cc.Label).string=s}else i.active=!1}var h=1;for(d.default.Instance.playerData.wearFashionList.indexOf(this.equipId)>=0?h=3:d.default.Instance.playerData.fashionList.indexOf(this.equipId)>=0&&(h=2),n=1;n<=3;++n)cc.find("Status"+n,this.node).active=n==h;for(n=0;n<=6;++n)cc.find("Status1/Type"+n,this.node).active=n==this.shopInfo.get_way},e.prototype.review=function(){var t=1;d.default.Instance.playerData.wearFashionList.indexOf(this.equipId)>=0?t=3:d.default.Instance.playerData.fashionList.indexOf(this.equipId)>=0&&(t=2);for(var e=1;e<=3;++e)cc.find("Status"+e,this.node).active=e==t},e.prototype.onClickBtn=function(t,e){h.SoundManager.Instance.playEffect("anniu"),1==e?(this.shopLayer.unscheduleAllCallbacks(),this.shopLayer.node.active=!1,1==this.shopInfo.get_way?(f.default.Instance.combatScene.homeLayer.hideNode(),f.default.Instance.combatScene.popLayer.reviewPassCheckLayer()):2==this.shopInfo.get_way?(f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewLotteryLayer(l.PAGE_NAME.Home)):3==this.shopInfo.get_way?(f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(1)):4==this.shopInfo.get_way?(f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewMoreFashionLayer(2)):5==this.shopInfo.get_way?(f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewActivityLayer(1)):6==this.shopInfo.get_way&&(f.default.Instance.combatScene.homeLayer.hideBanner(),f.default.Instance.combatScene.popLayer.reviewShopLayer(2,3))):2==e?(d.default.Instance.playerData.wearFashionList[this.equipPlace-7]=this.equipId,f.default.Instance.combatScene.homeLayer.streetLayer.streetHero.updateHeroArm(),this.review(),this.shopLayer.flashFashion(this.equipPlace-6)):(d.default.Instance.playerData.wearFashionList[this.equipPlace-7]=0,f.default.Instance.combatScene.homeLayer.streetLayer.streetHero.updateHeroArm(),this.review(),this.shopLayer.flashFashion(this.equipPlace-6))},e.prototype.shareSuccCallbsck=function(){},e.prototype.shareAppCallback=function(){},e.prototype.shareFailCallback=function(t){0==t&&(f.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],ShopInfo:[function(t,e,a){"use strict";cc._RF.push(e,"6d020u8EqVI1bAPXeQAplVY","ShopInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.shop_type=o.default.stringToInt(t.shop_type),this.order=o.default.stringToInt(t.order),this.type=o.default.stringToInt(t.type),this.buy_value=t.buy_value+"",this.item=t.item,this.itemList=o.default.config_stringToIntListOfList(this.item),this.buy_type=o.default.stringToInt(t.buy_type),this.limit_type=o.default.stringToInt(t.limit_type),this.buy_limit=o.default.stringToInt(t.buy_limit),this.costList=o.default.config_stringToIntList(this.buy_value,"_"),this.weight=o.default.stringToInt(t.weight),this.get_way=o.default.stringToInt(t.get_way)},cc._RF.pop()},{}],ShopLayer:[function(t,e,a){"use strict";cc._RF.push(e,"50cd67uFL9EF4cbhDjjBVc3","ShopLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("MainLogic"),h=i("ShopPropItem"),u=i("AdServer"),d=i("PublicConst"),p=i("DateUtils"),f=i("ShopFashionItem"),y=i("SoundManager"),m=i("TaskLogic"),g=i("PublicEnum"),I=cc._decorator,_=I.ccclass,v=I.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.propItemPrefab=null,e.fashionItemPrefab=null,e.shopType=1,e.currencyItems=new Array,e.propItems=new Array,e.faskion1Items=new Array,e.faskion2Items=new Array,e.faskion3Items=new Array,e.cunponItems=new Array,e.myPropItems=new Array,e.myTitleItems=new Array,e.myFlashSpItems=new Array,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e){this.shopNode=cc.find("Layer",this.node),this.myShopNode=cc.find("Layer2",this.node),this.currencyNode=cc.find("Layer/Currency",this.node),this.currencyList=cc.find("List",this.currencyNode).getComponent(cc.ScrollView),this.propNode=cc.find("Layer/Prop",this.node),this.propList=cc.find("Layer/Prop/List",this.node).getComponent(cc.ScrollView),this.propTime=cc.find("Layer/Prop/Time/Time",this.node),this.propUpdateNum=cc.find("Layer/Prop/Update/Num",this.node),this.propNode.active=!1,this.fashionNode=cc.find("Layer/Fashion",this.node),this.fashionList1=cc.find("Layer/Fashion/List1",this.node).getComponent(cc.ScrollView),this.fashionList2=cc.find("Layer/Fashion/List2",this.node).getComponent(cc.ScrollView),this.fashionList3=cc.find("Layer/Fashion/List3",this.node).getComponent(cc.ScrollView),this.fashionNode.active=!1,this.cunponNode=cc.find("Layer/Cunpon",this.node),this.cunponList=cc.find("List",this.cunponNode).getComponent(cc.ScrollView),this.myPropNode=cc.find("Layer2/Prop",this.node),this.myPropList=cc.find("Layer2/Prop/List",this.node).getComponent(cc.ScrollView),this.myTitleNode=cc.find("Layer2/Title",this.node),this.myTitleList=cc.find("Layer2/Title/List",this.node).getComponent(cc.ScrollView),this.myFlashSpNode=cc.find("Layer2/Fashion",this.node),this.myFlashSpList=cc.find("Layer2/Fashion/List",this.node).getComponent(cc.ScrollView),this.moneyTypeNode1=cc.find("Layer2/Money/Type1/Count",this.node),this.review(t,e)},e.prototype.review=function(t,e,a,n){if(void 0===a&&(a=3),void 0===n&&(n=!1),this.node.active=!0,this.shopType=t,this.shopNode.active=1==t,this.myShopNode.active=2==t,1==t){this.currencyList.content.childrenCount>0&&n&&1==a&&(this.currencyList.content.destroyAllChildren(),this.currencyItems=[]),this.propList.content.childrenCount>0&&n&&3==a&&(this.propList.content.destroyAllChildren(),this.propItems=[]),this.cunponList.content.childrenCount>0&&n&&4==a&&(this.cunponList.content.destroyAllChildren(),this.cunponItems=[]);for(var i=c.default.Instance.playerData.shopDataList,o=1;o<i.length;++o){var r=i[o];if(1==o){if(this.currencyList.content.childrenCount>0){for(var s=0;s<this.currencyItems.length;++s)(g=this.currencyItems[s]).reqShareCount();continue}}else{if(2==o)continue;if(3==o){if(this.propList.content.childrenCount>0){for(s=0;s<this.propItems.length;++s)(g=this.propItems[s]).reqShareCount();continue}}else if(4==o&&this.cunponList.content.childrenCount>0){for(s=0;s<this.cunponItems.length;++s)(g=this.cunponItems[s]).reqShareCount();continue}}for(s=0;s<r.length;++s)(g=(m=cc.instantiate(this.propItemPrefab)).getComponent(h.default)).init(this,1,r[s],s),1==o?(this.currencyList.content.addChild(m),this.currencyItems.push(g)):2==o||(3==o?(this.propList.content.addChild(m),this.propItems.push(g)):4==o&&(this.cunponList.content.addChild(m),this.cunponItems.push(g)))}if(0==this.faskion1Items.length){var d=l.default.Instance.shopLogic.getFashion(1);for(o=0;o<d.length;++o)(g=(p=cc.instantiate(this.fashionItemPrefab)).getComponent(f.default)).init(d[o],this),this.fashionList1.content.addChild(p),this.faskion1Items.push(g)}else for(o=0;o<this.faskion1Items.length;++o)this.faskion1Items[o].review();if(0==this.faskion2Items.length)for(d=l.default.Instance.shopLogic.getFashion(2),o=0;o<d.length;++o)(g=(p=cc.instantiate(this.fashionItemPrefab)).getComponent(f.default)).init(d[o],this),this.fashionList2.content.addChild(p),this.faskion2Items.push(g);else for(o=0;o<this.faskion2Items.length;++o)this.faskion2Items[o].review();if(0==this.faskion3Items.length)for(d=l.default.Instance.shopLogic.getFashion(3),o=0;o<d.length;++o){var p;(g=(p=cc.instantiate(this.fashionItemPrefab)).getComponent(f.default)).init(d[o],this),this.fashionList3.content.addChild(p),this.faskion3Items.push(g)}else for(o=0;o<this.faskion3Items.length;++o)this.faskion3Items[o].review();0!=e&&(this.currencyNode.active=1==e,this.fashionNode.active=2==e,this.propNode.active=3==e,this.cunponNode.active=4==e,this.showBtnNode(1,e))}else if(2==this.shopType){this.myPropList.content.childrenCount>0&&n&&3==a&&(this.myPropList.content.destroyAllChildren(),this.myPropItems=[]),this.myTitleList.content.childrenCount>0&&n&&5==a&&(this.myTitleList.content.destroyAllChildren(),this.myTitleItems=[]),this.myFlashSpList.content.childrenCount>0&&n&&6==a&&(this.myFlashSpList.content.destroyAllChildren(),this.myFlashSpItems=[]);var y=c.default.Instance.playerData.myShopDataList;for(o=1;o<y.length;++o)if(r=y[o],1!=o&&2!=o){if(3==o){if(this.myPropList.content.childrenCount>0){for(s=0;s<this.myPropItems.length;++s)(g=this.myPropItems[s]).reqShareCount();continue}}else{if(4==o)continue;if(5==o){if(this.myTitleList.content.childrenCount>0){for(s=0;s<this.myTitleItems.length;++s)(g=this.myTitleItems[s]).reqShareCount();continue}}else if(6==o&&this.myFlashSpList.content.childrenCount>0){for(s=0;s<this.myFlashSpItems.length;++s)(g=this.myFlashSpItems[s]).reqShareCount();continue}}for(s=0;s<r.length;++s){var m,g;(g=(m=cc.instantiate(this.propItemPrefab)).getComponent(h.default)).init(this,2,r[s],s),1==o||2==o||(3==o?(this.myPropList.content.addChild(m),this.myPropItems.push(g)):4==o||(5==o?(this.myTitleList.content.addChild(m),this.myTitleItems.push(g)):6==o&&(this.myFlashSpList.content.addChild(m),this.myFlashSpItems.push(g))))}}0!=e&&(this.myPropNode.active=1==e,this.myFlashSpNode.active=3==e,this.myTitleNode.active=2==e,this.showBtnNode(2,e)),this.showMoney()}u.default.Instance.showCustomAd(1)},e.prototype.showMoney=function(){this.moneyTypeNode1.getComponent(cc.Label).string=l.default.Instance.moneyLogic.getItemCount(1036)+""},e.prototype.updateFaskionInfo=function(t,e){for(var a=0;a<this.faskion1Items.length;++a)this.faskion1Items[a].equipId==t&&(n=l.default.Instance.roleLogic.getFashionShareCount(t))!=e&&(l.default.Instance.roleLogic.addFashionShareCount(t,e-n),this.faskion1Items[a].review());for(a=0;a<this.faskion2Items.length;++a)this.faskion2Items[a].equipId==t&&(n=l.default.Instance.roleLogic.getFashionShareCount(t))!=e&&(l.default.Instance.roleLogic.addFashionShareCount(t,e-n),this.faskion2Items[a].review());for(a=0;a<this.faskion3Items.length;++a){var n;this.faskion3Items[a].equipId==t&&(n=l.default.Instance.roleLogic.getFashionShareCount(t))!=e&&(l.default.Instance.roleLogic.addFashionShareCount(t,e-n),this.faskion3Items[a].review())}},e.prototype.flashFashion=function(t){if(1==t)for(var e=0;e<this.faskion1Items.length;++e)this.faskion1Items[e].review();else if(2==t)for(e=0;e<this.faskion2Items.length;++e)this.faskion2Items[e].review();else for(e=0;e<this.faskion3Items.length;++e)this.faskion3Items[e].review()},e.prototype.autoUpdatePropTime=function(){var t=p.default.getTomorrowTimeDiff(),e=Math.floor(t/3600),a=t-3600*e,n=Math.floor(a/60),i=a-60*n;this.propTime.getComponent(cc.Label).string="\u5237\u65b0\u65f6\u95f4\uff1a"+(e>9?e:"0"+e)+":"+(n>9?n:"0"+n)+":"+(i>9?i:"0"+i)},e.prototype.showBtnNode=function(t,e){var a,n=4;1==t?(a=cc.find("Layer/Btns",this.node),n=4):(a=cc.find("Layer2/Btns",this.node),n=3);for(var i=1;i<=n;++i){var o=cc.find("Btn"+i,a);cc.find("Bg",o).active=i==e}},e.prototype.onClickBtn=function(t,e){if(y.SoundManager.Instance.playEffect("anniu"),1==e)u.default.Instance.hideCustomAd(1),this.unscheduleAllCallbacks(),this.node.active=!1;else if(2==e)this.currencyNode.active=!0,this.fashionNode.active=!1,this.propNode.active=!1,this.cunponNode.active=!1,this.showBtnNode(1,1);else if(3==e)this.currencyNode.active=!1,this.fashionNode.active=!0,this.propNode.active=!1,this.cunponNode.active=!1,this.showBtnNode(1,2);else if(4==e){if(c.default.Instance.playerData.shopPropUpdate<=0)return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5237\u65b0\u6b21\u6570\u5df2\u7528\u5c3d");u.default.Instance.adHandler(u.default.AD_TYPE_SHOP_PROP_UPDATE,this,this.adCallback)}else 5==e?(this.fashionList1.node.active=!0,this.fashionList2.node.active=!1,this.fashionList3.node.active=!1):6==e?(this.fashionList1.node.active=!1,this.fashionList2.node.active=!0,this.fashionList3.node.active=!1):7==e?(this.fashionList1.node.active=!1,this.fashionList2.node.active=!1,this.fashionList3.node.active=!0):8==e?(this.currencyNode.active=!1,this.fashionNode.active=!1,this.propNode.active=!0,this.cunponNode.active=!1,this.showBtnNode(1,3)):9==e?(this.currencyNode.active=!1,this.fashionNode.active=!1,this.propNode.active=!1,this.cunponNode.active=!0,this.showBtnNode(1,4)):10==e?(this.myPropNode.active=!0,this.myFlashSpNode.active=!1,this.myTitleNode.active=!1,this.showBtnNode(2,1)):11==e?(this.myPropNode.active=!1,this.myFlashSpNode.active=!1,this.myTitleNode.active=!0,this.showBtnNode(2,2)):12==e&&(this.myPropNode.active=!1,this.myFlashSpNode.active=!0,this.myTitleNode.active=!1,this.showBtnNode(2,3))},e.prototype.adCallback=function(t,e,a){0==e?t!=u.default.AD_TYPE_SHOP_PROP_UPDATE&&t!=u.default.SHARE_TYPE_SHOP_PROP_UPDATE||(c.default.Instance.playerData.shopPropUpdate-=1,this.review(this.shopType,0,3,!0),0!=c.default.Instance.playerData.cdActiveFreeAd&&a||l.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)):-1==e?(l.default.Instance.combatScene.showMsgInfo(d.default.NO_AD),u.default.Instance.noVideoToShare()&&(t==u.default.AD_TYPE_SHOP_PROP_UPDATE&&(this.shareType=u.default.SHARE_TYPE_SHOP_PROP_UPDATE),d.default.Platform==g.PLAT_FORM.Douyin?u.default.Instance.shareAppCallBack(this,this.shareAppCallback2):l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())):l.default.Instance.combatScene.showMsgInfo(d.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(d.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else l.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-u.default.Instance.adServer.shareDateTime)/1e3);if(u.default.Instance.shareState(e)){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void l.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,l.default.Instance.combatScene.showMsgInfo(d.default.SUCCESS_SHARE,1),u.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else u.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(l.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),u.default.Instance.shareApp())},s([v(cc.Prefab)],e.prototype,"propItemPrefab",void 0),s([v(cc.Prefab)],e.prototype,"fashionItemPrefab",void 0),s([_],e)}(cc.Component);o.default=S,cc._RF.pop()},{}],ShopLogic:[function(t,e,a){"use strict";cc._RF.push(e,"72b1258XWJKVqYSJTQkricU","ShopLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("ConfigData"),r=n("ShopData"),s=n("GameData"),c=n("DataUtils"),l=n("MainLogic"),h=function(){function t(){}return t.prototype.initShopData=function(){var t=s.default.Instance.playerData.shopDataList;if(0==t.length)for(var e=0;e<11;++e)t.push(new Array);for(e=1;e<=6;++e){var a=t[e];if(null==a&&(t.push(new Array),a=t[e]),0==a.length){var n=o.default.Instance.shopMap.get(e);if(null==n)continue;for(var i=n.getKeys(),c=0;c<i.length;++c){var h=i[c],u=n.get(h)[0],d=new r.default(u.shop_type,u.type,u.order,u.limit_type,u.buy_type);a.push(d)}}else for(c=0;c<a.length;++c)1==a[c].limitType?(a[c].videoCount=0,a[c].rewardCount=0,null==a[c].seasionId?a[c].seasionId=1:a[c].seasionId+=1,null==a[c].shopType&&(a[c].shopType=1)):2==a[c].limitType&&null==a[c].shopType&&(a[c].shopType=1)}s.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.initMyShopData=function(){var t=s.default.Instance.playerData.myShopDataList;if(0==t.length)for(var e=0;e<11;++e)t.push(new Array);for(e=1;e<=6;++e){var a=t[e];if(null==a&&(t.push(new Array),a=t[e]),0==a.length){var n=o.default.Instance.myShopMap.get(e);if(null==n)continue;for(var i=n.getKeys(),c=0;c<i.length;++c){var h=i[c],u=n.get(h)[0],d=new r.default(u.shop_type,u.type,u.order,u.limit_type,u.buy_type);a.push(d)}}else for(c=0;c<a.length;++c)1==a[c].limitType?(a[c].videoCount=0,a[c].rewardCount=0,null==a[c].seasionId?a[c].seasionId=1:a[c].seasionId+=1,null==a[c].shopType&&(a[c].shopType=2)):2==a[c].limitType&&null==a[c].shopType&&(a[c].shopType=2)}s.default.Instance.localStorage(l.default.Instance.combatScene.isGameStart())},t.prototype.checkMyShopData=function(){var t=s.default.Instance.playerData.myShopDataList;if(0==t.length)return!0;for(var e=0,a=0;a<t.length;++a)e+=t[a].length;return 0==e},t.prototype.getShopData=function(t,e,a){return 1==t?s.default.Instance.playerData.shopDataList[e][a-1]:2==t?s.default.Instance.playerData.myShopDataList[e][a-1]:void 0},t.prototype.setShopData=function(t,e,a,n,i){var o;return 1==t?((o=s.default.Instance.playerData.shopDataList[e][a-1]).rewardCount+=n,o.videoCount+=i,o):2==t?((o=s.default.Instance.playerData.myShopDataList[e][a-1]).rewardCount+=n,o.videoCount+=i,o):void 0},t.prototype.getFashion=function(t){return o.default.Instance.shopMap.get(2).get(t)},t.prototype.randomShopIndex=function(t,e){for(var a=o.default.Instance.shopMap.get(t).get(e),n=new Array,i=0;i<a.length;i++){var r=a[i];n.push(r.weight)}return c.default.randomIndexByWeight(n)},t}();i.default=h,cc._RF.pop()},{}],ShopPropItem:[function(t,e,a){"use strict";cc._RF.push(e,"e8fcacQ3n1ID5sALoV9nzy6","ShopPropItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("StringUtils"),m=i("MainLogic"),g=i("TaskLogic"),I=cc._decorator,_=I.ccclass,v=(I.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopItemIndex=0,e.shareCount=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(t,e,a,n){var i=this;this.shopData=a,1==e?this.shopInfo=d.default.Instance.shopMap.get(this.shopData.type).get(this.shopData.order)[0]:2==e&&(this.shopInfo=d.default.Instance.myShopMap.get(this.shopData.type).get(this.shopData.order)[0]),null==a.shopType&&(a.shopType=e),this.shopLayer=t,this.shopItemIndex=n,this.limitNode=cc.find("Info/Limit",this.node),this.limitNumNode=cc.find("Info/Limit/Num",this.node),this.framentNode=cc.find("Item/Fragment",this.node),this.framentNode.active=!1,this.propType=this.shopInfo.itemList[0][0],this.propId=this.shopInfo.itemList[0][1],this.propNum=this.shopInfo.itemList[0][2],1==this.propType?(this.itemInfo=d.default.Instance.equipmentMap.get(this.propId),cc.find("Info/CC",this.node).active=5==this.itemInfo.type):(this.itemInfo=d.default.Instance.itemMap.get(this.propId),cc.find("Info/CC",this.node).active=!1,this.framentNode.active=1==this.itemInfo.is_chip);var o=this.itemInfo.quality,r=cc.find("ItemBg",this.node);f.AssetUtils.loadSpriteFrame(r,"Common/common_quality_"+o);var s=cc.find("Item",this.node);f.AssetUtils.loadSpriteFrame(s,"Common/"+this.itemInfo.icon),cc.find("Info/Name",this.node).getComponent(cc.Label).string=this.itemInfo.name,cc.find("Info/Num",this.node).getComponent(cc.Label).string="x"+y.default.stringToWord(this.propNum);for(var c=1;c<=3;++c)cc.find("Btn"+c,this.node).active=c==this.shopInfo.buy_type;this.shareGetNode=cc.find("ShareGet",this.node),this.shareGetNode.active=!1;var l=cc.find("Info/Tj",this.node);if(l.active=!1,1==this.shopInfo.buy_type){var h=d.default.Instance.itemMap.get(this.shopInfo.costList[0]),u=cc.find("Btn1/CostItem",this.node);f.AssetUtils.loadSpriteFrame(u,"Common/"+h.icon,function(){i.scheduleOnce(function(){u.height>40&&(u.scale=40/u.height)},0)},this),cc.find("Btn1/Num",this.node).getComponent(cc.Label).string=""+this.shopInfo.costList[1]}else 2==this.shopInfo.buy_type?(this.shareNumNode=cc.find("Btn2/Num",this.node),this.shareNumNode.getComponent(cc.Label).string="(0/"+this.shopInfo.costList[0]+")",this.reqShareCount()):3==this.shopInfo.buy_type&&(this.videoNumNode=cc.find("Btn3/Num",this.node),this.videoNumNode.getComponent(cc.Label).string="("+this.shopData.videoCount+"/"+this.shopInfo.costList[0]+")",l.active=!0,cc.find("Num",l).getComponent(cc.Label).string=this.shopInfo.costList[0]+"");cc.find("Over",this.node).active=this.shopData.rewardCount>=this.shopInfo.buy_limit,this.limitNode.getComponent(cc.Label).string=1==this.shopInfo.limit_type?"\u6bcf\u65e5\u9650\u8d2d":"\u7ec8\u751f\u9650\u8d2d",this.limitNumNode.getComponent(cc.Label).string="("+this.shopData.rewardCount+"/"+this.shopInfo.buy_limit+")"},e.prototype.review=function(){this.shareGetNode.active=!1,this.shopData=m.default.Instance.shopLogic.getShopData(this.shopInfo.shop_type,this.shopInfo.type,this.shopInfo.order),2==this.shopInfo.buy_type?(this.shopData.videoCount>=this.shopInfo.costList[0]?(this.shareGetNode.active=!0,cc.find("Num",this.shareGetNode).getComponent(cc.Label).string="("+this.shopData.videoCount+"/"+this.shopInfo.costList[0]+")"):this.shareNumNode.getComponent(cc.Label).string="("+this.shopData.videoCount+"/"+this.shopInfo.costList[0]+")",this.reqShareCount()):3==this.shopInfo.buy_type&&(this.videoNumNode.getComponent(cc.Label).string="("+this.shopData.videoCount+"/"+this.shopInfo.costList[0]+")"),this.limitNumNode.getComponent(cc.Label).string="("+this.shopData.rewardCount+"/"+this.shopInfo.buy_limit+")",cc.find("Over",this.node).active=this.shopData.rewardCount>=this.shopInfo.buy_limit},e.prototype.reqShareCount=function(){this.shopInfo.buy_type},e.prototype.updatePropShareCount=function(t){var e=t-this.shopData.shareCount;e<0&&(e=0),this.shopData.shareCount=t,this.shopData.videoCount=e,this.review(),p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart())},e.prototype.onClickBtn=function(t,e){if(u.SoundManager.Instance.playEffect("anniu"),1==e){var a=this.shopInfo.costList[0],n=this.shopInfo.costList[1];n<=m.default.Instance.moneyLogic.getItemCount(a)?(1==this.propType?(m.default.Instance.equipmentLogic.addEquipmentData(this.propId),m.default.Instance.combatScene.addRewardEffect(this.propId,1,1)):(m.default.Instance.moneyLogic.addItemCount(this.propId,this.propNum),m.default.Instance.combatScene.addRewardEffect(this.propId,this.propNum,2)),m.default.Instance.shopLogic.setShopData(this.shopInfo.shop_type,this.shopInfo.type,this.shopInfo.order,1,0),m.default.Instance.moneyLogic.addItemCount(a,-n),this.review()):m.default.Instance.moneyLogic.showMoreMoney(h.PAGE_NAME.Shop,a,!0)}else if(2==e){this.shareType=c.default.SHARE_TYPE_SHOP_INVITE;var i=this.shopData.seasionId;null==i&&(i=1),c.default.Instance.shareAppCallBack(this,function(){}),c.default.Instance.shareApp(p.default.Instance.playerData.openid,i,this.shopInfo.costList[1]),l.default.Platform==h.PLAT_FORM.Web&&(this.shareCount+=1,this.updatePropShareCount(this.shareCount))}else 3==e?c.default.Instance.adHandler(c.default.AD_TYPE_SHOP_REWARD,this,this.adCallback):4==e&&(this.shopData=m.default.Instance.shopLogic.setShopData(this.shopInfo.shop_type,this.shopInfo.type,this.shopInfo.order,1,0-this.shopInfo.costList[0]),1==this.propType?(m.default.Instance.equipmentLogic.addEquipmentData(this.propId),m.default.Instance.combatScene.addRewardEffect(this.propId,1,1)):(m.default.Instance.moneyLogic.addItemCount(this.propId,this.propNum),m.default.Instance.combatScene.addRewardEffect(this.propId,this.propNum,2)),this.review())},e.prototype.adCallback=function(t,e,a){0==e?t!=c.default.AD_TYPE_SHOP_REWARD&&t!=c.default.SHARE_TYPE_SHOP_REWARD||(m.default.Instance.shopLogic.setShopData(this.shopInfo.shop_type,this.shopInfo.type,this.shopInfo.order,0,1),this.shopData.videoCount>=this.shopInfo.costList[0]?(this.shopData.videoCount-=this.shopInfo.costList[0],this.shopData.rewardCount+=1,1==this.propType?(m.default.Instance.equipmentLogic.addEquipmentData(this.propId),m.default.Instance.combatScene.addRewardEffect(this.propId,1,1)):(m.default.Instance.moneyLogic.addItemCount(this.propId,this.propNum),m.default.Instance.combatScene.addRewardEffect(this.propId,this.propNum,2))):(m.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,1e4,2]],1),p.default.Instance.localStorage(m.default.Instance.combatScene.isGameStart())),this.review(),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||m.default.Instance.taskLogic.finishAllTask(g.default.type_see_ad_count1,0,1)):-1==e?(m.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_SHOP_REWARD&&(this.shareType=c.default.SHARE_TYPE_SHOP_REWARD),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):m.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else m.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){if(this.shareType!=c.default.SHARE_TYPE_SHOP_INVITE){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void m.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,m.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)}},e.prototype.shareFailCallback=function(t){0==t&&(m.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([_],e)}(cc.Component));o.default=v,cc._RF.pop()},{}],SigninItem:[function(t,e,a){"use strict";cc._RF.push(e,"4da9fmLA1lGbYRFj5WCWUGQ","SigninItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("GameData"),h=i("ConfigData"),u=i("MainLogic"),d=cc._decorator,p=d.ccclass,f=(d.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.day=t,this.dayNode=cc.find("Day",this.node),this.imgNode=cc.find("Img",this.node),this.framentNode=cc.find("Fragment",this.imgNode),this.nameNode=cc.find("Name",this.node),this.dayNode.getComponent(cc.Label).string="\u7b2c"+t+"\u5929",this.status=1,3==l.default.Instance.playerData.signinTaskList[t-1]&&(this.status=2);for(var e=1;e<=2;e++){var a=cc.find("Status"+e,this.node);this.status==e?a.active=!0:a.active=!1}var n,i=u.default.Instance.signinLogic.getSigninGift(t).itemList[0],o=i[1],r=i[2];if(1001==o){var s=u.default.Instance.chapterLogic.getMaxChapterInfo(1);r*=h.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).gold_reward}else 1004==o&&(s=u.default.Instance.chapterLogic.getMaxChapterInfo(1),r*=h.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).crystal_reward);1==i[0]?n=h.default.Instance.equipmentMap.get(o):(n=h.default.Instance.itemMap.get(o),this.framentNode.active=1==n.is_chip),6==n.type?this.imgNode.scale=.6:this.imgNode.scale=1,c.AssetUtils.loadSpriteFrame(this.imgNode,"Common/"+n.icon),this.nameNode.getComponent(cc.Label).string=""+r},e.prototype.reset=function(){this.status=1;var t=l.default.Instance.playerData.signinTaskList;3==t[this.day-1]||2==t[this.day-1]&&this.day<l.default.Instance.playerData.loginDayNum?this.status=3:1!=t[this.day-1]&&2!=t[this.day-1]||(this.status=2);for(var e=1;e<=3;e++){var a=cc.find("Status"+e,this.node);this.status==e?a.active=!0:a.active=!1}},s([p],e)}(cc.Component));o.default=f,cc._RF.pop()},{}],SigninLayer:[function(t,e,a){"use strict";cc._RF.push(e,"ec52cLls/tFwa8XP0d6SBM3","SigninLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("PublicConst"),h=i("PublicEnum"),u=i("MainLogic"),d=i("AdServer"),p=i("TaskLogic"),f=i("SoundManager"),y=i("AssetUtils"),m=i("ConfigData"),g=cc._decorator,I=g.ccclass,_=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.signinItemList=new Array,e.todayNum=1,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.itemListNode=cc.find("ItemList",this.node);for(var e=[1,2,3,4,5,6],a=this.itemListNode.children,n=0;n<a.length;n++){var i=a[n].getComponent("SigninItem");i.init(e[n]),this.signinItemList.push(i)}this.review(t)},e.prototype.review=function(t){this.pageName=t,this.todayNum=c.default.Instance.playerData.loginDayNum,this.status=u.default.Instance.signinLogic.getBtnStatus(this.todayNum),this.btnStatus=1,1==this.status?this.btnStatus=2:2==this.status&&(this.btnStatus=3);for(var e=1;e<=3;e++){var a=cc.find("Status"+e,this.node);this.btnStatus==e?a.active=!0:a.active=!1}for(e=0;e<2;e++)a=cc.find("Status1/Background/Status"+e,this.node),e==this.status?a.active=!0:a.active=!1;for(e=0;e<this.signinItemList.length;e++)this.signinItemList[e].reset();this.showDay7(),this.pageName==h.PAGE_NAME.Home?this.scheduleOnce(function(){d.default.Instance.showCustomAd(1),d.default.Instance.showCustomAd(2)},0):(this.pageName,h.PAGE_NAME.Task)},e.prototype.showDay7=function(){var t=cc.find("Day7",this.node),e=cc.find("Item",t),a=u.default.Instance.signinLogic.getSigninGift(7);a.big_pic?y.AssetUtils.loadSpriteFrame(e,"Fasion/"+a.big_pic):y.AssetUtils.loadSpriteFrame(e,"Fasion/qiandao_suitu_07");var n=1,i=c.default.Instance.playerData.signinTaskList;3==i[6]?n=3:1!=i[6]&&2!=i[6]||(n=2);for(var o=1;o<=3;o++)cc.find("Status"+o,t).active=n==o},e.prototype.onClickEvent=function(t,e){if(f.SoundManager.Instance.playEffect("anniu"),0==e)this.node.active=!1,this.pageName==h.PAGE_NAME.Home?(d.default.Instance.hideCustomAd(1),d.default.Instance.hideCustomAd(2),u.default.Instance.combatScene.homeLayer.showTips()):(this.pageName,h.PAGE_NAME.Task);else if(1==e){if(0==this.status);else if(1==this.status){for(var a=u.default.Instance.signinLogic.getSigninGift(this.todayNum),n=new Array,i=0;i<a.itemList.length;++i){var o=a.itemList[i][1],r=a.itemList[i][2];if(1001==o){var s=u.default.Instance.chapterLogic.getMaxChapterInfo(1);r*=m.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).gold_reward}else 1004==o&&(s=u.default.Instance.chapterLogic.getMaxChapterInfo(1),r*=m.default.Instance.dungeonMap.get(s[0]).get(s[1]).get(1).crystal_reward);n.push([o,r,a.itemList[i][0]])}u.default.Instance.giftBagLoigc.receiveGiftItems(n,1),c.default.Instance.playerData.signinTaskList[this.todayNum-1]=2,u.default.Instance.tipsLogic.updateSignTips(),this.review(this.pageName),u.default.Instance.taskLogic.finishAllTask(p.default.type_sigin_reward,0,1)}}else 2==e?d.default.Instance.adHandler(d.default.AD_TYPE_SIGNIN_DOUBLE,this,this.adCallback):3==e&&d.default.Instance.adHandler(d.default.AD_TYPE_SIGNIN_AGAIN,this,this.adCallback)},e.prototype.adCallback=function(t,e,a){if(0==e){for(var n=u.default.Instance.signinLogic.getSigninGift(this.todayNum),i=new Array,o=0;o<n.itemList.length;++o){var r=n.itemList[o][1],s=n.itemList[o][2];if(1001==r){var f=u.default.Instance.chapterLogic.getMaxChapterInfo(1);s*=m.default.Instance.dungeonMap.get(f[0]).get(f[1]).get(1).gold_reward}else 1004==r&&(f=u.default.Instance.chapterLogic.getMaxChapterInfo(1),s*=m.default.Instance.dungeonMap.get(f[0]).get(f[1]).get(1).crystal_reward);i.push([r,s,n.itemList[o][0]])}t==d.default.AD_TYPE_SIGNIN_DOUBLE||t==d.default.SHARE_TYPE_SIGNIN_DOUBLE?(u.default.Instance.giftBagLoigc.receiveGiftItems(i,2),c.default.Instance.playerData.signinTaskList[this.todayNum-1]=3,this.review(this.pageName),u.default.Instance.taskLogic.finishAllTask(p.default.type_sigin_reward,0,1),u.default.Instance.tipsLogic.updateSignTips()):t!=d.default.AD_TYPE_SIGNIN_AGAIN&&t!=d.default.SHARE_TYPE_SIGNIN_AGAIN||(u.default.Instance.giftBagLoigc.receiveGiftItems(i,1),c.default.Instance.playerData.signinTaskList[this.todayNum-1]=3,this.review(this.pageName),u.default.Instance.taskLogic.finishAllTask(p.default.type_sigin_reward,0,1),u.default.Instance.tipsLogic.updateSignTips()),0!=c.default.Instance.playerData.cdActiveFreeAd&&a||u.default.Instance.taskLogic.finishAllTask(p.default.type_see_ad_count1,0,1)}else-1==e?(u.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),d.default.Instance.noVideoToShare()&&(t==d.default.AD_TYPE_SIGNIN_DOUBLE?this.shareType=d.default.SHARE_TYPE_SIGNIN_DOUBLE:t==d.default.AD_TYPE_SIGNIN_AGAIN&&(this.shareType=d.default.SHARE_TYPE_SIGNIN_AGAIN),l.default.Platform==h.PLAT_FORM.Douyin?d.default.Instance.shareAppCallBack(this,this.shareAppCallback2):u.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),d.default.Instance.shareApp())):u.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void u.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,u.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),d.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else u.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-d.default.Instance.adServer.shareDateTime)/1e3);if(d.default.Instance.shareState(e)){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void u.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,u.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),d.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else d.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(u.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),d.default.Instance.shareApp())},s([I],e)}(cc.Component));o.default=_,cc._RF.pop()},{}],SigninLogic:[function(t,e,a){"use strict";cc._RF.push(e,"131aafY6MFPTo8qRsHhjqar","SigninLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("ConfigData"),r=n("GameData"),s=n("MainLogic"),c=function(){function t(){}return t.prototype.getSigninGift=function(t){var e=o.default.Instance.giftTypeMap.get(3),a=e.length/7,n=r.default.Instance.playerData.signinTimes;n>a&&(n=a),t=7*(n-1)+t;for(var i=0;i<e.length;i++)if(e[i].order==t)return s.default.Instance.giftBagLoigc.getGiftInfoByIndex(e[i].jsonIndex);return null},t.prototype.receiveSignin=function(t,e){for(var a=this.getSigninGift(t).itemList.slice(0),n=0;n<a.length;n++)a[n];return s.default.Instance.chapterLogic.receiveCombatBox(a,e),r.default.Instance.playerData.signinTaskList[t-1]=2,r.default.Instance.localStorage(s.default.Instance.combatScene.isGameStart()),!1},t.prototype.getBtnStatus=function(t){var e=r.default.Instance.playerData.signinTaskList[t-1];return 3==e?0:e},t}();i.default=c,cc._RF.pop()},{}],SkillGrowInfo:[function(t,e,a){"use strict";cc._RF.push(e,"70dbfN2PJpChpQlhRz0NIWN","SkillGrowInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.costList=new Array,this.lv=o.default.stringToInt(t.lv),this.cost2=o.default.stringToInt(t.cost2),this.cost3=o.default.stringToInt(t.cost3),this.cost4=o.default.stringToInt(t.cost4),this.cost5=o.default.stringToInt(t.cost5),this.cost6=o.default.stringToInt(t.cost6),this.cost7=o.default.stringToInt(t.cost7),this.cost8=o.default.stringToInt(t.cost8),this.cost9=o.default.stringToInt(t.cost9),this.cost10=o.default.stringToInt(t.cost10),this.costList.push(0),this.costList.push(1),this.costList.push(this.cost2),this.costList.push(this.cost3),this.costList.push(this.cost4),this.costList.push(this.cost5),this.costList.push(this.cost6),this.costList.push(this.cost7),this.costList.push(this.cost8),this.costList.push(this.cost9),this.costList.push(this.cost10)},cc._RF.pop()},{}],SkillHurtInfo:[function(t,e,a){"use strict";cc._RF.push(e,"305f0SUcStL45M0OBxnngdR","SkillHurtInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.num=o.default.stringToInt(t.num),this.Centrepoint=t.Centrepoint,this.hurt_area=t.hurt_area,this.initial_area=o.default.stringToInt(t.initial_area),this.centrePointList=o.default.config_stringToFloatListOfList(this.Centrepoint),this.hurtAreaList=o.default.config_stringToFloatListOfList(this.hurt_area)},cc._RF.pop()},{}],SkillInfo:[function(t,e,a){"use strict";cc._RF.push(e,"66036Sfo/BP9oFIOdfsmLqr","SkillInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=parseInt(t.id),this.name=t.name,this.icon=t.icon,this.quality=o.default.stringToInt(t.quality),this.skill_type=o.default.stringToInt(t.skill_type),this.skill_move=t.skill_move,this.attack_effect=t.attack_effect,this.sky_attack_effect=t.sky_attack_effect,this.unactive_time=t.unactive_time,this.hit_effect=t.hit_effect;var e=o.default.config_stringToIntList(this.hit_effect);this.hitEffect=e||[],this.attack_effect1=t.attack_effect1,this.unactive_time1=t.unactive_time1,this.hit_effect1=t.hit_effect1;var a=o.default.config_stringToIntList(this.hit_effect1);this.hitEffect1=a||[],this.effect_priority=t.effect_priority;var n=o.default.config_stringToIntList(this.effect_priority);this.effectPriority=n||[],this.injury_coefficient=t.injury_coefficient,this.injury_coefficient_add=o.default.stringToFloat(t.injury_coefficient_add),this.sound=t.sound,this.bullet_id=t.bullet_id,this.exploded_id=t.exploded_id,this.lock_area=t.lock_area;var i=o.default.config_stringToIntList(this.lock_area,"_");this.lockArea=i||[],this.hurt_res=t.hurt_res,this.skill_description=t.skill_description,this.Trap_last_time=o.default.stringToFloat(t.Trap_last_time),this.waring_time=o.default.stringToFloat(t.waring_time),this.hit_sound=t.hit_sound,this.skill_condition=o.default.stringToInt(t.skill_condition),this.condition_value=o.default.stringToFloat(t.condition_value),this.condition_value_grow=t.condition_value_grow,this.conditionValueGrow=o.default.config_stringToIntList(this.condition_value_grow,"_"),this.energy=o.default.stringToInt(t.energy),this.injury_height=o.default.stringToInt(t.injury_height),this.break=o.default.stringToInt(t.break),this.be_break=o.default.stringToInt(t.be_break),this.level_limit=o.default.stringToInt(t.level_limit),this.unlocked_tips=t.unlocked_tips,this.injury_coefficient_show=o.default.stringToFloat(t.injury_coefficient_show),this.injury_coefficient_add_show=o.default.stringToFloat(t.injury_coefficient_add_show),this.strong_cost=t.strong_cost,this.strongCostList=o.default.config_stringToIntListOfList(this.strong_cost),this.bullet_angle=t.bullet_angle,this.bulletAngleList=o.default.config_stringToIntList(this.bullet_angle),this.shot_range=o.default.stringToInt(t.shot_range),this.hurt_area_type=o.default.stringToInt(t.hurt_area_type),this.shake_screen=t.shake_screen,this.shakeScreen=o.default.config_stringToFloatList(this.shake_screen),this.buff_id=t.buff_id;var r=o.default.config_stringToIntList(this.buff_id);this.buffPools=r||[];var s=o.default.config_stringToIntListOfList(this.skill_move);if(null!=s&&s.length>0){this.move_impulse=new Array;for(var c=0;c<s.length;c++){var l=s[c];this.move_impulse.push(new cc.Vec2(l[0],l[1]))}}this.hitImpulseList=o.default.config_stringToIntListOfList(this.attack_effect),this.hitImpulseList1=o.default.config_stringToIntListOfList(this.attack_effect1),this.hitSkyAttackEffect=o.default.config_stringToIntListOfList(this.sky_attack_effect);var h=o.default.config_stringToFloatList(this.unactive_time);null!=h&&h.length>0&&(this.hitTimeList=h);var u=o.default.config_stringToFloatList(this.unactive_time1);null!=u&&u.length>0&&(this.hitTimeList1=u),null!=(h=o.default.config_stringToFloatList(this.injury_coefficient))&&h.length>0&&(this.hurtRateList=h),this.hurt_area=t.hurt_area,this.hurtAreaList=o.default.config_stringToIntList(this.hurt_area,"_"),this.hurt_startspace=t.hurt_startspace,this.hurtStartList=o.default.config_stringToIntListOfList(this.hurt_startspace),this.speed=o.default.stringToInt(t.speed),this.max_hurt=o.default.stringToInt(t.max_hurt,1),this.hurt_intermission=o.default.stringToFloat(t.hurt_intermission,.5)},cc._RF.pop()},{}],SkillItem:[function(t,e,a){"use strict";cc._RF.push(e,"54d89JGXmZLcJTB4ApeZqmK","SkillItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("SoundManager"),h=i("ConfigData"),u=i("AssetUtils"),d=i("MainLogic"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.review=function(t,e,a,n){this.skillId=t,this.skillIndex=e,this.heroId=a,this.skillLayer=n;var i=h.default.Instance.skillMap.get(t);this.unlockInfo=h.default.Instance.unlockSkillMap.get(t);var o=d.default.Instance.roleLogic.getRoleData(a),r=o.skillLevel[this.unlockInfo.skill_number-1];r>c.default.MAX_PLAYER_LEVEL&&(r=c.default.MAX_PLAYER_LEVEL,o.skillLevel[this.unlockInfo.skill_number-1]=r);var s=cc.find("Level/Level",this.node);s.getComponent(cc.Label).string="Lv."+r,s.parent.active=0!=r;var l=cc.find("Item",this.node);u.AssetUtils.loadSpriteFrame(l,"Skill/skill_icon_"+i.icon);var p=cc.find("Selected",this.node);p.active=2==this.unlockInfo.skill_number,p.active&&(n.currSkillId=this.unlockInfo.skill_id),0==r&&d.default.Instance.roleLogic.canUnlockSkill(this.heroId,this.unlockInfo.unlock_condition1,this.unlockInfo.value1List)&&d.default.Instance.roleLogic.canUnlockSkill(this.heroId,this.unlockInfo.unlock_condition2,this.unlockInfo.value2List)&&(r=1,o.skillLevel[this.unlockInfo.skill_number-1]=1),cc.find("Lock",this.node).active=0==r},e.prototype.updateItem=function(t){var e=d.default.Instance.roleLogic.getRoleData(this.heroId),a=e.skillLevel[this.unlockInfo.skill_number-1];a>c.default.MAX_PLAYER_LEVEL&&(a=c.default.MAX_PLAYER_LEVEL,e.skillLevel[this.unlockInfo.skill_number-1]=a);var n=cc.find("Level/Level",this.node);n.getComponent(cc.Label).string="Lv."+a,n.parent.active=0!=a,cc.find("Selected",this.node).active=this.skillId==t,cc.find("Lock",this.node).active=0==a},e.prototype.onClickEvent=function(){l.SoundManager.Instance.playEffect("anniu"),this.skillLayer.setCurrSkillId(this.skillId)},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],SkillLayer:[function(t,e,a){"use strict";cc._RF.push(e,"d0fccUdJmBJmrOqVIpukqJ9","SkillLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("StringUtils"),m=i("MainLogic"),g=i("TaskLogic"),I=i("SkillItem"),_=cc._decorator,v=_.ccclass,S=_.property,L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e.itemInitPos=[cc.v2(-483,12),cc.v2(-483,150),cc.v2(-304,150),cc.v2(-170,150),cc.v2(-237,13),cc.v2(-237,-118),cc.v2(-237,-250),cc.v2(53,150),cc.v2(53,14),cc.v2(53,-152)],e.skillItems=new Array,e}return r(e,t),e.prototype.init=function(t,e){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.rightSkillNode=cc.find("Layer/Right/Item",this.node),this.rightSkillName=cc.find("Layer/Right/Name",this.node),this.rightUnlockNode=cc.find("Layer/Right/Unlock",this.node),this.rightUpgradeNode=cc.find("Layer/Right/Upgrade",this.node),this.review(t,e)},e.prototype.review=function(t,e){if(this.node.active=!0,this.pageName=t,0==this.skillItems.length)for(var a=cc.find("Layer/Center",this.node),n=0;n<this.itemInitPos.length;++n){var i=cc.instantiate(this.itemPrefab);a.addChild(i),i.setPosition(this.itemInitPos[n]);var o=i.getComponent(I.default);this.skillItems.push(o)}for(n=0;n<this.skillItems.length;++n)this.skillItems[n].node.active=!1;for(this.heroId=e,this.roleInfo=d.default.Instance.roleMap.get(e),n=0;n<this.roleInfo.skillPools.length;++n){var r=d.default.Instance.unlockSkillMap.get(this.roleInfo.skillPools[n]);(o=this.skillItems[r.skill_number-1]).node.active=!0,o.review(r.skill_id,r.skill_number-1,e,this),this.skillItems[r.skill_number-1]=o}this.showRightInfo(),this.showMoney(),this.pageName==h.PAGE_NAME.Home||this.pageName==h.PAGE_NAME.CombatResult?this.scheduleOnce(function(){c.default.Instance.showCustomAd(1)},0):this.pageName==h.PAGE_NAME.Task?this.scheduleOnce(function(){c.default.Instance.hideCustomAd(2)},0):this.pageName==h.PAGE_NAME.Combat&&this.scheduleOnce(function(){c.default.Instance.hideCustomAd(3),c.default.Instance.showCustomAd(1)},0)},e.prototype.showCenterInfo=function(){for(var t=0;t<this.skillItems.length;++t)this.skillItems[t].node.active&&this.skillItems[t].updateItem(this.currSkillId)},e.prototype.showRightInfo=function(){var t=d.default.Instance.unlockSkillMap.get(this.currSkillId),e=m.default.Instance.roleLogic.getRoleData(this.heroId),a=d.default.Instance.skillMap.get(this.currSkillId);f.AssetUtils.loadSpriteFrame(this.rightSkillNode,"Skill/skill_icon_"+a.icon),cc.find("Layer/Right/Name",this.node).getComponent(cc.Label).string=a.name;var n=cc.find("Layer/Right/Unlock",this.node);n.active=!1;var i=cc.find("Layer/Right/Upgrade",this.node);if(i.active=!1,0==e.skillLevel[t.skill_number-1]){n.active=!0;var o=m.default.Instance.roleLogic.getUnlockSkillDesc(this.heroId,this.currSkillId,t.unlock_condition1,t.value1List),r=cc.find("Condition1/Condition",n);r.active=!0;var s=cc.find("Condition1/Value",n);s.active=!0,o.length>0?(r.getComponent(cc.Label).string=o[0],s.getComponent(cc.Label).string=o[1]):(r.active=!1,s.active=!1);var c=m.default.Instance.roleLogic.getUnlockSkillDesc(this.heroId,this.currSkillId,t.unlock_condition2,t.value2List),h=cc.find("Condition2/Condition",n);h.active=!0;var u=cc.find("Condition2/Value",n);u.active=!0,c.length>0?(h.getComponent(cc.Label).string=c[0],u.getComponent(cc.Label).string=c[1]):(h.active=!1,u.active=!1)}else{i.active=!0;var p=e.skillLevel[t.skill_number-1];p>l.default.MAX_PLAYER_LEVEL&&(p=l.default.MAX_PLAYER_LEVEL,e.skillLevel[t.skill_number-1]=p),cc.find("Level",i).getComponent(cc.Label).string=p+"";var g=cc.find("Desc",i),I=void 0;if(2003==a.id){var _=a.buffPools[0];I=(S=d.default.Instance.buffItemMap.get(_)).valueList[0]+S.grow_coefficient*(p-1)}else I=a.injury_coefficient_show*(1+a.injury_coefficient_add_show*(p-1))*100;var v=a.skill_description;v=v.replace("{injury_coefficient_show}",y.default.intFormate(I)+"%"),g.getComponent(cc.Label).string=v,cc.find("Level2",i).getComponent(cc.Label).string=p+1+"";var S,L=cc.find("Desc2",i);2003==a.id?(_=a.buffPools[0],I=(S=d.default.Instance.buffItemMap.get(_)).valueList[0]+S.grow_coefficient*p):I=a.injury_coefficient_show*(1+a.injury_coefficient_add_show*p)*100,v=(v=a.skill_description).replace("{injury_coefficient_show}",y.default.intFormate(I)+"%"),L.getComponent(cc.Label).string=v,cc.find("Cost/Num",i).getComponent(cc.Label).string="x"+d.default.Instance.skillGrowMap.get(p).costList[t.skill_number]}},e.prototype.setCurrSkillId=function(t){this.currSkillId=t,this.showCenterInfo(),this.showRightInfo()},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=y.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+y.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1004))},e.prototype.onClickEvent=function(t,e){if(u.SoundManager.Instance.playEffect("anniu"),2==e){var a=m.default.Instance.roleLogic.getSkillLevel(this.heroId,this.currSkillId);if(a==p.default.Instance.playerData.level||a>=l.default.MAX_PLAYER_LEVEL)return void m.default.Instance.combatScene.showMsgInfo("\u6280\u80fd\u7b49\u7ea7\u4e0d\u80fd\u8d85\u8fc7\u82f1\u96c4\u7b49\u7ea7");var n=d.default.Instance.unlockSkillMap.get(this.currSkillId),i=d.default.Instance.skillGrowMap.get(a).costList[n.skill_number];m.default.Instance.moneyLogic.getItemCount(1001)>=i?(m.default.Instance.moneyLogic.addItemCount(1001,-i),m.default.Instance.roleLogic.upgradeHeroSkillLevel(this.heroId,this.currSkillId),this.showCenterInfo(),this.showRightInfo(),m.default.Instance.tipsLogic.updateAllTips(),m.default.Instance.taskLogic.finishAllTask(g.default.type_skill_upgrade_count,0,1)):m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Skill,1,!0)}else 1==e?(this.node.active=!1,this.pageName==h.PAGE_NAME.Home?(m.default.Instance.combatScene.gotoHomeLayer(),c.default.Instance.hideCustomAd(1)):this.pageName==h.PAGE_NAME.Task?c.default.Instance.showCustomAd(2):this.pageName==h.PAGE_NAME.CombatResult||this.pageName==h.PAGE_NAME.Combat&&(m.default.Instance.combatScene.showCombatLayer(),c.default.Instance.hideCustomAd(1),c.default.Instance.showCustomAd(3))):100==e?m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Skill,1,!0):101==e&&m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Skill,2,!0)},s([S(cc.Prefab)],e.prototype,"itemPrefab",void 0),s([v],e)}(cc.Component);o.default=L,cc._RF.pop()},{}],SkillManager:[function(t,e,a){"use strict";cc._RF.push(e,"f6d3cLmgtBIlaQ4oHsrMcaA","SkillManager");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("SkillObject"),r=n("ConfigData"),s=function(){function t(t){this.skillList=new Array,this._heroSprite=t;var e=this._heroSprite.roleInfo;if(e.skillPools.length>1)for(var a=1;a<e.skillPools.length;++a){var n=r.default.Instance.skillMap.get(e.skillPools[a]),i=new o.default(this,a,n);this.skillList.push(i)}e.skill_passive1&&(n=r.default.Instance.skillMap.get(e.skill_passive1),i=new o.default(this,-1,n),this.skillList.push(i)),e.skill_passive2&&(n=r.default.Instance.skillMap.get(e.skill_passive2),i=new o.default(this,-1,n),this.skillList.push(i))}return t.prototype.logicUpdate=function(t){for(var e=0;e<this.skillList.length;e++)this.skillList[e].logicUpdate(t)},t.prototype.resetData=function(){for(var t=0;t<this.skillList.length;t++){var e=this.skillList[t];e.resetData(),e.targetTime=0}},t.prototype.addEnergy=function(t,e){for(var a=0;a<this.skillList.length;a++){var n=this.skillList[a];n.cdType==e&&n.addEnergy(t)}},t.prototype.cdOverLogic=function(t){this._heroSprite.cdOver(t)},t.prototype.getSkillObj=function(t){for(var e=0;e<this.skillList.length;e++){var a=this.skillList[e];if(a.skillInfo.id==t)return a}},t.prototype.releaseSkill=function(t){t.resetData()},t.prototype.reviedSkillCd=function(){for(var t=0;t<this.skillList.length;t++)this.skillList[t].targetTime=0},t}();i.default=s,cc._RF.pop()},{}],SkillObject:[function(t,e,a){"use strict";cc._RF.push(e,"a28b4dyP6JGwbgHtuLSRnti","SkillObject");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=n("MainLogic"),s=function(){function t(t,e,a){this.cdType=1,this.targetTime=0,this.skillIndex=0,this.skillInfo=a,this.skillManager=t,this.skillIndex=e,this.resetData()}return t.prototype.resetData=function(){this.skillState=o.SKILL_STATE.ContinuouCd,this.cdType=this.skillInfo.skill_condition,this.targetTime=this.skillInfo.condition_value,this.skillManager._heroSprite==r.default.Instance.combatLayer.mainLayer.myHeroSprite&&this.skillIndex>0?r.default.Instance.combatLayer.uiLayer.showSkillRate(this.targetTime,this.skillIndex,this.skillInfo.condition_value):-1==this.skillIndex&&(this.energy=this.skillInfo.condition_value)},t.prototype.logicUpdate=function(t){if(this.skillManager._heroSprite.lifeStatus!=o.LIFE_STATUS.Dead)switch(this.skillState){case o.SKILL_STATE.ContinuouCd:2==this.cdType&&(this.targetTime-=t,this.targetTime<=0&&(this.skillState=o.SKILL_STATE.CdOver,this.skillManager.cdOverLogic(this)),this.skillManager._heroSprite==r.default.Instance.combatLayer.mainLayer.myHeroSprite&&r.default.Instance.combatLayer.uiLayer.showSkillRate(this.targetTime,this.skillIndex,this.skillInfo.condition_value))}},t.prototype.addEnergy=function(t){this.energy+=t,this.energy<=0?(this.energy=0,this.skillState=o.SKILL_STATE.ContinuouCd):this.energy>=this.skillInfo.condition_value?(this.skillState=o.SKILL_STATE.CdOver,this.energy=this.skillInfo.condition_value):this.skillState=o.SKILL_STATE.ContinuouCd},t.prototype.useSkill=function(){this.skillState=o.SKILL_STATE.ContinuouCd,this.targetTime=this.skillInfo.condition_value},t}();i.default=s,cc._RF.pop()},{}],SmallMapItem:[function(t,e,a){"use strict";cc._RF.push(e,"8fadd4oawFJ95gLqMAi2QV2","SmallMapItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("MyMathUtils"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lineNodes=new Array,e.gridX=0,e.gridY=0,e}return r(e,t),e.prototype.init=function(){this.itemNode=cc.find("Item",this.node);for(var t=1;t<=4;++t){var e=cc.find("Line"+t,this.node);this.lineNodes.push(e)}this.bossNode=cc.find("Boss",this.node),this.heroNode=cc.find("Hero",this.node),this.grayNode=cc.find("Gray",this.node)},e.prototype.review=function(t){this.node.x=t.x,this.node.y=t.y,this.itemNode.active=!1,this.grayNode.active=!0,this.heroNode.active=!1,this.bossNode.active=!1;for(var e=0;e<this.lineNodes.length;++e)this.lineNodes[e].active=!1},e.prototype.setDoorInfo=function(t,e){var a=l.default.randomInt(1,12);this.itemNode.active=!0,c.AssetUtils.loadSpriteFrame(this.itemNode,"Combat/zhandou_mopA_"+(a<10?"0"+a:""+a));for(var n=0;n<this.lineNodes.length;++n){var i=n+1;t.indexOf(i)>=0?this.lineNodes[n].active=!0:this.lineNodes[n].active=!1}this.grayNode.active=!0,this.heroNode.active=!1,this.bossNode.active=e},e.prototype.showHeroNode=function(t){this.heroNode.active=t,t&&(this.showGrayNode(!1),this.showBossNode(!1))},e.prototype.showBossNode=function(t){this.bossNode.active=t},e.prototype.showGrayNode=function(t){this.grayNode.active=t},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],SmallMapLayer:[function(t,e,a){"use strict";cc._RF.push(e,"30da1JFIbNOFLPLT3PbLzYe","SmallMapLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("MainLogic"),l=cc._decorator,h=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.smallMapScript=new Array,e.smallMapHeight=46,e.smallMapWidth=46,e}return r(e,t),e.prototype.resetSmallMap=function(){for(var t=c.default.Instance.combatScene.combatLayer,e=t.dungeonInfo,a=e.stageTypeList[0],n=a[0],i=a[1],o=n;o>0;--o)for(var r=0-(5+(o-1)*this.smallMapHeight+this.smallMapHeight/2),s=n-o+1,l=0;l<i;++l){var h=5+this.smallMapWidth*(l+.5),u=l+1,d=t.mainLayer.nodeManager.getSmallMapItem(cc.v2(h,r));d.node.parent=this.node,d.gridX=s,d.gridY=u;var p=e.getRoomInfo(s,u);if(p.length>0){var f=e.getDoors([s,u]);d.setDoorInfo(f,3==p[2])}this.smallMapScript.push(d)}this.node.height=10+n*this.smallMapHeight,this.node.width=10+i*this.smallMapWidth},e.prototype.gameOver=function(){for(var t=c.default.Instance.combatScene.combatLayer,e=this.smallMapScript.length-1;e>=0;e--){var a=this.smallMapScript[e];t.mainLayer.nodeManager.putSmallMapItem(a)}},e.prototype.showHeroNode=function(t){for(var e=0;e<this.smallMapScript.length;++e)t[0]==this.smallMapScript[e].gridX&&t[1]==this.smallMapScript[e].gridY?this.smallMapScript[e].showHeroNode(!0):this.smallMapScript[e].showHeroNode(!1)},s([h],e)}(cc.Component));o.default=u,cc._RF.pop()},{}],SortDataList:[function(t,e,a){"use strict";cc._RF.push(e,"86f0ascunJM/ISQGxZ5oaW3","SortDataList");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.SortData=n.SortDataList=void 0;var i=function(){function t(){this.array=new Array}return t.prototype.addSortData=function(t,e){this.array.push(new o(t,e))},t.prototype.sort=function(t){return null==t&&(t=!0),this.array.sort(function(e,a){return t?e.value<a.value?-1:e.value==a.value?0:1:e.value<a.value?1:e.value==a.value?0:-1})},t}();n.SortDataList=i;var o=function(t,e){this.key=t,this.value=e};n.SortData=o,cc._RF.pop()},{}],SoundManager:[function(t,e,a){"use strict";cc._RF.push(e,"18973IObOJBzpPuKMK1NQHd","SoundManager");var n=t,i=a,o=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0}),i.SoundManager=void 0;var r=n("GameData"),s=n("Dictionary"),c=n("StringUtils"),l=n("PublicConst"),h=n("PublicEnum"),u=cc._decorator,d=u.ccclass,p=(u.property,function(){function t(){this.sounds={},this.music="",this.effectMap=new s.Dictionary,this.musicStatusAd=!0,this.audioConfig={}}var e;return e=t,Object.defineProperty(t,"Instance",{get:function(){return this.instance||(this.instance=new e),this.instance},enumerable:!1,configurable:!0}),t.prototype.loadStart=function(t,a){e.Instance.loadBundle(this,function(){a.call(t)})},t.prototype.addSound=function(t,e){this.sounds[t]=e},t.prototype.playEffect=function(t){try{if(c.default.stringIsNull(t))return-1;if(1!=r.default.Instance.playerData.soundEffectStatus)return-1;if(null==e.Instance.audioConfig[t])return console.log("\u4e0d\u5b58\u5728 "+t),-1;var a=this.effectMap.get(t),n=(new Date).getTime();if(null!=a&&n-a<200)return-1;this.effectMap.put(t,n);var i=this.sounds[t];return null==i?(this.loadBundleSound(t,this,this.playEffect),-1):cc.audioEngine.playEffect(i,!1)}catch(l){console.log("sound manager playEffect ",l)}},t.prototype.stopEffect=function(t){if(l.default.Platform!=h.PLAT_FORM.Opp&&-1!=t)try{cc.audioEngine.stopEffect(t)}catch(e){}},t.prototype.playMusic=function(t){try{if(t==this.music)return;if(c.default.stringIsNull(t))return;if(null==e.Instance.audioConfig[t])return;var a=this.sounds[t];if(null==a)return void this.loadBundleSound(t,this,this.playMusic);0==r.default.Instance.playerData.musicStatus?cc.audioEngine.pauseAll():(this.music=t,cc.audioEngine.playMusic(a,!0))}catch(o){console.log(" sound manager playMusic ",o)}},t.prototype.resumeMusic=function(){if(r.default.Instance.playerData.musicStatus=1,r.default.Instance.localStorage(!1),l.default.Platform==h.PLAT_FORM.Opp){var t=this.music;return this.music="",void this.playMusic(t)}cc.audioEngine.resumeAll()},t.prototype.resumeMusicAd=function(){if(this.musicStatusAd=!0,l.default.Platform==h.PLAT_FORM.Opp){var t=this.music;return this.music="",void this.playMusic(t)}1==r.default.Instance.playerData.musicStatus&&cc.audioEngine.resumeAll()},t.prototype.resumeAllEffects=function(){1!=r.default.Instance.playerData.soundEffectStatus&&(r.default.Instance.playerData.soundEffectStatus=1,r.default.Instance.localStorage(!1),l.default.Platform!=h.PLAT_FORM.Opp&&cc.audioEngine.resumeAllEffects())},t.prototype.pauseMusic=function(){r.default.Instance.playerData.musicStatus=0,r.default.Instance.localStorage(!1),cc.audioEngine.pauseAll()},t.prototype.pauseMusicAd=function(){l.default.Platform!=h.PLAT_FORM.Opp&&(this.musicStatusAd=!1,cc.audioEngine.pauseAll())},t.prototype.pauseAllEffects=function(){0!=r.default.Instance.playerData.soundEffectStatus&&(l.default.Platform!=h.PLAT_FORM.Opp&&cc.audioEngine.stopAllEffects(),r.default.Instance.playerData.soundEffectStatus=0,r.default.Instance.localStorage(!1))},t.prototype.loadBundle=function(t,a){var n=this;cc.assetManager.loadBundle("Sound",function(i,o){n.soundBundle=o;var r=o._config.assetInfos._map;for(var s in r){var c=r[s];if(!e.Instance.audioConfig[c.path]){var l=o._config.base+"native/"+s.substr(0,2)+"/"+c.uuid;null!=c.nativeVer&&(l+="."+c.nativeVer),l+=".mp3",e.Instance.audioConfig[c.path]=l}}a.call(t)})},t.prototype.loadBundleSound=function(t,e,a){if(null!=this.soundBundle){var n=this;this.soundBundle.load(t,cc.AudioClip,function(i,o){n.addSound(t,o),a.call(e,t)})}},t.prototype.loadBundleSounds=function(t,e,a){if(null!=this.soundBundle){var n=this;this.soundBundle.load(t,cc.AudioClip,function(i,o){for(var r=0;r<o.length;++r){var s=o[r];n.addSound(s.name,s)}a.call(e,t)})}},e=o([d],t)}());i.SoundManager=p,cc._RF.pop()},{}],StageInfo:[function(t,e,a){"use strict";cc._RF.push(e,"2fb4dVTRapCP74oLSaHe/JW","StageInfo");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){this.id=parseInt(t.id),this.monster_num_min=parseInt(t.monster_num_min),this.monster_num_max=parseInt(t.monster_num_max),this.is_elite_monster=parseInt(t.is_elite_monster),this.elite_monster_num_min=parseInt(t.elite_monster_num_min),this.elite_monster_num_max=parseInt(t.elite_monster_num_max)},cc._RF.pop()},{}],StreetHero:[function(t,e,a){"use strict";cc._RF.push(e,"84347hWck9I8InGXX12yZpy","StreetHero");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("AssetUtils"),h=i("MyMathUtils"),u=i("StringUtils"),d=i("MainLogic"),p=cc._decorator,f=p.ccclass,y=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.face=1,e.moveSpeed=0,e.bodyRadius=0,e.moveAngle=0,e.heroArmResId="",e.wingArmResId="",e.titleArmResId="",e.weaponId=0,e.weaponLevel=0,e.loadFinish=!1,e.loadWingFinish=!1,e.loadTitleFinish=!1,e}return r(e,t),e.prototype.init=function(t,e){var a=this;this.streetLayer=t,this.heroId=e,this.roleInfo=c.default.Instance.roleMap.get(this.heroId),this.moveSpeed=this.roleInfo.move_speed,this.bodyRadius=this.roleInfo.bodyArea.width,this.bodyNode=cc.find("Body",this.node),this.bodyDiplay=this.bodyNode.getComponent(sp.Skeleton);var n=d.default.Instance.roleLogic.getRoleArmResId();this.heroArmResId=n[0];var i=u.default.stringToStringListForRes(n[0]),o=c.default.Instance.resourceMap.get(n[0]);this.node.scale=o.scale,l.AssetUtils.loadSpine(this.bodyDiplay,"Animation/"+i[0],i[1],function(){a.loadFinish=!0,a.playStand(),a.weaponId=d.default.Instance.roleLogic.getRoleWeaponId(),d.default.Instance.roleLogic.changeWeaponSkin(a.bodyDiplay,a.weaponId),a.weaponLevel=d.default.Instance.roleLogic.getRoleWeaponLevel(),d.default.Instance.roleLogic.weaponUpgrade(a.bodyDiplay,a.weaponLevel,a.weaponId)},this),this.wingNode=cc.find("Wing",this.node),this.wingDiplay=this.wingNode.getComponent(sp.Skeleton);var r=n[1];if(this.wingArmResId=r,null!=r){var s=c.default.Instance.resourceMap.get(r).resource_way;this.wingNode.active=!0,l.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+s,null,function(){a.loadWingFinish=!0,a.playWingStand()},this)}else r==this.wingArmResId&&null!=r?(this.loadWingFinish=!0,this.wingNode.active=!0):(this.loadWingFinish=!1,this.wingNode.active=!1);this.titleNode=cc.find("Title",this.node),this.titleDiplay=this.titleNode.getComponent(sp.Skeleton),this.titleArmResId=n[2],null!=this.titleArmResId?(this.titleNode.active=!0,l.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+this.titleArmResId,null,function(){a.loadTitleFinish=!0,a.playTitleStand()},this)):(this.loadTitleFinish=!1,this.titleNode.active=!1)},e.prototype.review=function(){var t=d.default.Instance.roleLogic.getRoleWeaponId();t!=this.weaponId&&(this.weaponId=t,d.default.Instance.roleLogic.changeWeaponSkin(this.bodyDiplay,this.weaponId));var e=d.default.Instance.roleLogic.getRoleWeaponLevel();e!=this.weaponLevel&&(this.weaponLevel=e,d.default.Instance.roleLogic.weaponUpgrade(this.bodyDiplay,this.weaponLevel,t))},e.prototype.updateHeroArm=function(){var t=this,e=d.default.Instance.roleLogic.getRoleArmResId();if(e[0]!=this.heroArmResId){this.heroArmResId=e[0];var a=u.default.stringToStringListForRes(e[0]),n=c.default.Instance.resourceMap.get(e[0]);this.node.scale=n.scale,this.bodyDiplay.setSkin(a[1]),this.playStand(),d.default.Instance.roleLogic.changeWeaponSkin(this.bodyDiplay,this.weaponId)}var i=e[1];if(i!=this.wingArmResId&&null!=i){this.wingArmResId=i;var o=c.default.Instance.resourceMap.get(i).resource_way;this.loadWingFinish=!1,this.wingNode.active=!0,l.AssetUtils.loadSpine(this.wingDiplay,"Animation/"+o,null,function(){t.loadWingFinish=!0,t.playWingStand()},this)}else i==this.wingArmResId&&null!=i?(this.loadWingFinish=!0,this.wingNode.active=!0):null==i&&(this.loadWingFinish=!1,this.wingNode.active=!1);this.titleArmResId=e[2],null!=this.titleArmResId?(this.titleNode.active=!0,l.AssetUtils.loadSpine(this.titleDiplay,"Animation/"+this.titleArmResId,null,function(){t.loadTitleFinish=!0,t.playTitleStand()},this)):(this.loadTitleFinish=!1,this.titleNode.active=!1)},e.prototype.getWeaponPoint=function(){var t=this.bodyDiplay.attachUtil,e=t.getAttachedNodes("dao211");0==e.length&&(t.generateAllAttachedNodes(),e=t.getAttachedNodes("dao211"));var a=e[0];if(a){var n=a.convertToWorldSpaceAR(cc.v2(0,0)),i=a.convertToWorldSpaceAR(cc.v2(1,0)),o=n.sub(i);return{pos:n,pos1:i,angle:180*cc.v2(1,0).signAngle(o)/Math.PI+180}}return null},e.prototype.setPosition=function(t){this.node.x=t.x,this.node.y=t.y},e.prototype.playStand=function(){this.bodyDiplay.setAnimation(0,"stand",!0),this.bodyDiplay.timeScale=1,this.loadWingFinish&&this.playWingStand()},e.prototype.playMove=function(){this.bodyDiplay.setAnimation(0,"move",!0),this.bodyDiplay.timeScale=1,this.loadWingFinish&&this.playWingMove()},e.prototype.playWingStand=function(){this.wingDiplay.setAnimation(0,"stand",!0),this.wingDiplay.timeScale=1},e.prototype.playWingMove=function(){this.wingDiplay.setAnimation(0,"move",!0),this.wingDiplay.timeScale=1},e.prototype.playTitleStand=function(){this.titleDiplay.setAnimation(0,"stand",!0),this.titleDiplay.timeScale=1},e.prototype.controlMove=function(t,e,a){this.bodyNode.scaleX=this.face,this.wingNode.scaleX=this.face;var n=this.moveSpeed*t,i=.7;a&&(i=1);var o=this.node.x+Math.cos(e)*n,r=this.node.y+Math.sin(e)*n*i,s=this.streetLayer.currFightMap.fightMapData.objectInWall(o,r,this.bodyRadius*this.node.scale,20),c=s.inWall,l=h.default.toAngle(s.angle);if(!(s.times>1)){var u=this.moveAngle;if(u<0&&(u+=360),l<0&&(l+=360),c){if(a)return;var d=l+180;return d>360&&(d-=360),void(Math.abs(l-u)<Math.abs(d-u)?this.controlMove(t,h.default.toRadian(l),!0):this.controlMove(t,h.default.toRadian(d),!0))}this.node.x=o,this.node.y=r}},s([f],e)}(cc.Component));o.default=y,cc._RF.pop()},{}],StreetLayer:[function(t,e,a){"use strict";cc._RF.push(e,"3fc2eF+wF9JvpuAo1JPERhr","StreetLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("GameData"),h=i("AssetUtils"),u=i("MyMathUtils"),d=i("GuideUtils"),p=i("MainLogic"),f=i("KnifeShadow"),y=i("StreetHero"),m=cc._decorator,g=m.ccclass,I=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroPrefab=null,e.knifeShadowPrefab=null,e.streetHero=null,e.isMove=!1,e.leaveNpc=!0,e.preShowLayer="",e.knifShadowPool=new cc.NodePool,e.weaponShadowPoints=new Array,e.knifeShadowNodes=new Array,e}return r(e,t),e.prototype.init=function(t){var e=this;this.homeLayer=t,h.AssetUtils.loadPrefab("Prefab/Map/HomeMap",function(t){var a=cc.instantiate(t),n=a.getComponent("FightMap");e.node.addChild(a),n.init("HomeMap"),n.resetData([]),e.currFightMap=n,n.showDoor([],!0),e.createHero(),e.portalNode=cc.find("ObstacleLayer/Chapter",a),p.default.Instance.combatScene.mainCamera.gameInit(),p.default.Instance.combatScene.mainCamera.gameStart(),p.default.Instance.combatScene.combatLoadingNode.active=!1,d.default.Instance.isHaveGuide(1,1)&&e.scheduleOnce(function(){e.homeLayer.guideAction()},.3)},this)},e.prototype.review=function(){this.leaveShowLayer(),this.streetHero.review(),p.default.Instance.combatScene.mainCamera.gameInit(),p.default.Instance.combatScene.mainCamera.gameStart(),p.default.Instance.combatScene.combatLoadingNode.active=!1},e.prototype.createHero=function(){var t=cc.instantiate(this.heroPrefab);this.streetHero=t.getComponent(y.default),this.streetHero.init(this,1001),this.streetHero.setPosition(cc.v2(300,-250)),t.zIndex=10,this.node.addChild(t),this.schedule(this.heroWeaponShadow,.2)},e.prototype.heroWeaponShadow=function(){if(this.streetHero.loadFinish){var t=p.default.Instance.equipmentLogic.getEquipmentData(this.streetHero.weaponId);if(null==t)return;if(5!=c.default.Instance.equipmentMap.get(t.equipmentId).type)return;var e=this.streetHero.getWeaponPoint();null!=e&&(this.weaponShadowPoints.length>0?this.weaponShadowPoints[this.weaponShadowPoints.length-1].pos.sub(e.pos).mag()>0&&(this.weaponShadowPoints.push(e),this.createShadow(e)):(this.weaponShadowPoints.push(e),this.createShadow(e))),this.weaponShadowPoints.length>6&&this.weaponShadowPoints.splice(0,1)}},e.prototype.createShadow=function(t){var e,a;this.knifShadowPool.size()>0?a=(e=this.knifShadowPool.get()).getComponent(f.default):((e=cc.instantiate(this.knifeShadowPrefab)).scaleX=1.4*this.streetHero.node.scale,e.scaleY=1.6*this.streetHero.node.scale,(a=e.getComponent(f.default)).init(this));var n=p.default.Instance.roleLogic.getRoleWeaponId();a.review(n,t),a.weaponNode.scaleY=this.streetHero.face,this.node.addChild(e)},e.prototype.putKnifeShadow=function(t){this.knifShadowPool.put(t.node)},e.prototype.startMove=function(t){this.streetHero&&(this.isMove||(this.isMove=!0,this.streetHero.playMove()),this.streetHero.moveAngle=t)},e.prototype.leaveShowLayer=function(){this.leaveNpc=!0},e.prototype.update=function(t){if(this.isMove&&this.leaveNpc){var e=Math.abs(this.streetHero.moveAngle);this.streetHero.face=e<90?1:-1,this.streetHero.controlMove(t,u.default.toRadian(this.streetHero.moveAngle));var a=this.currFightMap.fightMapData.objectNpc(this.streetHero.node.x,this.streetHero.node.y,this.streetHero.bodyRadius*this.node.scale,20),n=a.inNpc,i=a.name;n&&this.preShowLayer!=i?(this.leaveNpc=!1,this.preShowLayer=i,this.isMove=!1,"ChapterLayer"==i?(this.streetHero.node.x-=100,this.streetHero.playStand(),this.homeLayer.homeUiLayer.rockerLayer.resetPoint(),this.scheduleOnce(function(){p.default.Instance.combatScene.homeLayer.hideNode()},0),p.default.Instance.combatScene.popLayer.reviewChapterLayer()):"TowerLayer"==i&&(l.default.Instance.playerData.level<20?(p.default.Instance.combatScene.showMsgInfo("\u8fbe\u523020\u7ea7\u540e\u624d\u53ef\u6311\u6218"),this.leaveNpc=!0):(this.streetHero.node.y-=50,this.streetHero.playStand(),this.homeLayer.homeUiLayer.rockerLayer.resetPoint(),this.scheduleOnce(function(){p.default.Instance.combatScene.homeLayer.hideNode()},0),p.default.Instance.combatScene.popLayer.reviewClimbTowerLayer()))):n||(this.preShowLayer="")}},s([I(cc.Prefab)],e.prototype,"heroPrefab",void 0),s([I(cc.Prefab)],e.prototype,"knifeShadowPrefab",void 0),s([g],e)}(cc.Component);o.default=_,cc._RF.pop()},{}],StreetRockerLayer:[function(t,e,a){"use strict";cc._RF.push(e,"8a041eo0Q5CFaFypGkV/K38","StreetRockerLayer");var n,i=a,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),r=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,l=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.r1=152,e.r2=55,e.moveAngle=0,e}return o(e,t),e.prototype.init=function(t){this.homeUiLayer=t,this.rockerNode=cc.find("RockerNode",this.node),this.directionNode=cc.find("Direction",this.node),this.directionNode.active=!1,this.originalPosition=this.node.getPosition()},e.prototype.resetPoint=function(){this.node.x=this.originalPosition.x,this.node.y=this.originalPosition.y,this.rockerNode.x=0,this.rockerNode.y=0,this.directionNode.active=!1,this.homeUiLayer.homeLayer.streetLayer.isMove=!1,this.homeUiLayer.homeLayer.streetLayer.streetHero.playStand()},e.prototype.setPoint=function(t){this.node.x=t.x,this.node.y=t.y},e.prototype.touchMove=function(t){var e=t.sub(this.node.getPosition()).mag();null==this.lastTouchPositon&&(this.lastTouchPositon=t),t.y,this.lastTouchPositon.y,this.lastTouchPositon=t,this.moveAngle=Math.atan2(t.y-this.node.y,t.x-this.node.x),this.rockerNode.active=!0;var a=180*this.moveAngle/Math.PI-90;this.rockerNode.angle=a,this.rockerNode.x=Math.cos(this.moveAngle)*Math.min(e,this.r1-this.r2),this.rockerNode.y=Math.sin(this.moveAngle)*Math.min(e,this.r1-this.r2);var n=180*this.moveAngle/Math.PI;this.homeUiLayer.homeLayer.streetLayer&&this.homeUiLayer.homeLayer.streetLayer.startMove(n),this.directionNode.active=!0,this.directionNode.angle=n},r([c],e)}(cc.Component));i.default=l,cc._RF.pop()},{}],StrengthenCostItem:[function(t,e,a){"use strict";cc._RF.push(e,"1d0f6EiCG1LfZQfK9vLDOpf","StrengthenCostItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("AssetUtils"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.costType=0,e.itemId=0,e.itemCount=0,e}return r(e,t),e.prototype.init=function(t){this.strengthLayer=t,this.itemBgNode=cc.find("ItemBg",this.node),this.itemNode=cc.find("Item",this.node),this.numNode=cc.find("Num",this.node)},e.prototype.review=function(t,e,a){this.costType=t,this.itemId=e,this.itemCount=a;var n=l.default.Instance.itemMap.get(e);h.AssetUtils.loadSpriteFrame(this.itemBgNode,"Common/common_quality_"+n.quality),h.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+n.icon),this.numNode.getComponent(cc.Label).string=""+a},e.prototype.selectedStatus=function(t){cc.find("Select",this.node).active=t},e.prototype.onClickbtn=function(t,e){1!=this.costType&&(c.SoundManager.Instance.playEffect("anniu"),1==e&&this.strengthLayer.selectedStrengthenCostId(this.itemId))},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],StrengthenLayer:[function(t,e,a){"use strict";cc._RF.push(e,"6e6f5cQ9bBNYZIvd5YZ8IZg","StrengthenLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("StringUtils"),m=i("MainLogic"),g=i("KnapsackItem"),I=i("StrengthenCostItem"),_=i("StrengthenSuccLayer"),v=cc._decorator,S=v.ccclass,L=v.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.knapsackPrefab=null,e.costPrefab=null,e.knapsackList=new Array,e.selecteEquipmentIndex=0,e.playStrengthenEffect=!1,e.strengthenType=1,e.strengthenQhqId=0,e.strengthenBdqId=0,e.qhqOrBdqScripts=new Array,e.showStrength=!0,e}return r(e,t),e.prototype.init=function(t){this.money1Node=cc.find("Layer/Top/Money/Type1/Num",this.node),this.money2Node=cc.find("Layer/Top/Money/Type2/Num",this.node),this.equipmentList=cc.find("Layer/Left/EquipmentList",this.node).getComponent(cc.ScrollView),this.equipmentInfoNode=cc.find("Layer/Right/Info",this.node),this.equipmentInfoTip=cc.find("Layer/Right/Tip",this.node),this.effectNode=cc.find("Layer/Right/Effect",this.node),this.effectArmDisplay=this.effectNode.getComponent(sp.Skeleton),this.effectNode.active=!1,this.strengthSuccLayer=cc.find("Succ",this.node).getComponent(_.default),this.strengthSuccLayer.init(this),this.failNode=cc.find("Fail",this.node),this.strengthTipNode=cc.find("Tip",this.node),this.showStrength=p.default.Instance.playerData.showStrengthState,this.review(t)},e.prototype.review=function(t){this.node.active=!0,this.strengthSuccLayer.node.active=!1,this.failNode.active=!1,this.pageName=t,this.equipmentInfoNode.active=!1,this.equipmentInfoTip.active=!1;var e=p.default.Instance.playerData.equipmentList,a=e.length;a<p.default.Instance.playerData.equipmentGridCount?a=p.default.Instance.playerData.equipmentGridCount:a+=5-a%5,a-=this.equipmentList.content.childrenCount;for(var n=0;n<a;++n){var i=cc.instantiate(this.knapsackPrefab);this.equipmentList.content.addChild(i),(d=i.getComponent(g.default)).init(this,0,0,0),this.knapsackList.push(d)}for(n=0;n<this.knapsackList.length;++n)this.knapsackList[n].review(this,0,0,0);var o=0,r=0,s=p.default.Instance.playerData.roleEquipInfo;for(n=0;n<s.length;++n)for(var l=s[n].equipment,u=0;u<l.length;++u)if(0!=l[u]){var d=this.knapsackList[o],f=m.default.Instance.equipmentLogic.getEquipmentData(l[u]);if(null==f)continue;d.review(this,5,f.equipmentId,f.equipmentIndex),o+=1,0==r&&(r=f.equipmentIndex)}for(n=0;n<e.length;++n)0==e[n].equipState&&((d=this.knapsackList[o]).review(this,5,e[n].equipmentId,e[n].equipmentIndex),o+=1,0==r&&(r=e[n].equipmentIndex));this.showMoney(),this.selecteEquipmentIndex>0?this.showEquipment(this.selecteEquipmentIndex):this.showEquipment(r),this.pageName==h.PAGE_NAME.Home?this.scheduleOnce(function(){c.default.Instance.showCustomAd(1)},0):this.pageName==h.PAGE_NAME.Task&&this.scheduleOnce(function(){c.default.Instance.hideCustomAd(2)},0)},e.prototype.showMoney=function(){this.money1Node.getComponent(cc.Label).string=y.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1001)),this.money2Node.getComponent(cc.Label).string=""+y.default.stringToWord(m.default.Instance.moneyLogic.getItemCount(1004))},e.prototype.updateEquipmentInfo=function(t){for(var e=0;e<this.knapsackList.length;++e){var a=this.knapsackList[e];if(t==a.itemIndex){a.review(this,5,a.itemId,a.itemIndex);break}}},e.prototype.showEquipment=function(t){this.selecteEquipmentIndex=t;var e=m.default.Instance.equipmentLogic.getEquipmentData(t);if(null==e)return this.equipmentInfoNode.active=!1,this.equipmentInfoTip.active=!0,void m.default.Instance.combatScene.showMsgInfo("\u672a\u627e\u5230\u88c5\u5907\u6570\u636e");var a=d.default.Instance.equipmentMap.get(e.equipmentId);if(e.strengthLevel<l.default.MAX_STRENGTH_LEVEL){this.equipmentInfoNode.active=!0,this.equipmentInfoTip.active=!1;var n=cc.find("Item",this.equipmentInfoNode);this.scheduleOnce(function(){f.AssetUtils.loadSpriteFrame(n,"Common/common_quality_"+a.quality)},0);var i=cc.find("Item/Effect",this.equipmentInfoNode);i&&(i.active=a.quality>=4);var o=cc.find("Item/Item",this.equipmentInfoNode);f.AssetUtils.loadSpriteFrame(o,"Common/"+a.icon),cc.find("Title",this.equipmentInfoNode).getComponent(cc.Label).string=a.name;var r=cc.find("Cost",this.equipmentInfoNode);r.destroyAllChildren();var s=cc.find("QHQ",this.equipmentInfoNode);s.destroyAllChildren();var c=cc.find("BDQ",this.equipmentInfoNode);c.destroyAllChildren(),this.qhqOrBdqScripts.splice(0,this.qhqOrBdqScripts.length);var h=d.default.Instance.equipmentGrowMap.get(e.strengthLevel+1).costValue;this.costValue=m.default.Instance.equipmentLogic.strengthEquipmentCost(h,t);for(var u=0;u<this.costValue.length;++u){var p=cc.instantiate(this.costPrefab);r.addChild(p),(S=p.getComponent(I.default)).init(this),S.review(1,this.costValue[u][0],this.costValue[u][1])}var y=0,g=[1017,1018,1019,1025];for(u=0;u<g.length;++u){p=cc.instantiate(this.costPrefab),s.addChild(p);var _=m.default.Instance.moneyLogic.getItemCount(g[u]);(S=p.getComponent(I.default)).init(this),S.review(2,g[u],_),this.qhqOrBdqScripts.push(S),_>0&&(y=g[u])}for(this.selectedStrengthenCostId(y,2),u=0;u<this.costValue.length;++u)p=cc.instantiate(this.costPrefab),c.addChild(p),(S=p.getComponent(I.default)).init(this),S.review(1,this.costValue[u][0],this.costValue[u][1]);var v=0;for(u=1020;u<=1021;++u){var S;p=cc.instantiate(this.costPrefab),c.addChild(p),_=m.default.Instance.moneyLogic.getItemCount(u),(S=p.getComponent(I.default)).init(this),S.review({1020:3,1021:4}[u],u,_),this.qhqOrBdqScripts.push(S),_>0&&(v=u)}this.selectedStrengthenCostId(v,3)}else this.equipmentInfoNode.active=!1,this.equipmentInfoTip.active=!0},e.prototype.selectedStrengthenCostId=function(t,e){if(void 0===e&&(e=-1),e<0&&(e=this.strengthenType),1==e);else if(2==e){this.strengthenQhqId=t;for(var a=0;a<this.qhqOrBdqScripts.length;++a)(n=this.qhqOrBdqScripts[a]).costType==e&&n.selectedStatus(n.itemId==t)}else for(this.strengthenBdqId=t,a=0;a<this.qhqOrBdqScripts.length;++a){var n;3!=(n=this.qhqOrBdqScripts[a]).costType&&4!=n.costType||n.selectedStatus(n.itemId==t)}},e.prototype.showStrengthenFail=function(t,e){this.failNode.active=!0;var a=m.default.Instance.equipmentLogic.getEquipmentData(t),n=d.default.Instance.equipmentMap.get(a.equipmentId),i=cc.find("Item",this.failNode);this.scheduleOnce(function(){f.AssetUtils.loadSpriteFrame(i,"Common/common_quality_"+n.quality)},0);var o=cc.find("Item/Item",this.failNode);f.AssetUtils.loadSpriteFrame(o,"Common/"+n.icon),cc.find("Title",this.failNode).getComponent(cc.Label).string=n.name,a.strengthLevel>=12&&!e&&m.default.Instance.equipmentLogic.equipmentLevelZero(t),c.default.Instance.showCustomAd(2)},e.prototype.hideInfoNode=function(){},e.prototype.onClickEvent=function(t,e){var a=this;if(u.SoundManager.Instance.playEffect("anniu"),!this.playStrengthenEffect)if(1==e)switch(this.node.active=!1,this.pageName==h.PAGE_NAME.Combat?m.default.Instance.combatScene.showCombatLayer():this.pageName==h.PAGE_NAME.CombatResult||m.default.Instance.combatScene.gotoHomeLayer(),this.pageName){case h.PAGE_NAME.Home:c.default.Instance.hideCustomAd(1);break;case h.PAGE_NAME.ChapterStart:case h.PAGE_NAME.Task:c.default.Instance.showCustomAd(1),c.default.Instance.showCustomAd(2);break;case h.PAGE_NAME.Combat:c.default.Instance.showCustomAd(3);break;case h.PAGE_NAME.CombatResult:c.default.Instance.showCustomAd(1)}else if(2==e)if(1==this.strengthenType){if(m.default.Instance.equipmentLogic.getEquipmentData(this.selecteEquipmentIndex).strengthLevel>=12&&this.showStrength)return void(this.strengthTipNode.active=!0);for(var n=0;n<this.costValue.length;++n)if(!(m.default.Instance.moneyLogic.getItemCount(this.costValue[n][0])>=this.costValue[n][1]))return void m.default.Instance.moneyLogic.showMoreMoney(h.PAGE_NAME.Strengthen,this.costValue[n][0],!0);this.playStrengthenEffect=!0,this.effectNode.active=!0,this.effectArmDisplay.setAnimation(0,"qianghua",!1),this.scheduleOnce(function(){a.playStrengthenEffect=!1,a.effectNode.active=!1;for(var t=0;t<a.costValue.length;++t)m.default.Instance.equipmentLogic.addStrengthItem(a.selecteEquipmentIndex,a.costValue[t]);m.default.Instance.equipmentLogic.strengthCostItem(a.costValue),m.default.Instance.equipmentLogic.getStrengthResult(a.selecteEquipmentIndex)?a.strengthSuccLayer.review(a.selecteEquipmentIndex,1):a.showStrengthenFail(a.selecteEquipmentIndex,!1)},1.3)}else if(2==this.strengthenType){if(0==this.strengthenQhqId)return void m.default.Instance.combatScene.showMsgInfo("\u8bf7\u9009\u62e9\u5408\u9002\u7684\u5f3a\u5316\u5238");var i=d.default.Instance.itemMap.get(this.strengthenQhqId),o=m.default.Instance.equipmentLogic.getEquipmentData(this.selecteEquipmentIndex);if(o.strengthLevel>=i.type_key)return void m.default.Instance.combatScene.showMsgInfo("\u65e0\u6cd5\u5f3a\u5316\u8d85\u8fc7\u5f3a\u5316\u5238\u7b49\u7ea7\u4e0a\u9650\u7684\u88c5\u5907");if(m.default.Instance.moneyLogic.getItemCount(i.id)<=0)return void m.default.Instance.combatScene.showMsgInfo("\u9053\u5177\u4e0d\u8db3");this.playStrengthenEffect=!0,this.effectNode.active=!0,this.effectArmDisplay.setAnimation(0,"qianghua",!1),this.scheduleOnce(function(){a.playStrengthenEffect=!1,a.effectNode.active=!1,m.default.Instance.moneyLogic.addItemCount(i.id,-1),a.strengthSuccLayer.review(a.selecteEquipmentIndex,i.type_key-o.strengthLevel)},1.3)}else{if(0==this.strengthenBdqId)return void m.default.Instance.combatScene.showMsgInfo("\u8bf7\u9009\u62e9\u4fdd\u5e95\u5238\u6216\u4f20\u8bf4\u5f3a\u5316\u5238");if(m.default.Instance.moneyLogic.getItemCount(this.strengthenBdqId)<=0)return void m.default.Instance.combatScene.showMsgInfo("\u9053\u5177\u4e0d\u8db3");var r=d.default.Instance.itemMap.get(this.strengthenBdqId);for(n=0;n<this.costValue.length;++n)if(!(m.default.Instance.moneyLogic.getItemCount(this.costValue[n][0])>=this.costValue[n][1]))return void m.default.Instance.moneyLogic.showMoreMoney(h.PAGE_NAME.Strengthen,this.costValue[n][0],!0);this.playStrengthenEffect=!0,this.effectNode.active=!0,this.effectArmDisplay.setAnimation(0,"qianghua",!1),this.scheduleOnce(function(){a.playStrengthenEffect=!1,a.effectNode.active=!1;for(var t=0;t<a.costValue.length;++t)m.default.Instance.equipmentLogic.addStrengthItem(a.selecteEquipmentIndex,a.costValue[t]);if(m.default.Instance.equipmentLogic.strengthCostItem(a.costValue),m.default.Instance.moneyLogic.addItemCount(r.id,-1),13==r.type||m.default.Instance.equipmentLogic.getStrengthResult(a.selecteEquipmentIndex))a.strengthSuccLayer.review(a.selecteEquipmentIndex,1);else{var e=12==r.type;a.showStrengthenFail(a.selecteEquipmentIndex,e)}},1.3)}else if(3==e)this.failNode.active=!1,this.showEquipment(this.selecteEquipmentIndex),this.updateEquipmentInfo(this.selecteEquipmentIndex),c.default.Instance.hideCustomAd(2);else if(4==e)this.strengthenType=1,cc.find("Cost",this.equipmentInfoNode).active=1==this.strengthenType,cc.find("QHQ",this.equipmentInfoNode).active=2==this.strengthenType,cc.find("BDQ",this.equipmentInfoNode).active=3==this.strengthenType;else if(5==e)this.strengthenType=2,cc.find("Cost",this.equipmentInfoNode).active=1==this.strengthenType,cc.find("QHQ",this.equipmentInfoNode).active=2==this.strengthenType,cc.find("BDQ",this.equipmentInfoNode).active=3==this.strengthenType;else if(6==e)this.strengthenType=3,cc.find("Cost",this.equipmentInfoNode).active=1==this.strengthenType,cc.find("QHQ",this.equipmentInfoNode).active=2==this.strengthenType,cc.find("BDQ",this.equipmentInfoNode).active=3==this.strengthenType;else if(7==e)this.strengthTipNode.active=!1,p.default.Instance.playerData.showStrengthState!=this.showStrength&&(p.default.Instance.playerData.showStrengthState=this.showStrength);else if(8==e){for(this.strengthTipNode.active=!1,p.default.Instance.playerData.showStrengthState!=this.showStrength&&(p.default.Instance.playerData.showStrengthState=this.showStrength),n=0;n<this.costValue.length;++n)if(!(m.default.Instance.moneyLogic.getItemCount(this.costValue[n][0])>=this.costValue[n][1]))return void m.default.Instance.moneyLogic.showMoreMoney(h.PAGE_NAME.Strengthen,this.costValue[n][0],!0);this.playStrengthenEffect=!0,this.effectNode.active=!0,this.effectArmDisplay.setAnimation(0,"qianghua",!1),this.scheduleOnce(function(){a.playStrengthenEffect=!1,a.effectNode.active=!1;for(var t=0;t<a.costValue.length;++t)m.default.Instance.equipmentLogic.addStrengthItem(a.selecteEquipmentIndex,a.costValue[t]);m.default.Instance.equipmentLogic.strengthCostItem(a.costValue),m.default.Instance.equipmentLogic.getStrengthResult(a.selecteEquipmentIndex)?a.strengthSuccLayer.review(a.selecteEquipmentIndex,1):a.showStrengthenFail(a.selecteEquipmentIndex,!1)},1.3)}else 9==e?this.showStrength=!this.showStrength:100==e?m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Strengthen,1,!0):101==e&&m.default.Instance.combatScene.popLayer.reviewMoneyMorePage(h.PAGE_NAME.Strengthen,2,!0)},s([L(cc.Prefab)],e.prototype,"knapsackPrefab",void 0),s([L(cc.Prefab)],e.prototype,"costPrefab",void 0),s([S],e)}(cc.Component);o.default=T,cc._RF.pop()},{}],StrengthenSuccLayer:[function(t,e,a){"use strict";cc._RF.push(e,"4064fWXaVZN2px9SyIxzdRB","StrengthenSuccLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("SoundManager"),l=i("ConfigData"),h=i("AssetUtils"),u=i("StringUtils"),d=i("MainLogic"),p=cc._decorator,f=p.ccclass,y=p.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.infoPrefab=null,e.preEquipmentLevel=0,e}return r(e,t),e.prototype.init=function(t){this.strengthLayer=t,this.itemBg=cc.find("Item",this.node),this.itemNode=cc.find("Item/Item",this.node),this.titleNode=cc.find("Title",this.node),this.infoList=cc.find("InfoList",this.node).getComponent(cc.ScrollView)},e.prototype.review=function(t,e){var a=this;this.node.active=!0,this.equipmentIndex=t,this.infoList.content.destroyAllChildren();var n=d.default.Instance.equipmentLogic.getEquipmentData(t);this.preEquipmentLevel=n.strengthLevel;var i=l.default.Instance.equipmentMap.get(n.equipmentId);this.scheduleOnce(function(){h.AssetUtils.loadSpriteFrame(a.itemBg,"Common/common_quality_"+i.quality)},0),h.AssetUtils.loadSpriteFrame(this.itemNode,"Common/"+i.icon),this.titleNode.getComponent(cc.Label).string=i.name,d.default.Instance.equipmentLogic.addEquipmentLevel(t,e);var o=d.default.Instance.equipmentLogic.getEquipmentAttrType(n.equipmentId);this.addInfoItem(8,t);for(var r=0;r<o[r];++r)this.addInfoItem(o[r],t)},e.prototype.addInfoItem=function(t,e){var a=d.default.Instance.equipmentLogic.getEquipmentData(e),n=cc.instantiate(this.infoPrefab);this.infoList.content.addChild(n);var i=cc.find("Name",n),o=cc.find("Curr",n),r=cc.find("Next",n),s=0;switch(t){case 8:i.getComponent(cc.Label).string="\u5f3a\u5316\u7b49\u7ea7",o.getComponent(cc.Label).string=this.preEquipmentLevel+"",r.getComponent(cc.Label).string=a.strengthLevel+"";break;case 1:i.getComponent(cc.Label).string="\u653b\u51fb\u529b",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,1,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=Math.round(s)+"",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,1)[0],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 2:i.getComponent(cc.Label).string="\u8840\u91cf",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,2,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=Math.round(s)+"",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,2)[0],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 3:i.getComponent(cc.Label).string="\u9632\u5fa1\u529b",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,3,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=Math.round(s)+"",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,3)[0],r.getComponent(cc.Label).string=Math.round(s)+"";break;case 4:i.getComponent(cc.Label).string="\u66b4\u51fb\u7387",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,4,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,4)[0],r.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%";break;case 5:i.getComponent(cc.Label).string="\u547d\u4e2d\u7387",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,5,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,5)[0],r.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%";break;case 6:i.getComponent(cc.Label).string="\u95ea\u907f\u7387",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,6,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,6)[0],r.getComponent(cc.Label).string=u.default.intFormate(100*s)+"%";break;case 7:i.getComponent(cc.Label).string="\u653b\u901f",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,7,this.preEquipmentLevel)[0],o.getComponent(cc.Label).string=u.default.intFormate(s,3)+"",s=d.default.Instance.equipmentLogic.getEquipmentAttr(e,7)[0],r.getComponent(cc.Label).string=u.default.intFormate(s,3)+""}},e.prototype.onClickEvent=function(t,e){c.SoundManager.Instance.playEffect("anniu"),1==e?this.node.active=!1:2==e&&(this.node.active=!1),this.strengthLayer.showEquipment(this.equipmentIndex),this.strengthLayer.updateEquipmentInfo(this.equipmentIndex)},s([y(cc.Prefab)],e.prototype,"infoPrefab",void 0),s([f],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],StringUtils:[function(t,e,a){"use strict";cc._RF.push(e,"1ff9c+tiD5Lp66Q2rhOdEtz","StringUtils");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("ConfigData"),r=function(){function t(){}return t.config_stringToIntListOfList=function(e,a){if(this.stringIsNull(e))return null;null==a&&(a="_");for(var n=e.substring(1,e.length-1),i=t.stringToStringList(n),o=new Array,r=0;r<i.length;r++){var s=i[r],c=t.stringToIntList(s,a);o.push(c)}return o},t.config_stringToIntList=function(e,a){if(this.stringIsNull(e))return null;if(-1==e.indexOf("["))return[t.stringToInt(e)];var n=e.substring(1,e.length-1);return t.stringToIntList(n,a)},t.config_stringToFloatListOfList=function(e,a){if(this.stringIsNull(e))return null;null==a&&(a="_");for(var n=e.substring(1,e.length-1),i=t.stringToStringList(n),o=new Array,r=0;r<i.length;r++){var s=i[r],c=t.stringToFloatList(s,a);o.push(c)}return o},t.config_stringToFloatList=function(e,a){if(this.stringIsNull(e))return null;if(-1==e.indexOf("["))return[t.stringToFloat(e)];var n=e.substring(1,e.length-1);return t.stringToFloatList(n,a)},t.stringToIntList=function(t,e){var a,n=new Array;a=null==e?t.split(","):t.split(e);for(var i=0;i<a.length;i++)""!=a[i]&&n.push(parseInt(a[i]));return n},t.stringToFloatList=function(t,e){var a,n=new Array;a=null==e?t.split(","):t.split(e);for(var i=0;i<a.length;i++)""!=a[i]&&n.push(parseFloat(a[i]));return n},t.stringToStringList=function(t,e){var a,n=new Array;a=null==e?t.split(","):t.split(e);for(var i=0;i<a.length;i++)""!=a[i]&&n.push(a[i]);return n},t.stringToWord=function(t){return(t=Math.floor(t))>=1e10?(t=Math.floor(t/1e9))+"G":t>=1e7?(t=Math.floor(t/1e6))+"M":t>=1e4?(t=Math.floor(t/1e3))+"K":t+""},t.stringToWord2=function(t){var e=[0,1];return(t=Math.floor(t))>1e10?(t=Math.floor(t/1e9),e[1]=4):t>1e7?(t=Math.floor(t/1e6),e[1]=3):t>1e4?(t=Math.floor(t/1e3),e[1]=2):e[1]=1,e[0]=t,e},t.stringToInt=function(t,e){return null==t||""==t?null!=e?e:0:parseInt(t)},t.stringToFloat=function(t,e){return null==t||""==t?null!=e?e:0:parseFloat((t+"").replace(" ",""))},t.secondToStringFormat=function(t){var e=Math.floor(t/3600),a=Math.floor((t-3600*e)/60),n=Math.floor(t%60),i="";return 0!=e&&(i+=e<10?"0"+e+":":e+":"),(i+=0!=a?a<10?"0"+a+":":a+":":"00:")+(0!=n?n<10?"0"+n:n+"":"00")},t.secondToStringFormatForDay=function(t){var e=Math.floor(t/3600),a=Math.floor((t-3600*e)/60),n=Math.floor(t%60),i=Math.floor(e/24),o="";return 0!=i&&(o=i+"\u5929"),0!=(e%=24)&&(o+=e<10?"0"+e+"\u5c0f\u65f6":e+"\u5c0f\u65f6"),(o+=0!=a?a<10?"0"+a+"\u5206":a+"\u5206":"00\u5206")+(0!=n?n<10?"0"+n:n+"":"00")},t.stringIsNull=function(t){return null==t||""==t},t.stringToStringListForRes=function(t){var e,a=o.default.Instance.resourceMap.get(t),n=new Array;if(null==a)return n;e=a.resource_way.split("-");for(var i=0;i<e.length;i++)""!=e[i]&&n.push(e[i]);return n},t.intToStringByZero=function(t){return t>=10?t+"":"0"+t},t.intFormate=function(t,e){return null==e&&(e=2),1==e?Math.floor(10*t)/10:2==e?Math.floor(100*t)/100:3==e?Math.floor(1e3*t)/1e3:4==e?Math.floor(1e4*t)/1e4:Math.floor(t)},t.floatFormatPercent=function(t){return Math.floor(100*t)},t.stringToSubStr=function(t,e){return null==e&&(e=8),t.length>e&&(t=t.substr(0,e)+"..."),t},t}();i.default=r,cc._RF.pop()},{}],SuperItem:[function(t,e,a){"use strict";cc._RF.push(e,"af2427w/OxBh4LFE8npneOP","SuperItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicConst"),l=i("PublicEnum"),h=i("SoundManager"),u=i("ConfigData"),d=i("AssetUtils"),p=i("MainLogic"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardJsonIndex=0,e}return r(e,t),e.prototype.init=function(t,e){this.passCheckLayer=t,this.taskOrder=e.order,this.taskType=e.type,this.fullNode=cc.find("Full",this.node),this.levelNode=cc.find("Level",this.node),this.itemBgNode1=cc.find("ItemBg1",this.node),this.itemNode1=cc.find("Item1",this.node),this.countNode1=cc.find("Count1",this.node),this.itemBgNode2=cc.find("ItemBg2",this.node),this.itemNode2=cc.find("Item2",this.node),this.countNode2=cc.find("Count2",this.node),this.btnNode=cc.find("Btn1",this.node),this.grayNode=cc.find("Gray",this.node),this.getNode=cc.find("Get",this.node);var a=c.default.PassCheckSeasonId%4;0==a&&(a=4),this.taskConfig=p.default.Instance.taskLogic.queryPassCheckTaskConfig(this.taskOrder);var n=this.taskConfig.awardList[a-1],i=u.default.Instance.giftMap.get(n);this.itemBgNode1.active=!1,this.itemNode1.active=!1,this.countNode1.active=!1,this.itemBgNode2.active=!1,this.itemNode2.active=!1,this.countNode2.active=!1;for(var o=1;o<i.itemList.length;++o){var r=i.itemList[o][0],s=i.itemList[o][1],h=i.itemList[o][2];if(1001==s){var f=p.default.Instance.chapterLogic.getMaxChapterInfo(1);h*=u.default.Instance.dungeonMap.get(f[0]).get(f[1]).get(1).gold_reward}else 1004==s&&(f=p.default.Instance.chapterLogic.getMaxChapterInfo(1),h*=u.default.Instance.dungeonMap.get(f[0]).get(f[1]).get(1).crystal_reward);this.rewardJsonIndex=i.jsonIndex;var y,m=void 0,g=void 0,I=void 0;1==o?(m=this.itemBgNode1,g=this.itemNode1,I=this.countNode1):(m=this.itemBgNode2,g=this.itemNode2,I=this.countNode2),m.active=!0,g.active=!0,I.active=!0,y=1==r?u.default.Instance.equipmentMap.get(s):u.default.Instance.itemMap.get(s),d.AssetUtils.loadSpriteFrame(m,"Common/common_quality_"+y.quality),d.AssetUtils.loadSpriteFrame(g,"Common/"+y.icon),I.getComponent(cc.Label).string=""+h,I.color=l.Quality_COLOR[y.quality]}this.review()},e.prototype.review=function(){var t=p.default.Instance.taskLogic.queryPassCheckTaskData(this.taskOrder,this.taskType);switch(this.fullNode.active=10==t.order,this.levelNode.active=!1,this.btnNode.active=!1,this.grayNode.active=!1,this.getNode.active=!1,t.status){case 0:this.levelNode.active=!0,this.grayNode.active=!0;break;case 1:case 4:this.btnNode.active=!0;break;case 2:case 3:this.grayNode.active=!0,this.getNode.active=!0}},e.prototype.onClickBtn=function(t,e){if(h.SoundManager.Instance.playEffect("anniu"),1==e)if(p.default.Instance.moneyLogic.getItemCount(1016)>0){for(var a=p.default.Instance.giftBagLoigc.getGiftRewardByIndex(this.rewardJsonIndex),n=new Array,i=1;i<a.length;++i)n.push(a[i]);p.default.Instance.giftBagLoigc.receiveGiftItems(n,1),p.default.Instance.taskLogic.receivePassCheckReward(this.taskOrder,this.taskType,4),p.default.Instance.moneyLogic.addItemCount(1016,-1),this.review(),this.passCheckLayer.showCrytalNum()}else p.default.Instance.combatScene.showMsgInfo("\u6c34\u6676\u4e0d\u8db3")},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],TalentInfo:[function(t,e,a){"use strict";cc._RF.push(e,"580073IwDJLj6p2T3Tk/Vn5","TalentInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.type=o.default.stringToInt(t.type),this.skill_number=o.default.stringToInt(t.skill_number),this.skill_id=o.default.stringToInt(t.skill_id),this.unlock_condition1=o.default.stringToInt(t.unlock_condition1),this.value1=t.value1,this.valueList1=o.default.config_stringToIntListOfList(this.value1,"_"),this.atk_grwo=o.default.stringToInt(t.atk_grwo),this.hp_grow=o.default.stringToInt(t.hp_grow),this.def_grow=o.default.stringToInt(t.def_grow),this.cost_resource=t.cost_resource,this.costValueList=o.default.config_stringToIntListOfList(this.cost_resource,"_")},cc._RF.pop()},{}],TalentItem:[function(t,e,a){"use strict";cc._RF.push(e,"6dd37FuNulFV5hfMXcy/rAW","TalentItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("PublicEnum"),l=i("SoundManager"),h=i("ConfigData"),u=i("GameData"),d=i("AssetUtils"),p=i("MainLogic"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t,e,a){this.talentLayer=t,this.talentType=e,this.talentIndex=a,this.talentInfo=h.default.Instance.talentSkillTypeMap.get(e).get(a),this.talentId=this.talentInfo.id,this.itemNode=cc.find("Item",this.node),d.AssetUtils.loadSpriteFrame(this.itemNode,"Skill/talent_icon_"+this.talentId),this.stateNode1=cc.find("State1",this.node),this.jiaoNode1=cc.find("Jiao",this.stateNode1),this.line1Node1=cc.find("Line1",this.stateNode1),this.line2Node1=cc.find("Line2",this.stateNode1),this.stateNode2=cc.find("State2",this.node),this.jiaoNode2=cc.find("Jiao",this.stateNode2),this.line1Node2=cc.find("Line1",this.stateNode2),this.line2Node2=cc.find("Line2",this.stateNode2),this.lightNode=cc.find("Light",this.node),this.levelNode=cc.find("Level/Level",this.node),this.review()},e.prototype.review=function(){this.talentLevel=u.default.Instance.playerData.talentSkill[this.talentType][this.talentIndex],this.talentLevel>0?(this.stateNode2.active=!0,this.stateNode1.active=!1,this.levelNode.getComponent(cc.Label).string="Lv."+this.talentLevel):(this.stateNode2.active=!1,this.stateNode1.active=!0,this.levelNode.parent.active=!0,this.levelNode.parent.active=!1),this.talentIndex<7||8==this.talentIndex?(this.line1Node1.active=!1,this.line2Node1.active=!1,this.jiaoNode1.active=!0,this.line1Node2.active=!1,this.line2Node2.active=!1,this.jiaoNode2.active=!0):7==this.talentIndex?(this.line1Node1.active=!0,this.line2Node1.active=!1,this.jiaoNode1.active=!0,this.line1Node2.active=!0,this.line2Node2.active=!1,this.jiaoNode2.active=!0):9==this.talentIndex?(this.line1Node1.active=!1,this.line2Node1.active=!0,this.jiaoNode1.active=!0,this.line1Node2.active=!1,this.line2Node2.active=!0,this.jiaoNode2.active=!0):10==this.talentIndex&&(this.line1Node1.active=!1,this.line2Node1.active=!1,this.jiaoNode1.active=!1,this.line1Node2.active=!1,this.line2Node2.active=!1,this.jiaoNode2.active=!1)},e.prototype.showLight=function(t){this.lightNode.active=t==this.talentIndex},e.prototype.upgradeTalentLevel=function(){if(!(this.talentLevel>=60)){var t=this.talentInfo.costValueList[0][1],e=this.talentInfo.costValueList[0][2];return p.default.Instance.moneyLogic.getItemCount(t)>=e?(u.default.Instance.playerData.talentSkill[this.talentType][this.talentIndex]+=1,p.default.Instance.moneyLogic.addItemCount(t,-e),this.review(),u.default.Instance.localStorage(p.default.Instance.combatScene.isGameStart()),!0):(p.default.Instance.moneyLogic.showMoreMoney(c.PAGE_NAME.Home,t,!0),!1)}p.default.Instance.combatScene.showMsgInfo(this.talentInfo.name+"\u7b49\u7ea7\u5df2\u6ee1")},e.prototype.onClickBtn=function(){l.SoundManager.Instance.playEffect("anniu"),this.talentLayer.selectedTalentIndex(this.talentIndex-1)},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],TalentLayer:[function(t,e,a){"use strict";cc._RF.push(e,"b6226/vjO5N97Ho3z6RkfLl","TalentLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("SoundManager"),d=i("ConfigData"),p=i("GameData"),f=i("AssetUtils"),y=i("MainLogic"),m=i("TaskLogic"),g=i("TalentItem"),I=cc._decorator,_=I.ccclass,v=I.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.talentItemPrefab=null,e.selfOrHelp=1,e.selfItemScripts=new Array,e.helpItemScripts=new Array,e.selfSelectedSkillIndex=0,e.helpSelectedSkillIndex=0,e.shareType=0,e}return r(e,t),e.prototype.init=function(){this.selfNode=cc.find("Layer/Self",this.node),this.selfTalentCountNode=cc.find("Self_Talent/Count",this.selfNode),this.selfVideoCountNode=cc.find("GetSelf/Tip",this.selfNode);var t=cc.find("Self_Talent/Item",this.selfNode);f.AssetUtils.loadSpriteFrame(t,"Common/daoju_icon_1018"),this.helpNode=cc.find("Layer/Help",this.node),this.helpTalentCountNode=cc.find("Help_Talent/Count",this.helpNode);var e=cc.find("Help_Talent/Item",this.helpNode);f.AssetUtils.loadSpriteFrame(e,"Common/daoju_icon_1019");for(var a=1;a<11;++a){var n=cc.instantiate(this.talentItemPrefab);n.x=[-155,0,155,-155,0,155,-155,0,155,0][a-1],n.y=[130,130,130,25,25,25,-80,-80,-80,-185][a-1],this.selfNode.addChild(n);var i=n.getComponent(g.default);i.init(this,1,a),this.selfItemScripts.push(i);var o=cc.instantiate(this.talentItemPrefab);o.x=[-155,0,155,-155,0,155,-155,0,155,0][a-1],o.y=[130,130,130,25,25,25,-80,-80,-80,-185][a-1],this.helpNode.addChild(o);var r=o.getComponent(g.default);r.init(this,2,a),this.helpItemScripts.push(r)}this.review()},e.prototype.review=function(){this.node.active=!0;for(var t=0;t<this.selfItemScripts.length;++t)this.selfItemScripts[t].review();for(t=0;t<this.helpItemScripts.length;++t)this.helpItemScripts[t].review();1==this.selfOrHelp?this.selectedTalentIndex(this.selfSelectedSkillIndex):this.selectedTalentIndex(this.helpSelectedSkillIndex),this.showSelfVideoCount(),c.default.Instance.showCustomAd(1)},e.prototype.showSelfVideoCount=function(){this.selfVideoCountNode.getComponent(cc.Label).string="\u6bcf\u65e5\u9650\u5236\uff08"+p.default.Instance.playerData.selfTalentVideoCount+"/5\uff09",this.selfTalentCountNode.getComponent(cc.Label).string="x"+y.default.Instance.moneyLogic.getItemCount(1037)},e.prototype.updateShareCount=function(){this.selfVideoCountNode.getComponent(cc.Label).string="\u6bcf\u65e5\u9650\u5236\uff08"+p.default.Instance.playerData.helpTalentVideoCount+"/5\uff09",this.helpTalentCountNode.getComponent(cc.Label).string="x"+y.default.Instance.moneyLogic.getItemCount(1038)},e.prototype.showRightInfo=function(){var t=0,e=cc.find("Layer/Right/Attr/Cost/Item",this.node);1==this.selfOrHelp?(this.selfSelectedSkillIndex,t=this.selfItemScripts[this.selfSelectedSkillIndex].talentId,f.AssetUtils.loadSpriteFrame(e,"Common/daoju_icon_1018")):(this.helpSelectedSkillIndex,t=this.helpItemScripts[this.helpSelectedSkillIndex].talentId,f.AssetUtils.loadSpriteFrame(e,"Common/daoju_icon_1019"));var a=d.default.Instance.talentSkillMap.get(t),n=p.default.Instance.playerData.talentSkill[a.type][a.skill_number],i=cc.find("Layer/Right/Attr",this.node),o=cc.find("Layer/Right/Unlock",this.node),r=cc.find("Layer/Right/Item",this.node);if(f.AssetUtils.loadSpriteFrame(r,"Skill/talent_icon_"+t),cc.find("Layer/Right/Name",this.node).getComponent(cc.Label).string=a.name,0==n){o.active=!0,i.active=!1;for(var s=1;s<4;++s){var c=cc.find("Condition"+s,o),l=a.valueList1[s-1];if(null==l)c.active=!1;else{c.active=!0;var h=l[0],u=d.default.Instance.talentSkillMap.get(h),y=l[1],m=p.default.Instance.playerData.talentSkill[u.type][u.skill_number];cc.find("Condition",c).getComponent(cc.Label).string=u.name,cc.find("Value",c).getComponent(cc.Label).string=m+"/"+y}}}else for(o.active=!1,i.active=!0,s=1;s<3;++s){var g=n+s-1;g>60?(cc.find("Jian",i).active=!1,cc.find("Attr2",i).active=!1):(cc.find("Jian",i).active=!0,cc.find("Attr2",i).active=!0),cc.find("Attr"+s+"/LevelName/Level",i).getComponent(cc.Label).string=g+"";var I=cc.find("Attr"+s+"/AtkName",i),_=cc.find("Atk",I);0==a.atk_grwo?I.active=!1:(I.active=!0,_.getComponent(cc.Label).string="+"+a.atk_grwo*g);var v=cc.find("Attr"+s+"/DefName",i),S=cc.find("Def",v);0==a.def_grow?v.active=!1:(v.active=!0,S.getComponent(cc.Label).string="+"+a.def_grow*g);var L=cc.find("Attr"+s+"/HpName",i),T=cc.find("Hp",L);0==a.hp_grow?L.active=!1:(L.active=!0,T.getComponent(cc.Label).string="+"+a.hp_grow*g)}this.showSelfVideoCount(),this.updateShareCount()},e.prototype.selectedTalentIndex=function(t){if(1==this.selfOrHelp){this.selfSelectedSkillIndex=t;for(var e=0;e<this.selfItemScripts.length;++e)this.selfItemScripts[e].showLight(t+1)}else for(this.helpSelectedSkillIndex=t,e=0;e<this.selfItemScripts.length;++e)this.helpItemScripts[e].showLight(t+1);this.showRightInfo()},e.prototype.upgradeTalentLevel=function(){var t,e=!1;(t=1==this.selfOrHelp?this.selfItemScripts[this.selfSelectedSkillIndex]:this.helpItemScripts[this.helpSelectedSkillIndex])&&(e=t.upgradeTalentLevel()),e&&(this.showRightInfo(),this.checkUnlockTalebn(this.selfOrHelp))},e.prototype.checkUnlockTalebn=function(t){for(var e=d.default.Instance.talentSkillTypeMap.get(t),a=e.getKeys(),n=0;n<a.length;++n){var i=e.get(a[n]);if(0==p.default.Instance.playerData.talentSkill[i.type][i.skill_number]){for(var o=!0,r=0;r<i.valueList1.length;++r){var s=i.valueList1[r],c=s[0],l=d.default.Instance.talentSkillMap.get(c);if(!(p.default.Instance.playerData.talentSkill[l.type][l.skill_number]>=s[1])){o=!1;break}}o&&(p.default.Instance.playerData.talentSkill[i.type][i.skill_number]=1,(1==t?this.selfItemScripts[i.skill_number-1]:this.helpItemScripts[i.skill_number-1]).review())}}p.default.Instance.localStorage(y.default.Instance.combatScene.isGameStart())},e.prototype.onClickBtn=function(t,e){u.SoundManager.Instance.playEffect("anniu"),1==e?(c.default.Instance.hideCustomAd(1),this.node.active=!1):2==e?(this.selfOrHelp=1,this.selfNode.active=!0,this.helpNode.active=!1,this.selectedTalentIndex(this.selfSelectedSkillIndex)):3==e?(this.selfOrHelp=2,this.selfNode.active=!1,this.helpNode.active=!0,this.selectedTalentIndex(this.helpSelectedSkillIndex)):4==e?this.upgradeTalentLevel():5==e?p.default.Instance.playerData.selfTalentVideoCount>0?c.default.Instance.adHandler(c.default.AD_TYPE_SELF_TALENT,this,this.adCallback):y.default.Instance.combatScene.showMsgInfo("\u89c6\u9891\u6b21\u6570\u5df2\u7528\u5b8c"):6==e&&(p.default.Instance.playerData.helpTalentVideoCount>0?c.default.Instance.adHandler(c.default.AD_TYPE_HELP_TALENT,this,this.adCallback):y.default.Instance.combatScene.showMsgInfo("\u89c6\u9891\u6b21\u6570\u5df2\u7528\u5b8c"))},e.prototype.adCallback=function(t,e,a){0==e?(t==c.default.AD_TYPE_SELF_TALENT||t==c.default.SHARE_TYPE_SELF_TALENT?(p.default.Instance.playerData.selfTalentVideoCount-=1,y.default.Instance.moneyLogic.addItemCount(1037,1),this.showSelfVideoCount()):t!=c.default.AD_TYPE_HELP_TALENT&&t!=c.default.SHARE_TYPE_HELP_TALENT||(p.default.Instance.playerData.helpTalentVideoCount-=1,y.default.Instance.moneyLogic.addItemCount(1038,1),this.updateShareCount()),0!=p.default.Instance.playerData.cdActiveFreeAd&&a||y.default.Instance.taskLogic.finishAllTask(m.default.type_see_ad_count1,0,1)):-1==e?(y.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_SELF_TALENT?this.shareType=c.default.SHARE_TYPE_SELF_TALENT:t==c.default.AD_TYPE_HELP_TALENT&&(this.shareType=c.default.SHARE_TYPE_HELP_TALENT),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):y.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else y.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(p.default.Instance.playerData.shareGetRewardCount>0))return void y.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");p.default.Instance.playerData.shareGetRewardCount-=1,y.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(y.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([v(cc.Prefab)],e.prototype,"talentItemPrefab",void 0),s([_],e)}(cc.Component);o.default=S,cc._RF.pop()},{}],TaskData:[function(t,e,a){"use strict";cc._RF.push(e,"e9d9d3R2q5P1q4cgybyf8mU","TaskData");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){this.type=0,this.count=0,this.order=0,this.status=0,this.smallType=t,this.type=e,this.count=0,this.order=1,this.status=0},cc._RF.pop()},{}],TaskInfo:[function(t,e,a){"use strict";cc._RF.push(e,"a6785aeNvNL/J1PkmVaxyQv","TaskInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.small_type=o.default.stringToInt(t.small_type),this.type=o.default.stringToInt(t.type),this.type_key=o.default.stringToInt(t.type_key),this.task_name=t.task_name,this.task_content=t.task_content,this.base_award=t.base_award,this.order=o.default.stringToInt(t.order),this.baseAwardList=o.default.config_stringToIntListOfList(this.base_award),this.award_list=t.award_list,this.awardList=o.default.config_stringToIntList(this.award_list),this.point_award=t.point_award,this.pointAward=o.default.config_stringToIntListOfList(this.point_award)},cc._RF.pop()},{}],TaskItem:[function(t,e,a){"use strict";cc._RF.push(e,"6840bOvG7BDDrufPAqsmflk","TaskItem");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("GameData"),h=i("PublicConst"),u=i("PublicEnum"),d=i("MainLogic"),p=i("AdServer"),f=i("TaskLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItemList=new Array,e.order=0,e.rewardArray=new Array,e}return r(e,t),e.prototype.init=function(t,e){this.taskLayer=t,this.taskData=e,this.smallType=this.taskData.smallType,this.type=Number(this.taskData.type),this.nameNode=cc.find("Name",this.node),this.rateNode=cc.find("Progress/Rate",this.node),this.numNode=cc.find("Num",this.node),this.ItemListNode=cc.find("ItemListNode",this.node),this.ProgressNode=cc.find("Progress",this.node),this.reset()},e.prototype.reset=function(){if(0!=this.order&&this.order!=this.taskData.order){for(var t=0;t<this.rewardItemList.length;t++){var e=this.rewardItemList[t];d.default.Instance.sceneNodeManager.putRewardItem(e)}this.rewardItemList.splice(0,this.rewardItemList.length),this.rewardArray.splice(0,this.rewardArray.length)}if(this.order=this.taskData.order,3==this.smallType?this.taskConfig=c.default.Instance.achieveMap.get(this.taskData.type).get(this.order):2==this.smallType&&(this.taskConfig=d.default.Instance.taskLogic.queryDayTaskConfig(this.type)),null!=this.taskConfig){var a=this.taskConfig.task_content;if(this.taskConfig.pointAward&&h.default.PassCheckSwitch){var n=this.taskConfig.pointAward;for(t=0;t<n.length;++t){n[t][0];var i=n[t][1],o=n[t][2];a+="\uff0c\u83b7\u5f97"+c.default.Instance.itemMap.get(i).name+"x"+o}}this.nameNode.getComponent(cc.Label).string=a;var r=Math.min(this.taskConfig.type_key,this.taskData.count);if(this.numNode.getComponent(cc.Label).string=r+"/"+this.taskConfig.type_key,this.rateNode.scaleX=r/this.taskConfig.type_key,0==this.rewardItemList.length)for(t=0;t<this.taskConfig.baseAwardList.length;t++){var s=this.taskConfig.baseAwardList[t];e=d.default.Instance.sceneNodeManager.getRewardItem(s[1],s[2],s[0],t,!1,!0,!1,!1,!1),this.rewardItemList.push(e),this.ItemListNode.addChild(e.node),this.rewardArray.push([s[1],s[2],s[0]])}for(this.btnStatus=[[1,1,1,1,1,1,1,1,1,2,2,1,4,3,4,1,1,1],[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6]][this.taskData.status][this.type],t=1;t<=6;t++){var l=cc.find("btn"+t,this.node);this.btnStatus==t?l.active=!0:l.active=!1}2==this.type||6==this.type?(this.ProgressNode.active=!1,this.numNode.active=!1):(this.ProgressNode.active=!0,this.numNode.active=!0)}else this.node.active=!1},e.prototype.onClickEvent=function(t,e){if(1==e)this.goDoTask();else if(2==e)this.goDoTask();else if(3==e)h.default.Platform==u.PLAT_FORM.Douyin?p.default.Instance.shareAppCallBack(this,this.shareAppCallback2):d.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),p.default.Instance.shareApp();else if(4==e);else if(5==e){if(d.default.Instance.giftBagLoigc.receiveGiftItems(this.rewardArray,1),d.default.Instance.taskLogic.receiveReward(this.smallType,this.type),this.taskConfig.pointAward&&h.default.PassCheckSwitch)for(var a=this.taskConfig.pointAward,n=0;n<a.length;++n){var i=a[n][0],o=a[n][1],r=a[n][2];2==i?d.default.Instance.moneyLogic.addItemCount(o,r):1==i&&d.default.Instance.equipmentLogic.addEquipmentData(o)}this.reset(),2==this.smallType&&this.taskLayer.resetCompeleteAllTaskItem(),this.taskLayer.orderTaskItem()}},e.prototype.goDoTask=function(){switch(this.type){case 1:case 11:this.taskLayer.node.active=!1,d.default.Instance.chapterLogic.quickStartGame(u.PAGE_NAME.Task,d.default.Instance.chapterLogic.getMaxChapterInfo(1)[0],d.default.Instance.chapterLogic.getMaxChapterInfo(1)[1],1);break;case 2:this.taskLayer.node.active=!1;var t=Math.floor(this.taskConfig.type_key/100),e=this.taskConfig.type_key%100;d.default.Instance.chapterLogic.quickStartGame(u.PAGE_NAME.Task,t,e,1);break;case 3:case 5:d.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(u.PAGE_NAME.Task,l.default.Instance.playerData.roleId);break;case 4:case 15:d.default.Instance.combatScene.popLayer.reviewStrengthLayer(u.PAGE_NAME.Task);break;case 6:d.default.Instance.combatScene.popLayer.reviewSigninLayer(u.PAGE_NAME.Task);break;case 7:d.default.Instance.combatScene.popLayer.reviewLotteryLayer(u.PAGE_NAME.Task);break;case 8:d.default.Instance.combatScene.popLayer.reviewSkillLayer(u.PAGE_NAME.Task,l.default.Instance.playerData.roleId);break;case 9:p.default.Instance.adHandler(p.default.AD_TYPE_TASK_TYPE1,this,this.adCallback);break;case 10:p.default.Instance.adHandler(p.default.AD_TYPE_TASK_TYPE2,this,this.adCallback);break;case 12:case 13:case 14:break;case 16:d.default.Instance.combatScene.popLayer.reviewShakeJarLayer(u.PAGE_NAME.Task);break;case 17:d.default.Instance.combatScene.popLayer.reviewEndlessLayer(u.PAGE_NAME.Task)}},e.prototype.adCallback=function(t,e){0==e?(0==l.default.Instance.playerData.cdActiveFreeAd&&(t==p.default.AD_TYPE_TASK_TYPE2?d.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count2,0,1):d.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1)),t!=p.default.AD_TYPE_TASK_TYPE2&&t!=p.default.AD_TYPE_TASK_TYPE1||(this.reset(),this.taskLayer.orderTaskItem(),5!=this.btnStatus&&d.default.Instance.giftBagLoigc.receiveGiftItems([[1043,1,2],[1001,100,2]],1))):-1==e?d.default.Instance.combatScene.showMsgInfo(h.default.NO_AD):d.default.Instance.combatScene.showMsgInfo(h.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void d.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,d.default.Instance.combatScene.showMsgInfo(h.default.SUCCESS_SHARE,1),p.default.Instance.addShareEvent(p.default.SHARE_TYPE_TASK,!0),this.reset(),this.taskLayer.orderTaskItem()}else d.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-p.default.Instance.adServer.shareDateTime)/1e3);if(p.default.Instance.shareState(e)){if(!(l.default.Instance.playerData.shareGetRewardCount>0))return void d.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");l.default.Instance.playerData.shareGetRewardCount-=1,d.default.Instance.combatScene.showMsgInfo(h.default.SUCCESS_SHARE,1),p.default.Instance.addShareEvent(p.default.SHARE_TYPE_TASK,!0),this.reset(),this.taskLayer.orderTaskItem()}else p.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(d.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),p.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],TaskLayer:[function(t,e,a){"use strict";cc._RF.push(e,"eebbcR5XF1AgaoqNmVhRNCF","TaskLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("PublicEnum"),h=i("MainLogic"),u=i("AdServer"),d=i("TaskLogic"),p=i("SoundManager"),f=cc._decorator,y=f.ccclass,m=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskItemPrefab=null,e.dayTaskItemList=new Array,e.achieveItemList=new Array,e}return r(e,t),e.prototype.init=function(t){var e=this;this.dayList=cc.find("List1",this.node).getComponent(cc.ScrollView),this.dayBtn=cc.find("Btns/toggle1",this.node).getComponent(cc.Toggle),this.achieveList=cc.find("List2",this.node).getComponent(cc.ScrollView),this.achieveBtn=cc.find("Btns/toggle2",this.node).getComponent(cc.Toggle),this.dayList.node.active=!0,this.dayBtn.isChecked=!0,this.achieveList.node.active=!1,this.achieveBtn.isChecked=!1,this.node.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){for(var a=c.default.Instance.achieveMap.getKeys(),n=0;n<a.length;n++){var i=a[n];null!=(r=h.default.Instance.taskLogic.queryAchieveTaskData(i))&&((l=(s=cc.instantiate(e.taskItemPrefab)).getComponent("TaskItem")).init(e,r),e.achieveList.content.addChild(s),e.achieveItemList.push(l))}var o=c.default.Instance.dayMap;for(n=0;n<o.length;n++){var r,s,l;i=o[n].type,null!=(r=h.default.Instance.taskLogic.queryDayTaskData(i))&&((l=(s=cc.instantiate(e.taskItemPrefab)).getComponent("TaskItem")).init(e,r),e.dayList.content.addChild(s),e.dayTaskItemList.push(l))}e.review(t)},this)))},e.prototype.orderTaskItem=function(){for(var t=0;t<this.dayTaskItemList.length;t++)1==(a=(e=this.dayTaskItemList[t]).taskData.status)&&(e.node.zIndex=1e3),0==a&&(e.node.zIndex=2e3),2==a&&(e.node.zIndex=3e3);for(t=0;t<this.achieveItemList.length;t++){var e,a;1==(a=(e=this.achieveItemList[t]).taskData.status)&&(e.node.zIndex=1e3),0==a&&(e.node.zIndex=2e3),2==a&&(e.node.zIndex=3e3)}var n=cc.find("Tip",this.dayBtn.node);n.active=1==h.default.Instance.tipsLogic.homeTips[7],n.stopAllActions(),n.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))));var i=cc.find("Tip",this.achieveBtn.node);i.active=1==h.default.Instance.tipsLogic.homeTips[8],i.stopAllActions(),i.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.3,.72),cc.scaleTo(.3,.6))))},e.prototype.review=function(t){this.fromPageName=t;for(var e=0;e<this.dayTaskItemList.length;e++)this.dayTaskItemList[e].reset();for(e=0;e<this.achieveItemList.length;e++)this.achieveItemList[e].reset();this.orderTaskItem(),this.scheduleOnce(function(){u.default.Instance.showCustomAd(1),u.default.Instance.showCustomAd(2)},0)},e.prototype.resetCompeleteAllTaskItem=function(){for(var t=0;t<this.dayTaskItemList.length;t++){var e=this.dayTaskItemList[t];e.type==d.default.type_complete_all_task&&e.reset()}},e.prototype.onClickEvent=function(t,e){p.SoundManager.Instance.playEffect("anniu"),0==e?(this.node.active=!1,this.fromPageName==l.PAGE_NAME.Home&&h.default.Instance.combatScene.homeLayer.showTips(),u.default.Instance.hideCustomAd(1),u.default.Instance.hideCustomAd(2)):1==e?(this.dayList.node.active=!0,this.achieveList.node.active=!1):2==e&&(this.dayList.node.active=!1,this.achieveList.node.active=!0)},s([m(cc.Prefab)],e.prototype,"taskItemPrefab",void 0),s([y],e)}(cc.Component);o.default=g,cc._RF.pop()},{}],TaskLogic:[function(t,e,a){"use strict";cc._RF.push(e,"22bb77htdNALoY/DHKD/ccg","TaskLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("TaskData"),s=n("ConfigData"),c=n("MainLogic"),l=n("PublicConst"),h=function(){function t(){}return t.prototype.queryAchieveTaskData=function(t,e){void 0===e&&(e=!1);var a,n=o.default.Instance.playerData.acheveTaskList;if(n)for(var i=0;i<n.length;i++){var s=n[i];if(s.type==t&&3==s.smallType){a=s;break}}else o.default.Instance.playerData.acheveTaskList=new Array;return null==a&&e&&((a=new r.default(3,t)).status=0,o.default.Instance.playerData.acheveTaskList.push(a)),a},t.prototype.initAchieveTaskData=function(){for(var t=s.default.Instance.achieveMap.getKeys(),e=0;e<t.length;e++){var a=Number(t[e]),n=this.queryAchieveTaskData(a,!0);null==n&&((n=new r.default(3,a)).status=0,n.order=1,o.default.Instance.playerData.acheveTaskList.push(n))}},t.prototype.queryDayTaskData=function(t,e){void 0===e&&(e=!1);var a,n=o.default.Instance.playerData.dailyTaskList;if(n)for(var i=0;i<n.length;i++){var s=n[i];if(s.type==t&&2==s.smallType){a=s;break}}else o.default.Instance.playerData.dailyTaskList=new Array;return null==a&&e&&((a=new r.default(2,t)).status=0,o.default.Instance.playerData.dailyTaskList.push(a)),a},t.prototype.initDayData=function(){for(var t=s.default.Instance.dayMap,e=0;e<t.length;e++){var a=t[e].type,n=this.queryDayTaskData(a,!0);null==n&&((n=new r.default(2,a)).status=0,o.default.Instance.playerData.dailyTaskList.push(n)),n.status=0,n.order=1,n.count=0}},t.prototype.queryThreadTaskData=function(t,e,a){void 0===a&&(a=!1);var n,i=o.default.Instance.playerData.threadTaskList;if(i)for(var s=0;s<i.length;s++){var c=i[s];if(c.order==e&&1==c.smallType){n=c;break}}else o.default.Instance.playerData.threadTaskList=new Array;return null==n&&a&&((n=new r.default(1,t)).status=0,n.order=e,o.default.Instance.playerData.threadTaskList.push(n)),n},t.prototype.queryThreadTaskDataByOrder=function(t){for(var e,a=o.default.Instance.playerData.threadTaskList,n=0;n<a.length;n++){var i=a[n];if(i.order==t&&1==i.smallType){e=i;break}}return e},t.prototype.queryThreadTaskDataList=function(t){for(var e=o.default.Instance.playerData.threadTaskList,a=new Array,n=0;n<e.length;n++){var i=e[n];i.type==t&&1==i.smallType&&a.push(i)}return a},t.prototype.initThreadData=function(){for(var t=s.default.Instance.threadTaskMap.getKeys(),e=0;e<t.length;e++){var a=Number(t[e]),n=s.default.Instance.threadTaskMap.get(a).type,i=this.queryThreadTaskData(n,a,!0);null==i&&((i=new r.default(1,n)).status=0,i.order=a,o.default.Instance.playerData.threadTaskList.push(i))}},t.prototype.finishAllTask=function(e,a,n){if(e==t.type_pass_check_level)this.finishPassCheckTask(e,a,n);else{for(var i=1;i<4;++i)1==i?this.finishThreadTask(e,a,n):2==i?this.finishDayTask(e,a,n):3==i&&this.finishAchieveTask(e,a,n);c.default.Instance.tipsLogic.updateTask()}},t.prototype.finishAchieveTask=function(e,a,n){var i=this.queryAchieveTaskData(e);if(null!=i){if(e==t.type_wear_equipment||e==t.type_role_level?i.count=a:e==t.type_strength_equipment_level?a>i.count&&(i.count=a):i.type==t.type_adopt_appoint_dungeon||(i.count+=n),0==i.status){var r=s.default.Instance.achieveMap.get(e).get(i.order);r&&(i.type==t.type_adopt_appoint_dungeon?r.type_key==a&&(i.count+=n,i.status=1):i.count>=r.type_key&&(i.status=1))}o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())}else console.log("\u6ca1\u6709\u8fd9\u4e2a\u6210\u5c31\u4efb\u52a1")},t.prototype.finishDayTask=function(e,a,n){var i=this.queryDayTaskData(e);if(null!=i){if(e==t.type_wear_equipment||e==t.type_role_level?i.count=a:e==t.type_strength_equipment_level?a>i.count&&(i.count=a):i.type==t.type_adopt_appoint_dungeon||(i.count+=n),0==i.status){var r=this.queryDayTaskConfig(e);r&&(i.type==t.type_adopt_appoint_dungeon?r.type_key==a&&(i.count+=n,i.status=1):i.count>=r.type_key&&(i.status=1))}o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())}else console.log("\u6ca1\u6709\u8fd9\u4e2a\u65e5\u5e38\u4efb\u52a1")},t.prototype.finishThreadTask=function(e,a,n){var i=this.queryThreadTaskDataList(e);if(0!=i.length){for(var r=0;r<i.length;++r){var l=i[r];if(e==t.type_wear_equipment||e==t.type_role_level?l.count=a:e==t.type_strength_equipment_level?a>l.count&&(l.count=a):l.type==t.type_adopt_appoint_dungeon||(l.count+=n),0==l.status){var h=s.default.Instance.threadTaskMap.get(l.order);h&&(l.type==t.type_adopt_appoint_dungeon?h.type_key==a&&(l.count+=n,l.status=1):l.count>=h.type_key&&(l.status=1))}}o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())}else console.log("\u6ca1\u6709\u8fd9\u4e2a\u4e3b\u7ebf\u4efb\u52a1")},t.prototype.queryDayTaskConfig=function(t){for(var e=s.default.Instance.dayMap,a=0;a<e.length;a++){var n=e[a];if(n.type==t)return n}return null},t.prototype.taskTip=function(){var t=o.default.Instance.playerData.threadTaskList,e=[0,0,0];if(t)for(var a=0;a<t.length;a++)if(1==t[a].status){e[0]=1;break}var n=o.default.Instance.playerData.dailyTaskList;if(n)for(a=0;a<n.length;a++)if(1==n[a].status){e[1]=1;break}var i=o.default.Instance.playerData.acheveTaskList;if(i)for(a=0;a<i.length;a++)if(1==i[a].status){e[2]=1;break}return e},t.prototype.receiveReward=function(e,a){var n;if(1==(n=1==e?this.queryThreadTaskData(a,o.default.Instance.playerData.showThreadTaskOrder):2==e?this.queryDayTaskData(a):this.queryAchieveTaskData(a)).status)if(3==e){var i=s.default.Instance.achieveMap.get(a).get(n.order+1);null==i?n.status=2:(n.order++,n.count>=i.type_key?n.status=1:n.status=0)}else 2==e?(n.status=2,10!=a&&this.finishDayTask(t.type_complete_all_task,0,1)):(o.default.Instance.playerData.showThreadTaskOrder+=1,n.status=2);c.default.Instance.tipsLogic.updateTask(),o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())},t.prototype.queryPassCheckTaskData=function(t,e,a){void 0===a&&(a=!1);var n,i=o.default.Instance.playerData.passCheckTaskData;if(i)for(var s=0;s<i.length;s++){var c=i[s];if(c.order==t&&4==c.smallType){n=c;break}}else o.default.Instance.playerData.passCheckTaskData=new Array;return null==n&&a&&((n=new r.default(4,e)).status=0,o.default.Instance.playerData.passCheckTaskData.push(n)),n},t.prototype.initPassCheckTaskData=function(){for(var t=s.default.Instance.passCheckTaskMap,e=0;e<t.length;e++){var a=t[e].order,n=t[e].type,i=this.queryPassCheckTaskData(a,n,!0);null==i&&((i=new r.default(4,n)).status=0,o.default.Instance.playerData.passCheckTaskData.push(i)),i.status=0,i.order=t[e].order,i.count=0}},t.prototype.queryPassCheckTaskConfig=function(t){for(var e=s.default.Instance.passCheckTaskMap,a=0;a<e.length;a++){var n=e[a];if(n.order==t)return n}return null},t.prototype.finishPassCheckTask=function(t,e){var a=o.default.Instance.playerData.passCheckTaskData;if(l.default.PassCheckSwitch&&null!=a&&0!=a.length){for(var n=0;n<a.length;++n){var i=a[n];if(i.type==t&&(i.count=e,0==i.status)){var r=this.queryPassCheckTaskConfig(i.order);r&&i.count>=r.type_key&&(i.status=1)}}o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())}},t.prototype.receivePassCheckReward=function(t,e,a){var n=this.queryPassCheckTaskData(t,e);switch(n.status){case 0:break;case 1:n.status=3==a?4:3;break;case 2:break;case 3:3==a&&(n.status=2);break;case 4:4==a&&(n.status=2)}11==t&&(n.status=2),o.default.Instance.localStorage(c.default.Instance.combatScene.isGameStart())},t.prototype.getTowerReward=function(){var t=c.default.Instance.taskLogic.getTowerTargetInfo();if(o.default.Instance.playerData.maxTowerLayerCount<t.type_key&&o.default.Instance.playerData.maxTowerLayerCount!=l.default.MAX_TOWER_LAYER)return c.default.Instance.combatScene.showMsgInfo("\u901a\u5173\u7b2c"+t.type_key+"\u5c42\u540e\u624d\u53ef\u9886\u53d6"),!1;var e=o.default.Instance.playerData.towerRewardOrder;l.default.MAX_TOWER_LAYER==e?o.default.Instance.playerData.towerRewardOver=1:o.default.Instance.playerData.towerRewardOrder+=1;var a=l.default.ClimbTowerSeasionId%4;0==a&&(a=4);var n=t.awardList[a-1],i=s.default.Instance.giftMap.get(n),r=c.default.Instance.giftBagLoigc.getGiftRewardByIndex(i.jsonIndex);return c.default.Instance.giftBagLoigc.receiveGiftItems(r,1),!0},t.prototype.getTowerTargetInfo=function(){for(var t=s.default.Instance.towerTaskMap,e=o.default.Instance.playerData.towerRewardOrder,a=0;a<t.length;++a)if(t[a].order==e)return t[a]},t.type_adopt_dungeon_count=1,t.type_adopt_appoint_dungeon=2,t.type_wear_equipment=3,t.type_strength_equipment_level=4,t.type_resolve_equipment_count=5,t.type_sigin_reward=6,t.type_lottery_count=7,t.type_skill_upgrade_count=8,t.type_see_ad_count1=9,t.type_see_ad_count2=10,t.type_role_level=11,t.type_login_count=12,t.type_share_count=13,t.type_complete_all_task=14,t.type_strength_equipment_count=15,t.type_draw_count=16,t.type_adopt_fuben_count=17,t.type_pass_check_level=18,t}();i.default=h,cc._RF.pop()},{}],ThreadTask:[function(t,e,a){"use strict";cc._RF.push(e,"8fe05962AJObLwArvjXWn8e","ThreadTask");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AdServer"),l=i("PublicConst"),h=i("PublicEnum"),u=i("ConfigData"),d=i("GameData"),p=i("MainLogic"),f=i("TaskLogic"),y=cc._decorator,m=y.ccclass,g=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItemList=new Array,e.rewardArray=new Array,e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.homeLayer=t,this.titleNode=cc.find("Name",this.node),this.descNode=cc.find("Progress/Desc",this.node),this.progressNode=cc.find("Progress/Num",this.node),this.rewardTipNode=cc.find("Status",this.node),this.itemListNode=cc.find("ItemListNode",this.node),this.taskData=p.default.Instance.taskLogic.queryThreadTaskDataByOrder(d.default.Instance.playerData.showThreadTaskOrder),this.review()},e.prototype.review=function(){if(this.taskData){if(d.default.Instance.playerData.showThreadTaskOrder!=this.taskData.order){if(this.taskData=p.default.Instance.taskLogic.queryThreadTaskDataByOrder(d.default.Instance.playerData.showThreadTaskOrder),!this.taskData)return void(this.node.active=!1);for(var t=0;t<this.rewardItemList.length;t++){var e=this.rewardItemList[t];p.default.Instance.sceneNodeManager.putRewardItem(e)}this.rewardItemList.splice(0,this.rewardItemList.length),this.rewardArray.splice(0,this.rewardArray.length)}if(this.taskConfig=u.default.Instance.threadTaskMap.get(this.taskData.order),this.titleNode.getComponent(cc.Label).string=this.taskConfig.task_name,this.descNode.getComponent(cc.Label).string=this.taskConfig.task_content,this.progressNode.getComponent(cc.Label).string="("+this.taskData.count+"/"+(this.taskConfig.type==f.default.type_adopt_appoint_dungeon?1:this.taskConfig.type_key)+")",0==this.rewardItemList.length)for(t=0;t<this.taskConfig.baseAwardList.length;t++){var a=this.taskConfig.baseAwardList[t];e=p.default.Instance.sceneNodeManager.getRewardItem(a[1],a[2],a[0],t,!1,!0,!1,!1,!1),this.rewardItemList.push(e),this.itemListNode.addChild(e.node),this.rewardArray.push([a[1],a[2],a[0]])}this.btnStatus=[[1,1,1,1,1,1,1,1,1,2,2,1,4,3,4,1,1,1],[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6]][this.taskData.status][this.taskData.type],this.rewardTipNode.active=5==this.btnStatus}else this.node.active=!1},e.prototype.onClickBtn=function(){1==this.btnStatus?this.goDoTask():2==this.btnStatus?this.goDoTask():3==this.btnStatus?(l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp()):4==this.btnStatus||5==this.btnStatus&&(p.default.Instance.giftBagLoigc.receiveGiftItems(this.rewardArray,1),p.default.Instance.taskLogic.receiveReward(1,this.taskData.type),this.review(),p.default.Instance.combatScene.popLayer.pointGuideFinish())},e.prototype.goDoTask=function(){switch(this.taskData.type){case 1:case 11:p.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.Home,p.default.Instance.chapterLogic.getMaxChapterInfo(1)[0],p.default.Instance.chapterLogic.getMaxChapterInfo(1)[1],1);break;case 2:var t=Math.floor(this.taskConfig.type_key/100),e=this.taskConfig.type_key%100;p.default.Instance.chapterLogic.quickStartGame(h.PAGE_NAME.Home,t,e,1);break;case 3:case 5:p.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(h.PAGE_NAME.Home,d.default.Instance.playerData.roleId);break;case 4:case 15:p.default.Instance.combatScene.popLayer.reviewStrengthLayer(h.PAGE_NAME.Home);break;case 6:p.default.Instance.combatScene.popLayer.reviewSigninLayer(h.PAGE_NAME.Home);break;case 7:p.default.Instance.combatScene.popLayer.reviewLotteryLayer(h.PAGE_NAME.Home);break;case 8:p.default.Instance.combatScene.popLayer.reviewSkillLayer(h.PAGE_NAME.Home,d.default.Instance.playerData.roleId);break;case 9:c.default.Instance.adHandler(c.default.AD_TYPE_TASK_TYPE1,this,this.adCallback);break;case 10:c.default.Instance.adHandler(c.default.AD_TYPE_TASK_TYPE2,this,this.adCallback);break;case 12:break;case 13:this.shareType=c.default.SHARE_TYPE_TASK,l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp();break;case 14:break;case 16:p.default.Instance.combatScene.popLayer.reviewShakeJarLayer(h.PAGE_NAME.Home);break;case 17:p.default.Instance.combatScene.popLayer.reviewEndlessLayer(h.PAGE_NAME.Home)}},e.prototype.adCallback=function(t,e){0==e?(0==d.default.Instance.playerData.cdActiveFreeAd&&(t==c.default.AD_TYPE_TASK_TYPE2?p.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count2,0,1):p.default.Instance.taskLogic.finishAllTask(f.default.type_see_ad_count1,0,1)),t!=c.default.AD_TYPE_TASK_TYPE2&&t!=c.default.AD_TYPE_TASK_TYPE1&&t!=c.default.SHARE_TYPE_TASK_TYPE1&&t!=c.default.SHARE_TYPE_TASK_TYPE2||this.review()):-1==e?(p.default.Instance.combatScene.showMsgInfo(l.default.NO_AD),c.default.Instance.noVideoToShare()&&(t==c.default.AD_TYPE_TASK_TYPE1?this.shareType=c.default.SHARE_TYPE_TASK_TYPE1:t==c.default.AD_TYPE_TASK_TYPE2&&(this.shareType=c.default.SHARE_TYPE_TASK_TYPE2),l.default.Platform==h.PLAT_FORM.Douyin?c.default.Instance.shareAppCallBack(this,this.shareAppCallback2):p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())):p.default.Instance.combatScene.showMsgInfo(l.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(d.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");d.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.review()}else p.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-c.default.Instance.adServer.shareDateTime)/1e3);if(c.default.Instance.shareState(e)){if(!(d.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");d.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(l.default.SUCCESS_SHARE,1),c.default.Instance.addShareEvent(this.shareType,!0),this.review()}else c.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),c.default.Instance.shareApp())},s([m],e)}(cc.Component));o.default=g,cc._RF.pop()},{}],TimeLogSerer:[function(t,e,a){"use strict";cc._RF.push(e,"dfb3alSqIxP6LsrXpDCHyJg","TimeLogSerer");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.startTimeAction=function(){this.starTime=(new Date).getTime()},t.prototype.printCommonLog=function(t){var e=(new Date).getTime()-this.starTime;console.log("<---"+t+"---\x3e\u65f6\u95f4\u6d88\u8017\uff1a"+e+"\u6beb\u79d2")},t}();n.default=i,cc._RF.pop()},{}],TipsLogic:[function(t,e,a){"use strict";cc._RF.push(e,"6decbVW6KFN/KX08ORjqFEL","TipsLogic");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("GameData"),r=n("MainLogic"),s=function(){function t(){this.homeTips=new Array;for(var t=0;t<20;t++)this.homeTips.push(0)}return t.prototype.updateAllTips=function(){for(var t=0;t<this.homeTips.length;t++)this.homeTips[t]=0;this.updateSignTips(),this.updateStrengthTips(),this.updateEquipment(),this.updateSkill(),this.updateLottery(),this.updateTask(),this.updateFuben(),this.updateShakeJar()},t.prototype.updateSignTips=function(){this.homeTips[1]=0;var t=o.default.Instance.playerData.loginDayNum;0!=r.default.Instance.signinLogic.getBtnStatus(t)&&(this.homeTips[1]=1)},t.prototype.updateStrengthTips=function(){this.homeTips[2]=0,r.default.Instance.equipmentLogic.getEquipmentStrengthIndex().length>0&&(this.homeTips[2]=1)},t.prototype.updateEquipment=function(){if(this.homeTips[3]=0,o.default.Instance.playerData.getNewEquipment&&(this.homeTips[3]=1),0==this.homeTips[3])for(var t=1;t<=6;++t){var e=r.default.Instance.equipmentLogic.getMostSuitEquipment(t);if(0!=e.length){var a=r.default.Instance.equipmentLogic.getRoleEquipData(o.default.Instance.playerData.roleId);if(null==a){this.homeTips[3]=1;break}var n=a.equipment[t];if(e.indexOf(n)>=0){this.homeTips[3]=1;break}}}0!=this.homeTips[3]||o.default.Instance.playerData.showPropUseTip||r.default.Instance.equipmentLogic.getPropTipStatus()&&(this.homeTips[3]=1)},t.prototype.updateSkill=function(){this.homeTips[4]=0,r.default.Instance.roleLogic.getSkillUpgradeUnlockIndex(o.default.Instance.playerData.roleId).length>0&&(this.homeTips[4]=1)},t.prototype.updateLottery=function(){this.homeTips[5]=0,o.default.Instance.playerData.freeLotteryTimes>0&&(this.homeTips[5]=1)},t.prototype.updateTask=function(){this.homeTips[6]=0,this.homeTips[7]=0,this.homeTips[8]=0;var t=r.default.Instance.taskLogic.taskTip();1==t[0]&&(this.homeTips[6]=1),1==t[1]&&(this.homeTips[7]=1),1==t[2]&&(this.homeTips[8]=1)},t.prototype.updateFuben=function(){this.homeTips[9]=0,r.default.Instance.chapterLogic.getFubenChallegeCount()>0&&(this.homeTips[9]=1)},t.prototype.updateShakeJar=function(){this.homeTips[10]=o.default.Instance.playerData.shakeJarCount>0?1:0},t}();i.default=s,cc._RF.pop()},{}],TowerRewardInfo:[function(t,e,a){"use strict";cc._RF.push(e,"1940dBZPcFNhpPF/yCM+eMC","TowerRewardInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.type=o.default.stringToInt(t.type),this.order=o.default.stringToInt(t.order),this.item=t.item,this.itemList=o.default.config_stringToIntListOfList(this.item),this.lvl=t.lvl,this.lvlValue=o.default.config_stringToIntList(this.lvl,"_"),this.startLevel=this.lvlValue[0],null==this.lvlValue[1]?this.endLevel=0:this.endLevel=this.lvlValue[1]},cc._RF.pop()},{}],TrapInfo:[function(t,e,a){"use strict";cc._RF.push(e,"88382d4rAJAEaTpi+ut8ulR","TrapInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=o.default.stringToInt(t.id),this.name=t.name,this.res_id=t.res_id,this.atk=o.default.stringToFloat(t.atk),this.direction=o.default.stringToInt(t.direction),this.skill=o.default.stringToInt(t.skill),this.start_time=o.default.stringToFloat(t.start_time)},cc._RF.pop()},{}],TrapShooter:[function(t,e,a){"use strict";cc._RF.push(e,"942ebv+vRdACqYXpVmz4OMa","TrapShooter");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("PublicEnum"),r=n("RectCircle"),s=n("HurtUtil"),c=n("StringUtils"),l=n("MyMathUtils"),h=n("Dictionary"),u=n("MainLogic"),d=n("SoundManager"),p=function(){function t(t){this.hitTargetMap=new h.Dictionary,this.trapSprite=t}return t.prototype.startAttack=function(){var t=this.trapSprite.skillInfo,e=u.default.Instance.combatLayer.dungeonInfo,a=u.default.Instance.mainLayer.myHeroSprite;if(null!=a&&a.heroStatus.canAttacked()){var n=this.trapSprite.trapInfo;if(t.skill_type==o.SKILL_TYPE.Type_1005){var i=this.trapSprite.node.getPosition(),h=new cc.Rect(i.x+t.hurtStartList[0][0]-t.hurtAreaList[0]/2,i.y+t.hurtStartList[0][1]-t.hurtAreaList[1]/2,t.hurtAreaList[0],t.hurtAreaList[1]);a.node.getPosition().y+=a.heroNode.bodyBoxSprite.y;var p=r.default.newCircle(cc.v2(a.node.getPosition().x,a.node.getPosition().y+a.heroNode.bodyBoxSprite.y*a.node.scaleY),.5*a.roleInfo.bodyArea.height*a.node.scale);if(r.default.collide(h,0,p)){var f=this.hitTargetMap.get(a.randomId);if(null!=f){if(++f>t.max_hurt)return}else f=1;this.hitTargetMap.put(a.randomId,f),d.SoundManager.Instance.playEffect(t.hit_sound);var y=e.atk_coefficient*this.trapSprite.trapInfo.atk,m=s.default.createTrapHurtData(a,t,y);s.default.hurt(m);var g=1;i.x>a.node.getPosition().x&&(g=-1),a.hitEvent(g,t.hitImpulseList[0],t.hitTimeList[0],!0,1,t.id,1,null)}}else{var I;if(c.default.stringIsNull(t.sound)||d.SoundManager.Instance.playEffect(t.sound),I=1==n.direction?90:2==n.direction?0:3==n.direction?-90:180,i=this.trapSprite.node.getPosition(),null!=t.hurtStartList&&t.hurtStartList.length>0){var _=t.hurtStartList[0][1];i.x+=Math.cos(l.default.toRadian(I))*_,i.y+=Math.sin(l.default.toRadian(I))*_}var v=u.default.Instance.combatLayer.mainLayer.nodeManager.getBullet(null,t.id,null,i,null,I);v.trapSprite=this.trapSprite,v.mainStep()}}},t}();i.default=p,cc._RF.pop()},{}],TrapSprite:[function(t,e,a){"use strict";cc._RF.push(e,"63ca7NjVhJA14OhurMHEbTm","TrapSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("StringUtils"),h=i("TrapShooter"),u=i("AssetUtils"),d=i("PublicEnum"),p=i("MainLogic"),f=cc._decorator,y=f.ccclass,m=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){var e=this;this.trapId=t,this.trapShooter=new h.default(this),this.trapInfo=c.default.Instance.trapMap.get(this.trapId),this.resList=l.default.stringToStringListForRes(this.trapInfo.res_id),this.skillInfo=c.default.Instance.skillMap.get(this.trapInfo.skill),this.bodyNode=cc.find("Body",this.node),this.bodyDisplay=this.bodyNode.getComponent(sp.Skeleton),this.node.scale=c.default.Instance.resourceMap.get(this.trapInfo.res_id).scale;var a,n=this.resList[0];u.AssetUtils.loadSpine(this.bodyDisplay,"Bullet/"+n,null,function(){e.playStand()},this),a=1==this.trapInfo.direction?90:3==this.trapInfo.direction?-90:2==this.trapInfo.direction?0:180,this.node.angle=a-90},e.prototype.resetData=function(t){var e=this;this.node.x=t.x,this.node.y=t.y,this.status=0,this.node.runAction(cc.sequence(cc.delayTime(this.trapInfo.start_time),cc.callFunc(function(){e.schedule(e.scheduleStatus,e.skillInfo.condition_value)},this)))},e.prototype.playStand=function(){this.bodyDisplay.setAnimation(0,"stand",!1)},e.prototype.playAtk=function(){},e.prototype.scheduleStatus=function(){var t=this;p.default.Instance.combatLayer.gameStep==d.GAME_STEP.Starting&&(0==this.status?(this.status=1,this.playAtk(),this.node.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){1005==t.skillInfo.skill_type?(t.trapShooter.hitTargetMap.clear(),t.schedule(t.scheduleAttack,.1),t.node.runAction(cc.sequence(cc.delayTime(.6),cc.callFunc(function(){t.playStand(),t.unschedule(t.scheduleAttack)},t)))):t.trapShooter.startAttack()},this)))):(this.unschedule(this.scheduleAttack),this.status=0,this.playStand()))},e.prototype.scheduleAttack=function(){this.trapShooter.startAttack()},e.prototype.delete=function(){this.node.stopAllActions(),this.unscheduleAllCallbacks(),p.default.Instance.mainLayer.nodeManager.putTrapSprite(this)},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this),this.bodyDisplay.timeScale=0},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this),this.bodyDisplay.timeScale=1},s([y],e)}(cc.Component));o.default=m,cc._RF.pop()},{}],UiLayer:[function(t,e,a){"use strict";cc._RF.push(e,"96538ZDm+tL3aAoafivENJM","UiLayer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("GameData"),l=i("PublicEnum"),h=i("AssetUtils"),u=i("ConfigData"),d=i("AdServer"),p=i("MainLogic"),f=i("SmallMapLayer"),y=i("StringUtils"),m=i("PublicConst"),g=i("PlayerAttribute"),I=i("SoundManager"),_=i("TaskLogic"),v=cc._decorator,S=v.ccclass,L=(v.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currRoommonsterTotalNum=0,e.currRoomdeadMonsterNum=0,e.deadMonsterNum=0,e.hurtTime=0,e.hurtNum=0,e.storageTime=0,e.heroId1=-1,e.heroId2=-1,e.monsterHpStartMove=!1,e.skillNodes={},e.totalTime=180,e.totalCoin=0,e.currPressKey=0,e.startCoinSchedule=!1,e.dtAddCoin=0,e.buffLastTime={},e.buffTime={},e.shareType=0,e}return r(e,t),e.prototype.init=function(t){this.combatLayer=t,this.rightNode=cc.find("Right",this.node),this.touchLayer=cc.find("TouchLayer",this.node),this.leftNode=cc.find("Left",this.node),this.rockerLayer=cc.find("Left/RockerLayer",this.node).getComponent("RockerLayer"),this.atkBtn=cc.find("Right/AtkBtn",this.node);var e=cc.find("Right/Skill1Btn",this.node),a=cc.find("Right/Skill2Btn",this.node),n=cc.find("Right/Skill3Btn",this.node),i=cc.find("Right/Skill4Btn",this.node),o=cc.find("Right/Skill5Btn",this.node),r=cc.find("Right/Skill6Btn",this.node),s=cc.find("Right/Skill7Btn",this.node),c=cc.find("Right/Skill8Btn",this.node),h=cc.find("Left/Jump",this.node);this.skillNodes[2001]=e,this.skillNodes[2002]=a,this.skillNodes[2004]=n,this.skillNodes[2006]=i,this.skillNodes[2005]=o,this.skillNodes[2007]=r,this.skillNodes[2008]=s,this.skillNodes[2003]=c,this.pauseBtn=cc.find("Left/Blood1/Pause",this.node),this.blood1Node=cc.find("Left/Blood1",this.node),this.blood1Node.active=!1,this.blood2Node=cc.find("Center/Blood",this.node),this.coinNumNode=cc.find("Left/Coin/Num",this.node),this.coinImgNode=cc.find("Left/Coin/Img",this.node),this.rewardNode=cc.find("Left/SmallMap/Reward",this.node),this.hurtEffectNode=cc.find("Right/HurtEffect",this.node),this.hurtEffectNode.active=!1,this.hurtTimeNode=cc.find("Times",this.hurtEffectNode),this.monsterNumNode=cc.find("Left/MonsterNum/Num",this.node),this.sceneChangeNode=cc.find("Center/SceneChange",this.node),this.sceneChangeNode.active=!1,this.startRecordNode=cc.find("Right/StartRecord",this.node),this.endRecordNode=cc.find("Right/EndRecord",this.node),this.buffBoxListNode=cc.find("BuffBoxList",this.node),this.timeNode=cc.find("Center/Time/Time",this.node),this.towerTimeNode=cc.find("Center/Time2/Time",this.node),this.towerLayerNode=cc.find("Center/Time2/Layer",this.node);for(var u=[this.atkBtn,e,a,n,i,o,r,s,c,h],d=0;d<u.length;d++){var y=u[d];y.on(cc.Node.EventType.TOUCH_START,this.touchStartEvent,this),y.on(cc.Node.EventType.TOUCH_END,this.touchEndEvent,this),y.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndEvent,this)}cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.openEvent(),this.specialItemNode=cc.find("Center/SpecialItem",this.node),this.specialItemNode.active=!1,this.smallMapLayer=cc.find("Left/SmallMap",this.node).getComponent(f.default),p.default.Instance.combatScene.isFringe>0&&m.default.Platform!=l.PLAT_FORM.Opp?(console.log("\u5f53\u524d\u5218\u6d77\u5c4f"),cc.find("Left/SmallMap",this.node).getComponent(cc.Widget).left=p.default.Instance.combatScene.isFringe,cc.find("Left/Coin",this.node).getComponent(cc.Widget).left=p.default.Instance.combatScene.isFringe,cc.find("Left/Blood1",this.node).getComponent(cc.Widget).left=p.default.Instance.combatScene.isFringe):console.log("\u5f53\u524d\u4e0d\u662f\u5218\u6d77\u5c4f")},e.prototype.openEvent=function(){this.touchLayer.on(cc.Node.EventType.TOUCH_START,this.touchStartEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_END,this.touchEndEventRocker,this),this.touchLayer.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancelEventRocker,this)},e.prototype.touchStartEventRocker=function(t){if(!this.combatLayer.loadSceneStage){var e=t.getLocation(),a=this.leftNode.convertToNodeSpaceAR(e),n=Math.max(this.rockerLayer.r1,a.x),i=Math.max(this.rockerLayer.r1,a.y);n=Math.min(n,cc.winSize.width/2-this.rockerLayer.r1),i=Math.min(i,cc.winSize.height-this.rockerLayer.r1),this.rockerLayer.setPoint(cc.v2(n,i))}},e.prototype.touchMoveEventRocker=function(t){if(!this.combatLayer.loadSceneStage){var e=t.getLocation();this.rockerLayer.touchMove(cc.v2(e.x,e.y))}},e.prototype.touchEndEventRocker=function(){this.rockerLayer.resetPoint()},e.prototype.touchCancelEventRocker=function(){this.rockerLayer.resetPoint()},e.prototype.onKeyDown=function(t){var e,a=this.combatLayer.mainLayer.myHeroSprite;if(null!=a&&a.lifeStatus!=l.LIFE_STATUS.Dead&&!this.combatLayer.loadSceneStage)switch(t.keyCode){case cc.macro.KEY.a:this.currPressKey=cc.macro.KEY.a,a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,180);break;case cc.macro.KEY.d:this.currPressKey=cc.macro.KEY.d,a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,0);break;case cc.macro.KEY.w:this.currPressKey=cc.macro.KEY.w,1==a.heroStatus.face?a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,89):a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,90);break;case cc.macro.KEY.s:this.currPressKey=cc.macro.KEY.s,1==a.heroStatus.face?a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,-89):a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move,-90);break;case cc.macro.KEY.h:a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Attack,0);break;case cc.macro.KEY.j:if(e=cc.find("Right/Skill1Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[1].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL1,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,1);break;case cc.macro.KEY.k:if(e=cc.find("Right/Skill2Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[2].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL2,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,2);break;case cc.macro.KEY.l:if(e=cc.find("Right/Skill3Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[6].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL3,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,6);break;case cc.macro.KEY.u:if(e=cc.find("Right/Skill4Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[4].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL4,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,4);break;case cc.macro.KEY.i:if(e=cc.find("Right/Skill5Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[5].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL5,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,5);break;case cc.macro.KEY.o:if(e=cc.find("Right/Skill6Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[7].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL6,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,7),this.storageTime=(new Date).getTime();break;case cc.macro.KEY.p:if(e=cc.find("Right/Skill7Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[8].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL7,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,8),this.storageTime=(new Date).getTime();break;case cc.macro.KEY.y:if(e=cc.find("Right/Skill8Btn",this.node),cc.find("Lock",e).active||a.skillManager.getSkillObj(a.skills[3].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL8,this,this.adCallback);a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,3),this.storageTime=(new Date).getTime();break;case cc.macro.KEY.e:a.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Jump_Back);break;case cc.macro.KEY.l:return}},e.prototype.onKeyUp=function(t){var e=this.combatLayer.mainLayer.myHeroSprite;if(null!=e&&e.lifeStatus!=l.LIFE_STATUS.Dead)switch(t.keyCode){case cc.macro.KEY.a:this.currPressKey==cc.macro.KEY.a&&e.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move_Cancel);break;case cc.macro.KEY.d:this.currPressKey==cc.macro.KEY.d&&e.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move_Cancel);break;case cc.macro.KEY.w:this.currPressKey==cc.macro.KEY.w&&e.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move_Cancel);break;case cc.macro.KEY.s:this.currPressKey==cc.macro.KEY.s&&e.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Move_Cancel);break;case cc.macro.KEY.j:case cc.macro.KEY.k:}},e.prototype.touchStartEvent=function(t){var e=t.target,a=e.name,n=this.combatLayer.mainLayer.myHeroSprite;if(null!=n&&n.lifeStatus!=l.LIFE_STATUS.Dead)if(e.getChildByName("Background").scale=.8,"Jump"==a)n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Jump_Back);else if("AtkBtn"==a)this.combatLayer.pressAttack=!0,n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Attack,0);else if("Skill1Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[1].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL1,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,1)}else if("Skill2Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[2].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL2,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,2)}else if("Skill3Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[6].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL3,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,6)}else if("Skill4Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[4].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL4,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,4)}else if("Skill5Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[5].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL5,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,5)}else if("Skill6Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[7].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL6,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,7),this.storageTime=(new Date).getTime()}else if("Skill7Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[8].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL7,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,8),this.storageTime=(new Date).getTime()}else if("Skill8Btn"==a){if(cc.find("Lock",e).active||n.skillManager.getSkillObj(n.skills[3].id).skillState==l.SKILL_STATE.ContinuouCd)return;if(cc.find("AdLock",e).active)return void d.default.Instance.adHandler(d.default.AD_TYPE_GET_SKILL8,this,this.adCallback);n.heroControl.handleControlEvent(l.CONTROL_EVENT.Control_Skill,3),this.storageTime=(new Date).getTime()}},e.prototype.touchEndEvent=function(t){var e=t.target;e.getChildByName("Background").scale=1,e.name;var a=this.combatLayer.mainLayer.myHeroSprite;null!=a&&a.lifeStatus!=l.LIFE_STATUS.Dead&&(this.combatLayer.pressAttack=!1)},e.prototype.onClickEvent=function(t,e){if(0==e){if(p.default.Instance.combatLayer.gameStep!=l.GAME_STEP.Starting)return;p.default.Instance.combatScene.popLayer.reviewGamePauseLayer(l.PAGE_NAME.Combat,1)}else 1==e?this.pauseAndResume(!0,!0):2==e?p.default.Instance.combatScene.popLayer.reviewEquipmentlLayer(l.PAGE_NAME.Combat,1001):3==e?(this.startRecordNode.active=!1,this.endRecordNode.active=!0,d.default.Instance.recordStart(this,function(){})):4==e&&(this.startRecordNode.active=!0,this.endRecordNode.active=!1,d.default.Instance.recordEnd())},e.prototype.pauseAndResume=function(t,e){t?(p.default.Instance.mainLayer.pauseAllHero(e),this.combatLayer.mainLayer.nodeManager.pauseNode(e)):(p.default.Instance.mainLayer.resumeAllHero(e),this.combatLayer.mainLayer.nodeManager.resumeNode(e)),cc.director.getCollisionManager().enabled=!t},e.prototype.showHurtEffect=function(t){var e=this;if(this.hurtTime++,this.hurtNum+=t,this.hurtTime>1){this.hurtEffectNode.active=!0,this.hurtEffectNode.stopAllActions();var a=(this.hurtTime-1)%20+1+"";1==a.length&&(a="0"+a);var n=cc.find("Nums",this.hurtTimeNode),i=cc.find("Word",this.hurtTimeNode);n.stopAllActions(),n.runAction(cc.sequence(cc.scaleTo(.1,3),cc.scaleTo(.1,1.2))),i.stopAllActions(),i.runAction(cc.repeat(cc.sequence(cc.moveTo(.04,cc.v2(-10,0)),cc.moveTo(.04,cc.v2(0,0))),3));for(var o=this.hurtTime+"",r=1;r<=3;r++){var s=cc.find("Nums/Num"+r,this.hurtTimeNode);if(r<=o.length){s.active=!0;var c=parseInt(o.substr(r-1,1));h.AssetUtils.loadSpriteFrame(s,"Combat/fight_shuzi_0"+c)}else s.active=!1}this.hurtEffectNode.runAction(cc.sequence(cc.delayTime(5),cc.callFunc(function(){e.hurtTime=0,e.hurtNum=0,e.hurtEffectNode.active=!1},this)))}else this.hurtEffectNode.active=!1},e.prototype.showMonsterNum=function(){this.currRoommonsterTotalNum-this.currRoomdeadMonsterNum<0||(this.monsterNumNode.getComponent(cc.Label).string=this.currRoommonsterTotalNum-this.currRoomdeadMonsterNum+"")},e.prototype.gameInit=function(){this.totalCoin=0,this.hurtTime=0,this.monsterHpStartMove=!1,this.buffLastTime={},this.buffTime={},this.totalTime=180,this.showGameTime(0),this.setRoleLevel(!1);for(var t=cc.find("Left/Blood1/Buff",this.node),e=0;e<t.childrenCount;++e){var a=t.children[e];"Boss"!=a.name&&(a.active=!1)}for(e=1;e<6;++e)this.showSkillRate(0,e,1);if(this.updateSkillState(),1==this.combatLayer.dungeonInfo.type)this.coinNumNode.parent.active=!1,this.rewardNode.active=!0,this.timeNode.parent.active=!1,this.towerTimeNode.parent.active=!1;else if(5==this.combatLayer.dungeonInfo.type)this.totalTime=90,this.coinNumNode.parent.active=!1,this.rewardNode.active=!0,this.timeNode.parent.active=!1,this.towerTimeNode.parent.active=!0,this.towerLayerNode.getComponent(cc.Label).string="\u7b2c"+this.combatLayer.dungeonInfo.dungeon+"\u5c42",this.showGameTime(0);else{var n=["common_ziyuanA_01","common_ziyuanA_04","common_ziyuanA_03"][this.combatLayer.dungeonInfo.type-2];h.AssetUtils.loadSpriteFrame(this.coinImgNode,"Common/"+n),this.coinNumNode.parent.active=!0,this.rewardNode.active=!1,this.showMoney(0,!1),this.timeNode.parent.active=!0,this.towerTimeNode.parent.active=!1}this.showHurtEffect(0),this.smallMapLayer.resetSmallMap(),this.schedule(this.buffSchedule,.5),this.startRecordNode.active=!1,this.endRecordNode.active=!1},e.prototype.startRecord=function(){m.default.Platform==l.PLAT_FORM.Douyin&&(d.default.Instance.recordStart(this,function(){}),this.startRecordNode.active=!1,this.endRecordNode.active=!0)},e.prototype.resetGameTime=function(){this.totalTime=180,1==this.combatLayer.dungeonInfo.type||(5==this.combatLayer.dungeonInfo.type?(this.totalTime=90,this.showGameTime(0)):this.showGameTime(0))},e.prototype.showGameTime=function(t){if(this.timeNode.parent.active||this.towerTimeNode.parent.active){this.totalTime-=t;var e=Math.floor(this.totalTime/60),a=this.totalTime-60*e;this.timeNode.getComponent(cc.Label).string="0"+e+":"+(a>9?a:"0"+a),this.towerTimeNode.getComponent(cc.Label).string="0"+e+":"+(a>9?a:"0"+a),this.totalTime<=0&&this.combatLayer.gameOver(l.GAME_RESULT.Fail)}},e.prototype.setRoleLevel=function(t){var e=cc.find("Level",this.blood1Node),a=cc.find("Exp/Rate",this.blood1Node),n=cc.find("Exp/Num",this.blood1Node),i=c.default.Instance.playerData,o=p.default.Instance.moneyLogic.getItemCount(1005);e.getComponent(cc.Label).string="Lv."+(i.level>m.default.MAX_PLAYER_LEVEL?m.default.MAX_PLAYER_LEVEL:i.level);var r=o/p.default.Instance.roleLogic.getNextLevelExp();if(a.scaleX=r>1?1:r,n.getComponent(cc.Label).string=o+"/"+p.default.Instance.roleLogic.getNextLevelExp(),t){var s=this.combatLayer.mainLayer.myHeroSprite;s&&(s.hurtData(g.ATTRIBUTE_TYPE.ADD_HP,this.combatLayer.mainLayer.myHeroSprite.hpMax),s.heroNode.addEffect(l.EFFECT_TYPE.Effect_Upgrade,cc.v2(0,0),2,1,""),s.heroNode.addEffect(l.EFFECT_TYPE.Show_Word2,cc.v2(0,s.roleInfo.height+50),1,0,"\u7b49\u7ea7+1"),I.SoundManager.Instance.playEffect("shengji"))}},e.prototype.showBlood1=function(t,e){if(this.blood1Node.active=!0,t!=this.heroId1){var a=cc.find("Head",this.blood1Node),n=cc.find("Name",this.blood1Node),i=u.default.Instance.roleMap.get(t);h.AssetUtils.loadSpriteFrame(a,"Combat/fight_head_"+i.picture_id),n.getComponent(cc.Label).string=i.name}var o=cc.find("Blood/Rate0",this.blood1Node);cc.find("Blood/Rate1",this.blood1Node).scaleX=e,o.stopAllActions(),o.runAction(cc.scaleTo(.3,e,1))},e.prototype.showSkillRate=function(t,e,a){var n={1:1,2:2,3:8,4:4,5:5,6:3,7:6,8:7}[e],i=cc.find("Right/Skill"+n+"Btn",this.node);if(i){var o=cc.find("/progressBar",i),r=t/a;o.getComponent(cc.ProgressBar).progress=r<=0?.001:r;var s=cc.find("Time",o),c=Math.floor(t);s.getComponent(cc.Label).string=c<=0?"":c+""}},e.prototype.showBlood2=function(t,e){var a=this;if(!this.monsterHpStartMove){if(this.blood2Node.active=!0,t!=this.heroId1){var n=cc.find("Head",this.blood2Node),i=cc.find("Name",this.blood2Node),o=u.default.Instance.roleMap.get(t);h.AssetUtils.loadSpriteFrame(n,"Combat/fight_head_"+o.picture_id),i.getComponent(cc.Label).string=o.name}var r=cc.find("Blood/Rate0",this.blood2Node),s=cc.find("Blood/Rate1",this.blood2Node);cc.find("Blood/Rate2",this.blood2Node),s.scaleX=e,r.stopAllActions(),r.runAction(cc.sequence(cc.scaleTo(.3,e,1),cc.callFunc(function(){0==e&&(a.blood2Node.active=!1)},this)))}},e.prototype.showSceneChange=function(){var t=this;this.sceneChangeNode.active=!0,this.rightNode.opacity=0,this.leftNode.opacity=0,this.sceneChangeNode.getComponent(sp.Skeleton).setAnimation(0,"newAnimation",!1),this.sceneChangeNode.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.sceneChangeNode.active=!1,t.rightNode.opacity=255,t.leftNode.opacity=255,t.combatLayer.gameReStart2()},this)))},e.prototype.gameOver=function(){this.currRoommonsterTotalNum=0,this.currRoomdeadMonsterNum=0,this.specialItemNode.active=!1,this.smallMapLayer.gameOver(),d.default.Instance.hideBannerAd(),d.default.Instance.recordEnd()},e.prototype.showSpecialItem=function(t){var e=this;this.specialItemNode.active=!0,h.AssetUtils.loadSpriteFrame(this.specialItemNode,"Combat/"+t),this.specialItemNode.scale=1,this.specialItemNode.runAction(cc.sequence(cc.scaleTo(.3,2),cc.scaleTo(.1,1),cc.delayTime(1.5),cc.callFunc(function(){e.specialItemNode.active=!1},this)))},e.prototype.addBuffBox=function(t){var e=this.combatLayer.mainLayer.nodeManager.getBuffBox(t);this.buffBoxListNode.addChild(e.node)},e.prototype.addRewardTip=function(t,e,a){var n=this.combatLayer.mainLayer.nodeManager.getRewardTip(t,e,a);this.rewardNode.addChild(n.node)},e.prototype.showMoney=function(t,e){void 0===e&&(e=!0),2==this.combatLayer.dungeonInfo.type?(this.totalCoin+=t,this.newResCount=this.totalCoin):3==this.combatLayer.dungeonInfo.type?(this.totalCoin+=t,this.newResCount=this.totalCoin):4==this.combatLayer.dungeonInfo.type&&(this.totalCoin+=t,this.newResCount=this.totalCoin),e?(this.dtAddCoin=Math.floor((this.newResCount-this.oldResCount)/20),this.startCoinSchedule||this.schedule(this.coinSchedule,.05)):(this.coinNumNode.getComponent(cc.Label).string=y.default.stringToWord(this.newResCount),this.oldResCount=this.newResCount)},e.prototype.coinSchedule=function(){this.oldResCount+=this.dtAddCoin,this.oldResCount>=this.newResCount&&(this.oldResCount=this.newResCount,this.startCoinSchedule=!1,this.unschedule(this.coinSchedule)),this.coinNumNode.getComponent(cc.Label).string=y.default.stringToWord(this.oldResCount)},e.prototype.updateSkillState=function(){var t=p.default.Instance.roleLogic.getRoleData(c.default.Instance.playerData.roleId);for(var e in this.skillNodes){var a=this.skillNodes[e],n=u.default.Instance.unlockSkillMap.get(Number(e));cc.find("progressBar",a).active=!0,cc.find("Lock",a).active=0==t.skillLevel[n.skill_number-1],1==c.default.Instance.playerData.currChapter&&1==c.default.Instance.playerData.currDungeon&&1==c.default.Instance.playerData.currDiffculty?(cc.find("AdLock",a).active=!1,cc.find("Lock",a).active=!1):cc.find("AdLock",a).active=!1}},e.prototype.showBuffBiaoShi=function(t,e){cc.find("Left/Blood1/Buff/"+t,this.node).active=!0,this.buffTime[t]=0,this.buffLastTime[t],this.buffLastTime[t]=e},e.prototype.buffSchedule=function(t){for(var e in this.buffTime){this.buffTime[e]+=t;var a=cc.find("Left/Blood1/Buff/"+e,this.node),n=this.buffTime[e]/this.buffLastTime[e];a.getComponent(cc.ProgressBar).progress=n<=0?.01:n,this.buffTime[e]>=this.buffLastTime[e]&&(a.active=!1,this.buffLastTime[e]=0,this.buffTime[e]=0)}},e.prototype.adCallback=function(t,e,a){0==e?(0!=c.default.Instance.playerData.cdActiveFreeAd&&a||p.default.Instance.taskLogic.finishAllTask(_.default.type_see_ad_count1,0,1),t==d.default.AD_TYPE_GET_SKILL1||t==d.default.SHARE_TYPE_GET_SKILL1?cc.find("Right/Skill1Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL2||t==d.default.SHARE_TYPE_GET_SKILL2?cc.find("Right/Skill2Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL3||t==d.default.SHARE_TYPE_GET_SKILL3?cc.find("Right/Skill3Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL4||t==d.default.SHARE_TYPE_GET_SKILL4?cc.find("Right/Skill4Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL5||t==d.default.SHARE_TYPE_GET_SKILL5?cc.find("Right/Skill5Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL6||t==d.default.SHARE_TYPE_GET_SKILL6?cc.find("Right/Skill6Btn/AdLock",this.node).active=!1:t==d.default.AD_TYPE_GET_SKILL7||t==d.default.SHARE_TYPE_GET_SKILL7?cc.find("Right/Skill7Btn/AdLock",this.node).active=!1:t!=d.default.AD_TYPE_GET_SKILL8&&t!=d.default.SHARE_TYPE_GET_SKILL8||(cc.find("Right/Skill8Btn/AdLock",this.node).active=!1)):-1==e?(p.default.Instance.combatScene.showMsgInfo(m.default.NO_AD),d.default.Instance.noVideoToShare()&&(t==d.default.AD_TYPE_GET_SKILL1?this.shareType=d.default.SHARE_TYPE_GET_SKILL1:t==d.default.AD_TYPE_GET_SKILL2?this.shareType=d.default.SHARE_TYPE_GET_SKILL2:t==d.default.AD_TYPE_GET_SKILL3?this.shareType=d.default.SHARE_TYPE_GET_SKILL3:t==d.default.AD_TYPE_GET_SKILL4?this.shareType=d.default.SHARE_TYPE_GET_SKILL4:t==d.default.AD_TYPE_GET_SKILL5?this.shareType=d.default.SHARE_TYPE_GET_SKILL5:t==d.default.AD_TYPE_GET_SKILL6?this.shareType=d.default.SHARE_TYPE_GET_SKILL6:t==d.default.AD_TYPE_GET_SKILL7?this.shareType=d.default.SHARE_TYPE_GET_SKILL7:t==d.default.AD_TYPE_GET_SKILL8&&(this.shareType=d.default.SHARE_TYPE_GET_SKILL8),m.default.Platform==l.PLAT_FORM.Douyin?d.default.Instance.shareAppCallBack(this,this.shareAppCallback2):p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),d.default.Instance.shareApp())):p.default.Instance.combatScene.showMsgInfo(m.default.ERROR_AD)},e.prototype.shareAppCallback2=function(t){if(0==t){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(m.default.SUCCESS_SHARE,1),d.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else p.default.Instance.combatScene.showMsgInfo("\u5206\u4eab\u5931\u8d25\uff01")},e.prototype.shareAppCallback=function(){var t=(new Date).getTime(),e=Math.round((t-d.default.Instance.adServer.shareDateTime)/1e3);if(d.default.Instance.shareState(e)){if(!(c.default.Instance.playerData.shareGetRewardCount>0))return void p.default.Instance.combatScene.showMsgInfo("\u4eca\u65e5\u5206\u4eab\u6b21\u6570\u5df2\u7528\u5c3d");c.default.Instance.playerData.shareGetRewardCount-=1,p.default.Instance.combatScene.showMsgInfo(m.default.SUCCESS_SHARE,1),d.default.Instance.addShareEvent(this.shareType,!0),this.adCallback(this.shareType,0,!0)}else d.default.Instance.showModal(this.shareFailCallback,this)},e.prototype.shareFailCallback=function(t){0==t&&(p.default.Instance.combatScene.setEventShowCallback(this.shareAppCallback,this),d.default.Instance.shareApp())},s([S],e)}(cc.Component));o.default=L,cc._RF.pop()},{}],UnlockSkillInfo:[function(t,e,a){"use strict";cc._RF.push(e,"85608Z0DkFF84+yTENmZwyu","UnlockSkillInfo");var n=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var o=n("StringUtils");i.default=function(t){this.id=parseInt(t.id),this.role_id=o.default.stringToInt(t.role_id),this.name=t.name,this.type=o.default.stringToInt(t.type),this.skill_number=o.default.stringToInt(t.skill_number),this.skill_id=o.default.stringToInt(t.skill_id),this.unlock_condition1=o.default.stringToInt(t.unlock_condition1),this.value1=t.value1;var e=o.default.config_stringToIntList(this.value1,"_");this.value1List=e||[],this.unlock_condition2=o.default.stringToInt(t.unlock_condition2),this.value2=t.value2;var a=o.default.config_stringToIntList(this.value2,"_");this.value2List=a||[],this.cost_resource=t.cost_resource,this.costList=o.default.config_stringToIntListOfList(this.cost_resource,"_")},cc._RF.pop()},{}],VivoAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"071ed1SXmxNI5EXJioYWkiU","VivoAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0}),o.VivoAdServer=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.loadRewardAd=function(){},e.prototype.showInterAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(t,e){this.component2=t,this.func2=e},e.prototype.shareApp=function(){},e.prototype.showNativeAd=function(){},e.prototype.showNativeAd2=function(){},e.prototype.adReportEvent=function(){},e.prototype.adReportEvent2=function(){},e.prototype.adHandler=function(){},e.prototype.showPort=function(){},e.prototype.showGameIcon=function(){},e.prototype.hideGameIcon=function(){},e.prototype.setKeepScreenOn=function(){},e.prototype.vibrateShort=function(){},e.prototype.getLaunchOptionsSync=function(){},e}(i("BaseAdServer").default);o.VivoAdServer=s,cc._RF.pop()},{}],WarnSprite:[function(t,e,a){"use strict";cc._RF.push(e,"16e079vKjpJGYiKn5mBtiqs","WarnSprite");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("AssetUtils"),l=i("MainLogic"),h=cc._decorator,u=h.ccclass,d=(h.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.warnName=t,this.armatureDisplay=cc.find("Armature",this.node).getComponent(sp.Skeleton),c.AssetUtils.loadSpine(this.armatureDisplay,"Effect/"+t,null,function(){},this)},e.prototype.resetData=function(t,e,a){this.warnTime=e,this.node.x=t.x,this.node.y=t.y,this.externalNode=a,this.playAnimation(),this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(this.delete,this)))},e.prototype.pauseNode=function(){this.node.pauseAllActions(),cc.director.getScheduler().pauseTarget(this),this.armatureDisplay.timeScale=0},e.prototype.resumeNode=function(){this.node.resumeAllActions(),cc.director.getScheduler().resumeTarget(this),this.armatureDisplay.timeScale=1},e.prototype.playAnimation=function(){var t,e=1;switch(this.warnName){case"effect32_yvjing":t="yvjing",e=0}this.armatureDisplay.setAnimation(0,t,0==e)},e.prototype.delete=function(){this.node.stopAllActions(),l.default.Instance.combatScene.combatLayer.mainLayer.nodeManager.pubWarnSprite(this)},s([u],e)}(cc.Component));o.default=d,cc._RF.pop()},{}],WeaponShadow:[function(t,e,a){"use strict";cc._RF.push(e,"134f5am4ttPpZC1U2030jAi","WeaponShadow");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),s=function(t,e,a,n){var i,o=arguments.length,r=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,a,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(o<3?i(r):o>3?i(e,a,r):i(e,a))||r);return o>3&&r&&Object.defineProperty(e,a,r),r};Object.defineProperty(o,"__esModule",{value:!0});var c=i("ConfigData"),l=i("AssetUtils"),h=i("MainLogic"),u=cc._decorator,d=u.ccclass,p=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(t){this.heroSprite=t,this.weaponNode=cc.find("Weapon",this.node),this.node.scaleX=1.3*this.heroSprite.node.scale,this.node.scaleY=1.6*this.heroSprite.node.scale},e.prototype.review=function(t,e){var a=this,n=h.default.Instance.equipmentLogic.getEquipmentData(t),i=c.default.Instance.equipmentMap.get(n.equipmentId),o="Weapon/"+i.res_id+"_1",r=h.default.Instance.combatLayer.mainLayer.currFightMap.objectLayer.convertToNodeSpaceAR(e.pos);if(this.weaponNode.opacity=255,this.node.setPosition(r),this.node.angle=e.angle,this.weaponNode.scaleY=this.heroSprite.heroStatus.face,this.weaponPath!=o){this.weaponPath=o;var s=h.default.Instance.roleLogic.getWeaponShadowPos(i.res_id);this.weaponNode.setPosition(cc.v2(s.x,0-s.y)),l.AssetUtils.loadSpriteFrame(this.weaponNode,this.weaponPath)}this.weaponNode.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){a.delete()},this)))},e.prototype.delete=function(){this.node.stopAllActions(),h.default.Instance.combatLayer.mainLayer.nodeManager.putWeaponShadow(this)},s([d],e)}(cc.Component));o.default=p,cc._RF.pop()},{}],Web4399AdServer:[function(t,e,a){"use strict";cc._RF.push(e,"7e3e8ayoFhLqYaLUNt8aS7S","Web4399AdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0}),o.Web4399AdServer=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){this.haveAd=!0},e.prototype.load=function(){},e.prototype.showInterAd=function(){},e.prototype.loadRewardAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(){},e.prototype.shareApp=function(){},e.prototype.adHandler=function(t,e,a){console.log("4399 Web\u5e7f\u544a\u5df2\u8df3\u8fc7\uff0c\u76f4\u63a5\u9886\u53d6\u5956\u52b1\uff0c\u7c7b\u578b:",t),this.type=t,this.component=e,this.func=a,this.func.call(this.component,this.type,0)},e.prototype.showPort=function(){},e.prototype.showGameIcon=function(){},e.prototype.hideGameIcon=function(){},e.prototype.login=function(t,e){window.h5api.isLogin()?(console.log("\u767b\u5f55\u6a21\u5f0f"),e.call(t,0)):(console.log("\u6e38\u5ba2\u6a21\u5f0f"),e.call(t,-1))},e.prototype.submitRankScore=function(t,e){window.h5api.submitRankScore(t,e,function(t){console.log("\u63d0\u4ea4\u7ed3\u679c\uff1a",t.data.score,t.data.rank)})},e.prototype.showRankList=function(){window.h5api.showRankList()},e.prototype.readingFiles=function(t,e){window.h5api.save({type:"read",more:!1,callback:function(a){console.log(" read file ",a),1e3===a.code?t.call(e,a.data):t.call(e,null)}})},e.prototype.writeFiles=function(t,e,a){window.h5api.save({type:"write",more:!1,title:"xfkdPlayerData01",data:t,callback:function(t){console.log(" write file ",t),1e3===t.code?e.call(a,0):e.call(a,1)}})},e}(i("BaseAdServer").default);o.Web4399AdServer=s,cc._RF.pop()},{}],WebAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"8cd15cax5VICboWo44FXe/f","WebAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0}),o.WebAdServer=void 0;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.showInterAd=function(){},e.prototype.loadRewardAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(t,e){this.component2=t,this.func2=e},e.prototype.shareApp=function(){},e.prototype.adHandler=function(t,e,a){console.log("Web\u5e7f\u544a\u5df2\u8df3\u8fc7\uff0c\u76f4\u63a5\u9886\u53d6\u5956\u52b1\uff0c\u7c7b\u578b:",t),this.type=t,this.component=e,this.func=a,this.func.call(this.component,this.type,0)},e.prototype.showPort=function(){},e.prototype.showGameIcon=function(){},e.prototype.hideGameIcon=function(){},e}(i("BaseAdServer").default);o.WebAdServer=s,cc._RF.pop()},{}],WxAdServer:[function(t,e,a){"use strict";cc._RF.push(e,"633e1N3EDpH85j5sBaXjtzd","WxAdServer");var n,i=t,o=a,r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)});Object.defineProperty(o,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.init=function(){},e.prototype.load=function(){},e.prototype.loadRewardAd=function(){},e.prototype.showShareMenu=function(){},e.prototype.showInterAd=function(){},e.prototype.createBannerAd=function(){},e.prototype.showBannerAd=function(){},e.prototype.hideBannerAd=function(){},e.prototype.shareAppCallBack=function(t,e){this.component2=t,this.func2=e},e.prototype.shareApp=function(){},e.prototype.adHandler=function(){},e.prototype.showCustomAd=function(){},e.prototype.hideCustomAd=function(){},e.prototype.vibrateShort=function(){},e.prototype.navigateToMiniProgram=function(){},e.prototype.showModal=function(){},e.prototype.getSetting=function(){},e.prototype.openSetting=function(){},e.prototype.getUserInfo=function(){},e.prototype.createUserInfoButton=function(){},e.prototype.createUserInfoButton2=function(){},e.prototype.hideUserInfoBtn=function(){},e.prototype.setKeepScreen=function(){},e.prototype.login=function(){},e.prototype.showSubscribeStatus=function(){},e.prototype.showSubscribeMessage=function(){},e.prototype.openCustomerServiceConversation=function(){},e.prototype.getLaunchOptions=function(){},e.prototype.setClipboardData=function(){},e}(i("BaseAdServer").default);o.default=s,cc._RF.pop()},{}]},{},["ActionTagLogic","ActivityItem","ActivityLayer","AdOrDiamondLogic","AdServer","AssetUtils","BaseAdServer","BuffBox","BuffData","BuffEnum","BuffInfo","BuffManager","BuffObject","BuffUtil","BulletData","BulletSprite","BunnyFashion","CdkeyLayer","ChapterBoxData","ChapterData","ChapterInfo","ChapterItem","ChapterLayer","ChapterLogic","ChapterMorePage","CircleRectIntersect","ClimbTowerLayer","CombatLayer","CombatResultLayer","CombatScene","ConfigData","DailyTaskData","DataUtils","DateUtils","DiamWelfareLayer","Dictionary","DouyinAdServer","DropInfo","DropItemSprite","DungeonInfo","EffectSprite","EndlessInfo","EndlessItem","EndlessLayer","EndlessModeItem","EquipmentData","EquipmentGrowInfo","EquipmentInfo","EquipmentLayer","EquipmentLogic","ExtroEffectInfo","FashionGrid","FashionLayer","FestivalInfo","FightMap","FightMapData","FightObject","FriendHelpItem","FriendsHelpLayer","GameData","GamePauseLayer","GameRecordLayer","GearInfo","GiftBagLogic","GiftInfo","GrayLayer","GrowData","GuestItem","GuideConfig","GuideLayer","GuideTaskData","GuideUtils","HeroArmature","HeroCollider","HeroControl","HeroEventData","HeroLog","HeroLogic","HeroNode","HeroShooter","HeroSprite","HeroStateMachine","HeroStatus","HeroTitle","HeroTitleLayer","HomeLayer","HomeUiLayer","HpTube","HurtData","HurtUtil","ItemInfo","ItemSprite","KnapsackItem","KnifeShadow","LoadingScene","LoginLogic","LotteryLayer","LotteryLogic","MailLayer","MailTitle","MainCamera","MainLayer","MainLogic","MoneyLogic","MoneyMorePage","MonsterManager","MoreFashionLayer","MoreGameLayer","MyMathUtils","MyPlatUtils","NodeManager","NoticeItem","NoticeLayer","NpcAbility","NpcAction","NpcAi","NpcBrain","NumberMethod","OppAdServer","PassCheckLayer","PlayerAttribute","PlayerData","PopLayer","PropData","PublicConst","PublicEnum","QmLocalStorage","QqAdServer","RankArmItem","RankingItem","RankingLayer","RectCircle","ResolveLayer","ResourceInfo","ResultCardItem","RevivedLayer","RewardEffectSprite","RewardItem","RewardLayer","RewardTip","RobotInfo","RockerLayer","RoleAdTimesData","RoleData","RoleEquipData","RoleGrowInfo","RoleInfo","RoleLogic","SceneNodeManager","SettingLayer","ShadowEffect","ShakeComponent","ShakeJarLayer","ShopData","ShopFashionItem","ShopInfo","ShopLayer","ShopLogic","ShopPropItem","SigninItem","SigninLayer","SigninLogic","SkillGrowInfo","SkillHurtInfo","SkillInfo","SkillItem","SkillLayer","SkillManager","SkillObject","SmallMapItem","SmallMapLayer","SortDataList","SoundManager","StageInfo","StreetHero","StreetLayer","StreetRockerLayer","StrengthenCostItem","StrengthenLayer","StrengthenSuccLayer","StringUtils","SuperItem","TalentInfo","TalentItem","TalentLayer","TaskData","TaskInfo","TaskItem","TaskLayer","TaskLogic","ThreadTask","TimeLogSerer","TipsLogic","TowerRewardInfo","TrapInfo","TrapShooter","TrapSprite","UiLayer","UnlockSkillInfo","VivoAdServer","WarnSprite","WeaponShadow","Web4399AdServer","WebAdServer","WxAdServer"]);